!function(o,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ol=t():o.ol=t()}(window,function(){var P=Math.abs,p=String.fromCharCode,o=Math.LN2,M=Math.pow,F=Math.ceil,E=Math.min,C=Math.max,N=Math.floor,ee=Math.sqrt,d=Math.exp,m=Math.log;return function(o){function a(e){if(t[e])return t[e].exports;var r=t[e]={i:e,l:!1,exports:{}};return o[e].call(r.exports,r,r.exports,a),r.l=!0,r.exports}var t={};return a.m=o,a.c=t,a.d=function(o,t,e){a.o(o,t)||Object.defineProperty(o,t,{enumerable:!0,get:e})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(o,r){if(1&r&&(o=a(o)),8&r)return o;if(4&r&&"object"==typeof o&&o&&o.__esModule)return o;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:o}),2&r&&"string"!=typeof o)for(var n in o)a.d(e,n,function(t){return o[t]}.bind(null,n));return e},a.n=function(o){var t=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(t,"a",t),t},a.o=function(o,t){return Object.prototype.hasOwnProperty.call(o,t)},a.p="",a(a.s=7)}([function(e){e.exports=function(){"use strict";function g(r,t,n,i,o){!function e(t,r,n,x,S){for(;x>n;){if(600<x-n){var a=x-n+1,s=r-n+1,u=m(a),l=.5*d(2*u/3),h=.5*ee(u*l*(a-l)/a)*(0>s-a/2?-1:1),c=C(n,N(r-s*l/a+h)),p=E(x,N(r+(a-s)*l/a+h));e(t,r,c,p,S)}var f=t[r],T=n,P=x;for(y(t,n,r),0<S(t[x],f)&&y(t,n,x);T<P;){for(y(t,T,P),T++,P--;0>S(t[T],f);)T++;for(;0<S(t[P],f);)P--}0===S(t[n],f)?y(t,n,P):(P++,y(t,P,x)),P<=r&&(n=P+1),r<=P&&(x=P-1)}}(r,t,n||0,i||r.length-1,o||e)}function y(o,t,e){var r=o[t];o[t]=o[e],o[e]=r}function e(o,t){return o<t?-1:o>t?1:0}function r(o,t,e){if(!e)return t.indexOf(o);for(var r=0;r<t.length;r++)if(e(o,t[r]))return r;return-1}function x(o,t){S(o,0,o.children.length,t,o)}function S(s,t,e,r,n){n||(n=R(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var l=t,p;l<e;l++)p=s.children[l],T(n,s.leaf?r(p):p);return n}function T(o,t){return o.minX=E(o.minX,t.minX),o.minY=E(o.minY,t.minY),o.maxX=C(o.maxX,t.maxX),o.maxY=C(o.maxY,t.maxY),o}function o(o,t){return o.minX-t.minX}function a(o,t){return o.minY-t.minY}function P(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function s(e){return e.maxX-e.minX+(e.maxY-e.minY)}function c(o,t){return o.minX<=t.minX&&o.minY<=t.minY&&t.maxX<=o.maxX&&t.maxY<=o.maxY}function l(o,t){return t.minX<=o.maxX&&t.minY<=o.maxY&&t.maxX>=o.minX&&t.maxY>=o.minY}function R(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function w(t,e,l,p,i){for(var o=[e,l];o.length;)if(!((l=o.pop())-(e=o.pop())<=p)){var a=e+F((l-e)/p/2)*p;g(t,a,e,l,i),o.push(e,a,a,l)}}var t=function(e){void 0===e&&(e=9),this._maxEntries=C(4,e),this._minEntries=C(2,F(.4*this._maxEntries)),this.clear()};return t.prototype.all=function(){return this._all(this.data,[])},t.prototype.search=function(p){var t=this.data,d=[];if(!l(p,t))return d;for(var r=this.toBBox,n=[];t;){for(var i=0;i<t.children.length;i++){var _=t.children[i],a=t.leaf?r(_):_;l(p,a)&&(t.leaf?d.push(_):c(p,a)?this._all(_,d):n.push(_))}t=n.pop()}return d},t.prototype.collides=function(a){var t=this.data;if(!l(a,t))return!1;for(var s=[];t;){for(var r=0;r<t.children.length;r++){var p=t.children[r],i=t.leaf?this.toBBox(p):p;if(l(a,i)){if(t.leaf||c(a,i))return!0;s.push(p)}}t=s.pop()}return!1},t.prototype.load=function(o){if(!o||!o.length)return this;if(o.length<this._minEntries){for(var t=0;t<o.length;t++)this.insert(o[t]);return this}var i=this._build(o.slice(),0,o.length-1,0);if(!this.data.children.length)this.data=i;else if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var a=this.data;this.data=i,i=a}this._insert(i,this.data.height-i.height-1,!0)}return this},t.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},t.prototype.clear=function(){return this.data=R([]),this},t.prototype.remove=function(i,t){if(!i)return this;for(var e=this.data,p=this.toBBox(i),s=[],d=[],l,_,g;e||s.length;){if(e||(e=s.pop(),_=s[s.length-1],l=d.pop(),g=!0),e.leaf){var u=r(i,e.children,t);if(-1!==u)return e.children.splice(u,1),s.push(e),this._condense(s),this}g||e.leaf||!c(e,p)?_?(l++,e=_.children[l],g=!1):e=null:(s.push(e),d.push(l),l=0,_=e,e=e.children[0])}return this},t.prototype.toBBox=function(e){return e},t.prototype.compareMinX=function(o,t){return o.minX-t.minX},t.prototype.compareMinY=function(o,t){return o.minY-t.minY},t.prototype.toJSON=function(){return this.data},t.prototype.fromJSON=function(e){return this.data=e,this},t.prototype._all=function(o,n){for(var e=[];o;)o.leaf?n.push.apply(n,o.children):e.push.apply(e,o.children),o=e.pop();return n},t.prototype._build=function(o,t,e,r){var d=e-t+1,a=this._maxEntries,_;if(d<=a)return x(_=R(o.slice(t,e+1)),this.toBBox),_;r||(r=F(m(d)/m(a)),a=F(d/M(a,r-1))),(_=R([])).leaf=!1,_.height=r;var g=F(d/a),u=g*F(ee(a));w(o,t,e,u,this.compareMinX);for(var l=t,y;l<=e;l+=u){y=E(l+u-1,e),w(o,l,y,g,this.compareMinY);for(var S=l,T;S<=y;S+=g)T=E(S+g-1,y),_.children.push(this._build(o,S,T,r-1))}return x(_,this.toBBox),_},t.prototype._chooseSubtree=function(d,t,_,r){for(;r.push(t),!t.leaf&&r.length-1!==_;){for(var n=1/0,g=1/0,y=void 0,m=0;m<t.children.length;m++){var h=t.children[m],u=P(h),l=(c=d,x=h,(C(x.maxX,c.maxX)-E(x.minX,c.minX))*(C(x.maxY,c.maxY)-E(x.minY,c.minY))-u);l<g?(g=l,n=u<n?u:n,y=h):l===g&&u<n&&(n=u,y=h)}t=y||t.children[0]}var c,x;return t},t.prototype._insert=function(a,t,s){var r=s?a:this.toBBox(a),n=[],i=this._chooseSubtree(r,this.data,t,n);for(i.children.push(a),T(i,r);0<=t&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(r,n,t)},t.prototype._split=function(o,t){var e=o[t],r=e.children.length,n=this._minEntries;this._chooseSplitAxis(e,n,r);var i=this._chooseSplitIndex(e,n,r),a=R(e.children.splice(i,e.children.length-i));a.height=e.height,a.leaf=e.leaf,x(e,this.toBBox),x(a,this.toBBox),t?o[t-1].children.push(a):this._splitRoot(e,a)},t.prototype._splitRoot=function(o,t){this.data=R([o,t]),this.data.height=o.height+1,this.data.leaf=!1,x(this.data,this.toBBox)},t.prototype._chooseSplitIndex=function(a,t,e){for(var r=1/0,m=1/0,h=t,x,T,R,w,L,I,b;h<=e-t;h++){var F=S(a,0,h,this.toBBox),_=S(a,h,e,this.toBBox),g=(T=F,R=_,w=void 0,L=void 0,I=void 0,b=void 0,w=C(T.minX,R.minX),L=C(T.minY,R.minY),I=E(T.maxX,R.maxX),b=E(T.maxY,R.maxY),C(0,I-w)*C(0,b-L)),y=P(F)+P(_);g<r?(r=g,x=h,m=y<m?y:m):g===r&&y<m&&(m=y,x=h)}return x||e-t},t.prototype._chooseSplitAxis=function(s,t,e){var r=s.leaf?this.compareMinX:o,n=s.leaf?this.compareMinY:a;this._allDistMargin(s,t,e,r)<this._allDistMargin(s,t,e,n)&&s.children.sort(r)},t.prototype._allDistMargin=function(a,t,e,r){a.children.sort(r);for(var n=this.toBBox,i=S(a,0,t,n),o=S(a,e-t,e,n),_=s(i)+s(o),g=t,u;g<e-t;g++)u=a.children[g],T(i,a.leaf?n(u):u),_+=s(i);for(var c=e-t-1,y;c>=t;c--)y=a.children[c],T(o,a.leaf?n(y):y),_+=s(o);return _},t.prototype._adjustParentBBoxes=function(o,t,e){for(var r=e;0<=r;r--)T(t[r],o)},t.prototype._condense=function(o){for(var t=o.length-1,n=void 0;0<=t;t--)0===o[t].children.length?0<t?(n=o[t-1].children).splice(n.indexOf(o[t]),1):this.clear():x(o[t],this.toBBox)},t}()},function(){function e(o,n,e){o.addEventListener(n,function(r){var t=new MouseEvent(e,r);t.pointerId=1,t.isPrimary=!0,t.pointerType="mouse",t.width=1,t.height=1,t.tiltX=0,t.tiltY=0,t.pressure="buttons"in r&&0!==r.buttons?.5:0;var i=r.target;null!==a&&(i=a,"mouseup"===n&&(a=null)),i.dispatchEvent(t),t.defaultPrevented&&r.preventDefault()})}function t(r,p,e){r.addEventListener(p,function(r){for(var t=r.changedTouches,n=t.length,i=0,d;i<n;i++){d=new CustomEvent(e,{bubbles:!0,cancelable:!0}),d.ctrlKey=r.ctrlKey,d.shiftKey=r.shiftKey,d.altKey=r.altKey,d.metaKey=r.metaKey;var _=t.item(i);d.clientX=_.clientX,d.clientY=_.clientY,d.screenX=_.screenX,d.screenY=_.screenY,d.pageX=_.pageX,d.pageY=_.pageY;var g=_.target.getBoundingClientRect();d.offsetX=_.clientX-g.left,d.offsetY=_.clientY-g.top,d.pointerId=1+_.identifier,d.button=0,d.buttons=1,d.movementX=0,d.movementY=0,d.region=null,d.relatedTarget=null,d.x=d.clientX,d.y=d.clientY,d.pointerType="touch",d.width=1,d.height=1,d.tiltX=0,d.tiltY=0,d.pressure=1,"touchstart"===p&&null===o&&(o=_.identifier),d.isPrimary=_.identifier===o,"touchend"===p&&d.isPrimary&&(o=null),r.target.dispatchEvent(d),d.defaultPrevented&&r.preventDefault()}})}var o=null,a=null;"PointerEvent"in window||(Element.prototype.setPointerCapture=Element.prototype.setCapture,Element.prototype.releasePointerCapture=Element.prototype.releaseCapture,"TouchEvent"in window||(e(document,"mousedown","pointerdown"),e(document,"mousemove","pointermove"),e(document,"mouseup","pointerup")),t(document,"touchstart","pointerdown"),t(document,"touchmove","pointermove"),t(document,"touchend","pointerup"))},function(S,t,e){"use strict";function E(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}function i(e){return e.type===E.Bytes?e.readVarint()+e.pos:e.pos+1}function a(o,t,e){return e?4294967296*t+(o>>>0):4294967296*(t>>>0)+(o>>>0)}function s(a,t,e){var r=16383>=t?1:2097151>=t?2:268435455>=t?3:N(m(t)/(7*o));e.realloc(r);for(var n=e.pos-1;n>=a;n--)e.buf[n+r]=e.buf[n]}function r(o,t){for(var e=0;e<o.length;e++)t.writeVarint(o[e])}function l(o,t){for(var e=0;e<o.length;e++)t.writeSVarint(o[e])}function u(o,t){for(var e=0;e<o.length;e++)t.writeFloat(o[e])}function c(o,t){for(var e=0;e<o.length;e++)t.writeDouble(o[e])}function h(o,t){for(var e=0;e<o.length;e++)t.writeBoolean(o[e])}function f(o,t){for(var e=0;e<o.length;e++)t.writeFixed32(o[e])}function d(o,t){for(var e=0;e<o.length;e++)t.writeSFixed32(o[e])}function _(o,t){for(var e=0;e<o.length;e++)t.writeFixed64(o[e])}function g(o,t){for(var e=0;e<o.length;e++)t.writeSFixed64(o[e])}function y(o,t){return(o[t]|o[t+1]<<8|o[t+2]<<16)+16777216*o[t+3]}function T(o,t,e){o[e]=t,o[e+1]=t>>>8,o[e+2]=t>>>16,o[e+3]=t>>>24}function C(o,t){return(o[t]|o[t+1]<<8|o[t+2]<<16)+(o[t+3]<<24)}S.exports=E;var x=e(4);E.Varint=0,E.Fixed64=1,E.Bytes=2,E.Fixed32=5;var n="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");E.prototype={destroy:function(){this.buf=null},readFields:function(i,t,e){for(e=e||this.length;this.pos<e;){var a=this.readVarint(),n=this.pos;this.type=7&a,i(a>>3,t,this),this.pos===n&&this.skip(a)}return t},readMessage:function(o,t){return this.readFields(o,t,this.readVarint()+this.pos)},readFixed32:function(){var e=y(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=C(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=y(this.buf,this.pos)+4294967296*y(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=y(this.buf,this.pos)+4294967296*C(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=x.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=x.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(o){var t=this.buf,n,i;return n=127&(i=t[this.pos++]),128>i?n:(n|=(127&(i=t[this.pos++]))<<7,128>i?n:(n|=(127&(i=t[this.pos++]))<<14,128>i?n:(n|=(127&(i=t[this.pos++]))<<21,128>i?n:function(s,t,e){var r=e.buf,o,l;if(l=r[e.pos++],o=(112&l)>>4,128>l)return a(s,o,t);if(l=r[e.pos++],o|=(127&l)<<3,128>l)return a(s,o,t);if(l=r[e.pos++],o|=(127&l)<<10,128>l)return a(s,o,t);if(l=r[e.pos++],o|=(127&l)<<17,128>l)return a(s,o,t);if(l=r[e.pos++],o|=(127&l)<<24,128>l)return a(s,o,t);if(l=r[e.pos++],o|=(1&l)<<31,128>l)return a(s,o,t);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(i=t[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return 1==e%2?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,t=this.pos;return this.pos=o,12<=o-t&&n?function(o,t,e){return n.decode(o.subarray(t,e))}(this.buf,t,o):function(d,t,e){for(var r="",_=t;_<e;){var g=d[_],u=null,c=239<g?4:223<g?3:191<g?2:1,y,m,f;if(_+c>e)break;1==c?128>g&&(u=g):2===c?128==(192&(y=d[_+1]))&&127>=(u=(31&g)<<6|63&y)&&(u=null):3===c?(y=d[_+1],m=d[_+2],128==(192&y)&&128==(192&m)&&(2047>=(u=(15&g)<<12|(63&y)<<6|63&m)||55296<=u&&57343>=u)&&(u=null)):4==c&&(y=d[_+1],m=d[_+2],f=d[_+3],128==(192&y)&&128==(192&m)&&128==(192&f)&&(65535>=(u=(15&g)<<18|(63&y)<<12|(63&m)<<6|63&f)||1114112<=u)&&(u=null)),null===u?(u=65533,c=1):65535<u&&(u-=65536,r+=p(55296|1023&u>>>10),u=56320|1023&u),r+=p(u),_+=c}return r}(this.buf,t,o)},readBytes:function(){var o=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,o);return this.pos=o,t},readPackedVarint:function(o,n){if(this.type!==E.Bytes)return o.push(this.readVarint(n));var e=i(this);for(o=o||[];this.pos<e;)o.push(this.readVarint(n));return o},readPackedSVarint:function(o){if(this.type!==E.Bytes)return o.push(this.readSVarint());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==E.Bytes)return o.push(this.readBoolean());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==E.Bytes)return o.push(this.readFloat());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==E.Bytes)return o.push(this.readDouble());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==E.Bytes)return o.push(this.readFixed32());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==E.Bytes)return o.push(this.readSFixed32());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==E.Bytes)return o.push(this.readFixed64());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==E.Bytes)return o.push(this.readSFixed64());var r=i(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed64());return o},skip:function(o){var t=7&o;if(t===E.Varint)for(;127<this.buf[this.pos++];);else if(t===E.Bytes)this.pos=this.readVarint()+this.pos;else if(t===E.Fixed32)this.pos+=4;else{if(t!==E.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(o,t){this.writeVarint(o<<3|t)},realloc:function(o){for(var t=this.length||16;t<this.pos+o;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),T(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),T(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),T(this.buf,-1&e,this.pos),T(this.buf,N(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),T(this.buf,-1&e,this.pos),T(this.buf,N(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){268435455<(e=+e||0)||0>e?function(o,t){var e,i;if(0<=o?(e=0|o%4294967296,i=0|o/4294967296):(i=~(-o/4294967296),4294967295^(e=~(-o%4294967296))?e=0|e+1:(e=0,i=0|i+1)),0x10000000000000000<=o||-0x10000000000000000>o)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(o,n,e){e.buf[e.pos++]=128|127&o,o>>>=7,e.buf[e.pos++]=128|127&o,o>>>=7,e.buf[e.pos++]=128|127&o,o>>>=7,e.buf[e.pos++]=128|127&o,o>>>=7,e.buf[e.pos]=127&o}(e,0,t),function(o,n){var e=(7&o)<<4;(n.buf[n.pos++]|=e|((o>>>=3)?128:0),!o)||(n.buf[n.pos++]=127&o|((o>>>=7)?128:0),!o)||(n.buf[n.pos++]=127&o|((o>>>=7)?128:0),!o)||(n.buf[n.pos++]=127&o|((o>>>=7)?128:0),!o)||(n.buf[n.pos++]=127&o|((o>>>=7)?128:0),!o)||(n.buf[n.pos++]=127&o)}(i,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&(e>>>=7)|(127<e?128:0),127>=e||(this.buf[this.pos++]=127&e>>>7))))},writeSVarint:function(e){this.writeVarint(0>e?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(o){o=o+"",this.realloc(4*o.length),this.pos++;var n=this.pos;this.pos=function(a,t,e){for(var s=0,l,p;s<t.length;s++){if(55295<(l=t.charCodeAt(s))&&57344>l){if(!p){56319<l||s+1===t.length?(a[e++]=239,a[e++]=191,a[e++]=189):p=l;continue}if(56320>l){a[e++]=239,a[e++]=191,a[e++]=189,p=l;continue}l=65536|(p-55296<<10|l-56320),p=null}else p&&(a[e++]=239,a[e++]=191,a[e++]=189,p=null);128>l?a[e++]=l:(2048>l?a[e++]=192|l>>6:(65536>l?a[e++]=224|l>>12:(a[e++]=240|l>>18,a[e++]=128|63&l>>12),a[e++]=128|63&l>>6),a[e++]=128|63&l)}return e}(this.buf,o,this.pos);var e=this.pos-n;128<=e&&s(n,e,this),this.pos=n-1,this.writeVarint(e),this.pos+=e},writeFloat:function(e){this.realloc(4),x.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),x.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var t=o.length;this.writeVarint(t),this.realloc(t);for(var e=0;e<t;e++)this.buf[this.pos++]=o[e]},writeRawMessage:function(o,t){this.pos++;var e=this.pos;o(t,this);var r=this.pos-e;128<=r&&s(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeMessage:function(o,t,e){this.writeTag(o,E.Bytes),this.writeRawMessage(t,e)},writePackedVarint:function(o,t){t.length&&this.writeMessage(o,r,t)},writePackedSVarint:function(o,t){t.length&&this.writeMessage(o,l,t)},writePackedBoolean:function(o,t){t.length&&this.writeMessage(o,h,t)},writePackedFloat:function(o,t){t.length&&this.writeMessage(o,u,t)},writePackedDouble:function(o,t){t.length&&this.writeMessage(o,c,t)},writePackedFixed32:function(o,t){t.length&&this.writeMessage(o,f,t)},writePackedSFixed32:function(o,t){t.length&&this.writeMessage(o,d,t)},writePackedFixed64:function(o,t){t.length&&this.writeMessage(o,_,t)},writePackedSFixed64:function(o,t){t.length&&this.writeMessage(o,g,t)},writeBytesField:function(o,t){this.writeTag(o,E.Bytes),this.writeBytes(t)},writeFixed32Field:function(o,t){this.writeTag(o,E.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(o,t){this.writeTag(o,E.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(o,t){this.writeTag(o,E.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(o,t){this.writeTag(o,E.Fixed64),this.writeSFixed64(t)},writeVarintField:function(o,t){this.writeTag(o,E.Varint),this.writeVarint(t)},writeSVarintField:function(o,t){this.writeTag(o,E.Varint),this.writeSVarint(t)},writeStringField:function(o,t){this.writeTag(o,E.Bytes),this.writeString(t)},writeFloatField:function(o,t){this.writeTag(o,E.Fixed32),this.writeFloat(t)},writeDoubleField:function(o,t){this.writeTag(o,E.Fixed64),this.writeDouble(t)},writeBooleanField:function(o,t){this.writeVarintField(o,!!t)}}},function(o,t,e){var r=e(5);t.Processor=r},function(r,t){t.read=function(d,t,e,r,n){var i=8*n-r-1,s=(1<<i)-1,_=s>>1,l=-7,g=e?n-1:0,u=e?-1:1,p=d[t+g],y,m;for(g+=u,y=p&(1<<-l)-1,p>>=-l,l+=i;0<l;y=256*y+d[t+g],g+=u,l-=8);for(m=y&(1<<-l)-1,y>>=-l,l+=r;0<l;m=256*m+d[t+g],g+=u,l-=8);if(0===y)y=1-_;else{if(y===s)return m?NaN:1/0*(p?-1:1);m+=M(2,r),y-=_}return(p?-1:1)*m*M(2,y-r)},t.write=function(g,t,y,r,n,x){var S=8*x-n-1,E=(1<<S)-1,h=E>>1,c=23===n?5.960464477539063e-8-6.617444900424222e-24:0,p=r?0:x-1,T=r?1:-1,d=0>t||0===t&&0>1/t?1:0,_,C,R;for(t=P(t),isNaN(t)||t===1/0?(C=isNaN(t)?1:0,_=E):(_=N(m(t)/o),1>t*(R=M(2,-_))&&(_--,R*=2),2<=(t+=1<=_+h?c/R:c*M(2,1-h))*R&&(_++,R/=2),_+h>=E?(C=0,_=E):1<=_+h?(C=(t*R-1)*M(2,n),_+=h):(C=t*M(2,h-1)*M(2,n),_=0));8<=n;g[y+p]=255&C,p+=T,C/=256,n-=8);for(_=_<<n|C,S+=n;0<S;g[y+p]=255&_,p+=T,_/=256,S-=8);g[y+p-T]|=128*d}},function(s,t,e){function l(s){function t(e,t,r){return o?new ImageData(e,t,r):{data:e,width:t,height:r}}var o=!0;try{new ImageData(10,10)}catch(e){o=!1}return function(r){var e=r.buffers,o=r.meta,a=r.imageOps,m=r.width,u=r.height,l=e.length,h=e[0].byteLength,c,x;if(a){var S=Array(l);for(x=0;x<l;++x)S[x]=t(new Uint8ClampedArray(e[x]),m,u);c=s(S,o).data}else{c=new Uint8ClampedArray(h);var p=Array(l),f=Array(l);for(x=0;x<l;++x)p[x]=new Uint8ClampedArray(e[x]),f[x]=[0,0,0,0];for(var d=0;d<h;d+=4){for(var E=0,T;E<l;++E)T=p[E],f[E][0]=T[d],f[E][1]=T[d+1],f[E][2]=T[d+2],f[E][3]=T[d+3];var C=s(f,o);c[d]=C[0],c[d+1]=C[1],c[d+2]=C[2],c[d+3]=C[3]}}return c.buffer}}function i(i,t){var e=Object.keys(i.lib||{}).map(function(t){return"var "+t+" = "+i.lib[t].toString()+";"}).concat(["var __minion__ = ("+l.toString()+")(",i.operation.toString(),");","self.addEventListener(\"message\", function(event) {","  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),r=new Blob(e,{type:"text/javascript"}),n=URL.createObjectURL(r),o=new Worker(n);return o.addEventListener("message",t),o}function o(o){var t;this._imageOps=!!o.imageOps;var a=[];if(t=0===o.threads?0:this._imageOps?1:o.threads||1)for(var r=0;r<t;++r)a[r]=i(o,this._onWorkerMessage.bind(this,r));else a[0]=function(o,n){var e=l(o.operation);return{postMessage:function(o){setTimeout(function(){n({data:{buffer:e(o),meta:o.meta}})},0)}}}(o,this._onWorkerMessage.bind(this,0));this._workers=a,this._queue=[],this._maxQueueLength=o.queue||1/0,this._running=0,this._dataLookup={},this._job=null}var p=e(6).newImageData;o.prototype.process=function(o,t,e){this._enqueue({inputs:o,meta:t,callback:e}),this._dispatch()},o.prototype.destroy=function(){for(var e in this)this[e]=null;this._destroyed=!0},o.prototype._enqueue=function(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},o.prototype._dispatch=function(){if(0===this._running&&0<this._queue.length){var p=this._job=this._queue.shift(),t=p.inputs[0].width,e=p.inputs[0].height,r=p.inputs.map(function(e){return e.data.buffer}),n=this._workers.length;if(this._running=n,1===n)this._workers[0].postMessage({buffers:r,meta:p.meta,imageOps:this._imageOps,width:t,height:e},r);else for(var i=p.inputs[0].data.length,o=4*F(i/4/n),a=0;a<n;++a){for(var d=a*o,_=[],l=0,g=r.length;l<g;++l)_.push(r[a].slice(d,d+o));this._workers[a].postMessage({buffers:_,meta:p.meta,imageOps:this._imageOps,width:t,height:e},_)}}},o.prototype._onWorkerMessage=function(o,t){this._destroyed||(this._dataLookup[o]=t.data,--this._running,0===this._running&&this._resolveJob())},o.prototype._resolveJob=function(){var n=this._job,r=this._workers.length,i,d;if(1===r)i=new Uint8ClampedArray(this._dataLookup[0].buffer),d=this._dataLookup[0].meta;else{var _=n.inputs[0].data.length;i=new Uint8ClampedArray(_),d=Array(_);for(var o=4*F(_/4/r),a=0;a<r;++a){var g=this._dataLookup[a].buffer,u=a*o;i.set(new Uint8ClampedArray(g),u),d[a]=this._dataLookup[a].meta}}this._job=null,this._dataLookup={},n.callback(null,p(i,n.inputs[0].width,n.inputs[0].height),d),this._dispatch()},s.exports=o},function(o,t){var a=!0;try{new ImageData(10,10)}catch(e){a=!1}var s=document.createElement("canvas").getContext("2d");t.newImageData=function(r,t,e){if(a)return new ImageData(r,t,e);var n=s.createImageData(t,e);return n.data.set(r),n}},function(G,t,e){"use strict";function r(){return function(){throw new Error("Unimplemented abstract method.")}()}function X(e){return e.ol_uid||(e.ol_uid=++uh+"")}function k(o){for(var t in o)delete o[t]}function f(o){for(var t in o)return!1;return!t}function _(s,t,e,l,n){if(l&&l!==s&&(e=e.bind(l)),n){var i=e;e=function(){s.removeEventListener(t,e),i.apply(this,arguments)}}var o={target:s,type:t,listener:e};return s.addEventListener(t,e),o}function g(o,t,e,r){return _(o,t,e,r,!0)}function y(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),k(e))}function Ge(o,t){return o>t?1:o<t?-1:0}function x(o,t){return 0<=o.indexOf(t)}function w(o,t,e){var r=o.length;if(o[0]<=t)return 0;if(t<=o[r-1])return r-1;var n;if(0<e){for(n=1;n<r;++n)if(o[n]<t)return n-1;}else if(0>e){for(n=1;n<r;++n)if(o[n]<=t)return n;}else for(n=1;n<r;++n){if(o[n]==t)return n;if(o[n]<t)return o[n-1]-t<t-o[n]?n-1:n}return r-1}function S(o,t,i){for(;t<i;){var a=o[t];o[t]=o[i],o[i]=a,++t,--i}}function v(o,t){for(var e=Array.isArray(t)?t:[t],r=e.length,n=0;n<r;n++)o[o.length]=e[n]}function U(o,t){for(var e=o.length>>>0,n=0,a;n<e;n++)if(t(a=o[n],n,o))return a;return null}function Kn(o,t){var e=o.length;if(e!==t.length)return!1;for(var r=0;r<e;r++)if(o[r]!==t[r])return!1;return!0}function z(o,t){var e;return o.every(function(r,n){return e=n,!t(r,n,o)})?-1:e}function T(){return!0}function R(){return!1}function b(){}function I(e){e.stopPropagation()}function L(e){return $.hasOwnProperty(e)?$[e]:$[e]="change:"+e}function O(o,t){if(!o)throw new s(t)}function Y(o){for(var t=ct(),e=0,i=o.length;e<i;++e)Et(t,o[e]);return t}function V(o,t,e){return e?(e[0]=o[0]-t,e[1]=o[1]-t,e[2]=o[2]+t,e[3]=o[3]+t,e):[o[0]-t,o[1]-t,o[2]+t,o[3]+t]}function et(o,t){return t?(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t):o.slice()}function st(o,t,e){var r,a;return(r=t<o[0]?o[0]-t:o[2]<t?t-o[2]:0)*r+(a=e<o[1]?o[1]-e:o[3]<e?e-o[3]:0)*a}function pt(o,t){return _t(o,t[0],t[1])}function dt(o,t){return o[0]<=t[0]&&t[2]<=o[2]&&o[1]<=t[1]&&t[3]<=o[3]}function _t(o,t,e){return o[0]<=t&&t<=o[2]&&o[1]<=e&&e<=o[3]}function gt(l,t){var e=l[0],r=l[1],n=l[2],i=l[3],o=t[0],a=t[1],s=0;return o<e?s|=16:o>n&&(s|=4),a<r?s|=8:a>i&&(s|=2),s===0&&(s=1),s}function ct(){return[1/0,1/0,-1/0,-1/0]}function yt(o,t,e,r,n){return n?(n[0]=o,n[1]=t,n[2]=e,n[3]=r,n):[o,t,e,r]}function mt(e){return yt(1/0,1/0,-1/0,-1/0,e)}function ht(o,t){var e=o[0],r=o[1];return yt(e,r,e,r,t)}function ft(o,t,e,r,n){return Ct(mt(n),o,t,e,r)}function xt(o,t){return o[0]==t[0]&&o[2]==t[2]&&o[1]==t[1]&&o[3]==t[3]}function St(o,t){return t[0]<o[0]&&(o[0]=t[0]),t[2]>o[2]&&(o[2]=t[2]),t[1]<o[1]&&(o[1]=t[1]),t[3]>o[3]&&(o[3]=t[3]),o}function Et(o,t){t[0]<o[0]&&(o[0]=t[0]),t[0]>o[2]&&(o[2]=t[0]),t[1]<o[1]&&(o[1]=t[1]),t[1]>o[3]&&(o[3]=t[1])}function Tt(o,t){for(var e=0,i=t.length;e<i;++e)Et(o,t[e]);return o}function Ct(o,t,e,a,n){for(;e<a;e+=n)Pt(o,t[e],t[e+1]);return o}function Pt(o,t,e){o[0]=E(o[0],t),o[1]=E(o[1],e),o[2]=C(o[2],t),o[3]=C(o[3],e)}function Rt(o,t){var e;return(e=t(Lt(o)))||(e=t(It(o)))||(e=t(At(o)))?e:(e=t(Nt(o)))||!1}function wt(o){var t=0;return kt(o)||(t=Gt(o)*Ot(o)),t}function Lt(e){return[e[0],e[1]]}function It(e){return[e[2],e[1]]}function vt(e){return[(e[0]+e[2])/2,(e[1]+e[3])/2]}function bt(o,t){var e;return t==="bottom-left"?e=Lt(o):t==="bottom-right"?e=It(o):t==="top-left"?e=Nt(o):t==="top-right"?e=At(o):O(!1,13),e}function Ft(T,t,e,r,n){var i=t*r[0]/2,o=t*r[1]/2,a=gh(e),s=_h(e),u=i*a,l=i*s,h=o*a,c=o*s,p=T[0],f=T[1],d=p-u+c,_=p-u-c,g=p+u-c,y=p+u+c,P=f-l-h,m=f-l+h,x=f+l+h,R=f+l-h;return yt(E(d,_,g,y),E(P,m,x,R),C(d,_,g,y),C(P,m,x,R),n)}function Ot(e){return e[3]-e[1]}function Mt(o,t,e){var r=e||[1/0,1/0,-1/0,-1/0];return Dt(o,t)?(r[0]=o[0]>t[0]?o[0]:t[0],r[1]=o[1]>t[1]?o[1]:t[1],r[2]=o[2]<t[2]?o[2]:t[2],r[3]=o[3]<t[3]?o[3]:t[3]):mt(r),r}function Nt(e){return[e[0],e[3]]}function At(e){return[e[2],e[3]]}function Gt(e){return e[2]-e[0]}function Dt(o,t){return o[0]<=t[2]&&o[2]>=t[0]&&o[1]<=t[3]&&o[3]>=t[1]}function kt(e){return e[2]<e[0]||e[3]<e[1]}function Ut(o,t){var e=(o[2]-o[0])/2*(t-1),r=(o[3]-o[1])/2*(t-1);o[0]-=e,o[2]+=e,o[1]-=r,o[3]+=r}function zt(p,t,e,r){var n=[];if(1<r)for(var d=p[2]-p[0],o=p[3]-p[1],a=0;a<r;++a)n.push(p[0]+d*a/r,p[1],p[2],p[1]+o*a/r,p[2]-d*a/r,p[3],p[0],p[3]-o*a/r);else n=[p[0],p[1],p[2],p[1],p[2],p[3],p[0],p[3]];t(n,n,2);for(var _=[],g=[],l=(a=0,n.length);a<l;a+=2)_.push(n[a]),g.push(n[a+1]);return function(o,t,e){return yt(E.apply(null,o),E.apply(null,t),C.apply(null,o),C.apply(null,t),e)}(_,g,e)}function te(a,t){var e=t.getExtent(),r=vt(a);if(t.canWrapX()&&(r[0]<e[0]||r[0]>=e[2])){var n=Gt(e),i=N((r[0]-e[0])/n)*n;a[0]-=i,a[2]-=i}return a}function jt(p,t,e,r,n,i){for(var o=i||[],a=0,d=t;d<e;d+=r){var _=p[d],l=p[d+1];o[a++]=n[0]*_+n[2]*l+n[4],o[a++]=n[1]*_+n[3]*l+n[5]}return i&&o.length!=a&&(o.length=a),o}function se(y,t,e,r,n,i,o){for(var a=o||[],s=gh(n),u=_h(n),l=i[0],m=i[1],c=0,h=t;h<e;h+=r){var x=y[h]-l,d=y[h+1]-m;a[c++]=l+x*s-d*u,a[c++]=m+x*u+d*s;for(var _=h+2;_<h+r;++_)a[c++]=y[_]}return o&&a.length!=c&&(a.length=c),a}function ue(p,t,e,r,n,i,o){for(var a=o||[],s=0,d=t;d<e;d+=r){a[s++]=p[d]+n,a[s++]=p[d+1]+i;for(var _=d+2;_<d+r;++_)a[s++]=p[_]}return o&&a.length!=s&&(a.length=s),a}function le(o,t,e){return E(C(o,t),e)}function he(l,t,e,p,d,i){var o=d-e,a=i-p;if(0!=o||0!==a){var s=((l-e)*o+(t-p)*a)/(o*o+a*a);1<s?(e=d,p=i):0<s&&(e+=o*s,p+=a*s)}return pe(l,t,e,p)}function pe(a,t,e,r){var n=e-a,i=r-t;return n*n+i*i}function fe(e){return 180*e/dh}function de(e){return e*dh/180}function _e(o,t){var e=o%t;return 0>e*t?e+t:e}function ge(o,t,e){return o+e*(t-o)}function ye(n,t,e){var r=de(n[1]),i=de(t[1]),o=(i-r)/2,a=de(t[0]-n[0])/2,s=_h(o)*_h(o)+_h(a)*_h(a)*gh(r)*gh(i);return 2*(e||6371008.8)*sh(ee(s),ee(1-s))}function n(o,t){for(var e=0,a=0,s=o.length;a<s-1;++a)e+=ye(o[a],o[a+1],t);return e}function me(l,t){for(var e=0,p=l.length,n=l[p-1][0],d=l[p-1][1],_=0;_<p;_++){var g=l[_][0],s=l[_][1];e+=de(g-n)*(2+_h(de(d))+_h(de(s))),n=g,d=s}return e*t*t/2}function xe(i,t,e,r){var n=de(i[1]),o=de(i[0]),a=t/(r||6371008.8),s=Math.asin(_h(n)*gh(a)+gh(n)*_h(a)*gh(e));return[fe(o+sh(_h(e)*_h(a)*gh(n),gh(a)-_h(n)*_h(s))),fe(s)]}function we(l,t,e){var r=l.length,n=1<e?e:2,i=t;void 0===i&&(i=2<n?l.slice():Array(r));for(var p=be,a=0;a<r;a+=n){i[a]=p*l[a]/180;var d=6378137*m(Math.tan(dh*(+l[a+1]+90)/360));d>p?d=p:d<-p&&(d=-p),i[a+1]=d}return i}function ve(s,t,e){var r=s.length,n=1<e?e:2,i=t;void 0===i&&(i=2<n?s.slice():Array(r));for(var l=0;l<r;l+=n)i[l]=180*s[l]/be,i[l+1]=360*ah(d(s[l+1]/6378137))/dh-90;return i}function Fe(o,t,e){var r=o.getCode(),n=t.getCode();r in De||(De[r]={}),De[r][n]=e}function Me(o,t){var e;return o in De&&t in De[o]&&(e=De[o][t]),e}function Ue(r,t){var e;if(void 0!==t){for(var a=0,s=r.length;a<s;++a)t[a]=r[a];e=t}else e=r.slice();return e}function ze(o,r){if(void 0!==r&&o!==r){for(var e=0,a=o.length;e<a;++e)r[e]=o[e];o=r}return o}function Ye(e){!function(o,t){ke[o]=t}(e.getCode(),e),Fe(e,e,Ue)}function Ve(e){return"string"==typeof e?ke[e]||null:e||null}function Xe(l,p,e,r){var n=(l=Ve(l)).getPointResolutionFunc(),o;if(n)o=n(p,e),r&&r!==l.getUnits()&&(_=l.getMetersPerUnit())&&(o=o*_/Se[r]);else if(l.getUnits()==bh.DEGREES&&!r||r==bh.DEGREES)o=p;else{var d=Je(l,Ve("EPSG:4326")),s=[e[0]-p/2,e[1],e[0]+p/2,e[1],e[0],e[1]-p/2,e[0],e[1]+p/2],_;o=(ye((s=d(s,s,2)).slice(0,2),s.slice(2,4))+ye(s.slice(4,6),s.slice(6,8)))/2,void 0!==(_=r?Se[r]:l.getMetersPerUnit())&&(o/=_)}return o}function We(o){!function(e){e.forEach(Ye)}(o),o.forEach(function(r){o.forEach(function(e){r!==e&&Fe(r,e,Ue)})})}function Ze(o,t){return o?"string"==typeof o?Ve(o):o:Ve(t)}function Ke(r){return function(t,e,p){for(var n=t.length,i=void 0===p?2:p,o=void 0===e?Array(n):e,a=0,d;a<n;a+=i){d=r([t[a],t[a+1]]),o[a]=d[0],o[a+1]=d[1];for(var _=i-1;2<=_;--_)o[a+_]=t[a+_]}return o}}function He(a,t,e,r){var n=Ve(a),i=Ve(t);Fe(n,i,Ke(e)),Fe(i,n,Ke(r))}function qe(o,t){if(o===t)return!0;var e=o.getUnits()===t.getUnits();return(o.getCode()===t.getCode()||Je(o,t)===Ue)&&e}function Je(o,t){var e=Me(o.getCode(),t.getCode());return e||(e=ze),e}function Qe(o,t){return Je(Ve(o),Ve(t))}function $e(o,t,e){return Qe(t,e)(o,void 0,o.length)}function Bt(o,t,e,r){return zt(o,Qe(t,e),void 0,r)}function Yt(){return Be}function Vt(o,t){return o}function Xt(o,t){return o}function Wt(o,t){return o}function Zt(o,t){return o}function Kt(e){return qt(e,1,0,0,1,0,0)}function Ht(d,t){var e=d[0],r=d[1],n=d[2],i=d[3],o=d[4],a=d[5],s=t[0],_=t[1],l=t[2],g=t[3],u=t[4],p=t[5];return d[0]=e*s+n*_,d[1]=r*s+i*_,d[2]=e*l+n*g,d[3]=r*l+i*g,d[4]=e*u+n*p+o,d[5]=r*u+i*p+a,d}function qt(s,t,e,r,n,i,o){return s[0]=t,s[1]=e,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s}function Jt(o,t){var e=t[0],r=t[1];return t[0]=o[0]*e+o[2]*r+o[4],t[1]=o[1]*e+o[3]*r+o[5],t}function Qt(o,t,e){return Ht(o,qt(Uh,t,0,0,e,0,0))}function $t(p,t,e,r,n,i,o,a){var s=_h(i),d=gh(i);return p[0]=r*d,p[1]=n*s,p[2]=-r*s,p[3]=n*d,p[4]=o*r*d-a*r*s+t,p[5]=o*n*s+a*n*d+e,p}function er(p,t){var e=(n=t)[0]*n[3]-n[1]*n[2],n;O(0!=e,32);var d=t[0],i=t[1],o=t[2],a=t[3],s=t[4],_=t[5];return p[0]=a/e,p[1]=-i/e,p[2]=-o/e,p[3]=d/e,p[4]=(o*_-a*s)/e,p[5]=-(d*_-i*s)/e,p}function tr(e){return"matrix("+e.join(", ")+")"}function rr(o){var t;return o=="XY"?t=2:o=="XYZ"||o=="XYM"?t=3:o=="XYZM"&&(t=4),t}function sr(l,t,p,r){for(var n=0,d=l[p-r],_=l[p-r+1];t<p;t+=r){var g=l[t],s=l[t+1];n+=_*g-d*s,d=g,_=s}return n/2}function lr(l,t,p,r){for(var n=0,d=0,_=p.length,a;d<_;++d)a=p[d],n+=sr(l,t,a,r),t=a;return n}function dr(d,t,e,r,n,i,o){var a=d[t],_=d[t+1],l=d[e]-a,g=d[e+1]-_,u;if(0==l&&0===g)u=t;else{var c=((n-a)*l+(i-_)*g)/(l*l+g*g);if(1<c)u=e;else{if(0<c){for(var p=0;p<r;++p)o[p]=ge(d[t+p],d[e+p],c);return void(o.length=r)}u=t}}for(p=0;p<r;++p)o[p]=d[u+p];o.length=r}function _r(p,t,d,r,n){var _=p[t],g=p[t+1];for(t+=r;t<d;t+=r){var c=p[t],s=p[t+1],u=pe(_,g,c,s);u>n&&(n=u),_=c,g=s}return n}function gr(l,t,p,r,n){for(var d=0,_=p.length,a;d<_;++d)a=p[d],n=_r(l,t,a,r,n),t=a;return n}function ur(_,t,e,r,n,i,o,a,s,g,u){if(t==e)return g;var y,m;if(0===n){if((m=pe(o,a,_[t],_[t+1]))<g){for(y=0;y<r;++y)s[y]=_[t+y];return s.length=r,m}return g}for(var h=u||[NaN,NaN],f=t+r;f<e;)if(dr(_,f-r,f,r,o,a,h),(m=pe(o,a,h[0],h[1]))<g){for(g=m,y=0;y<r;++y)s[y]=h[y];s.length=r,f+=r}else f+=r*C(0|(ee(m)-ee(g))/n,1);if(i&&(dr(_,e-r,t,r,o,a,h),(m=pe(o,a,h[0],h[1]))<g)){for(g=m,y=0;y<r;++y)s[y]=h[y];s.length=r}return g}function cr(_,t,g,r,n,i,o,a,s,u,y){for(var m=y||[NaN,NaN],c=0,h=g.length,f;c<h;++c)f=g[c],u=ur(_,t,f,r,n,i,o,a,s,u,m),t=f;return u}function yr(n,t,a){for(var r=0,s=a.length;r<s;++r)n[t++]=a[r];return t}function mr(l,t,p,r){for(var n=0,d=p.length;n<d;++n)for(var o=p[n],a=0;a<r;++a)l[t++]=o[a];return t}function hr(p,t,d,r,n){for(var i=n||[],o=0,_=0,g=d.length,u;_<g;++_)u=mr(p,t,d[_],r),i[o++]=u,t=u;return i.length=o,i}function fr(l,t,e,r,n){for(var i=void 0===n?[]:n,o=0,p=t;p<e;p+=r)i[o++]=l.slice(p,p+r);return i.length=o,i}function xr(p,t,d,r,n){for(var i=void 0===n?[]:n,o=0,_=0,g=d.length,u;_<g;++_)u=d[_],i[o++]=fr(p,t,u,r,i[o]),t=u;return i.length=o,i}function Cr(p,t,d,r,n){for(var i=void 0===n?[]:n,o=0,_=0,g=d.length,u;_<g;++_)u=d[_],i[o++]=xr(p,t,u,r,i[o]),t=u[u.length-1];return i.length=o,i}function Pr(x,t,S,r,n,i,o){var E=(S-t)/r;if(3>E){for(;t<S;t+=r)i[o++]=x[t],i[o++]=x[t+1];return o}var s=Array(E);s[0]=1,s[E-1]=1;for(var u=[t,S-r],l=0;0<u.length;){for(var T=u.pop(),c=u.pop(),p=0,C=x[c],d=x[c+1],_=x[T],g=x[T+1],y=c+r,P;y<T;y+=r)P=he(x[y],x[y+1],C,d,_,g),P>p&&(l=y,p=P);p>n&&(s[(l-t)/r]=1,c+r<l&&u.push(c,l),l+r<T&&u.push(l,T))}for(y=0;y<E;++y)s[y]&&(i[o++]=x[t+y*r],i[o++]=x[t+y*r+1]);return o}function Rr(p,t,d,r,n,i,o,_){for(var s=0,g=d.length,l;s<g;++s)l=d[s],o=Pr(p,t,l,r,n,i,o),_.push(o),t=l;return o}function Lr(o,t){return t*Zm(o/t)}function Ir(y,t,m,r,n,i,o){if(t==m)return o;var x=Lr(y[t],n),S=Lr(y[t+1],n),E,T;t+=r,i[o++]=x,i[o++]=S;do if(E=Lr(y[t],n),T=Lr(y[t+1],n),(t+=r)==m)return i[o++]=E,i[o++]=T,o;while(E==x&&T==S);for(;t<m;){var C=Lr(y[t],n),c=Lr(y[t+1],n);if(t+=r,C!=E||c!=T){var p=E-x,f=T-S,d=C-x,_=c-S;p*_==f*d&&(0>p&&d<p||p==d||0<p&&d>p)&&(0>f&&_<f||f==_||0<f&&_>f)?(E=C,T=c):(i[o++]=E,i[o++]=T,x=E,S=T,E=C,T=c)}}return i[o++]=E,i[o++]=T,o}function vr(p,t,d,r,n,i,o,_){for(var s=0,g=d.length,l;s<g;++s)l=d[s],o=Ir(p,t,l,r,n,i,o),_.push(o),t=l;return o}function Fr(o,t,e,r,n){return!Rt(n,function(n){return!Or(o,t,e,r,n[0],n[1])})}function Or(p,t,d,r,n,i){for(var o=0,_=p[d-r],g=p[d-r+1];t<d;t+=r){var c=p[t],l=p[t+1];g<=i?l>i&&0<(c-_)*(i-g)-(n-_)*(l-g)&&o++:l<=i&&0>(c-_)*(i-g)-(n-_)*(l-g)&&o--,_=c,g=l}return 0!=o}function Mr(l,t,e,r,n,i){if(0===e.length)return!1;if(!Or(l,t,e[0],r,n,i))return!1;for(var o=1,p=e.length;o<p;++o)if(Or(l,e[o-1],e[o],r,n,i))return!1;return!0}function Nr(x,t,e,r,n,i,o){for(var a=n[i+1],d=[],_=0,E=e.length,y,T,C,R,L,I,b,F;_<E;++_)for(F=e[_],R=x[F-r],I=x[F-r+1],y=t;y<F;y+=r)L=x[y],b=x[y+1],(a<=I&&b<=a||I<=a&&a<=b)&&(C=(a-I)/(b-I)*(L-R)+R,d.push(C)),R=L,I=b;var O=NaN,M=-1/0;for(d.sort(Ge),R=d[0],y=1,T=d.length;y<T;++y){L=d[y];var N=P(L-R);N>M&&Mr(x,t,e,r,C=(R+L)/2,a)&&(O=C,M=N),R=L}return isNaN(O)&&(O=n[i]),o?(o.push(O,a,M),o):[O,a,M]}function Ar(l,t,p,r,n){for(var i=[],d=0,_=p.length,s;d<_;++d)s=p[d],i=Nr(l,t,s,r,n,2*d,i),t=s[s.length-1];return i}function Gr(l,t,p,r,n){for(var i=[l[t],l[t+1]],a=[],s;t+r<p;t+=r){if(a[0]=l[t+r],a[1]=l[t+r+1],s=n(i,a))return s;i[0]=a[0],i[1]=a[1]}return!1}function Dr(a,t,e,r,n){var i=Ct([1/0,1/0,-1/0,-1/0],a,t,e,r);return!!Dt(n,i)&&(!!dt(n,i)||i[0]>=n[0]&&i[2]<=n[2]||i[1]>=n[1]&&i[3]<=n[3]||Gr(a,t,e,r,function(o,t){return function(y,t,e){var r=!1,m=gt(y,t),i=gt(y,e);if(m===1||i===1)r=!0;else{var o=y[0],a=y[1],s=y[2],u=y[3],l=t[0],h=t[1],c=e[0],p=e[1],f=(p-h)/(c-l),d,x;i&2&&!(m&2)&&(r=(d=c-(p-u)/f)>=o&&d<=s),r||!(i&4)||m&4||(r=(x=p-(c-s)*f)>=a&&x<=u),r||!(i&8)||m&8||(r=(d=c-(p-a)/f)>=o&&d<=s),r||!(i&16)||m&16||(r=(x=p-(c-o)*f)>=a&&x<=u)}return r}(n,o,t)}))}function kr(s,t,e,r,n){if(!function(o,t,e,r,n){return!!Dr(o,t,e,r,n)||!!Or(o,t,e,r,n[0],n[1])||!!Or(o,t,e,r,n[0],n[3])||!!Or(o,t,e,r,n[2],n[1])||!!Or(o,t,e,r,n[2],n[3])}(s,t,e[0],r,n))return!1;if(1===e.length)return!0;for(var i=1,l=e.length;i<l;++i)if(Fr(s,e[i-1],e[i],r,n)&&!Dr(s,e[i-1],e[i],r,n))return!1;return!0}function Ur(a,t,s,l){for(;t<s-l;){for(var n=0,p;n<l;++n)p=a[t+n],a[t+n]=a[s-l+n],a[s-l+n]=p;t+=l,s-=l}}function zr(l,t,p,r){for(var n=0,d=l[p-r],_=l[p-r+1];t<p;t+=r){var g=l[t],s=l[t+1];n+=(g-d)*(s+_),d=g,_=s}return 0<n}function jr(p,t,d,r,n){for(var i=void 0!==n&&n,o=0,_=d.length;o<_;++o){var s=d[o],g=zr(p,t,s,r);if(0==o){if(i&&g||!i&&!g)return!1;}else if(i&&!g||!i&&g)return!1;t=s}return!0}function Br(p,t,d,r,n){for(var i=void 0!==n&&n,o=0,_=d.length;o<_;++o){var s=d[o],g=zr(p,t,s,r);(0==o?i&&g||!i&&!g:i&&!g||!i&&g)&&Ur(p,t,s,r),t=s}return t}function Yr(s,t,l,r,n){for(var i=0,p=l.length;i<p;++i)t=Br(s,t,l[i],r,n);return t}function Vr(s,t,e,r){for(var n=e||32,i=[],o=0;o<n;++o)v(i,xe(s,t,2*dh*o/n,r));return i.push(i[0],i[1]),new ln(i,"XY",[i.length])}function Hr(a){var t=a[0],e=a[1],r=a[2],n=a[3],i=[t,e,t,n,r,n,r,e,t,e];return new ln(i,"XY",[i.length])}function qr(n,t,e){for(var r=n.getStride(),i=n.getLayout(),o=n.getCenter(),a=r*((t||32)+1),s=Array(a),d=0;d<a;d+=r){s[d]=0,s[d+1]=0;for(var _=2;_<r;_++)s[d+_]=o[_]}var g=[s.length],u=new ln(s,i,g);return Jr(u,o,n.getRadius(),e),u}function Jr(s,t,e,r){for(var n=s.getFlatCoordinates(),i=s.getStride(),o=n.length/i-1,a=0;a<=o;++a){var p=a*i,l=(r||0)+2*_e(a,o)*dh/o;n[p]=t[0]+e*gh(l),n[p+1]=t[1]+e*_h(l)}s.changed()}function Qr(g,t,e){return function(r,n,i,o){if(r){var a=t?0:i[0]*n,s=t?0:i[1]*n,u=g[0]+a/2,y=g[2]-a/2,x=g[1]+s/2,S=g[3]-s/2;u>y&&(y=u=(y+u)/2),x>S&&(S=x=(S+x)/2);var E=le(r[0],u,y),T=le(r[1],x,S),P=30*n;return o&&e&&(E+=-P*m(1+C(0,u-r[0])/P)+P*m(1+C(0,r[0]-y)/P),T+=-P*m(1+C(0,x-r[1])/P)+P*m(1+C(0,r[1]-S)/P)),[E,T]}}}function $r(e){return e}function en(a,t,e,r){var n=Gt(t)/e[0],i=Ot(t)/e[1];return r?E(a,C(n,i)):E(a,E(n,i))}function tn(o,t,e){var r=E(o,t);return r*=m(1+50*C(0,o/t-1))/50+1,e&&(r=C(r,e),r/=m(1+50*C(0,e/o-1))/50+1),le(r,e/2,2*t)}function on(a,t,e,r,n){return function(i,o,p,s){if(void 0!==i){var d=r?en(a,r,p,n):a;return(void 0===e||e)&&s?tn(i,d,t):le(i,t,d)}}}function rn(e){return void 0===e?void 0:0}function nn(e){return void 0===e?void 0:e}function an(o,t,e){var r=void 0===e?""+o:o.toFixed(e),n=r.indexOf(".");return(n=-1===n?r.length:n)>t?r:Array(1+t-n).join("0")+r}function sn(s,t){for(var e=(""+s).split("."),r=(""+t).split("."),n=0;n<C(e.length,r.length);n++){var l=parseInt(e[n]||"0",10),o=parseInt(r[n]||"0",10);if(l>o)return 1;if(o>l)return-1}return 0}function pn(o,t){return o[0]+=+t[0],o[1]+=+t[1],o}function dn(_,t){var e=_[0],i=_[1],o=t[0],a=t[1],s=o[0],g=o[1],l=a[0],u=a[1],c=l-s,p=u-g,y=0==c&&0===p?0:(c*(e-s)+p*(i-g))/(c*c+p*p||0),d,m;return 0>=y?(d=s,m=g):1<=y?(d=l,m=u):(d=s+y*c,m=g+y*p),[d,m]}function _n(p,t,e){var r=_e(t+180,360)-180,n=P(3600*r),i=e||0,o=M(10,i),a=N(n/3600),d=N((n-3600*a)/60),_=n-3600*a-60*d;return 60<=(_=F(_*o)/o)&&(_=0,d+=1),60<=d&&(d=0,a+=1),a+"\xB0 "+an(d,2)+"\u2032 "+an(_,2,i)+"\u2033"+(0==r?"":" "+p.charAt(0>r?1:0))}function un(o,t,e){return o?t.replace("{x}",o[0].toFixed(e)).replace("{y}",o[1].toFixed(e)):""}function fn(o,t){for(var e=!0,i=o.length-1;0<=i;--i)if(o[i]!=t[i]){e=!1;break}return e}function Qn(a,t){var e=gh(t),r=_h(t),n=a[0]*e-a[1]*r,i=a[1]*e+a[0]*r;return a[0]=n,a[1]=i,a}function $n(o,t){return o[0]*=t,o[1]*=t,o}function ii(o,t){var e=o[0]-t[0],r=o[1]-t[1];return e*e+r*r}function si(o,t){return ee(ii(o,t))}function yi(o,t){return ii(o,dn(o,t))}function mi(o,t){return un(o,"{x}, {y}",t)}function xi(o,t){var e=t.getExtent();if(t.canWrapX()&&(o[0]<e[0]||o[0]>=e[2])){var r=Gt(e),n=N((o[0]-e[0])/r);o[0]-=n*r}return o}function Si(e){return M(e,3)}function Ei(e){return 1-Si(1-e)}function wi(e){return 3*e*e-2*e*e*e}function Li(e){return e}function Ii(o,t){setTimeout(function(){o(t)},0)}function vi(e){return!(e.sourceCenter&&e.targetCenter&&!fn(e.sourceCenter,e.targetCenter))&&e.sourceResolution===e.targetResolution&&e.sourceRotation===e.targetRotation}function Fi(o,t,e){var r=e&&e.length?e.shift():Dn?new OffscreenCanvas(o||300,t||300):document.createElement("canvas");return o&&(r.width=o),t&&(r.height=t),r.getContext("2d")}function Oi(o){var t=o.offsetWidth,n=getComputedStyle(o);return t+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10)}function Mi(o){var t=o.offsetHeight,n=getComputedStyle(o);return t+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10)}function Ni(o,t){var e=t.parentNode;e&&e.replaceChild(o,t)}function to(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function eo(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function ro(o,t,e){return void 0===e&&(e=[0,0]),e[0]=o[0]+2*t,e[1]=o[1]+2*t,e}function So(o,t,e){return void 0===e&&(e=[0,0]),e[0]=0|o[0]*t+.5,e[1]=0|o[1]*t+.5,e}function Eo(o,t){return Array.isArray(o)?o:(void 0===t?t=[o,o]:(t[0]=o,t[1]=o),t)}function To(o,t){if(!o.visible)return!1;var e=t.resolution;if(e<o.minResolution||e>=o.maxResolution)return!1;var r=t.zoom;return r>o.minZoom&&r<=o.maxZoom}function Mo(e){this.updateElement_(e.frameState)}function Go(o){var t=o.frameState;if(t){var e=t.viewState.rotation;if(e!=this.rotation_){if(this.autoHide_){var r=this.element.classList.contains("ol-hidden");r||0!==e?r&&0!==e&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.label_.style.transform="rotate("+e+"rad)"}this.rotation_=e}}function ko(o){var t=o||{},e=new ot;return(void 0===t.zoom||t.zoom)&&e.push(new zo(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Do(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new No(t.attributionOptions)),e}function Yo(s,t,e,r){var n=s.getZoom();if(void 0!==n){var i=s.getConstrainedZoom(n+t),o=s.getResolutionForZoom(i);s.getAnimating()&&s.cancelAnimations(),s.animate({resolution:o,anchor:e,duration:void 0===r?250:r,easing:Ei})}}function Wo(a){var t=!1;if(a.type==zn.DBLCLICK){var s=a.originalEvent,r=a.map,n=a.coordinate,i=s.shiftKey?-this.delta_:this.delta_;Yo(r.getView(),i,n,this.duration_),a.preventDefault(),t=!0}return!t}function qo(o){for(var t=o.length,e=0,a=0,s=0;s<t;s++)e+=o[s].clientX,a+=o[s].clientY;return[e/t,a/t]}function Ai(e){return na(e)&&sa(e)}function Gi(){var p=this.getMap(),r=p.getView(),n=p.getSize(),i=this.getGeometry().getExtent(),d,_;if(this.out_){var e=r.calculateExtentInternal(n),a=(d=[p.getPixelFromCoordinateInternal(Lt(i)),p.getPixelFromCoordinateInternal(At(i))],Tt(mt(_),d));Ut(e,1/r.getResolutionForExtentInternal(a,n)),i=e}var s=r.getConstrainedResolution(r.getResolutionForExtentInternal(i,n)),g=r.getConstrainedCenter(vt(i),s);r.animateInternal({resolution:s,center:g,duration:this.duration_,easing:Ei})}function Di(l){var t=!1;if(l.type=="keydown"){var p=l.originalEvent.keyCode;if(this.condition_(l)&&(p==40||p==37||p==39||p==38)){var r=l.map.getView(),n=r.getResolution()*this.pixelDelta_,i=0,d=0;p==40?d=-n:p==37?i=-n:p==39?i=n:d=n;var _=[i,d];Qn(_,r.getRotation()),function(o,t,e){var r=o.getCenterInternal();if(r){var n=[r[0]+t[0],r[1]+t[1]];o.animateInternal({duration:void 0===e?250:e,easing:Li,center:o.getConstrainedCenter(n)})}}(r,_,this.duration_),l.preventDefault(),t=!0}}return!t}function ki(o){var t=!1;if(o.type=="keydown"||o.type=="keypress"){var a=o.originalEvent.charCode;if(this.condition_(o)&&(a==43||a==45)){var r=o.map,n=a==43?this.delta_:-this.delta_;Yo(r.getView(),n,void 0,this.duration_),o.preventDefault(),t=!0}}return!t}function Ui(o){var t=o||{},e=new ot,r=new Rn(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new _a),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Ko({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new pa({condition:t.onFocusOnly?Qo:void 0,kinetic:r})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Ba),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Va({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new Fa),e.push(new Na({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new ka({condition:t.onFocusOnly?Qo:void 0,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new Ca({duration:t.zoomDuration})),e}function zi(e){return"string"==typeof e?e:Vi(e)}function ji(o){var t=document.createElement("div");if(t.style.color=o,""!==t.style.color){document.body.appendChild(t);var e=getComputedStyle(t).color;return document.body.removeChild(t),e}return""}function Bi(e){return Array.isArray(e)?e:Ka(e)}function Yi(e){return e[0]=le(0|e[0]+.5,0,255),e[1]=le(0|e[1]+.5,0,255),e[2]=le(0|e[2]+.5,0,255),e[3]=le(e[3],0,1),e}function Vi(o){var t=o[0];t!=(0|t)&&(t=0|t+.5);var i=o[1];i!=(0|i)&&(i=0|i+.5);var a=o[2];return a!=(0|a)&&(a=0|a+.5),"rgba("+t+","+i+","+a+","+(void 0===o[3]?1:o[3])+")"}function Xi(o,t,e){return t+":"+o+":"+(e?zi(e):"null")}function Wi(e){return Array.isArray(e)?Vi(e):e}function Ki(o,t){return Xh||(Xh=Fi(1,1)),o!=mc&&(Xh.font=o,mc=Xh.font),Xh.measureText(t)}function qi(o,t){return Ki(o,t).width}function Ji(o,t,e){if(t in e)return e[t];var r=qi(o,t);return e[t]=r,r}function Qi(o,t,e,r){0!==t&&(o.translate(e,r),o.rotate(t),o.translate(-e,-r))}function $i(p,t,e,r,n,i,o,a,s,d,l){p.save(),1!==e&&(p.globalAlpha*=e),t&&p.setTransform.apply(p,t),r.contextInstructions?(p.translate(s,d),p.scale(l,l),function(o,t){for(var e=o.contextInstructions,r=0,a=e.length;r<a;r+=2)Array.isArray(e[r+1])?t[e[r]].apply(t,e[r+1]):t[e[r]]=e[r+1]}(r,p)):p.drawImage(r,n,i,o,a,s,d,o*l,a*l),p.restore()}function ha(e){return Dn?tr(e):(xs||(xs=Fi(1,1).canvas),xs.style.transform=tr(e),xs.style.transform)}function fa(o,t){return parseInt(X(o),10)-parseInt(X(t),10)}function xa(o,t){var e=Sa(o,t);return e*e}function Sa(o,t){return .5*o/t}function Ra(l,t,e,r,n,i){var o=!1,p=e.getImage();if(p){var s=p.getImageState();s==2||s==3?p.unlistenImageChange(n):(s==0&&p.load(),s=p.getImageState(),p.listenImageChange(n),o=!0)}return function(s,t,e,r,n){var i=e.getGeometryFunction()(t);if(i){var o=i.simplifyTransformed(r,n);e.getRenderer()?!function l(t,e,r,n){if(e.getType()==oe.GEOMETRY_COLLECTION){for(var i=e.getGeometries(),o=0,p=i.length;o<p;++o)l(t,i[o],r,n);return}t.getBuilder(r.getZIndex(),"Default").drawCustom(e,n,r.getRenderer())}(s,o,e,t):(0,Us[o.getType()])(s,o,e,t)}}(l,t,e,r,i),o}function wa(a){var t=a.frameState,r=Ht(a.inversePixelTransform.slice(),t.coordinateToPixelTransform),n=xa(t.viewState.resolution,t.pixelRatio),i=Yt(),o;return i&&(o=Je(i,t.viewState.projection)),new Rs(a.context,t.pixelRatio,t.extent,r,t.viewState.rotation,n,o)}function La(l,t){t&&t.clear();for(var p=l.declutterItems,r=p.length-1;0<=r;--r)for(var d=p[r],i=d.items,o=0,_=i.length;o<_;o+=3)t=i[o].renderDeclutter(i[o+1],i[o+2],d.opacity,t);return p.length=0,t}function Ia(){os.expire()}function ba(l,t,e,r){return function(n,i,p){var a=new XMLHttpRequest;a.open("GET","function"==typeof l?l(n,i,p):l,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=gu,a.onload=function(){if(!a.status||200<=a.status&&300>a.status){var i=t.getType(),o;i=="json"||i=="text"?o=a.responseText:i=="xml"?(o=a.responseXML)||(o=new DOMParser().parseFromString(a.responseText,"application/xml")):i=="arraybuffer"&&(o=a.response),o?e.call(this,t.readFeatures(o,{extent:n,featureProjection:p}),t.readProjection(o)):r.call(this)}else r.call(this)}.bind(this),a.onerror=function(){r.call(this)}.bind(this),a.send()}}function Oa(o,t){return ba(o,t,function(e){"function"==typeof this.addFeatures&&this.addFeatures(e)},b)}function Ma(){return[[-1/0,-1/0,1/0,1/0]]}function Ga(o,t,e,r,n){return void 0===n?new hf(o,t,e,r):(n.minX=o,n.maxX=t,n.minY=e,n.maxY=r,n)}function Ua(o,t,e,r){return void 0===r?[o,t,e]:(r[0]=o,r[1]=t,r[2]=e,r)}function Wa(o,t,e){return o+"/"+t+"/"+e}function Ha(e){return Wa(e[0],e[1],e[2])}function qa(e){return e.split("/").map(Number)}function Ja(e){return(e[1]<<e[0])+e[2]}function Qa(o){var t=o.getDefaultTileGrid();return t||(t=is(o),o.setDefaultTileGrid(t)),t}function rs(o){var t=o||{},e=t.extent||Ve("EPSG:3857").getExtent(),r={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:ns(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Mu(r)}function ns(p,t,e,r){for(var n=void 0===t?42:t,i=Ot(p),o=Gt(p),a=Eo(void 0===e?256:e),s=0<r?r:C(o/a[0],i/a[1]),d=n+1,l=Array(d),_=0;_<d;++_)l[_]=s/M(2,_);return l}function is(o,t,e,r){return function(a,t,e,r){var n=void 0===r?"top-left":r,i=ns(a,t,e);return new Mu({extent:a,origin:bt(a,n),resolutions:i,tileSize:e})}(as(o),t,e,r)}function as(o){var n=(o=Ve(o)).getExtent();if(!n){var i=180*Se[bh.DEGREES]/o.getMetersPerUnit();n=yt(-i,-i,i,i)}return n}function us(o,t){for(var e=Au.length,r=0;r<e;++r)try{var a=o.getContext(Au[r],t);if(a)return a}catch(e){}return null}function Ss(o,t){return il().createElementNS(o,t)}function Es(o,t){return function o(t,e,r){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?r.push((t.nodeValue+"").replace(/(\r\n|\r|\n)/g,"")):r.push(t.nodeValue);else{var n;for(n=t.firstChild;n;n=n.nextSibling)o(n,e,r)}return r}(o,t,[]).join("")}function Ts(e){return"documentElement"in e}function Cs(e){return new DOMParser().parseFromString(e,"application/xml")}function Ps(o,t){return function(e,r){var n=o.call(void 0===t?this:t,e,r);void 0!==n&&v(r[r.length-1],n)}}function ws(o,t){return function(e,r){var n=o.call(void 0===t?this:t,e,r);void 0!==n&&r[r.length-1].push(n)}}function As(o,t){return function(e,r){var n=o.call(void 0===t?this:t,e,r);void 0!==n&&(r[r.length-1]=n)}}function Bs(l,t,e){return function(r,n){var i=l.call(void 0===e?this:e,r,n);if(void 0!==i){var o=n[n.length-1],a=void 0===t?r.localName:t,s;a in o?s=o[a]:(s=[],o[a]=s),s.push(i)}}}function Ys(a,t,e){return function(r,n){var i=a.call(void 0===e?this:e,r,n);void 0!==i&&(n[n.length-1][void 0===t?r.localName:t]=i)}}function Vs(o,t){return function(e,r,n){o.call(void 0===t?this:t,e,r,n),n[n.length-1].node.appendChild(e)}}function Xs(o){var t,s;return function(r,e,n){if(void 0===t){t={};var i={};i[r.localName]=o,t[r.namespaceURI]=i,s=Ws(r.localName)}ol(t,s,e,n)}}function Ws(o,s){var e=o;return function(r,t,n){var i=t[t.length-1].node,o=e;return void 0===o&&(o=n),Ss(void 0===s?i.namespaceURI:s,o)}}function Zs(o,t){for(var e=t.length,r=Array(e),n=0;n<e;++n)r[n]=o[t[n]];return r}function qs(a,t,e){var r=void 0===e?{}:e,o,s;for(o=0,s=a.length;o<s;++o)r[a[o]]=t;return r}function el(s,t,e,r){var n;for(n=t.firstElementChild;n;n=n.nextElementSibling){var l=s[n.namespaceURI];if(void 0!==l){var o=l[n.localName];void 0!==o&&o.call(r,n,e)}}}function tl(o,t,e,r,n){return r.push(o),el(t,e,r,n),r.pop()}function ol(p,t,e,r,n,i){for(var o=(void 0===n?e:n).length,d=0,_,g;d<o;++d)void 0!==(_=e[d])&&void 0!==(g=t.call(void 0===i?this:i,_,r,void 0===n?void 0:n[d]))&&p[g.namespaceURI][g.localName].call(i,g,_,r)}function nl(s,t,e,r,n,i,o){return n.push(s),ol(t,e,r,n,i,o),n.pop()}function il(){return void 0===ff&&"undefined"!=typeof document&&(ff=document.implementation.createDocument("","",null)),ff}function al(e){return 34962===e?Float32Array:34963===e?Uint32Array:Float32Array}function sl(o,t){return o[0]=t[0],o[1]=t[1],o[4]=t[2],o[5]=t[3],o[12]=t[4],o[13]=t[5],o}function pl(o){for(var t=0,i=0,a;i<o.length;i++)a=o[i],t+=a.size*ul(a.type);return t}function ul(e){switch(e){case ml.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ml.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ml.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case ml.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT;}}function cl(d,t,e){var _=[],n=[],i=[],o=[],a=[],s=void 0===e?[]:e,r=d.SupportedCRS,l=Ve(r.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||Ve(r),g=l.getMetersPerUnit(),u="ne"==l.getAxisOrientation().substr(0,2);return d.TileMatrix.sort(function(o,t){return t.ScaleDenominator-o.ScaleDenominator}),d.TileMatrix.forEach(function(t){if(!(0<s.length)||U(s,function(e){return t.Identifier==e.TileMatrix||-1===t.Identifier.indexOf(":")&&d.Identifier+":"+t.Identifier===e.TileMatrix})){n.push(t.Identifier);var e=28e-5*t.ScaleDenominator/g,r=t.TileWidth,l=t.TileHeight;u?i.push([t.TopLeftCorner[1],t.TopLeftCorner[0]]):i.push(t.TopLeftCorner),_.push(e),o.push(r==l?r:[r,l]),a.push([t.MatrixWidth,t.MatrixHeight])}}),new Fl({extent:t,origins:i,resolutions:_,matrixIds:n,tileSizes:o,sizes:a})}function yl(s,l,e){var t=s;if(t.src&&kn){var r=t.decode(),n=!0;return r.then(function(){n&&l()}).catch(function(o){n&&("EncodingError"===o.name&&"Invalid image type."===o.message?l():e())}),function(){n=!1}}var i=[g(t,"load",l),g(t,"error",e)];return function(){i.forEach(y)}}function fl(){if(!ih){var e=new Ul({color:"rgba(255,255,255,0.4)"}),t=new rh({color:"#3399CC",width:1.25});ih=[new nh({image:new kl({fill:e,stroke:t,radius:5}),fill:e,stroke:t})]}return ih}function xl(){var o={},t=[255,255,255,1],e=[0,153,255,1];return o[oe.POLYGON]=[new nh({fill:new Ul({color:[255,255,255,.5]})})],o[oe.MULTI_POLYGON]=o[oe.POLYGON],o[oe.LINE_STRING]=[new nh({stroke:new rh({color:t,width:5})}),new nh({stroke:new rh({color:e,width:3})})],o[oe.MULTI_LINE_STRING]=o[oe.LINE_STRING],o[oe.CIRCLE]=o[oe.POLYGON].concat(o[oe.LINE_STRING]),o[oe.POINT]=[new nh({image:new kl({radius:6,fill:new Ul({color:e}),stroke:new rh({color:t,width:1.5})}),zIndex:1/0})],o[oe.MULTI_POINT]=o[oe.POINT],o[oe.GEOMETRY_COLLECTION]=o[oe.POLYGON].concat(o[oe.LINE_STRING],o[oe.POINT]),o}function Sl(e){return e.getGeometry()}function El(o,n){return function(e){return e?o.replace(/\{z\}/g,e[0].toString()).replace(/\{x\}/g,e[1].toString()).replace(/\{y\}/g,e[2].toString()).replace(/\{-y\}/g,function(){var o=e[0],t=n.getFullTileRange(o);return O(t,55),(t.getHeight()-e[2]-1).toString()}):void 0}}function Tl(o,t){for(var e=o.length,r=Array(e),n=0;n<e;++n)r[n]=El(o[n],t);return Cl(r)}function Cl(o){return 1===o.length?o[0]:function(t,e,r){if(t){var n=_e(Ja(t),o.length);return o[n](t,e,r)}}}function Pl(){}function Rl(l){var t=[],e=/\{([a-z])-([a-z])\}/.exec(l);if(e){var d=e[1].charCodeAt(0),n=e[2].charCodeAt(0),i;for(i=d;i<=n;++i)t.push(l.replace(e[0],p(i)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(l)){for(var _=parseInt(e[2],10),a=parseInt(e[1],10);a<=_;a++)t.push(l.replace(e[0],a.toString()));return t}return t.push(l),t}function wl(o,l,e,t){function r(){delete window[i],n.parentNode.removeChild(n)}var n=document.createElement("script"),i="olc_"+X(l);n.async=!0,n.src=o+(-1==o.indexOf("?")?"?":"&")+(t||"callback")+"="+i;var a=setTimeout(function(){r(),e&&e()},1e4);window[i]=function(e){clearTimeout(a),r(),l(e)},document.getElementsByTagName("head")[0].appendChild(n)}function Nl(p,t,e,r){var n=$e(e,t,p),i=Xe(t,r,e),d=t.getMetersPerUnit();void 0!==d&&(i*=d);var a=p.getMetersPerUnit();void 0!==a&&(i/=a);var s=p.getExtent();if(!s||pt(s,n)){var _=Xe(p,i,n)/i;isFinite(_)&&0<_&&(i/=_)}return i}function Al(s,t,e,r){var n=e-s,i=r-t,o=ee(n*n+i*i);return[Zm(e+n/o),Zm(r+i/o)]}function Zl(m,t,e,r,n,F,o,i,a,s,l){var M=Fi(Zm(e*m),Zm(e*t));if(0===a.length)return M.canvas;M.scale(e,e);var u=[1/0,1/0,-1/0,-1/0];a.forEach(function(e){St(u,e.extent)});var p=Gt(u),c=Ot(u),d=Fi(Zm(e*p/r),Zm(e*c/r)),_=e/r;a.forEach(function(e){var t=e.extent[0]-u[0],r=-(e.extent[3]-u[3]),n=Gt(e.extent),o=Ot(e.extent);d.drawImage(e.image,s,s,e.image.width-2*s,e.image.height-2*s,t*_,r*_,n*_,o*_)});var N=Nt(o);return i.getTriangles().forEach(function(o){var t=o.source,n=o.target,i=t[0][0],a=t[0][1],s=t[1][0],p=t[1][1],_=t[2][0],c=t[2][1],y=(n[0][0]-N[0])/F,v=-(n[0][1]-N[1])/F,m=(n[1][0]-N[0])/F,x=-(n[1][1]-N[1])/F,w=(n[2][0]-N[0])/F,S=-(n[2][1]-N[1])/F,E=i,T=a;i=0,a=0;var C=function(d){for(var t=d.length,e=0;e<t;e++){for(var _=e,g=P(d[e][e]),y=e+1,m;y<t;y++)m=P(d[y][e]),m>g&&(g=m,_=y);if(0===g)return null;var x=d[_];d[_]=d[e],d[e]=x;for(var s=e+1;s<t;s++)for(var S=-d[s][e]/d[e][e],l=e;l<t+1;l++)e==l?d[s][l]=0:d[s][l]+=S*d[e][l]}for(var E=Array(t),c=t-1;0<=c;c--){E[c]=d[c][t]/d[c][c];for(var T=c-1;0<=T;T--)d[T][t]-=d[T][c]*E[c]}return E}([[s-=E,p-=T,0,0,m-y],[_-=E,c-=T,0,0,w-y],[0,0,s,p,x-v],[0,0,_,c,S-v]]);if(C){M.save(),M.beginPath();var b=(y+m+w)/3,A=(v+x+S)/3,R=Al(b,A,y,v),O=Al(b,A,m,x),I=Al(b,A,w,S);M.moveTo(O[0],O[1]),M.lineTo(R[0],R[1]),M.lineTo(I[0],I[1]),M.clip(),M.transform(C[0],C[2],C[1],C[3],y,v),M.translate(u[0]-E,u[3]-T),M.scale(r/e,-r/e),M.drawImage(d.canvas,0,0),M.restore()}}),l&&(M.save(),M.strokeStyle="black",M.lineWidth=1,i.getTriangles().forEach(function(e){var t=e.target,o=(t[0][0]-N[0])/F,r=-(t[0][1]-N[1])/F,n=(t[1][0]-N[0])/F,i=-(t[1][1]-N[1])/F,a=(t[2][0]-N[0])/F,s=-(t[2][1]-N[1])/F;M.beginPath(),M.moveTo(n,i),M.lineTo(o,r),M.lineTo(a,s),M.closePath(),M.stroke()}),M.restore()),M.canvas}function Cp(e){return e?Array.isArray(e)?function(){return e}:"function"==typeof e?e:function(){return[e]}:null}function Pp(o,t){o.getImage().src=t}function Rp(e){return e.toLocaleString("en",{maximumFractionDigits:10})}function bp(o,t){o.getImage().src=t}function Ap(o,i){var e=[];Object.keys(i).forEach(function(o){null!==i[o]&&void 0!==i[o]&&e.push(o+"="+encodeURIComponent(i[o]))});var r=e.join("&");return(o=-1===(o=o.replace(/[?&]$/,"")).indexOf("?")?o+"?":o+"&")+r}function Ud(l,t){var e=l.getRenderer();if(!e)throw new Error("Unsupported layer type: "+l);if(!e.prepareFrame(t))return null;var r=t.size[0],i=t.size[1],o=e.renderFrame(t,null),a;if(o&&(a=o.firstElementChild),!(a instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+a);if(a.width===r&&a.height===i)return a.getContext("2d").getImageData(0,0,r,i);if(Ip){var p=Ip.canvas;p.width!==r||p.height!==i?Ip=Fi(r,i):Ip.clearRect(0,0,r,i)}else Ip=Fi(r,i);return Ip.drawImage(a,0,0,r,i),Ip.getImageData(0,0,r,i)}function Fp(o){var t;return o instanceof Fh?o instanceof jh?t=new Sp({source:o}):o instanceof Ac&&(t=new fp({source:o})):t=o,t}function Mp(s,t,l){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(l)),!(r.getResolutions().length<=s[0])){1==t||this.hidpi_||(t=1);var p=r.getTileCoordExtent(s,this.tmpExtent_),i=Eo(r.getTileSize(s[0]),this.tmpSize);1!=t&&(i=So(i,t,this.tmpSize));var d={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return yh(d,this.params_),this.getRequestUrl_(s,i,p,t,l,d)}}function zp(l,t,p){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(p)),!(r.getResolutions().length<=l[0])){1==t||this.hidpi_&&void 0!==this.serverType_||(t=1);var d=r.getResolution(l[0]),i=r.getTileCoordExtent(l,this.tmpExtent_),_=Eo(r.getTileSize(l[0]),this.tmpSize),g=this.gutter_;0!==g&&(_=ro(_,g,this.tmpSize),i=V(i,d*g,i)),1!=t&&(_=So(_,t,this.tmpSize));var s={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return yh(s,this.params_),this.getRequestUrl_(l,_,i,t,p,s)}}function qp(o,t){var e=ba(t,o.getFormat(),o.onLoad.bind(o),o.onError.bind(o));o.setLoader(e)}function l_(o){var a=this.requestEncoding_,s={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};a=="KVP"&&yh(s,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),o=a=="KVP"?Ap(o,s):o.replace(/\{(\w+?)\}/g,function(o,t){return t.toLowerCase()in s?s[t.toLowerCase()]:o});var e=this.tileGrid,n=this.dimensions_;return function(t){if(t){var r={TileMatrix:e.getMatrixId(t[0]),TileCol:t[1],TileRow:t[2]};yh(r,n);var i=o;return i=a=="KVP"?Ap(i,r):i.replace(/\{(\w+?)\}/g,function(o,t){return r[t]})}}}function d_(S,t,e,r,n){var i=e,E=e,T=0,C=0,P=e,R,w,L,I,b,F,O,M,N;for(R=e;R<r;R+=n){var A=t[R],m=t[R+1];void 0!==I&&(M=A-I,N=m-b,L=ee(M*M+N*N),void 0!==F&&(C+=w,Math.acos((F*M+O*N)/(w*L))>S&&(C>T&&(T=C,i=P,E=R),C=0,P=R-n)),w=L,F=M,O=N),I=A,b=m}return(C+=L)>T?[P,R]:[i,E]}function h_(p,t,e,r){for(var n=p[t],d=p[t+1],_=0,g=t+r;g<e;g+=r){var c=p[g],u=p[g+1];_+=ee((c-n)*(c-n)+(u-d)*(u-d)),n=c,d=u}return _}function E_(N,t,A,r,n,i,G,a,s,u,l){for(var h=[],f=N[t]>N[A-r],d=n.length,_=N[t],D=N[t+1],k=N[t+=r],U=N[t+1],z=0,j=ee(M(k-_,2)+M(U-D,2)),B=!1,Y=0,V,X;Y<d;++Y){for(var W=n[V=f?d-Y-1:Y],T=a*s(u,W,l),C=i+T/2;t<A-r&&z+j<C;)_=k,D=U,k=N[t+=r],U=N[t+1],z+=j,j=ee(M(k-_,2)+M(U-D,2));var b=C-z,Z=sh(U-D,k-_);if(f&&(Z+=0<Z?-dh:dh),void 0!==X){var K=Z-X;if(B=B||0!==K,K+=K>dh?-2*dh:K<-dh?2*dh:0,P(K)>G)return null}X=Z;var H=b/j,I=ge(_,k,H),L=ge(D,U,H);h[V]=[I,L,T/2,Z,W],i+=T}return B?h:[[h[0][0],h[0][1],h[0][2],h[0][3],n]]}function L_(o,t,e){var r=N(o.length/2),i;if(t>=r)for(i=r;i<t;i++)o[i][e]=!0;else if(t<r)for(i=t+1;i<r;i++)o[i][e]=!0}function rd(_,t,e,r,n,i){for(var o=Object.keys(_).map(Number).sort(Ge),a=0,g=o.length;a<g;++a)for(var u=_[o[a].toString()],l=void 0,y=0,m=u.length,p;y<m;){p=u[y++],p!==l&&(l=p,i.push({items:p.declutterItems,opacity:r}));var x=u[y++];p.execute(t,x,e,n)}}function nd(x,t,e,r,n,i,o){var a=Fi(x[0]/2,x[1]/2);a.imageSmoothingEnabled=!1;for(var s=a.canvas,u=new Rs(a,.5,n,null,o),l=e.length,h=N(16777215/l),c={},p=1;p<=l;++p){var k=e[p-1],d=k.getStyleFunction()||r;if(r){var _=d(k,i);if(_){Array.isArray(_)||(_=[_]);for(var U="#"+("000000"+(p*h).toString(16)).slice(-6),y=0,z=_.length;y<z;++y){var B=_[y],w=B.clone(),S=w.getFill();S&&S.setColor(U);var E=w.getStroke();E&&E.setColor(U),w.setText(void 0);var T=B.getImage();if(T){var C=T.getImageSize();if(!C)continue;var b=document.createElement("canvas");b.width=C[0],b.height=C[1];var P=b.getContext("2d",{alpha:!1});P.fillStyle=U;var R=P.canvas;P.fillRect(0,0,R.width,R.height),Fi(C?C[0]:R.width,C?C[1]:R.height).drawImage(R,0,0),w.setImage(new eh({img:R,imgSize:C,anchor:T.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:T.getOrigin(),size:T.getSize(),opacity:T.getOpacity(),scale:T.getScale(),rotation:T.getRotation(),rotateWithView:T.getRotateWithView()}))}var O=+w.getZIndex();(M=c[O])||(M={},c[O]=M,M[oe.POLYGON]=[],M[oe.CIRCLE]=[],M[oe.LINE_STRING]=[],M[oe.POINT]=[]);var I=w.getGeometryFunction()(k);I&&Dt(n,I.getExtent())&&M[I.getType().replace("Multi","")].push(I,w)}}}}for(var L=Object.keys(c).map(Number).sort(Ge),F=(p=0,L.length),M;p<F;++p)for(var Y in M=c[L[p]],M){var V=M[Y];for(y=0,z=V.length;y<z;y+=2){u.setStyle(V[y+1]);for(var G=0,X=t.length;G<X;++G)u.setTransform(t[G]),u.drawGeometry(V[y])}}return document.body.appendChild(a.canvas),a.getImageData(0,0,s.width,s.height)}function od(l,t,e){var r=[];if(e){var n=4*(Zm(l[0]/2)+Zm(l[1]/2)*e.width),i=e.data[n],o=e.data[n+1],a=e.data[n+2]+256*(o+256*i),s=N(16777215/t.length);a&&0==a%s&&r.push(t[a/s-1])}return r}function ad(x,t,e,r,n,i){var o=NaN,S=NaN,E=(e-t)/r;if(1==E)o=x[t],S=x[t+1];else if(2==E)o=(1-n)*x[t]+n*x[t+r],S=(1-n)*x[t+1]+n*x[t+r+1];else if(0!==E){for(var u=x[t],T=x[t+1],C=0,P=[0],p=t+r;p<e;p+=r){var R=x[p],d=x[p+1];C+=ee((R-u)*(R-u)+(d-T)*(d-T)),P.push(C),u=R,T=d}var _=n*C,g=function(o,t,e){for(var r=0,l=o.length,p=!1,d,_;r<l;)0>(_=+(e||Ge)(o[d=r+(l-r>>1)],t))?r=d+1:(l=d,p=!_);return p?r:~r}(P,_);if(0>g){var y=(_-P[-g-2])/(P[-g-1]-P[-g-2]),w=t+(-g-2)*r;o=ge(x[w],x[w+r],y),S=ge(x[w+1],x[w+r+1],y)}else o=x[t+g*r],S=x[t+g*r+1]}return i?(i[0]=o,i[1]=S,i):[o,S]}function xd(d,t,e,r,n,i){if(e==t)return null;var o;if(n<d[t+r-1])return i?((o=d.slice(t,t+r))[r-1]=n,o):null;if(d[e-1]<n)return i?((o=d.slice(e-r,e))[r-1]=n,o):null;if(n==d[t+r-1])return d.slice(t,t+r);for(var _=t/r,g=e/r,y;_<g;)y=_+g>>1,n<d[(y+1)*r-1]?g=y:_=y+1;var m=d[_*r-1];if(n==m)return d.slice((_-1)*r,(_-1)*r+r);var h=(n-m)/(d[(_+1)*r-1]-m);o=[];for(var c=0;c<r-1;++c)o.push(ge(d[(_-1)*r+c],d[_*r+c],h));return o.push(n),o}function wd(m,t,e){for(var r=[],l=m(0),x=m(1),S=t(l),E=t(x),T=[x,l],d=[E,S],_=[1,0],g={},y=1e5,C,P,R,w,L,I;0<--y&&0<_.length;)R=_.pop(),l=T.pop(),S=d.pop(),(I=R.toString())in g||(r.push(S[0],S[1]),g[I]=!0),w=_.pop(),x=T.pop(),E=d.pop(),he((P=t(C=m(L=(R+w)/2)))[0],P[1],S[0],S[1],E[0],E[1])<e?(r.push(E[0],E[1]),g[I=w.toString()]=!0):(_.push(w,L,L,R),d.push(E,P,P,S),T.push(x,C,C,l));return r}function Td(a){for(var t=a.dataTransfer.files,e=0,s=t.length;e<s;++e){var n=t.item(e),i=new FileReader;i.addEventListener("load",this.handleResult_.bind(this,n)),i.readAsText(n)}}function Bd(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function Yd(l,t,p,r){for(var n=[],i=[1/0,1/0,-1/0,-1/0],d=0,_=p.length,s;d<_;++d)s=p[d],i=ft(l,t,s[0],r),n.push((i[0]+i[2])/2,(i[1]+i[3])/2),t=s[s.length-1];return n}function t_(){var e=xl();return function(){return e[oe.POINT]}}function g_(o){return function(t){return Y([o,t])}}function y_(o,t){return o[0]==t[0]?function(e){return Y([o,[e[0],t[1]]])}:o[1]==t[1]?function(e){return Y([o,[t[0],e[1]]])}:null}function v_(o,t){return o.index-t.index}function b_(l,t,e){var r=t.geometry;if(r.getType()===oe.CIRCLE){var n=r;if(1===t.index){var p=Yt();p&&(n=n.clone().transform(p,e));var o=ii(n.getCenter(),Xt(l,e)),a=ee(o)-n.getRadius();return a*a}}var s=Xt(l,e);return w_[0]=Xt(t.segment[0],e),w_[1]=Xt(t.segment[1],e),yi(s,w_)}function P_(s,t,e){var r=t.geometry;if(r.getType()===oe.CIRCLE&&1===t.index){var n=r,l=Yt();return l&&(n=n.clone().transform(l,e)),Vt(n.getClosestPoint(Xt(s,e)),e)}var o=Xt(s,e);return w_[0]=Xt(t.segment[0],e),w_[1]=Xt(t.segment[1],e),Vt(dn(o,w_),e)}function R_(i){if(!this.condition_(i))return!0;var d=this.addCondition_(i),e=this.removeCondition_(i),r=this.toggleCondition_(i),t=i.map,o=this.getFeatures(),n=[],a=[];if(!d&&!e&&!r){k(this.featureLayerAssociation_),t.forEachFeatureAtPixel(i.pixel,function(o,t){if(this.filter_(o,t))return a.push(o),this.addFeatureLayerAssociation_(o,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var s=o.getLength()-1;0<=s;--s){var _=o.item(s),g=a.indexOf(_);-1<g?a.splice(g,1):(o.remove(_),n.push(_))}0!==a.length&&o.extend(a)}else{t.forEachFeatureAtPixel(i.pixel,function(s,t){if(this.filter_(s,t))return(d||r)&&!x(o.getArray(),s)?(a.push(s),this.addFeatureLayerAssociation_(s,t)):(e||r)&&x(o.getArray(),s)&&(n.push(s),this.removeFeatureLayerAssociation_(s)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=n.length-1;0<=u;--u)o.remove(n[u]);o.extend(a)}return(0<a.length||0<n.length)&&this.dispatchEvent(new I_("select",a,n,i)),!0}function A_(e){return e.feature?e.feature:e.element?e.element:void 0}function z_(o){for(var t=[],e=0,i=o.length;e<i;++e)t.push(o[e].clone());return t}function j_(s,t,e){var r=e?Ve(e.featureProjection):null,i=e?Ve(e.dataProjection):null,o;if(o=r&&i&&!qe(r,i)?(t?s.clone():s).transform(t?r:i,t?i:r):s,t&&e&&void 0!==e.decimals){var l=M(10,e.decimals);o===s&&(o=s.clone()),o.applyTransform(function(o){for(var t=0,n=o.length;t<n;++t)o[t]=Zm(o[t]*l)/l;return o})}return o}function B_(o,t){var e=t?Ve(t.featureProjection):null,r=t?Ve(t.dataProjection):null;return e&&r&&!qe(e,r)?Bt(o,r,e):o}function Y_(o){if("string"==typeof o){var t=JSON.parse(o);return t||null}return null===o?null:o}function Z_(l,p){var e,d,_;if(!l)return null;if("number"==typeof l.x&&"number"==typeof l.y)_=oe.POINT;else if(l.points)_=oe.MULTI_POINT;else if(l.paths)_=1===l.paths.length?oe.LINE_STRING:oe.MULTI_LINE_STRING;else if(l.rings){var g=l,o=H_(g),a=function(p,t){var e=[],i=[],o=[],a,d;for(a=0,d=p.length;a<d;++a)e.length=0,mr(e,0,p[a],t.length),zr(e,0,e.length,t.length)?i.push([p[a]]):o.push(p[a]);for(;o.length;){var _=o.shift(),s=!1;for(a=i.length-1;0<=a;a--){var g=i[a][0];if(dt(new Xr(g).getExtent(),new Xr(_).getExtent())){i[a].push(_),s=!0;break}}s||i.push([_.reverse()])}return i}(g.rings,o);1===a.length?(_=oe.POLYGON,l=Object.assign({},l,((e={}).rings=a[0],e))):(_=oe.MULTI_POLYGON,l=Object.assign({},l,((d={}).rings=a,d)))}return j_((0,eg[_])(l),!1,p)}function H_(o){var t="XY";return!0===o.hasZ&&!0===o.hasM?t="XYZM":!0===o.hasZ?t="XYZ":!0===o.hasM&&(t="XYM"),t}function J_(o){var t=o.getLayout();return{hasZ:t==="XYZ"||t==="XYZM",hasM:t==="XYM"||t==="XYZM"}}function $_(o,t){return(0,rg[o.getType()])(j_(o,!0,t),t)}function og(e){return ig(Es(e,!1))}function ig(o){var t=/^\s*(true|1)|(false|0)\s*$/.exec(o);return t?void 0!==t[1]||!1:void 0}function ag(o){var t=Es(o,!1),e=Date.parse(t);return isNaN(e)?void 0:e/1e3}function sg(e){return pg(Es(e,!1))}function pg(o){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(o);return t?parseFloat(t[1]):void 0}function gg(e){return yg(Es(e,!1))}function yg(o){var t=/^\s*(\d+)\s*$/.exec(o);return t?parseInt(t[1],10):void 0}function mg(e){return Es(e,!1).trim()}function fg(o,t){Eg(o,t?"1":"0")}function xg(o,t){var e=t.toPrecision();o.appendChild(il().createTextNode(e))}function Sg(o,t){var e=t.toString();o.appendChild(il().createTextNode(e))}function Eg(o,t){o.appendChild(il().createTextNode(t))}function Tg(o,t){var e=o.getGeometry();if(e){var r=hy[e.getType()];if(r)return Ss(t[t.length-1].node.namespaceURI,r)}}function Cg(o,t,e,r){return o.push(parseFloat(e.getAttribute("lon")),parseFloat(e.getAttribute("lat"))),"ele"in r?(o.push(r.ele),delete r.ele,t.hasZ=!0):o.push(0),"time"in r?(o.push(r.time),delete r.time,t.hasM=!0):o.push(0),o}function Pg(s,t,e){var r="XY",l=2;if(s.hasZ&&s.hasM?(r="XYZM",l=4):s.hasZ?(r="XYZ",l=3):s.hasM&&(r="XYM",l=3),4!=l){for(var p=0,d=t.length/4;p<d;p++)t[p*l]=t[4*p],t[p*l+1]=t[4*p+1],s.hasZ&&(t[p*l+2]=t[4*p+2]),s.hasM&&(t[p*l+2]=t[4*p+3]);if(t.length=t.length/4*l,e)for(p=0,d=e.length;p<d;p++)e[p]=e[p]/4*l}return r}function wg(o,t){var e=t[t.length-1],r=o.getAttribute("href");null!==r&&(e.link=r),el(Vg,o,t)}function vg(o,t){t[t.length-1].extensionsNode_=o}function bg(l,t){var e=t[0],r=tl({flatCoordinates:[],layoutOptions:{}},Zg,l,t);if(r){var n=r.flatCoordinates;delete r.flatCoordinates;var i=r.layoutOptions;delete r.layoutOptions;var o=Pg(i,n),a=new Sd(n,o);j_(a,!1,e);var s=new ut(a);return s.setProperties(r,!0),s}}function Mg(p,t){var e=t[0],r=tl({flatCoordinates:[],ends:[],layoutOptions:{}},qg,p,t);if(r){var n=r.flatCoordinates;delete r.flatCoordinates;var i=r.ends;delete r.ends;var o=r.layoutOptions;delete r.layoutOptions;var a=Pg(o,n,i),s=new Hd(n,a,i);j_(s,!1,e);var d=new ut(s);return d.setProperties(r,!0),d}}function Ug(l,t){var e=t[0],r=tl({},Qg,l,t);if(r){var n={},i=Cg([],n,l,r),o=Pg(n,i),a=new Zr(i,o);j_(a,!1,e);var s=new ut(a);return s.setProperties(r,!0),s}}function eu(o,t,e){o.setAttribute("href",t);var r=e[e.length-1].properties,n=[r.linkText,r.linkType];nl({node:o},ty,Yu,n,e,$g)}function iu(l,t,e){var r=e[e.length-1],n=r.node.namespaceURI,i=r.properties;switch(l.setAttributeNS(null,"lat",t[1]+""),l.setAttributeNS(null,"lon",t[0]+""),r.geometryLayout){case"XYZM":0!==t[3]&&(i.time=t[3]);case"XYZ":0!==t[2]&&(i.ele=t[2]);break;case"XYM":0!==t[2]&&(i.time=t[2]);}var o="rtept"==l.nodeName?ny[n]:uy[n],a=Zs(i,o);nl({node:l,properties:i},ly,Yu,a,e,o)}function su(o,t){if(!o)return null;var e;switch(o.type){case oe.POINT:e=function(e){return new Zr(e.coordinates)}(o);break;case oe.LINE_STRING:e=function(e){return new Sd(e.coordinates)}(o);break;case oe.POLYGON:e=function(e){return new hn(e.coordinates)}(o);break;case oe.MULTI_POINT:e=function(e){return new Qd(e.coordinates)}(o);break;case oe.MULTI_LINE_STRING:e=function(e){return new Hd(e.coordinates)}(o);break;case oe.MULTI_POLYGON:e=function(e){return new e_(e.coordinates)}(o);break;case oe.GEOMETRY_COLLECTION:e=function(o,n){var e=o.geometries.map(function(e){return su(e,n)});return new W_(e)}(o);break;default:throw new Error("Unsupported GeoJSON type: "+o.type);}return j_(e,!1,t)}function lu(o,i){var e=(o=j_(o,!0,i)).getType(),n;switch(e){case oe.POINT:n=function(e){return{type:"Point",coordinates:e.getCoordinates()}}(o);break;case oe.LINE_STRING:n=function(e){return{type:"LineString",coordinates:e.getCoordinates()}}(o);break;case oe.POLYGON:n=function(o,t){var e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:o.getCoordinates(e)}}(o,i);break;case oe.MULTI_POINT:n=function(e){return{type:"MultiPoint",coordinates:e.getCoordinates()}}(o);break;case oe.MULTI_LINE_STRING:n=function(e){return{type:"MultiLineString",coordinates:e.getCoordinates()}}(o);break;case oe.MULTI_POLYGON:n=function(o,t){var e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:o.getCoordinates(e)}}(o,i);break;case oe.GEOMETRY_COLLECTION:n=function(o,n){return{type:"GeometryCollection",geometries:o.getGeometriesArray().map(function(e){var t=yh({},n);return delete t.featureProjection,lu(e,t)})}}(o,i);break;case oe.CIRCLE:n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+e);}return n}function uu(e){return"string"==typeof e?e:""}function yu(o){var t=Es(o,!1),e=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(t);if(e){var r=e[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function mu(i){for(var t=Es(i,!1),l=[],n;n=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i.exec(t);){var p=parseFloat(n[1]),o=parseFloat(n[2]),a=n[3]?parseFloat(n[3]):0;l.push(p,o,a),t=t.substr(n[0].length)}if(""===t)return l}function xu(o){var t=Es(o,!1).trim(),e=o.baseURI;return e&&"about:blank"!=e||(e=window.location.href),e?new URL(t,e).href:t}function Su(e){return sg(e)}function Eu(o,t){return tl(void 0,mx,o,t,this)}function Tu(o,t){return tl(null,TS,o,t)}function Ru(s,t){var e=tl({flatCoordinates:[],whens:[]},bS,s,t);if(e){for(var r=e.flatCoordinates,n=e.whens,i=0,l=E(r.length,n.length);i<l;++i)r[4*i+3]=n[i];return new Sd(r,"XYZM")}}function Lu(o,t){return tl(null,lE,o,t)}function Iu(o,t){var e=tl({},pE,o,t),r=Lu(o,t);if(r){var n=new Sd(r,"XYZ");return n.setProperties(e,!0),n}}function vu(o,t){var e=tl({},pE,o,t),r=Lu(o,t);if(r){var n=new hn(r,"XYZ",[r.length]);return n.setProperties(e,!0),n}}function bu(p,t){var e=tl([],dE,p,t),n;if(!e)return null;if(0===e.length)return new W_(e);for(var d=!0,_=e[0].getType(),o=1,g=e.length;o<g;++o)if(e[o].getType()!=_){d=!1;break}if(d){var c,y;if(_==oe.POINT){var m=e[0];for(c=m.getLayout(),y=m.getFlatCoordinates(),(o=1,g=e.length);o<g;++o)v(y,e[o].getFlatCoordinates());Gu(n=new Qd(y,c),e)}else _==oe.LINE_STRING?Gu(n=new Hd(e),e):_==oe.POLYGON?Gu(n=new e_(e),e):_==oe.GEOMETRY_COLLECTION?n=new W_(e):O(!1,37)}else n=new W_(e);return n}function Fu(o,t){var e=tl({},pE,o,t),r=Lu(o,t);if(r){var n=new Zr(r,"XYZ");return n.setProperties(e,!0),n}}function Ou(l,t){var e=tl({},pE,l,t),r=tl([null],_E,l,t);if(r&&r[0]){for(var n=r[0],i=[n.length],o=1,p=r.length;o<p;++o)v(n,r[o]),i.push(n.length);var s=new hn(n,"XYZ",i);return s.setProperties(e,!0),s}}function Nu(l,t){var e=tl({},gE,l,t,this);if(!e)return null;var r="fillStyle"in e?e.fillStyle:sx,p=e.fill,o;void 0===p||p||(r=null),"imageStyle"in e?e.imageStyle!=qE&&(o=e.imageStyle):o=lx;var d="textStyle"in e?e.textStyle:_x,a="strokeStyle"in e?e.strokeStyle:dx,s=e.outline;return void 0===s||s?[new Vf({fill:r,image:o,stroke:a,text:d,zIndex:void 0})]:[new Vf({geometry:function(o){var t=o.getGeometry(),e=t.getType();return e===oe.GEOMETRY_COLLECTION?new W_(t.getGeometriesArrayRecursive().filter(function(o){var t=o.getType();return t!==oe.POLYGON&&t!==oe.MULTI_POLYGON})):e!==oe.POLYGON&&e!==oe.MULTI_POLYGON?t:void 0},fill:r,image:o,stroke:a,text:d,zIndex:void 0}),new Vf({geometry:function(o){var t=o.getGeometry(),e=t.getType();return e===oe.GEOMETRY_COLLECTION?new W_(t.getGeometriesArrayRecursive().filter(function(o){var t=o.getType();return t===oe.POLYGON||t===oe.MULTI_POLYGON})):e===oe.POLYGON||e===oe.MULTI_POLYGON?t:void 0},fill:r,stroke:null,zIndex:void 0})]}function Gu(p,t){var e=t.length,o=Array(t.length),a=Array(t.length),s=Array(t.length),d,_,g;d=!1,_=!1,g=!1;for(var u=0,c;u<e;++u)c=t[u],o[u]=c.get("extrude"),a[u]=c.get("tessellate"),s[u]=c.get("altitudeMode"),d=d||void 0!==o[u],_=_||void 0!==a[u],g=g||s[u];d&&p.set("extrude",o),_&&p.set("tessellate",a),g&&p.set("altitudeMode",s)}function Du(o,t){el(mE,o,t)}function ku(o,t){el(Qy,o,t)}function ju(a,t){for(var e=Bi(t),r=[255*(4==e.length?e[3]:1),e[2],e[1],e[0]],n=0,s;4>n;++n)s=N(r[n]).toString(16),r[n]=1==s.length?"0"+s:s;Eg(a,r.join(""))}function Bu(i,t,e){var r=t.getType(),o=[],s;r===oe.GEOMETRY_COLLECTION?(t.getGeometriesArrayRecursive().forEach(function(r){var t=r.getType();t===oe.MULTI_POINT?o=o.concat(r.getPoints()):t===oe.MULTI_LINE_STRING?o=o.concat(r.getLineStrings()):t===oe.MULTI_POLYGON?o=o.concat(r.getPolygons()):t===oe.POINT||t===oe.LINE_STRING||t===oe.POLYGON?o.push(r):O(!1,39)}),s=cm):r===oe.MULTI_POINT?(o=t.getPoints(),s=pm):r===oe.MULTI_LINE_STRING?(o=t.getLineStrings(),s=fm):r===oe.MULTI_POLYGON?(o=t.getPolygons(),s=_m):O(!1,39),nl({node:i},gm,s,o,e)}function Vu(o,t,e){nl({node:o},ym,dm,[t],e)}function Xu(x,S,e){var t={node:x};S.getId()&&x.setAttribute("id",S.getId());var r=S.getProperties(),n={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};n[S.getGeometryName()]=1;var o=Object.keys(r||{}).sort().filter(function(e){return!n[e]}),i=S.getStyleFunction();if(i){var a=i(S,0);if(a){var s=Array.isArray(a)?a:[a],l=s;if(S.getGeometry()&&(l=s.filter(function(e){var t=e.getGeometryFunction()(S);if(t){var o=t.getType();return o===oe.GEOMETRY_COLLECTION?t.getGeometriesArrayRecursive().filter(function(o){var t=o.getType();return t===oe.POINT||t===oe.MULTI_POINT}).length:o===oe.POINT||o===oe.MULTI_POINT}})),this.writeStyles_){var u=s,E=s;S.getGeometry()&&(u=s.filter(function(e){var t=e.getGeometryFunction()(S);if(t){var o=t.getType();return o===oe.GEOMETRY_COLLECTION?t.getGeometriesArrayRecursive().filter(function(o){var t=o.getType();return t===oe.LINE_STRING||t===oe.MULTI_LINE_STRING}).length:o===oe.LINE_STRING||o===oe.MULTI_LINE_STRING}}),E=s.filter(function(e){var t=e.getGeometryFunction()(S);if(t){var o=t.getType();return o===oe.GEOMETRY_COLLECTION?t.getGeometriesArrayRecursive().filter(function(o){var t=o.getType();return t===oe.POLYGON||t===oe.MULTI_POLYGON}).length:o===oe.POLYGON||o===oe.MULTI_POLYGON}})),r.Style={pointStyles:l,lineStyles:u,polyStyles:E}}if(l.length&&void 0===r.name){var T=l[0].getText();T&&(r.name=T.getText())}}}var f=e[e.length-1].node,d=wm[f.namespaceURI],_=Zs(r,d);if(nl(t,mm,Yu,_,e,d),0<o.length){var g=Zs(r,o);nl(t,mm,Sm,[{names:o,values:g}],e)}var y=e[0],C=S.getGeometry();C&&(C=j_(C,!0,y)),nl(t,mm,cm,[C],e)}function Wu(l,t,e){var r=t.getFlatCoordinates(),n={node:l};n.layout=t.getLayout(),n.stride=t.getStride();var i=t.getProperties();i.coordinates=r;var o=e[e.length-1].node,a=Em[o.namespaceURI],s=Zs(i,a);nl(n,Cm,Yu,s,e,a)}function Zu(a,t,e){var r=t.getLinearRings(),n=r.shift(),i={node:a};nl(i,Rm,Om,r,e),nl(i,Rm,Im,[n],e)}function Ku(o,t){xg(o,Zm(1e6*t)/1e6)}function Hu(o,t,e){if(3===o){var r={keys:[],values:[],features:[]},n=e.readVarint()+e.pos;e.readFields(qu,r,n),r.length=r.features.length,r.length&&(t[r.name]=r)}}function qu(o,a,e){if(15===o)a.version=e.readVarint();else if(1===o)a.name=e.readString();else if(5===o)a.extent=e.readVarint();else if(2===o)a.features.push(e.pos);else if(3===o)a.keys.push(e.readString());else if(4===o){for(var r=null,s=e.readVarint()+e.pos;e.pos<s;)r=1==(o=e.readVarint()>>3)?e.readString():2===o?e.readFloat():3===o?e.readDouble():4===o?e.readVarint64():5===o?e.readVarint():6===o?e.readSVarint():7===o?e.readBoolean():null;a.values.push(r)}}function Ju(a,t,e){if(1==a)t.id=e.readVarint();else if(2==a)for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t.layer.keys[e.readVarint()],i=t.layer.values[e.readVarint()];t.properties[n]=i}else 3==a?t.type=e.readVarint():4==a&&(t.geometry=e.pos)}function Qu(o,t,e){o.pos=t.features[e];var r=o.readVarint()+o.pos,n={layer:t,type:0,properties:{}};return o.readFields(Ju,n,r),n}function $u(o,t){t[t.length-1].tags[o.getAttribute("k")]=o.getAttribute("v")}function fc(p,t,e,r,n,i){var o,d;void 0===n?(o=[],d=0):(o=n,d=void 0===i?0:i);for(var _=t,g;_<e;){g=p[_++],o[d++]=p[_++],o[d++]=g;for(var c=2;c<r;++c)o[d++]=p[_++]}return o.length=d,o}function xc(i,t,e){var r=Array(t),o;for(o=0;o<t;++o)r[o]=0;for(var p=0,d=i.length;p<d;)for(o=0;o<t;++o,++p){var s=i[p],_=s-r[o];r[o]=s,i[p]=_}return Lc(i,e||1e5)}function Sc(i,t,e){var r=Array(t),o;for(o=0;o<t;++o)r[o]=0;for(var l=bc(i,e||1e5),a=0,p=l.length;a<p;)for(o=0;o<t;++o,++a)r[o]+=l[a],l[a]=r[o];return l}function Lc(o,t){for(var e=0,r=o.length;e<r;++e)o[e]=Zm(o[e]*(t||1e5));return function(o){for(var t=0,i=o.length,r;t<i;++t)r=o[t],o[t]=0>r?~(r<<1):r<<1;return function(o){for(var t="",i=0,a=o.length;i<a;++i)t+=Fc(o[i]);return t}(o)}(o)}function bc(r,t){for(var e=function(o){for(var t=function(s){for(var t=[],e=0,l=0,p=0,d=s.length,o;p<d;++p)o=s.charCodeAt(p)-63,e|=(31&o)<<l,32>o?(t.push(e),e=0,l=0):l+=5;return t}(o),e=0,a=t.length,n;e<a;++e)n=t[e],t[e]=1&n?~(n>>1):n>>1;return t}(r),n=0,a=e.length;n<a;++n)e[n]/=t||1e5;return e}function Fc(o){for(var n="",i;32<=o;)i=63+(32|31&o),n+=p(i),o>>=5;return i=o+63,n+=p(i)}function Mc(l,t){for(var e=[],i=0,p=l.length,a,d;i<p;++i)a=l[i],0<i&&e.pop(),d=0<=a?t[a]:t[~a].slice().reverse(),e.push.apply(e,d);for(var _=0,g=e.length;_<g;++_)e[_]=e[_].slice();return e}function Nc(p,t,e,r,n,i,o){for(var a=p.geometries,s=[],d=0,_=a.length;d<_;++d)s[d]=jc(a[d],t,e,r,n,i,o);return s}function jc(p,t,e,r,n,i,o){var a=p.type,d=px[a],l;l="Point"===a||"MultiPoint"===a?d(p,e,r):d(p,t);var _=new ut;_.setGeometry(j_(l,!1,o)),void 0!==p.id&&_.setId(p.id);var g=p.properties;return n&&(g||(g={}),g[n]=i),g&&_.setProperties(g,!0),_}function py(l,t,e){for(var r=0,p=0,d=0,_=l.length,a;d<_;++d)a=l[d],r+=a[0],p+=a[1],a[0]=r,a[1]=p,dy(a,t,e)}function dy(o,t,e){o[0]=o[0]*t[0]+e[0],o[1]=o[1]*t[1]+e[1]}function _y(){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Ex,t))}function gy(o,t,e){return new Cx(o,t,e)}function yy(o,t){var e=Ss("http://www.opengis.net/ogc","Filter"),r=Ss("http://www.opengis.net/ogc","FeatureId");e.appendChild(r),r.setAttribute("fid",t),o.appendChild(e)}function my(o,n){var e=(o=o||"feature")+":";return 0===n.indexOf(e)?n:e+n}function fy(o,t,e){nl({node:o},ET,Ws(t.getTagName()),[t],e)}function xy(l,t,e){for(var r={node:l},n=t.conditions,i=0,p=n.length,a;i<p;++i)a=n[i],nl(r,ET,Ws(a.getTagName()),[a],e)}function Sy(o,t){void 0!==t.matchCase&&o.setAttribute("matchCase",t.matchCase.toString()),Cy(o,t.propertyName),Ry(o,""+t.expression)}function Ty(o,t,e){var r=Ss("http://www.opengis.net/ogc",o);Eg(r,e),t.appendChild(r)}function Cy(o,t){Ty("PropertyName",o,t)}function Ry(o,t){Ty("Literal",o,t)}function wy(o,t){var e=Ss("http://www.opengis.net/gml","TimeInstant");o.appendChild(e);var r=Ss("http://www.opengis.net/gml","timePosition");e.appendChild(r),Eg(r,t)}function vy(o){var t=o.getCoordinates();return 0===t.length?"":t.join(" ")}function Dy(o){for(var t=o.getCoordinates(),e=[],r=0,a=t.length;r<a;++r)e.push(t[r].join(" "));return e.join(",")}function ky(o){for(var t=[],e=o.getLinearRings(),r=0,a=e.length;r<a;++r)t.push("("+Dy(e[r])+")");return t.join(",")}function zy(o){var t=o.getType(),i=(0,NT[t])(o);if(t=t.toUpperCase(),"function"==typeof o.getFlatCoordinates){var r=function(o){var t=o.getLayout(),e="";return t!=="XYZ"&&t!=="XYZM"||(e+="Z"),t!=="XYM"&&t!=="XYZM"||(e+="M"),e}(o);0<r.length&&(t+=" "+r)}return 0===i.length?t+" EMPTY":t+"("+i+")"}function By(e){return e.getAttributeNS("http://www.w3.org/1999/xlink","href")}function Yy(o,t){return tl({},mS,o,t)}function Vy(o,t){return tl({},_S,o,t)}function xm(o,t){var e=Yy(o,t);if(e){var r=[yg(o.getAttribute("width")),yg(o.getAttribute("height"))];return e.size=r,e}}function Tm(o,t){return tl([],xS,o,t)}function Pm(e){var t=mg(e).split(/\s+/);if(t&&2==t.length){var o=+t[0],r=+t[1];if(!isNaN(o)&&!isNaN(r))return[o,r]}}function vm(){var e=document.body;return!!(e.webkitRequestFullscreen||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)}function Fm(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function Am(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function jm(o){var t=o.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null}function Vm(){this.validateExtent_(),this.updateBox_()}function Xm(o){var t=o.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}function Wm(o){if(o.frameState){this.sliderInitialized_||this.initSlider_();var t=o.frameState.viewState.resolution;this.currentResolution_=t,this.setThumbPosition_(t)}}var Zm=Math.round,ah=Math.atan,sh=Math.atan2,dh=Math.PI,_h=Math.sin,gh=Math.cos;e.r(t);var uh=0,ch=(Ee=function(o,t){return(Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(o,t)},function(o,t){function e(){this.constructor=o}Ee(o,t),o.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),s=function(o){function t(t){var e=this,i="Assertion failed. See https://openlayers.org/en/v"+["6.3.1"][0]+"/doc/errors/#"+t+" for details.";return(e=o.call(this,i)||this).code=t,e.name="AssertionError",e.message=i,e}return ch(t,o),t}(Error),u="add",l="remove",h="propertychange",yh="function"==typeof Object.assign?Object.assign:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1,s=arguments.length,i;r<s;++r)if(i=arguments[r],null!=i)for(var l in i)i.hasOwnProperty(l)&&(t[l]=i[l]);return t},c="function"==typeof Object.values?Object.values:function(o){var t=[];for(var e in o)t.push(o[e]);return t},hh=function(){function e(){this.disposed_=!1}return e.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},e.prototype.disposeInternal=function(){},e}(),fh=function(){function e(e){this.propagationStopped,this.type=e,this.target=null}return e.prototype.preventDefault=function(){this.propagationStopped=!0},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e}(),Ph=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Rh=function(o){function t(t){var e=o.call(this)||this;return e.eventTarget_=t,e.pendingRemovals_={},e.dispatching_={},e.listeners_={},e}return Ph(t,o),t.prototype.addEventListener=function(o,t){if(o&&t){var e=this.listeners_[o];e||(e=[],this.listeners_[o]=e),-1===e.indexOf(t)&&e.push(t)}},t.prototype.dispatchEvent=function(l){var t="string"==typeof l?new fh(l):l,e=t.type;t.target||(t.target=this.eventTarget_||this);var r=this.listeners_[e],i;if(r){e in this.dispatching_||(this.dispatching_[e]=0,this.pendingRemovals_[e]=0),++this.dispatching_[e];for(var p=0,d=r.length;p<d;++p)if(!1===(i="handleEvent"in r[p]?r[p].handleEvent(t):r[p].call(this,t))||t.propagationStopped){i=!1;break}if(--this.dispatching_[e],0===this.dispatching_[e]){var a=this.pendingRemovals_[e];for(delete this.pendingRemovals_[e];a--;)this.removeEventListener(e,b);delete this.dispatching_[e]}return i}},t.prototype.disposeInternal=function(){k(this.listeners_)},t.prototype.getListeners=function(e){return this.listeners_[e]},t.prototype.hasListener=function(e){return e?e in this.listeners_:0<Object.keys(this.listeners_).length},t.prototype.removeEventListener=function(o,t){var e=this.listeners_[o];if(e){var r=e.indexOf(t);-1!==r&&(o in this.pendingRemovals_?(e[r]=b,++this.pendingRemovals_[o]):(e.splice(r,1),0===e.length&&delete this.listeners_[o]))}},t}(hh),A="change",vh="contextmenu",j="click",D="drop",B="resize",W="touchmove",Z="wheel",K=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),q=function(o){function t(){var t=o.call(this)||this;return t.revision_=0,t}return K(t,o),t.prototype.changed=function(){++this.revision_,this.dispatchEvent(A)},t.prototype.getRevision=function(){return this.revision_},t.prototype.on=function(o,t){if(Array.isArray(o)){for(var e=o.length,r=Array(e),n=0;n<e;++n)r[n]=_(this,o[n],t);return r}return _(this,o,t)},t.prototype.once=function(o,t){if(Array.isArray(o)){for(var e=o.length,r=Array(e),n=0;n<e;++n)r[n]=g(this,o[n],t);return r}return g(this,o,t)},t.prototype.un=function(o,t){if(Array.isArray(o))for(var e=0,i=o.length;e<i;++e)this.removeEventListener(o[e],t);else this.removeEventListener(o,t)},t}(Rh),H=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),J=function(o){function t(t,e,r){var n=o.call(this,t)||this;return n.key=e,n.oldValue=r,n}return H(t,o),t}(fh),Q=function(o){function t(t){var e=o.call(this)||this;return X(e),e.values_={},void 0!==t&&e.setProperties(t),e}return H(t,o),t.prototype.get=function(o){var t;return this.values_.hasOwnProperty(o)&&(t=this.values_[o]),t},t.prototype.getKeys=function(){return Object.keys(this.values_)},t.prototype.getProperties=function(){return yh({},this.values_)},t.prototype.notify=function(o,t){var e;e=L(o),this.dispatchEvent(new J(e,o,t)),e=h,this.dispatchEvent(new J(e,o,t))},t.prototype.set=function(o,t,e){if(e)this.values_[o]=t;else{var r=this.values_[o];this.values_[o]=t,r!==t&&this.notify(o,r)}},t.prototype.setProperties=function(o,t){for(var e in o)this.set(e,o[e],t)},t.prototype.unset=function(o,t){if(o in this.values_){var e=this.values_[o];delete this.values_[o],t||this.notify(o,e)}},t}(q),$={},tt=Q,rt=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),nt="length",it=function(o){function t(t,e,r){var n=o.call(this,t)||this;return n.element=e,n.index=r,n}return rt(t,o),t}(fh),ot=function(i){function t(t,e){var r=i.call(this)||this;if(r.unique_=!!(e||{}).unique,r.array_=t||[],r.unique_)for(var n=0,s=r.array_.length;n<s;++n)r.assertUnique_(r.array_[n],n);return r.updateLength_(),r}return rt(t,i),t.prototype.clear=function(){for(;0<this.getLength();)this.pop()},t.prototype.extend=function(o){for(var t=0,n=o.length;t<n;++t)this.push(o[t]);return this},t.prototype.forEach=function(o){for(var t=this.array_,e=0,i=t.length;e<i;++e)o(t[e],e,t)},t.prototype.getArray=function(){return this.array_},t.prototype.item=function(e){return this.array_[e]},t.prototype.getLength=function(){return this.get(nt)},t.prototype.insertAt=function(o,t){this.unique_&&this.assertUnique_(t),this.array_.splice(o,0,t),this.updateLength_(),this.dispatchEvent(new it(u,t,o))},t.prototype.pop=function(){return this.removeAt(this.getLength()-1)},t.prototype.push=function(o){this.unique_&&this.assertUnique_(o);var t=this.getLength();return this.insertAt(t,o),this.getLength()},t.prototype.remove=function(o){for(var t=this.array_,e=0,i=t.length;e<i;++e)if(t[e]===o)return this.removeAt(e)},t.prototype.removeAt=function(o){var t=this.array_[o];return this.array_.splice(o,1),this.updateLength_(),this.dispatchEvent(new it(l,t,o)),t},t.prototype.setAt=function(o,t){var e=this.getLength();if(o<e){this.unique_&&this.assertUnique_(t,o);var r=this.array_[o];this.array_[o]=t,this.dispatchEvent(new it(l,r,o)),this.dispatchEvent(new it(u,t,o))}else{for(var n=e;n<o;++n)this.insertAt(n,void 0);this.insertAt(o,t)}},t.prototype.updateLength_=function(){this.set(nt,this.array_.length)},t.prototype.assertUnique_=function(o,t){for(var e=0,i=this.array_.length;e<i;++e)if(this.array_[e]===o&&e!==t)throw new s(58)},t}(tt),at=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ut=function(o){function i(t){var e=o.call(this)||this;if(e.id_=void 0,e.geometryName_="geometry",e.style_=null,e.styleFunction_=void 0,e.geometryChangeKey_=null,e.addEventListener(L(e.geometryName_),e.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){e.setGeometry(t)}else{e.setProperties(t)}return e}return at(i,o),i.prototype.clone=function(){var e=new i(this.getProperties());e.setGeometryName(this.getGeometryName());var t=this.getGeometry();t&&e.setGeometry(t.clone());var o=this.getStyle();return o&&e.setStyle(o),e},i.prototype.getGeometry=function(){return this.get(this.geometryName_)},i.prototype.getId=function(){return this.id_},i.prototype.getGeometryName=function(){return this.geometryName_},i.prototype.getStyle=function(){return this.style_},i.prototype.getStyleFunction=function(){return this.styleFunction_},i.prototype.handleGeometryChange_=function(){this.changed()},i.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(y(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=_(e,A,this.handleGeometryChange_,this)),this.changed()},i.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},i.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?function(o){if("function"==typeof o)return o;var t;return Array.isArray(o)?t=o:(O("function"==typeof o.getZIndex,41),t=[o]),function(){return t}}(e):void 0,this.changed()},i.prototype.setId=function(e){this.id_=e,this.changed()},i.prototype.setGeometryName=function(e){this.removeEventListener(L(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=e,this.addEventListener(L(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},i}(tt),lt="XY",re="XYZ",ne="XYM",ie="XYZM",oe={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ae="cosh"in Math?Math.cosh:function(o){var t=d(o);return(t+1/t)/2},ce={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Se={},Ee;Se[ce.DEGREES]=6370997*(2*dh)/360,Se[ce.FEET]=.3048,Se[ce.METERS]=1,Se[ce.USFEET]=1200/3937;var bh=ce,Te=function(){function e(e){this.code_=e.code,this.units_=e.units,this.extent_=void 0===e.extent?null:e.extent,this.worldExtent_=void 0===e.worldExtent?null:e.worldExtent,this.axisOrientation_=void 0===e.axisOrientation?"enu":e.axisOrientation,this.global_=void 0!==e.global&&e.global,this.canWrapX_=this.global_&&this.extent_,this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return e.prototype.canWrapX=function(){return this.canWrapX_},e.prototype.getCode=function(){return this.code_},e.prototype.getExtent=function(){return this.extent_},e.prototype.getUnits=function(){return this.units_},e.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Se[this.units_]},e.prototype.getWorldExtent=function(){return this.worldExtent_},e.prototype.getAxisOrientation=function(){return this.axisOrientation_},e.prototype.isGlobal=function(){return this.global_},e.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=e&&this.extent_},e.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},e.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},e.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=this.global_&&e},e.prototype.setWorldExtent=function(e){this.worldExtent_=e},e.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},e.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},e}(),Ce=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),be=6378137*dh,Pe=[-be,-be,be,be],Re=[-180,-85,180,85],Oe=function(o){function t(t){return o.call(this,{code:t,units:bh.METERS,extent:Pe,global:!0,worldExtent:Re,getPointResolution:function(o,t){return o/ae(t[1]/6378137)}})||this}return Ce(t,o),t}(Te),Ie=[new Oe("EPSG:3857"),new Oe("EPSG:102100"),new Oe("EPSG:102113"),new Oe("EPSG:900913"),new Oe("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Oe("urn:ogc:def:crs:EPSG::3857"),new Oe("http://www.opengis.net/gml/srs/epsg.xml#3857")],Le=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ae=[-180,-90,180,90],Ne=function(o){function t(t,e){return o.call(this,{code:t,units:bh.DEGREES,extent:Ae,axisOrientation:e,global:!0,metersPerUnit:6378137*dh/180,worldExtent:Ae})||this}return Le(t,o),t}(Te),je=[new Ne("CRS:84"),new Ne("EPSG:4326","neu"),new Ne("urn:ogc:def:crs:EPSG::4326","neu"),new Ne("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Ne("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ne("urn:ogc:def:crs:OGC:2:84"),new Ne("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ne("urn:x-ogc:def:crs:EPSG:4326","neu")],De={},ke={},Be=null,ar,Mh,kh;We(Ie),We(je),ar=Ie,Mh=we,kh=ve,je.forEach(function(o){ar.forEach(function(t){Fe(o,t,Mh),Fe(t,o,kh)})});var Uh=[,,,,,,],pr=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wr=[1,0,0,1,0,0],Sr=function(s){function t(){var t=s.call(this)||this,a,l,p,d,_;return t.extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(a=function(o,t,e){if(!e)return this.getSimplifiedGeometry(t);var r=this.clone();return r.applyTransform(e),r.getSimplifiedGeometry(t)},_=!1,function(){var e=Array.prototype.slice.call(arguments);return _&&this===d&&Kn(e,p)||(_=!0,d=this,p=e,l=a.apply(this,arguments)),l}),t}return pr(t,s),t.prototype.simplifyTransformed=function(o,t){return this.simplifyTransformedInternal(this.getRevision(),o,t)},t.prototype.clone=function(){return r()},t.prototype.closestPointXY=function(){return r()},t.prototype.containsXY=function(o,t){var e=this.getClosestPoint([o,t]);return e[0]===o&&e[1]===t},t.prototype.getClosestPoint=function(o,t){var e=t||[NaN,NaN];return this.closestPointXY(o[0],o[1],e,1/0),e},t.prototype.intersectsCoordinate=function(e){return this.containsXY(e[0],e[1])},t.prototype.computeExtent=function(){return r()},t.prototype.getExtent=function(e){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(o,t){return t?(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t):o}(this.extent_,e)},t.prototype.rotate=function(){r()},t.prototype.scale=function(){r()},t.prototype.simplify=function(e){return this.getSimplifiedGeometry(e*e)},t.prototype.getSimplifiedGeometry=function(){return r()},t.prototype.getType=function(){return r()},t.prototype.applyTransform=function(){r()},t.prototype.intersectsExtent=function(){return r()},t.prototype.translate=function(){r()},t.prototype.transform=function(o,l){var e=Ve(o),t=e.getUnits()==bh.TILE_PIXELS?function(r,t,n){var i=e.getExtent(),o=e.getWorldExtent(),a=Ot(o)/Ot(i);return $t(wr,o[0],o[3],a,-a,0,0,0),jt(r,0,r.length,n,wr,t),Qe(e,l)(r,t,n)}:Qe(e,l);return this.applyTransform(t),this},t}(tt),Er=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tr=function(o){function t(){var t=o.call(this)||this;return t.layout=lt,t.stride=2,t.flatCoordinates=null,t}return Er(t,o),t.prototype.computeExtent=function(e){return ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)},t.prototype.getCoordinates=function(){return r()},t.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.getFlatCoordinates=function(){return this.flatCoordinates},t.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},t.prototype.getLayout=function(){return this.layout},t.prototype.getSimplifiedGeometry=function(o){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),0>o||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&o<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var t=this.getSimplifiedGeometryInternal(o);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=o,this)},t.prototype.getSimplifiedGeometryInternal=function(){return this},t.prototype.getStride=function(){return this.stride},t.prototype.setFlatCoordinates=function(o,t){this.stride=rr(o),this.layout=o,this.flatCoordinates=t},t.prototype.setCoordinates=function(){r()},t.prototype.setLayout=function(o,a,s){var r;if(o)r=rr(o);else{for(var l=0;l<s;++l){if(0===a.length)return this.layout=lt,void(this.stride=2);a=a[0]}o=function(o){var t;return 2==o?t=lt:3==o?t=re:4==o&&(t=ie),t}(r=a.length)}this.layout=o,this.stride=r},t.prototype.applyTransform=function(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},t.prototype.rotate=function(o,t){var e=this.getFlatCoordinates();if(e){var r=this.getStride();se(e,0,e.length,r,o,t,e),this.changed()}},t.prototype.scale=function(s,t,e){var r=t;void 0===r&&(r=s);var l=e;l||(l=vt(this.getExtent()));var p=this.getFlatCoordinates();if(p){var o=this.getStride();!function(g,t,e,r,n,i,o,a){for(var s=a||[],u=o[0],l=o[1],y=0,m=t;m<e;m+=r){var h=g[m]-u,f=g[m+1]-l;s[y++]=u+n*h,s[y++]=l+i*f;for(var d=m+2;d<m+r;++d)s[y++]=g[d]}a&&s.length!=y&&(s.length=y)}(p,0,p.length,o,s,r,l,p),this.changed()}},t.prototype.translate=function(o,t){var e=this.getFlatCoordinates();if(e){var r=this.getStride();ue(e,0,e.length,r,o,t,e),this.changed()}},t}(Sr),br=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xr=function(o){function n(t,e){var r=o.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r}return br(n,o),n.prototype.clone=function(){return new n(this.flatCoordinates.slice(),this.layout)},n.prototype.closestPointXY=function(o,t,e,r){return r<st(this.getExtent(),o,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=ee(_r(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,o,t,e,r))},n.prototype.getArea=function(){return sr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getCoordinates=function(){return fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getSimplifiedGeometryInternal=function(e){var t=[];return t.length=Pr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new n(t,lt)},n.prototype.getType=function(){return oe.LINEAR_RING},n.prototype.intersectsExtent=function(){return!1},n.prototype.setCoordinates=function(o,t){this.setLayout(t,o,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mr(this.flatCoordinates,0,o,this.stride),this.changed()},n}(Tr),Wr=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zr=function(o){function t(t,e){var r=o.call(this)||this;return r.setCoordinates(t,e),r}return Wr(t,o),t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(l,t,e,r){var n=this.flatCoordinates,i=pe(l,t,n[0],n[1]);if(i<r){for(var o=this.stride,a=0;a<o;++a)e[a]=n[a];return e.length=o,i}return r},t.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},t.prototype.computeExtent=function(e){return ht(this.flatCoordinates,e)},t.prototype.getType=function(){return oe.POINT},t.prototype.intersectsExtent=function(e){return _t(e,this.flatCoordinates[0],this.flatCoordinates[1])},t.prototype.setCoordinates=function(o,t){this.setLayout(t,o,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=yr(this.flatCoordinates,0,o,this.stride),this.changed()},t}(Tr),Kr=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ln=function(o){function i(t,e,r){var n=o.call(this)||this;return n.ends_=[],n.flatInteriorPointRevision_=-1,n.flatInteriorPoint_=null,n.maxDelta_=-1,n.maxDeltaRevision_=-1,n.orientedRevision_=-1,n.orientedFlatCoordinates_=null,void 0!==e&&r?(n.setFlatCoordinates(e,t),n.ends_=r):n.setCoordinates(t,e),n}return Kr(i,o),i.prototype.appendLinearRing=function(e){this.flatCoordinates?v(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},i.prototype.clone=function(){return new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},i.prototype.closestPointXY=function(o,t,e,r){return r<st(this.getExtent(),o,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=ee(gr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,o,t,e,r))},i.prototype.containsXY=function(o,t){return Mr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,o,t)},i.prototype.getArea=function(){return lr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},i.prototype.getCoordinates=function(o){var t;return void 0===o?t=this.flatCoordinates:Br(t=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,o),xr(t,0,this.ends_,this.stride)},i.prototype.getEnds=function(){return this.ends_},i.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var e=vt(this.getExtent());this.flatInteriorPoint_=Nr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},i.prototype.getInteriorPoint=function(){return new Zr(this.getFlatInteriorPoint(),ne)},i.prototype.getLinearRingCount=function(){return this.ends_.length},i.prototype.getLinearRing=function(e){return 0>e||this.ends_.length<=e?null:new Xr(this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]),this.layout)},i.prototype.getLinearRings=function(){for(var l=this.layout,t=this.flatCoordinates,e=this.ends_,r=[],n=0,p=0,d=e.length;p<d;++p){var a=e[p],s=new Xr(t.slice(n,a),l);r.push(s),n=a}return r},i.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;jr(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Br(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},i.prototype.getSimplifiedGeometryInternal=function(e){var t=[],o=[];return t.length=vr(this.flatCoordinates,0,this.ends_,this.stride,ee(e),t,0,o),new i(t,lt,o)},i.prototype.getType=function(){return oe.POLYGON},i.prototype.intersectsExtent=function(e){return kr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)},i.prototype.setCoordinates=function(o,t){this.setLayout(t,o,2),this.flatCoordinates||(this.flatCoordinates=[]);var e=hr(this.flatCoordinates,0,o,this.stride,this.ends_);this.flatCoordinates.length=0===e.length?0:e[e.length-1],this.changed()},i}(Tr),hn=ln,cn=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),gn="accuracy",yn="accuracyGeometry",vn="altitude",mn="altitudeAccuracy",xn="heading",wn="position",Sn="projection",En="speed",Tn="tracking",Cn="trackingOptions",bn=function(o){function t(t){var e=o.call(this,"error")||this;return e.code=t.code,e.message=t.message,e}return cn(t,o),t}(fh),Pn=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.position_=null,e.transform_=ze,e.watchId_=void 0,e.addEventListener(L(Sn),e.handleProjectionChanged_),e.addEventListener(L(Tn),e.handleTrackingChanged_),void 0!==r.projection&&e.setProjection(r.projection),void 0!==r.trackingOptions&&e.setTrackingOptions(r.trackingOptions),e.setTracking(void 0!==r.tracking&&r.tracking),e}return cn(t,o),t.prototype.disposeInternal=function(){this.setTracking(!1),o.prototype.disposeInternal.call(this)},t.prototype.handleProjectionChanged_=function(){var e=this.getProjection();e&&(this.transform_=Je(Ve("EPSG:4326"),e),this.position_&&this.set(wn,this.transform_(this.position_)))},t.prototype.handleTrackingChanged_=function(){if("geolocation"in navigator){var e=this.getTracking();e&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):e||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},t.prototype.positionChange_=function(o){var t=o.coords;this.set(gn,t.accuracy),this.set(vn,null===t.altitude?void 0:t.altitude),this.set(mn,null===t.altitudeAccuracy?void 0:t.altitudeAccuracy),this.set(xn,null===t.heading?void 0:de(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];var e=this.transform_(this.position_);this.set(wn,e),this.set(En,null===t.speed?void 0:t.speed);var r=Vr(this.position_,t.accuracy);r.applyTransform(this.transform_),this.set(yn,r),this.changed()},t.prototype.positionError_=function(e){this.setTracking(!1),this.dispatchEvent(new bn(e))},t.prototype.getAccuracy=function(){return this.get(gn)},t.prototype.getAccuracyGeometry=function(){return this.get(yn)||null},t.prototype.getAltitude=function(){return this.get(vn)},t.prototype.getAltitudeAccuracy=function(){return this.get(mn)},t.prototype.getHeading=function(){return this.get(xn)},t.prototype.getPosition=function(){return this.get(wn)},t.prototype.getProjection=function(){return this.get(Sn)},t.prototype.getSpeed=function(){return this.get(En)},t.prototype.getTracking=function(){return this.get(Tn)},t.prototype.getTrackingOptions=function(){return this.get(Cn)},t.prototype.setProjection=function(e){this.set(Sn,Ve(e))},t.prototype.setTracking=function(e){this.set(Tn,e)},t.prototype.setTrackingOptions=function(e){this.set(Cn,e)},t}(tt),Rn=function(){function e(o,t,e){this.decay_=o,this.minVelocity_=t,this.delay_=e,this.points_=[],this.angle_=0,this.initialVelocity_=0}return e.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},e.prototype.update=function(o,t){this.points_.push(o,t,Date.now())},e.prototype.end=function(){if(6>this.points_.length)return!1;var a=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<a)return!1;for(var e=t-3;0<e&&this.points_[e+2]>a;)e-=3;var s=this.points_[t+2]-this.points_[e+2];if(s<1e3/60)return!1;var n=this.points_[t]-this.points_[e],i=this.points_[t+1]-this.points_[e+1];return this.angle_=sh(i,n),this.initialVelocity_=ee(n*n+i*i)/s,this.initialVelocity_>this.minVelocity_},e.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},e.prototype.getAngle=function(){return this.angle_},e}(),On=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),In=function(o){function t(t,e,r){var n=o.call(this,t)||this;return n.map=e,n.frameState=void 0===r?null:r,n}return On(t,o),t}(fh),Ln=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fn=function(s){function t(t,e,r,n,i){var o=s.call(this,t,e,i)||this;return o.originalEvent=r,o.pixel_=null,o.coordinate_=null,o.dragging=void 0!==n&&n,o}return Ln(t,s),Object.defineProperty(t.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(e){this.pixel_=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(e){this.coordinate_=e},enumerable:!0,configurable:!0}),t.prototype.preventDefault=function(){s.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},t.prototype.stopPropagation=function(){s.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},t}(In),Mn=(e(1),"undefined"==typeof navigator?"":navigator.userAgent.toLowerCase()),An=-1!==Mn.indexOf("firefox"),Nn=(-1!==Mn.indexOf("safari")&&Mn.indexOf("chrom"),-1!==Mn.indexOf("webkit")&&-1==Mn.indexOf("edge")),Gn=-1!==Mn.indexOf("macintosh"),jn="undefined"==typeof devicePixelRatio?1:devicePixelRatio,Dn="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,kn="undefined"!=typeof Image&&Image.prototype.decode,Un=function(){var o=!1;try{var r=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("_",null,r),window.removeEventListener("_",null,r)}catch(e){}return o}(),zn={SINGLECLICK:"singleclick",CLICK:j,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Bn=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yn=function(s){function t(t,e,r,n,i){var o=s.call(this,t,e,r,n,i)||this;return o.pointerEvent=r,o}return Bn(t,s),t}(Fn),Vn="pointermove",Xn="pointerdown",Wn="pointerup",Zn=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qn=function(o){function t(t,e){var r=o.call(this,t)||this;r.map_=t,r.clickTimeoutId_,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=e?e*jn:jn,r.down_=null;var n=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=n,r.pointerdownListenerKey_=_(n,Xn,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=_(n,Vn,r.relayEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(W,r.boundHandleTouchMove_,!!Un&&{passive:!1}),r}return Zn(t,o),t.prototype.emulateClick_=function(o){var t=new Yn(zn.CLICK,this.map_,o);this.dispatchEvent(t),void 0===this.clickTimeoutId_?this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var t=new Yn(zn.SINGLECLICK,this.map_,o);this.dispatchEvent(t)}.bind(this),250):(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Yn(zn.DBLCLICK,this.map_,o),this.dispatchEvent(t))},t.prototype.updateActivePointers_=function(o){var t=o;t.type==zn.POINTERUP||t.type==zn.POINTERCANCEL?delete this.trackedTouches_[t.pointerId]:t.type==zn.POINTERDOWN&&(this.trackedTouches_[t.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},t.prototype.handlePointerUp_=function(o){this.updateActivePointers_(o);var t=new Yn(zn.POINTERUP,this.map_,o);this.dispatchEvent(t),t.propagationStopped||this.dragging_||!this.isMouseActionButton_(o)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(y),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},t.prototype.isMouseActionButton_=function(e){return 0===e.button},t.prototype.handlePointerDown_=function(o){this.updateActivePointers_(o);var t=new Yn(zn.POINTERDOWN,this.map_,o);this.dispatchEvent(t),this.down_=o,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(_(document,zn.POINTERMOVE,this.handlePointerMove_,this),_(document,zn.POINTERUP,this.handlePointerUp_,this),_(this.element_,zn.POINTERCANCEL,this.handlePointerUp_,this))},t.prototype.handlePointerMove_=function(o){if(this.isMoving_(o)){this.dragging_=!0;var t=new Yn(zn.POINTERDRAG,this.map_,o,this.dragging_);this.dispatchEvent(t)}},t.prototype.relayEvent_=function(o){this.originalPointerMoveEvent_=o;var t=this.down_&&this.isMoving_(o);this.dispatchEvent(new Yn(o.type,this.map_,o,t))},t.prototype.handleTouchMove_=function(e){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||e.preventDefault()},t.prototype.isMoving_=function(e){return this.dragging_||P(e.clientX-this.down_.clientX)>this.moveTolerance_||P(e.clientY-this.down_.clientY)>this.moveTolerance_},t.prototype.disposeInternal=function(){this.relayedListenerKey_&&(y(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(W,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(y(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(y),this.dragListenerKeys_.length=0,this.element_=null,o.prototype.disposeInternal.call(this)},t}(Rh),Hn="postrender",Jn="layergroup",ti="size",ei="target",ri="view",ni="postrender",oi="precompose",ai="rendercomplete",ui=0,li=1,hi=2,ci=3,pi=4,fi=function(){function e(o,t){this.priorityFunction_=o,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return e.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,k(this.queuedElements_)},e.prototype.dequeue=function(){var o=this.elements_,t=this.priorities_,e=o[0];1==o.length?(o.length=0,t.length=0):(o[0]=o.pop(),t[0]=t.pop(),this.siftUp_(0));var r=this.keyFunction_(e);return delete this.queuedElements_[r],e},e.prototype.enqueue=function(o){O(!(this.keyFunction_(o)in this.queuedElements_),31);var t=this.priorityFunction_(o);return t!=1/0&&(this.elements_.push(o),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(o)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},e.prototype.getCount=function(){return this.elements_.length},e.prototype.getLeftChildIndex_=function(e){return 2*e+1},e.prototype.getRightChildIndex_=function(e){return 2*e+2},e.prototype.getParentIndex_=function(e){return e-1>>1},e.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;0<=e;e--)this.siftUp_(e)},e.prototype.isEmpty=function(){return 0===this.elements_.length},e.prototype.isKeyQueued=function(e){return e in this.queuedElements_},e.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},e.prototype.siftUp_=function(p){for(var d=this.elements_,e=this.priorities_,r=d.length,n=d[p],i=e[p],o=p;p<r>>1;){var a=this.getLeftChildIndex_(p),s=this.getRightChildIndex_(p),_=s<r&&e[s]<e[a]?s:a;d[p]=d[_],e[p]=e[_],p=_}d[p]=n,e[p]=i,this.siftDown_(o,p)},e.prototype.siftDown_=function(s,t){for(var l=this.elements_,r=this.priorities_,n=l[t],i=r[t],o;t>s&&(o=this.getParentIndex_(t),!!(r[o]>i));)l[t]=l[o],r[t]=r[o],t=o;l[t]=n,r[t]=i},e.prototype.reprioritize=function(){var l=this.priorityFunction_,n=this.elements_,i=this.priorities_,o=0,p=n.length,s,d,_;for(d=0;d<p;++d)(_=l(s=n[d]))==1/0?delete this.queuedElements_[this.keyFunction_(s)]:(i[o]=_,n[o++]=s);n.length=o,i.length=o,this.heapify_()},e}(),di=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_i=function(o){function t(i,e){var t=o.call(this,function(e){return i.apply(null,e)},function(e){return e[0].getKey()})||this;return t.boundHandleTileChange_=t.handleTileChange.bind(t),t.tileChangeCallback_=e,t.tilesLoading_=0,t.tilesLoadingKeys_={},t}return di(t,o),t.prototype.enqueue=function(t){var e=o.prototype.enqueue.call(this,t);return e&&t[0].addEventListener(A,this.boundHandleTileChange_),e},t.prototype.getTilesLoading=function(){return this.tilesLoading_},t.prototype.handleTileChange=function(o){var t=o.target,e=t.getState();if(t.hifi&&e===hi||e===ci||e===pi){t.removeEventListener(A,this.boundHandleTileChange_);var r=t.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},t.prototype.loadMoreTiles=function(o,t){for(var e=0,a,s;this.tilesLoading_<o&&e<t&&0<this.getCount();)s=(a=this.dequeue()[0]).getKey(),a.getState()!==ui||s in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++e,a.load())},t}(fi),gi=0,Ti=1,Ci="center",bi="resolution",Pi="rotation",Ri=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zi=function(o){function t(t){var e=o.call(this)||this,r=yh({},t);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=Ze(r.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.cancelAnchor_=void 0,r.center&&(r.center=Xt(r.center,e.projection_)),r.extent&&(r.extent=Zt(r.extent,e.projection_)),e.applyOptions_(r),e}return Ri(t,o),t.prototype.applyOptions_=function(o){var t=function(g){var t=void 0===g.minZoom?0:g.minZoom,y=void 0===g.maxZoom?28:g.maxZoom,x=void 0===g.zoomFactor?2:g.zoomFactor,a=void 0!==g.multiWorld&&g.multiWorld,s=void 0===g.smoothResolutionConstraint||g.smoothResolutionConstraint,u=void 0!==g.showFullExtent&&g.showFullExtent,l=Ze(g.projection,"EPSG:3857"),h=l.getExtent(),c=g.constrainOnlyCenter,S=g.extent,T,P,R;if(a||S||!l.isGlobal()||(c=!1,S=h),void 0!==g.resolutions){var L=g.resolutions;P=L[t],R=void 0===L[y]?L[L.length-1]:L[y],T=g.constrainResolution?function(d,t,e,r){return function(n,i,o,a){if(void 0!==n){var s=d[0],_=d[d.length-1],l=e?en(s,e,o,r):s;if(a)return void 0===t||t?tn(n,l,_):le(n,_,l);var g=E(l,n),u=N(w(d,g,i));return d[u]>l&&u<d.length-1?d[u+1]:d[u]}}}(L,s,!c&&S,u):on(P,R,s,!c&&S,u)}else{var d=(h?C(Gt(h),Ot(h)):360*Se[bh.DEGREES]/l.getMetersPerUnit())/256/1;void 0===(P=g.maxResolution)?P=d/M(x,t):t=0,void 0===(R=g.minResolution)&&(R=void 0===g.maxZoom?d/268435456:void 0===g.maxResolution?d/M(x,y):P/M(x,y)),y=t+N(m(P/R)/m(x)),R=P/M(x,y-t),T=g.constrainResolution?function(y,t,e,r,n,i){return function(o,a,s,u){if(void 0!==o){var l=n?en(t,n,s,i):t,h=void 0===e?0:e;if(u)return void 0===r||r?tn(o,l,h):le(o,h,l);var c=F(m(t/l)/m(y)-1e-9),p=E(l,o),d=N(m(t/p)/m(y)+(-a*(.5-1e-9)+.5)),_=C(c,d);return le(t/M(y,_),h,l)}}}(x,P,R,s,!c&&S,u):on(P,R,s,!c&&S,u)}return{constraint:T,maxResolution:P,minResolution:R,minZoom:t,zoomFactor:x}}(o);this.maxResolution_=t.maxResolution,this.minResolution_=t.minResolution,this.zoomFactor_=t.zoomFactor,this.resolutions_=o.resolutions,this.minZoom_=t.minZoom;var e=function(o){if(void 0!==o.extent){var t=void 0===o.smoothExtentConstraint||o.smoothExtentConstraint;return Qr(o.extent,o.constrainOnlyCenter,t)}var e=Ze(o.projection,"EPSG:3857");if(!0!==o.multiWorld&&e.isGlobal()){var r=e.getExtent().slice();return r[0]=-1/0,r[2]=1/0,Qr(r,!1,!1)}return $r}(o),r=t.constraint,n=function(a){if(void 0===a.enableRotation||a.enableRotation){var t=a.constrainRotation;return void 0===t||!0===t?(i=l||de(5),function(o,t){return t?o:void 0===o?void 0:P(o)<=i?0:o}):!1===t?nn:"number"==typeof t?(e=t,s=2*dh/e,function(o,r){return r?o:void 0===o?void 0:o=N(o/s+.5)*s}):nn}return rn;var e,s,l,i}(o);this.constraints_={center:e,resolution:r,rotation:n},this.setRotation(void 0===o.rotation?0:o.rotation),this.setCenterInternal(void 0===o.center?null:o.center),void 0===o.resolution?void 0!==o.zoom&&this.setZoom(o.zoom):this.setResolution(o.resolution),this.setProperties({}),this.options_=o},t.prototype.getUpdatedOptions_=function(o){var t=yh({},this.options_);return void 0===t.resolution?t.zoom=this.getZoom():t.resolution=this.getResolution(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),yh({},t,o)},t.prototype.animate=function(){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var t=Array(arguments.length),e=0,o;e<t.length;++e)o=arguments[e],o.center&&((o=yh({},o)).center=Xt(o.center,this.getProjection())),o.anchor&&((o=yh({},o)).anchor=Xt(o.anchor,this.getProjection())),t[e]=o;this.animateInternal.apply(this,t)},t.prototype.animateInternal=function(){var t=arguments.length,d;if(1<t&&"function"==typeof arguments[t-1]&&(d=arguments[t-1],--t),!this.isDef()){var _=arguments[t-1];return _.center&&this.setCenterInternal(_.center),void 0!==_.zoom&&this.setZoom(_.zoom),void 0!==_.rotation&&this.setRotation(_.rotation),void(d&&Ii(d,!0))}for(var n=Date.now(),g=this.targetCenter_.slice(),y=this.targetResolution_,m=this.targetRotation_,f=[],u=0;u<t;++u){var x=arguments[u],h={start:n,complete:!1,anchor:x.anchor,duration:void 0===x.duration?1e3:x.duration,easing:x.easing||wi,callback:d};if(x.center&&(h.sourceCenter=g,h.targetCenter=x.center.slice(),g=h.targetCenter),void 0===x.zoom?x.resolution&&(h.sourceResolution=y,h.targetResolution=x.resolution,y=h.targetResolution):(h.sourceResolution=y,h.targetResolution=this.getResolutionForZoom(x.zoom),y=h.targetResolution),void 0!==x.rotation){h.sourceRotation=m;var c=_e(x.rotation-m+dh,2*dh)-dh;h.targetRotation=m+c,m=h.targetRotation}vi(h)?h.complete=!0:n+=h.duration,f.push(h)}this.animations_.push(f),this.setHint(gi,1),this.updateAnimations_()},t.prototype.getAnimating=function(){return 0<this.hints_[gi]},t.prototype.getInteracting=function(){return 0<this.hints_[Ti]},t.prototype.cancelAnimations=function(){var s;this.setHint(gi,-this.hints_[gi]);for(var l=0,p=this.animations_.length,r;l<p;++l)if(r=this.animations_[l],r[0].callback&&Ii(r[0].callback,!1),!s)for(var d=0,_=r.length,o;d<_;++d)if(o=r[d],!o.complete){s=o.anchor;break}this.animations_.length=0,this.cancelAnchor_=s},t.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var S=Date.now(),t=!1,E=this.animations_.length-1;0<=E;--E){for(var T=this.animations_[E],n=!0,C=0,P=T.length,a;C<P;++C)if(a=T[C],!a.complete){var R=S-a.start,u=0<a.duration?R/a.duration:1;1<=u?(a.complete=!0,u=1):n=!1;var w=a.easing(u);if(a.sourceCenter){var h=a.sourceCenter[0],c=a.sourceCenter[1],p=h+w*(a.targetCenter[0]-h),f=c+w*(a.targetCenter[1]-c);this.targetCenter_=[p,f]}if(a.sourceResolution&&a.targetResolution){var d=1===w?a.targetResolution:a.sourceResolution+w*(a.targetResolution-a.sourceResolution);if(a.anchor){var _=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,_,!0);this.targetCenter_=this.calculateCenterZoom(g,a.anchor)}this.targetResolution_=d,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var y=1===w?_e(a.targetRotation+dh,2*dh)-dh:a.sourceRotation+w*(a.targetRotation-a.sourceRotation);if(a.anchor){var L=this.constraints_.rotation(y,!0);this.targetCenter_=this.calculateCenterRotate(L,a.anchor)}this.targetRotation_=y}if(this.applyTargetState_(!0),t=!0,!a.complete)break}if(n){this.animations_[E]=null,this.setHint(gi,-1);var m=T[0].callback;m&&Ii(m,!0)}}this.animations_=this.animations_.filter(Boolean),t&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},t.prototype.calculateCenterRotate=function(o,t){var e=this.getCenterInternal(),n;return void 0!==e&&(Qn(n=[e[0]-t[0],e[1]-t[1]],o-this.getRotation()),pn(n,t)),n},t.prototype.calculateCenterZoom=function(o,t){var e=this.getCenterInternal(),n=this.getResolution(),i;return void 0!==e&&void 0!==n&&(i=[t[0]-o*(t[0]-e[0])/n,t[1]-o*(t[1]-e[1])/n]),i},t.prototype.getViewportSize_=function(o){var t=this.viewportSize_;if(o){var e=t[0],r=t[1];return[P(e*gh(o))+P(r*_h(o)),P(e*_h(o))+P(r*gh(o))]}return t},t.prototype.setViewportSize=function(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.resolveConstraints(0)},t.prototype.getCenter=function(){var e=this.getCenterInternal();return e?Vt(e,this.getProjection()):e},t.prototype.getCenterInternal=function(){return this.get(Ci)},t.prototype.getConstraints=function(){return this.constraints_},t.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},t.prototype.getHints=function(e){return void 0===e?this.hints_.slice():(e[0]=this.hints_[0],e[1]=this.hints_[1],e)},t.prototype.calculateExtent=function(e){return Wt(this.calculateExtentInternal(e),this.getProjection())},t.prototype.calculateExtentInternal=function(o){var t=o||this.getViewportSize_(),e=this.getCenterInternal();O(e,1);var r=this.getResolution();O(void 0!==r,2);var n=this.getRotation();return O(void 0!==n,3),Ft(e,r,n,t)},t.prototype.getMaxResolution=function(){return this.maxResolution_},t.prototype.getMinResolution=function(){return this.minResolution_},t.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},t.prototype.setMaxZoom=function(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))},t.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},t.prototype.setMinZoom=function(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))},t.prototype.setConstrainResolution=function(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))},t.prototype.getProjection=function(){return this.projection_},t.prototype.getResolution=function(){return this.get(bi)},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getResolutionForExtent=function(o,t){return this.getResolutionForExtentInternal(Zt(o,this.getProjection()),t)},t.prototype.getResolutionForExtentInternal=function(o,t){var e=t||this.getViewportSize_(),r=Gt(o)/e[0],n=Ot(o)/e[1];return C(r,n)},t.prototype.getResolutionForValueFunction=function(o){var a=o||2,e=this.getConstrainedResolution(this.maxResolution_),t=this.minResolution_,r=m(e/t)/m(a);return function(o){return e/M(a,o*r)}},t.prototype.getRotation=function(){return this.get(Pi)},t.prototype.getValueForResolutionFunction=function(o){var a=m(o||2),e=this.getConstrainedResolution(this.maxResolution_),t=this.minResolution_,r=m(e/t)/a;return function(o){return m(e/o)/a/r}},t.prototype.getState=function(){var o=this.getCenterInternal(),t=this.getProjection(),e=this.getResolution(),r=this.getRotation();return{center:o.slice(0),projection:void 0===t?null:t,resolution:e,rotation:r,zoom:this.getZoom()}},t.prototype.getZoom=function(){var o=this.getResolution(),e;return void 0!==o&&(e=this.getZoomForResolution(o)),e},t.prototype.getZoomForResolution=function(o){var t=this.minZoom_||0,a,s;if(this.resolutions_){var l=w(this.resolutions_,o,1);t=l,a=this.resolutions_[l],s=l==this.resolutions_.length-1?2:a/this.resolutions_[l+1]}else a=this.maxResolution_,s=this.zoomFactor_;return t+m(a/o)/m(s)},t.prototype.getResolutionForZoom=function(o){if(this.resolutions_){if(1>=this.resolutions_.length)return 0;var t=le(N(o),0,this.resolutions_.length-2),e=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/M(e,le(o-t,0,1))}return this.maxResolution_/M(this.zoomFactor_,o-this.minZoom_)},t.prototype.fit=function(a,t){var e=yh({size:this.getViewportSize_()},t||{}),n;if(O(Array.isArray(a)||"function"==typeof a.getSimplifiedGeometry,24),Array.isArray(a))O(!kt(a),25),n=Hr(s=Zt(a,this.getProjection()));else if(a.getType()===oe.CIRCLE){var s;(n=Hr(s=Zt(a.getExtent(),this.getProjection()))).rotate(this.getRotation(),vt(s))}else{var l=Yt();n=l?a.clone().transform(l,this.getProjection()):a}this.fitInternal(n,e)},t.prototype.fitInternal=function(P,t){var e=t||{},r=e.size;r||(r=this.getViewportSize_());var R=void 0===e.padding?[0,0,0,0]:e.padding,o=void 0!==e.nearest&&e.nearest,a;a=void 0===e.minResolution?void 0===e.maxZoom?0:this.getResolutionForZoom(e.maxZoom):e.minResolution;for(var L=P.getFlatCoordinates(),s=this.getRotation(),u=gh(-s),l=_h(-s),I=1/0,F=1/0,O=-1/0,M=-1/0,N=P.getStride(),_=0,A=L.length;_<A;_+=N){var y=L[_]*u-L[_+1]*l,v=L[_]*l+L[_+1]*u;I=E(I,y),F=E(F,v),O=C(O,y),M=C(M,v)}var m=this.getResolutionForExtentInternal([I,F,O,M],[r[0]-R[1]-R[3],r[1]-R[0]-R[2]]);m=isNaN(m)?a:C(m,a),m=this.getConstrainedResolution(m,o?0:1),l=-l;var G=(I+O)/2,D=(F+M)/2,k=[(G+=(R[1]-R[3])/2*m)*u-(D+=(R[0]-R[2])/2*m)*l,D*u+G*l],U=e.callback?e.callback:b;void 0===e.duration?(this.targetResolution_=m,this.targetCenter_=k,this.applyTargetState_(!1,!0),Ii(U,!0)):this.animateInternal({resolution:m,center:this.getConstrainedCenter(k,m),duration:e.duration,easing:e.easing},U)},t.prototype.centerOn=function(o,t,e){this.centerOnInternal(Xt(o,this.getProjection()),t,e)},t.prototype.centerOnInternal=function(p,t,e){var r=this.getRotation(),n=gh(-r),i=_h(-r),d=p[0]*n-p[1]*i,_=p[1]*n+p[0]*i,g=this.getResolution(),u=(d+=(t[0]/2-e[0])*g)*n-(_+=(e[1]-t[1]/2)*g)*(i=-i),l=_*n+d*i;this.setCenterInternal([u,l])},t.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},t.prototype.adjustCenter=function(o){var t=Vt(this.targetCenter_,this.getProjection());this.setCenter([t[0]+o[0],t[1]+o[1]])},t.prototype.adjustCenterInternal=function(o){var t=this.targetCenter_;this.setCenterInternal([t[0]+o[0],t[1]+o[1]])},t.prototype.adjustResolution=function(o,t){var e=t&&Xt(t,this.getProjection());this.adjustResolutionInternal(o,e)},t.prototype.adjustResolutionInternal=function(o,t){var e=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(this.targetResolution_*o,0,r,e);t&&(this.targetCenter_=this.calculateCenterZoom(n,t)),this.targetResolution_*=o,this.applyTargetState_()},t.prototype.adjustZoom=function(o,t){this.adjustResolution(M(this.zoomFactor_,-o),t)},t.prototype.adjustRotation=function(o,t){t&&(t=Xt(t,this.getProjection())),this.adjustRotationInternal(o,t)},t.prototype.adjustRotationInternal=function(o,t){var e=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+o,e);t&&(this.targetCenter_=this.calculateCenterRotate(r,t)),this.targetRotation_+=o,this.applyTargetState_()},t.prototype.setCenter=function(e){this.setCenterInternal(Xt(e,this.getProjection()))},t.prototype.setCenterInternal=function(e){this.targetCenter_=e,this.applyTargetState_()},t.prototype.setHint=function(o,t){return this.hints_[o]+=t,this.changed(),this.hints_[o]},t.prototype.setResolution=function(e){this.targetResolution_=e,this.applyTargetState_()},t.prototype.setRotation=function(e){this.targetRotation_=e,this.applyTargetState_()},t.prototype.setZoom=function(e){this.setResolution(this.getResolutionForZoom(e))},t.prototype.applyTargetState_=function(s,t){var e=this.getAnimating()||this.getInteracting()||t,r=this.constraints_.rotation(this.targetRotation_,e),n=this.getViewportSize_(r),i=this.constraints_.resolution(this.targetResolution_,0,n,e),o=this.constraints_.center(this.targetCenter_,i,n,e);this.get(Pi)!==r&&this.set(Pi,r),this.get(bi)!==i&&this.set(bi,i),this.get(Ci)&&fn(this.get(Ci),o)||this.set(Ci,o),this.getAnimating()&&!s&&this.cancelAnimations(),this.cancelAnchor_=void 0},t.prototype.resolveConstraints=function(i,t,e){var r=void 0===i?200:i,n=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(n),a=this.constraints_.resolution(this.targetResolution_,t||0,o),s=this.constraints_.center(this.targetCenter_,a,o);if(0===r&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=n,this.targetCenter_=s,void this.applyTargetState_();var p=e||(0===r?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===n&&this.getCenterInternal()&&fn(this.getCenterInternal(),s)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:n,center:s,resolution:a,duration:r,easing:Ei,anchor:p}))},t.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Ti,1)},t.prototype.endInteraction=function(o,t,e){var r=e&&Xt(e,this.getProjection());this.endInteractionInternal(o,t,r)},t.prototype.endInteractionInternal=function(o,t,e){this.setHint(Ti,-1),this.resolveConstraints(o,t,e)},t.prototype.getConstrainedCenter=function(o,t){var e=this.getViewportSize_(this.getRotation());return this.constraints_.center(o,t||this.getResolution(),e)},t.prototype.getConstrainedZoom=function(o,t){var e=this.getResolutionForZoom(o);return this.getZoomForResolution(this.getConstrainedResolution(e,t))},t.prototype.getConstrainedResolution=function(o,t){var e=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(o,t||0,e)},t}(tt),Hi="opacity",no="visible",io="extent",oo="zIndex",ao="maxResolution",so="minResolution",uo="maxZoom",lo="minZoom",ho="source",co=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),po=function(o){function t(t){var e=o.call(this)||this,r=yh({},t);return r[Hi]=void 0===t.opacity?1:t.opacity,O("number"==typeof r[Hi],64),r[no]=void 0===t.visible||t.visible,r[oo]=t.zIndex,r[ao]=void 0===t.maxResolution?1/0:t.maxResolution,r[so]=void 0===t.minResolution?0:t.minResolution,r[lo]=void 0===t.minZoom?-1/0:t.minZoom,r[uo]=void 0===t.maxZoom?1/0:t.maxZoom,e.className_=void 0===r.className?"ol-layer":t.className,delete r.className,e.setProperties(r),e.state_=null,e}return co(t,o),t.prototype.getClassName=function(){return this.className_},t.prototype.getLayerState=function(o){var t=this.state_||{layer:this,managed:void 0===o||o},e=this.getZIndex();return t.opacity=le(Zm(100*this.getOpacity())/100,0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0===e?!1===t.managed?1/0:0:e,t.maxResolution=this.getMaxResolution(),t.minResolution=C(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t},t.prototype.getLayersArray=function(){return r()},t.prototype.getLayerStatesArray=function(){return r()},t.prototype.getExtent=function(){return this.get(io)},t.prototype.getMaxResolution=function(){return this.get(ao)},t.prototype.getMinResolution=function(){return this.get(so)},t.prototype.getMinZoom=function(){return this.get(lo)},t.prototype.getMaxZoom=function(){return this.get(uo)},t.prototype.getOpacity=function(){return this.get(Hi)},t.prototype.getSourceState=function(){return r()},t.prototype.getVisible=function(){return this.get(no)},t.prototype.getZIndex=function(){return this.get(oo)},t.prototype.setExtent=function(e){this.set(io,e)},t.prototype.setMaxResolution=function(e){this.set(ao,e)},t.prototype.setMinResolution=function(e){this.set(so,e)},t.prototype.setMaxZoom=function(e){this.set(uo,e)},t.prototype.setMinZoom=function(e){this.set(lo,e)},t.prototype.setOpacity=function(e){O("number"==typeof e,64),this.set(Hi,e)},t.prototype.setVisible=function(e){this.set(no,e)},t.prototype.setZIndex=function(e){this.set(oo,e)},t.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),o.prototype.disposeInternal.call(this)},t}(tt),fo="undefined",_o="loading",go="ready",yo="error",vo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),mo="layers",xo=function(a){function t(t){var e=this,s=t||{},n=yh({},s);delete n.layers;var i=s.layers;return(e=a.call(this,n)||this).layersListenerKeys_=[],e.listenerKeys_={},e.addEventListener(L(mo),e.handleLayersChanged_),i?Array.isArray(i)?i=new ot(i.slice(),{unique:!0}):O("function"==typeof i.getArray,43):i=new ot(void 0,{unique:!0}),e.setLayers(i),e}return vo(t,a),t.prototype.handleLayerChange_=function(){this.changed()},t.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(y),this.layersListenerKeys_.length=0;var o=this.getLayers();for(var t in this.layersListenerKeys_.push(_(o,u,this.handleLayersAdd_,this),_(o,l,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(y);k(this.listenerKeys_);for(var e=o.getArray(),r=0,s=e.length,i;r<s;r++)i=e[r],this.listenerKeys_[X(i)]=[_(i,h,this.handleLayerChange_,this),_(i,A,this.handleLayerChange_,this)];this.changed()},t.prototype.handleLayersAdd_=function(o){var t=o.element;this.listenerKeys_[X(t)]=[_(t,h,this.handleLayerChange_,this),_(t,A,this.handleLayerChange_,this)],this.changed()},t.prototype.handleLayersRemove_=function(o){var t=X(o.element);this.listenerKeys_[t].forEach(y),delete this.listenerKeys_[t],this.changed()},t.prototype.getLayers=function(){return this.get(mo)},t.prototype.setLayers=function(e){this.set(mo,e)},t.prototype.getLayersArray=function(o){var r=void 0===o?[]:o;return this.getLayers().forEach(function(e){e.getLayersArray(r)}),r},t.prototype.getLayerStatesArray=function(s){var l=void 0===s?[]:s,e=l.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(l)});for(var t=this.getLayerState(),r=e,n=l.length,o;r<n;r++)o=l[r],o.opacity*=t.opacity,o.visible=o.visible&&t.visible,o.maxResolution=E(o.maxResolution,t.maxResolution),o.minResolution=C(o.minResolution,t.minResolution),o.minZoom=C(o.minZoom,t.minZoom),o.maxZoom=E(o.maxZoom,t.maxZoom),void 0!==t.extent&&(void 0===o.extent?o.extent=t.extent:o.extent=Mt(o.extent,t.extent));return l},t.prototype.getSourceState=function(){return go},t}(po),wo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Co=function(s){function t(t){var e=s.call(this)||this,r=function(s){var t=null;void 0!==s.keyboardEventTarget&&(t="string"==typeof s.keyboardEventTarget?document.getElementById(s.keyboardEventTarget):s.keyboardEventTarget);var l={},o=s.layers&&"function"==typeof s.layers.getLayers?s.layers:new xo({layers:s.layers}),a,p,d;return l[Jn]=o,l[ei]=s.target,l[ri]=void 0===s.view?new Zi:s.view,void 0!==s.controls&&(Array.isArray(s.controls)?a=new ot(s.controls.slice()):(O("function"==typeof s.controls.getArray,47),a=s.controls)),void 0!==s.interactions&&(Array.isArray(s.interactions)?p=new ot(s.interactions.slice()):(O("function"==typeof s.interactions.getArray,48),p=s.interactions)),void 0===s.overlays?d=new ot:Array.isArray(s.overlays)?d=new ot(s.overlays.slice()):(O("function"==typeof s.overlays.getArray,49),d=s.overlays),{controls:a,interactions:p,keyboardEventTarget:t,overlays:d,values:l}}(t);e.boundHandleBrowserEvent_=e.handleBrowserEvent.bind(e),e.maxTilesLoading_=void 0===t.maxTilesLoading?16:t.maxTilesLoading,e.pixelRatio_=void 0===t.pixelRatio?jn:t.pixelRatio,e.postRenderTimeoutHandle_,e.animationDelayKey_,e.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(e),e.coordinateToPixelTransform_=[1,0,0,1,0,0],e.pixelToCoordinateTransform_=[1,0,0,1,0,0],e.frameIndex_=0,e.frameState_=null,e.previousExtent_=null,e.viewPropertyListenerKey_=null,e.viewChangeListenerKey_=null,e.layerGroupPropertyListenerKeys_=null,e.viewport_=document.createElement("div"),e.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),e.viewport_.style.position="relative",e.viewport_.style.overflow="hidden",e.viewport_.style.width="100%",e.viewport_.style.height="100%",e.overlayContainer_=document.createElement("div"),e.overlayContainer_.style.position="absolute",e.overlayContainer_.style.zIndex="0",e.overlayContainer_.style.width="100%",e.overlayContainer_.style.height="100%",e.overlayContainer_.className="ol-overlaycontainer",e.viewport_.appendChild(e.overlayContainer_),e.overlayContainerStopEvent_=document.createElement("div"),e.overlayContainerStopEvent_.style.position="absolute",e.overlayContainerStopEvent_.style.zIndex="0",e.overlayContainerStopEvent_.style.width="100%",e.overlayContainerStopEvent_.style.height="100%",e.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",e.viewport_.appendChild(e.overlayContainerStopEvent_),e.mapBrowserEventHandler_=new qn(e,t.moveTolerance);var n=e.handleMapBrowserEvent.bind(e);for(var i in zn)e.mapBrowserEventHandler_.addEventListener(zn[i],n);e.keyboardEventTarget_=r.keyboardEventTarget,e.keyHandlerKeys_=null;var o=e.handleBrowserEvent.bind(e);return e.viewport_.addEventListener(vh,o,!1),e.viewport_.addEventListener(Z,o,!!Un&&{passive:!1}),e.controls=r.controls||new ot,e.interactions=r.interactions||new ot,e.overlays_=r.overlays,e.overlayIdIndex_={},e.renderer_=null,e.handleResize_,e.postRenderFunctions_=[],e.tileQueue_=new _i(e.getTilePriority.bind(e),e.handleTileChange_.bind(e)),e.addEventListener(L(Jn),e.handleLayerGroupChanged_),e.addEventListener(L(ri),e.handleViewChanged_),e.addEventListener(L(ti),e.handleSizeChanged_),e.addEventListener(L(ei),e.handleTargetChanged_),e.setProperties(r.values),e.controls.forEach(function(e){e.setMap(this)}.bind(e)),e.controls.addEventListener(u,function(e){e.element.setMap(this)}.bind(e)),e.controls.addEventListener(l,function(e){e.element.setMap(null)}.bind(e)),e.interactions.forEach(function(e){e.setMap(this)}.bind(e)),e.interactions.addEventListener(u,function(e){e.element.setMap(this)}.bind(e)),e.interactions.addEventListener(l,function(e){e.element.setMap(null)}.bind(e)),e.overlays_.forEach(e.addOverlayInternal_.bind(e)),e.overlays_.addEventListener(u,function(e){this.addOverlayInternal_(e.element)}.bind(e)),e.overlays_.addEventListener(l,function(o){var t=o.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],o.element.setMap(null)}.bind(e)),e}return wo(t,s),t.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},t.prototype.addControl=function(e){this.getControls().push(e)},t.prototype.addInteraction=function(e){this.getInteractions().push(e)},t.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},t.prototype.addOverlay=function(e){this.getOverlays().push(e)},t.prototype.addOverlayInternal_=function(o){var t=o.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=o),o.setMap(this)},t.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(vh,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Z,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(B,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),s.prototype.disposeInternal.call(this)},t.prototype.forEachFeatureAtPixel=function(s,t,e){if(this.frameState_){var l=this.getCoordinateFromPixelInternal(s),n=void 0===(e=void 0===e?{}:e).hitTolerance?0:e.hitTolerance*this.frameState_.pixelRatio,i=void 0===e.layerFilter?T:e.layerFilter,o=!1!==e.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(l,this.frameState_,n,o,t,null,i,null)}},t.prototype.getFeaturesAtPixel=function(o,t){var e=[];return this.forEachFeatureAtPixel(o,function(o){e.push(o)},t),e},t.prototype.forEachLayerAtPixel=function(a,t,e){if(this.frameState_){var r=e||{},n=void 0===r.hitTolerance?0:r.hitTolerance*this.frameState_.pixelRatio,i=r.layerFilter||T;return this.renderer_.forEachLayerAtPixel(a,this.frameState_,n,t,i)}},t.prototype.hasFeatureAtPixel=function(a,t){if(!this.frameState_)return!1;var s=this.getCoordinateFromPixelInternal(a),r=void 0===(t=void 0===t?{}:t).layerFilter?T:t.layerFilter,n=void 0===t.hitTolerance?0:t.hitTolerance*this.frameState_.pixelRatio,i=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(s,this.frameState_,n,i,r,null)},t.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},t.prototype.getEventCoordinateInternal=function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))},t.prototype.getEventPixel=function(o){var t=this.viewport_.getBoundingClientRect(),e="changedTouches"in o?o.changedTouches[0]:o;return[e.clientX-t.left,e.clientY-t.top]},t.prototype.getTarget=function(){return this.get(ei)},t.prototype.getTargetElement=function(){var e=this.getTarget();return void 0===e?null:"string"==typeof e?document.getElementById(e):e},t.prototype.getCoordinateFromPixel=function(e){return Vt(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())},t.prototype.getCoordinateFromPixelInternal=function(o){var t=this.frameState_;return t?Jt(t.pixelToCoordinateTransform,o.slice()):null},t.prototype.getControls=function(){return this.controls},t.prototype.getOverlays=function(){return this.overlays_},t.prototype.getOverlayById=function(o){var t=this.overlayIdIndex_[o.toString()];return void 0===t?null:t},t.prototype.getInteractions=function(){return this.interactions},t.prototype.getLayerGroup=function(){return this.get(Jn)},t.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},t.prototype.getLoading=function(){for(var o=this.getLayerGroup().getLayerStatesArray(),t=0,i=o.length,r;t<i;++t)if(r=o[t].layer.getSource(),r&&r.loading)return!0;return!1},t.prototype.getPixelFromCoordinate=function(o){var t=Xt(o,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)},t.prototype.getPixelFromCoordinateInternal=function(o){var t=this.frameState_;return t?Jt(t.coordinateToPixelTransform,o.slice(0,2)):null},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.getSize=function(){return this.get(ti)},t.prototype.getView=function(){return this.get(ri)},t.prototype.getViewport=function(){return this.viewport_},t.prototype.getOverlayContainer=function(){return this.overlayContainer_},t.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},t.prototype.getTilePriority=function(o,t,e,r){return function(l,t,e,r,n){if(!(l&&e in l.wantedTiles))return 1/0;if(!l.wantedTiles[e][t.getKey()])return 1/0;var i=l.viewState.center,o=r[0]-i[0],a=r[1]-i[1];return 65536*m(n)+ee(o*o+a*a)/n}(this.frameState_,o,t,e,r)},t.prototype.handleBrowserEvent=function(o,t){var e=t||o.type,r=new Fn(e,this,o);this.handleMapBrowserEvent(r)},t.prototype.handleMapBrowserEvent=function(o){if(this.frameState_){var t=o.originalEvent.target;if(o.dragging||!this.overlayContainerStopEvent_.contains(t)&&(document.body.contains(t)||this.viewport_.getRootNode&&this.viewport_.getRootNode().contains(t))){o.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(o))for(var r=e.length-1,a;0<=r&&(a=e[r],!a.getActive()||a.handleEvent(o));r--);}}},t.prototype.handlePostRender=function(){var l=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var e=this.maxTilesLoading_,p=e;if(l){var d=l.viewHints;if(d[gi]||d[Ti]){var i=!kn&&8<Date.now()-l.time;e=i?0:8,p=i?0:2}}t.getTilesLoading()<e&&(t.reprioritize(),t.loadMoreTiles(e,p))}!l||!this.hasListener(ai)||l.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(ai,l);for(var o=this.postRenderFunctions_,a=0,_=o.length;a<_;++a)o[a](this,l);o.length=0},t.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},t.prototype.handleTargetChanged_=function(){var o;if(this.getTarget()&&(o=this.getTargetElement()),this.keyHandlerKeys_){for(var i=0,a=this.keyHandlerKeys_.length;i<a;++i)y(this.keyHandlerKeys_[i]);this.keyHandlerKeys_=null}if(o){o.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var r=this.keyboardEventTarget_?this.keyboardEventTarget_:o;this.keyHandlerKeys_=[_(r,"keydown",this.handleBrowserEvent,this),_(r,"keypress",this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(B,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),to(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(B,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},t.prototype.handleTileChange_=function(){this.render()},t.prototype.handleViewPropertyChanged_=function(){this.render()},t.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(y(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(y(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=_(e,h,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=_(e,A,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()},t.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(y),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[_(e,h,this.render,this),_(e,A,this.render,this)]),this.render()},t.prototype.isRendered=function(){return!!this.frameState_},t.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},t.prototype.redrawText=function(){for(var o=this.getLayerGroup().getLayerStatesArray(),t=0,i=o.length,r;t<i;++t)r=o[t].layer,r.hasRenderer()&&r.getRenderer().handleFontsChanged()},t.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},t.prototype.removeControl=function(e){return this.getControls().remove(e)},t.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},t.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},t.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},t.prototype.renderFrame_=function(s){var t=this.getSize(),e=this.getView(),r=this.frameState_,n=null;if(void 0!==t&&function(e){return 0<e[0]&&0<e[1]}(t)&&e&&e.isDef()){var l=e.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=e.getState();n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:r?r.declutterItems:[],extent:Ft(o.center,o.resolution,o.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:s,usedTiles:{},viewState:o,viewHints:l,wantedTiles:{}}}(this.frameState_=n,this.renderer_.renderFrame(n),n)&&((n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),r)&&(!this.previousExtent_||!kt(this.previousExtent_)&&!xt(n.extent,this.previousExtent_))&&(this.dispatchEvent(new In("movestart",this,r)),this.previousExtent_=mt(this.previousExtent_)),this.previousExtent_&&!n.viewHints[gi]&&!n.viewHints[Ti]&&!xt(n.extent,this.previousExtent_)&&(this.dispatchEvent(new In("moveend",this,n)),et(n.extent,this.previousExtent_))),this.dispatchEvent(new In(Hn,this,n)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},t.prototype.setLayerGroup=function(e){this.set(Jn,e)},t.prototype.setSize=function(e){this.set(ti,e)},t.prototype.setTarget=function(e){this.set(ei,e)},t.prototype.setView=function(e){this.set(ri,e)},t.prototype.updateSize=function(){var o=this.getTargetElement();if(o){var t=getComputedStyle(o);this.setSize([o.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),o.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()},t.prototype.updateViewportSize_=function(){var o=this.getView();if(o){var t=getComputedStyle(this.viewport_),r;t.width&&t.height&&(r=[parseInt(t.width,10),parseInt(t.height,10)]),o.setViewportSize(r)}},t}(tt),bo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Po=function(o){function t(t){var e=o.call(this)||this;return e.element=t.element?t.element:null,e.target_=null,e.map_=null,e.listenerKeys=[],e.render_=t.render?t.render:b,t.target&&e.setTarget(t.target),e}return bo(t,o),t.prototype.disposeInternal=function(){to(this.element),o.prototype.disposeInternal.call(this)},t.prototype.getMap=function(){return this.map_},t.prototype.setMap=function(o){this.map_&&to(this.element);for(var t=0,n=this.listenerKeys.length;t<n;++t)y(this.listenerKeys[t]);(this.listenerKeys.length=0,this.map_=o,this.map_)&&((this.target_?this.target_:o.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==b&&this.listenerKeys.push(_(o,Hn,this.render,this)),o.render())},t.prototype.render=function(e){this.render_.call(this,e)},t.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},t}(tt),Ro=new RegExp("^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$","i"),Oo=["style","variant","weight","size","lineHeight","family"],Io=function(a){var t=a.match(Ro);if(!t)return null;for(var e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},r=0,s=Oo.length,i;r<s;++r)i=t[r+1],void 0!==i&&(e[Oo[r]]=i);return e.families=e.family.split(/,\s?/),e},Lo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fo=function(o){function t(t){var e=this,a=yh({},t);delete a.source,(e=o.call(this,a)||this).mapPrecomposeKey_=null,e.mapRenderKey_=null,e.sourceChangeKey_=null,e.renderer_=null,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addEventListener(L(ho),e.handleSourcePropertyChange_);var n=t.source?t.source:null;return e.setSource(n),e}return Lo(t,o),t.prototype.getLayersArray=function(o){var t=o||[];return t.push(this),t},t.prototype.getLayerStatesArray=function(o){var t=o||[];return t.push(this.getLayerState()),t},t.prototype.getSource=function(){return this.get(ho)||null},t.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():fo},t.prototype.handleSourceChange_=function(){this.changed()},t.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(y(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=_(e,A,this.handleSourceChange_,this)),this.changed()},t.prototype.getFeatures=function(e){return this.renderer_.getFeatures(e)},t.prototype.render=function(o,t){var e=this.getRenderer();if(e.prepareFrame(o))return e.renderFrame(o,t)},t.prototype.setMap=function(e){this.mapPrecomposeKey_&&(y(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(y(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=_(e,oi,function(o){var t=o.frameState.layerStatesArray,e=this.getLayerState(!1);O(!t.some(function(o){return o.layer===e.layer}),67),t.push(e)},this),this.mapRenderKey_=_(this,A,e.render,e),this.changed())},t.prototype.setSource=function(e){this.set(ho,e)},t.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},t.prototype.hasRenderer=function(){return!!this.renderer_},t.prototype.createRenderer=function(){return null},t.prototype.disposeInternal=function(){this.setSource(null),o.prototype.disposeInternal.call(this)},t}(po),Ao=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),No=function(p){function t(t){var e=this,d=t||{};(e=p.call(this,{element:document.createElement("div"),render:d.render||Mo,target:d.target})||this).ulElement_=document.createElement("ul"),e.collapsed_=void 0===d.collapsed||d.collapsed,e.overrideCollapsible_=void 0!==d.collapsible,e.collapsible_=void 0===d.collapsible||d.collapsible,e.collapsible_||(e.collapsed_=!1);var n=void 0===d.className?"ol-attribution":d.className,i=void 0===d.tipLabel?"Attributions":d.tipLabel,o=void 0===d.collapseLabel?"\xBB":d.collapseLabel;"string"==typeof o?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=o):e.collapseLabel_=o;var a=void 0===d.label?"i":d.label;"string"==typeof a?(e.label_=document.createElement("span"),e.label_.textContent=a):e.label_=a;var s=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_,_=document.createElement("button");_.setAttribute("type","button"),_.title=i,_.appendChild(s),_.addEventListener(j,e.handleClick_.bind(e),!1);var l=n+" ol-unselectable ol-control"+(e.collapsed_&&e.collapsible_?" ol-collapsed":"")+(e.collapsible_?"":" ol-uncollapsible"),g=e.element;return g.className=l,g.appendChild(e.ulElement_),g.appendChild(_),e.renderedAttributions_=[],e.renderedVisible_=!0,e}return Ao(t,p),t.prototype.collectSourceAttributions_=function(p){for(var t={},e=[],r=p.layerStatesArray,n=0,d=r.length,o;n<d;++n)if(o=r[n],To(o,p.viewState)){var _=o.layer.getSource();if(_){var s=_.getAttributions();if(s){var g=s(p);if(g)if(this.overrideCollapsible_||!1!==_.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(g))for(var l=0,u=g.length;l<u;++l)g[l]in t||(e.push(g[l]),t[g[l]]=!0);else g in t||(e.push(g),t[g]=!0)}}}return e},t.prototype.updateElement_=function(a){if(a){var t=this.collectSourceAttributions_(a),e=0<t.length;if(this.renderedVisible_!=e&&(this.element.style.display=e?"":"none",this.renderedVisible_=e),!Kn(t,this.renderedAttributions_)){eo(this.ulElement_);for(var r=0,s=t.length,i;r<s;++r)i=document.createElement("li"),i.innerHTML=t[r],this.ulElement_.appendChild(i);this.renderedAttributions_=t}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Ni(this.collapseLabel_,this.label_):Ni(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t}(Po),jo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Do=function(p){function t(t){var e=this,d=t||{};e=p.call(this,{element:document.createElement("div"),render:d.render||Go,target:d.target})||this;var n=void 0===d.className?"ol-rotate":d.className,i=void 0===d.label?"\u21E7":d.label;e.label_=null,"string"==typeof i?(e.label_=document.createElement("span"),e.label_.className="ol-compass",e.label_.textContent=i):(e.label_=i,e.label_.classList.add("ol-compass"));var o=d.tipLabel?d.tipLabel:"Reset rotation",a=document.createElement("button");a.className=n+"-reset",a.setAttribute("type","button"),a.title=o,a.appendChild(e.label_),a.addEventListener(j,e.handleClick_.bind(e),!1);var s=e.element;return s.className=n+" ol-unselectable ol-control",s.appendChild(a),e.callResetNorth_=d.resetNorth?d.resetNorth:void 0,e.duration_=void 0===d.duration?250:d.duration,e.autoHide_=void 0===d.autoHide||d.autoHide,e.rotation_=void 0,e.autoHide_&&e.element.classList.add("ol-hidden"),e}return jo(t,p),t.prototype.handleClick_=function(e){e.preventDefault(),void 0===this.callResetNorth_?this.resetNorth_():this.callResetNorth_()},t.prototype.resetNorth_=function(){var o=this.getMap().getView();if(o){var t=o.getRotation();void 0!==t&&(0<this.duration_&&0!=t%(2*dh)?o.animate({rotation:0,duration:this.duration_,easing:Ei}):o.setRotation(0))}},t}(Po),Uo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),zo=function(p){function t(t){var e=this,d=t||{};e=p.call(this,{element:document.createElement("div"),target:d.target})||this;var n=void 0===d.className?"ol-zoom":d.className,i=void 0===d.delta?1:d.delta,o=void 0===d.zoomInLabel?"+":d.zoomInLabel,a=void 0===d.zoomOutLabel?"\u2212":d.zoomOutLabel,s=void 0===d.zoomInTipLabel?"Zoom in":d.zoomInTipLabel,_=void 0===d.zoomOutTipLabel?"Zoom out":d.zoomOutTipLabel,l=document.createElement("button");l.className=n+"-in",l.setAttribute("type","button"),l.title=s,l.appendChild("string"==typeof o?document.createTextNode(o):o),l.addEventListener(j,e.handleClick_.bind(e,i),!1);var g=document.createElement("button");g.className=n+"-out",g.setAttribute("type","button"),g.title=_,g.appendChild("string"==typeof a?document.createTextNode(a):a),g.addEventListener(j,e.handleClick_.bind(e,-i),!1);var u=e.element;return u.className=n+" ol-unselectable ol-control",u.appendChild(l),u.appendChild(g),e.duration_=void 0===d.duration?250:d.duration,e}return Uo(t,p),t.prototype.handleClick_=function(o,t){t.preventDefault(),this.zoomByDelta_(o)},t.prototype.zoomByDelta_=function(o){var t=this.getMap().getView();if(t){var e=t.getZoom();if(void 0!==e){var r=t.getConstrainedZoom(e+o);0<this.duration_?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:r,duration:this.duration_,easing:Ei})):t.setZoom(r)}}},t}(Po),Bo="active",Vo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xo=function(o){function t(t){var e=o.call(this)||this;return t.handleEvent&&(e.handleEvent=t.handleEvent),e.map_=null,e.setActive(!0),e}return Vo(t,o),t.prototype.getActive=function(){return this.get(Bo)},t.prototype.getMap=function(){return this.map_},t.prototype.handleEvent=function(){return!0},t.prototype.setActive=function(e){this.set(Bo,e)},t.prototype.setMap=function(e){this.map_=e},t}(tt),Zo=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ko=function(o){function t(t){var e=o.call(this,{handleEvent:Wo})||this,r=t||{};return e.delta_=r.delta?r.delta:1,e.duration_=void 0===r.duration?250:r.duration,e}return Zo(t,o),t}(Xo),Ho=function(o){var t=o.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},Jo=function(o){var t=o.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Qo=function(e){return e.target.getTargetElement()===document.activeElement},$o=T,ta=function(o){var t=o.originalEvent;return 0==t.button&&!(Nn&&Gn&&t.ctrlKey)},ea=R,ra=function(e){return e.type==zn.SINGLECLICK},na=function(o){var t=o.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},ia=function(o){var t=o.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},oa=function(o){var t=o.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t},aa=function(o){var t=o.pointerEvent;return O(void 0!==t,56),"mouse"==t.pointerType},sa=function(o){var t=o.pointerEvent;return O(void 0!==t,56),t.isPrimary&&0===t.button},ua=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),la=function(o){function t(t){var e=this,i=t||{};return e=o.call(this,i)||this,i.handleDownEvent&&(e.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(e.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(e.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(e.handleUpEvent=i.handleUpEvent),i.stopDown&&(e.stopDown=i.stopDown),e.handlingDownUpSequence=!1,e.trackedPointers_={},e.targetPointers=[],e}return ua(t,o),t.prototype.getPointerCount=function(){return this.targetPointers.length},t.prototype.handleDownEvent=function(){return!1},t.prototype.handleDragEvent=function(){},t.prototype.handleEvent=function(o){if(!o.pointerEvent)return!0;var t=!1;if(this.updateTrackedPointers_(o),this.handlingDownUpSequence){if(o.type==zn.POINTERDRAG)this.handleDragEvent(o);else if(o.type==zn.POINTERUP){var i=this.handleUpEvent(o);this.handlingDownUpSequence=i&&0<this.targetPointers.length}}else if(o.type==zn.POINTERDOWN){var r=this.handleDownEvent(o);this.handlingDownUpSequence=r,t=this.stopDown(r)}else o.type==zn.POINTERMOVE&&this.handleMoveEvent(o);return!t},t.prototype.handleMoveEvent=function(){},t.prototype.handleUpEvent=function(){return!1},t.prototype.stopDown=function(e){return e},t.prototype.updateTrackedPointers_=function(o){if(function(o){var t=o.type;return t===zn.POINTERDOWN||t===zn.POINTERDRAG||t===zn.POINTERUP}(o)){var t=o.pointerEvent,e=t.pointerId.toString();o.type==zn.POINTERUP?delete this.trackedPointers_[e]:(o.type==zn.POINTERDOWN||e in this.trackedPointers_)&&(this.trackedPointers_[e]=t),this.targetPointers=c(this.trackedPointers_)}},t}(Xo),ca=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),pa=function(o){function t(t){var e=o.call(this,{stopDown:R})||this,r=t||{};return e.kinetic_=r.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1,e.condition_=r.condition?r.condition:Ai,e.noKinetic_=!1,e}return ca(t,o),t.prototype.conditionInternal_=function(o){var t=!0;return o.map.getTargetElement().hasAttribute("tabindex")&&(t=Qo(o)),t&&this.condition_(o)},t.prototype.handleDragEvent=function(o){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var t=this.targetPointers,e=qo(t);if(!(t.length==this.lastPointersCount_))this.kinetic_&&this.kinetic_.begin();else if(this.kinetic_&&this.kinetic_.update(e[0],e[1]),this.lastCentroid){var r=[this.lastCentroid[0]-e[0],e[1]-this.lastCentroid[1]],n=o.map.getView();$n(r,n.getResolution()),Qn(r,n.getRotation()),n.adjustCenterInternal(r)}this.lastCentroid=e,this.lastPointersCount_=t.length,o.originalEvent.preventDefault()},t.prototype.handleUpEvent=function(l){var t=l.map,e=t.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),i=e.getCenterInternal(),o=t.getPixelFromCoordinateInternal(i),a=t.getCoordinateFromPixelInternal([o[0]-r*gh(n),o[1]-r*_h(n)]);e.animateInternal({center:e.getConstrainedCenter(a),duration:500,easing:Ei})}return this.panning_&&(this.panning_=!1,e.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},t.prototype.handleDownEvent=function(o){if(0<this.targetPointers.length&&this.conditionInternal_(o)){var t=o.map.getView();return this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=1<this.targetPointers.length,!0}return!1},t}(la),da=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_a=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,{stopDown:R})||this).condition_=i.condition?i.condition:Jo,e.lastAngle_=void 0,e.duration_=void 0===i.duration?250:i.duration,e}return da(t,o),t.prototype.handleDragEvent=function(s){if(aa(s)){var t=s.map,e=t.getView();if(e.getConstraints().rotation!==rn){var r=t.getSize(),n=s.pixel,i=sh(r[1]/2-n[1],n[0]-r[0]/2);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;e.adjustRotationInternal(-o)}this.lastAngle_=i}}},t.prototype.handleUpEvent=function(e){return!aa(e)||(e.map.getView().endInteraction(this.duration_),!1)},t.prototype.handleDownEvent=function(e){return!!aa(e)&&ta(e)&&this.condition_(e)&&(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)},t}(la),ga=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ya=function(o){function t(t){var e=o.call(this)||this;return e.geometry_=null,e.element_=document.createElement("div"),e.element_.style.position="absolute",e.element_.className="ol-box "+t,e.map_=null,e.startPixel_=null,e.endPixel_=null,e}return ga(t,o),t.prototype.disposeInternal=function(){this.setMap(null)},t.prototype.render_=function(){var o=this.startPixel_,t=this.endPixel_,e=this.element_.style;e.left=E(o[0],t[0])+"px",e.top=E(o[1],t[1])+"px",e.width=P(t[0]-o[0])+"px",e.height=P(t[1]-o[1])+"px"},t.prototype.setMap=function(o){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=o,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},t.prototype.setPixels=function(o,t){this.startPixel_=o,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()},t.prototype.createOrUpdateGeometry=function(){var o=this.startPixel_,t=this.endPixel_,e=[o,[o[0],t[1]],t,[t[0],o[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);e[4]=e[0].slice(),this.geometry_?this.geometry_.setCoordinates([e]):this.geometry_=new hn([e])},t.prototype.getGeometry=function(){return this.geometry_},t}(hh),va=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ma=function(o){function t(t,e,r){var n=o.call(this,t)||this;return n.coordinate=e,n.mapBrowserEvent=r,n}return va(t,o),t}(fh),Ea=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.box_=new ya(r.className||"ol-dragbox"),e.minArea_=void 0===r.minArea?64:r.minArea,e.onBoxEnd_=r.onBoxEnd?r.onBoxEnd:b,e.startPixel_=null,e.condition_=r.condition?r.condition:ta,e.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:e.defaultBoxEndCondition,e}return va(t,o),t.prototype.defaultBoxEndCondition=function(o,t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n>=this.minArea_},t.prototype.getGeometry=function(){return this.box_.getGeometry()},t.prototype.handleDragEvent=function(e){this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new ma("boxdrag",e.coordinate,e))},t.prototype.handleUpEvent=function(e){return this.box_.setMap(null),this.boxEndCondition_(e,this.startPixel_,e.pixel)&&(this.onBoxEnd_(e),this.dispatchEvent(new ma("boxend",e.coordinate,e))),!1},t.prototype.handleDownEvent=function(e){return!!this.condition_(e)&&(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ma("boxstart",e.coordinate,e)),!0)},t}(la),Ta=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ca=function(o){function t(t){var e=this,a=t||{},n=a.condition?a.condition:ia;return(e=o.call(this,{condition:n,className:a.className||"ol-dragzoom",minArea:a.minArea,onBoxEnd:Gi})||this).duration_=void 0===a.duration?200:a.duration,e.out_=void 0!==a.out&&a.out,e}return Ta(t,o),t}(Ea),Pa=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fa=function(o){function t(t){var e=o.call(this,{handleEvent:Di})||this,r=t||{};return e.defaultCondition_=function(e){return na(e)&&oa(e)},e.condition_=void 0===r.condition?e.defaultCondition_:r.condition,e.duration_=void 0===r.duration?100:r.duration,e.pixelDelta_=void 0===r.pixelDelta?128:r.pixelDelta,e}return Pa(t,o),t}(Xo),Aa=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Na=function(o){function t(t){var e=o.call(this,{handleEvent:ki})||this,r=t||{};return e.condition_=r.condition?r.condition:oa,e.delta_=r.delta?r.delta:1,e.duration_=void 0===r.duration?100:r.duration,e}return Aa(t,o),t}(Xo),ja=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Da="trackpad",ka=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,i)||this).totalDelta_=0,e.lastDelta_=0,e.maxDelta_=void 0===i.maxDelta?1:i.maxDelta,e.duration_=void 0===i.duration?250:i.duration,e.timeout_=void 0===i.timeout?80:i.timeout,e.useAnchor_=void 0===i.useAnchor||i.useAnchor,e.condition_=i.condition?i.condition:$o,e.lastAnchor_=null,e.startTime_=void 0,e.timeoutId_,e.mode_=void 0,e.trackpadEventGap_=400,e.trackpadTimeoutId_,e.deltaPerZoom_=300,e}return ja(t,o),t.prototype.conditionInternal_=function(o){var t=!0;return o.map.getTargetElement().hasAttribute("tabindex")&&(t=Qo(o)),t&&this.condition_(o)},t.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?0<this.lastDelta_?1:-1:0,this.lastAnchor_)},t.prototype.handleEvent=function(s){if(!this.conditionInternal_(s))return!0;if(s.type!==Z)return!0;s.preventDefault();var t=s.map,r=s.originalEvent,n;if(this.useAnchor_&&(this.lastAnchor_=s.coordinate),s.type==Z&&(n=r.deltaY,An&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=jn),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;var l=Date.now();void 0===this.startTime_&&(this.startTime_=l),(!this.mode_||l-this.startTime_>this.trackpadEventGap_)&&(this.mode_=4>P(n)?Da:"wheel");var i=t.getView();if(this.mode_===Da&&!i.getConstrainResolution())return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(i.getAnimating()&&i.cancelAnimations(),i.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),i.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=l,!1;this.totalDelta_+=n;var o=C(this.timeout_-(l-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,t),o),!1},t.prototype.handleWheelZoom_=function(o){var t=o.getView();t.getAnimating()&&t.cancelAnimations();var e=-le(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;t.getConstrainResolution()&&(e=e?0<e?1:-1:0),Yo(t,e,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},t.prototype.setMouseAnchor=function(e){this.useAnchor_=e,e||(this.lastAnchor_=null)},t}(Xo),za=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ba=function(o){function t(t){var e=this,a=t||{},n=a;return n.stopDown||(n.stopDown=R),(e=o.call(this,n)||this).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0===a.threshold?.3:a.threshold,e.duration_=void 0===a.duration?250:a.duration,e}return za(t,o),t.prototype.handleDragEvent=function(p){var t=0,d=this.targetPointers[0],r=this.targetPointers[1],n=sh(r.clientY-d.clientY,r.clientX-d.clientX);if(void 0!==this.lastAngle_){var i=n-this.lastAngle_;this.rotationDelta_+=i,!this.rotating_&&P(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=i}this.lastAngle_=n;var o=p.map,a=o.getView();if(a.getConstraints().rotation!==rn){var s=o.getViewport().getBoundingClientRect(),_=qo(this.targetPointers);_[0]-=s.left,_[1]-=s.top,this.anchor_=o.getCoordinateFromPixelInternal(_),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_))}},t.prototype.handleUpEvent=function(e){return!(2>this.targetPointers.length)||(e.map.getView().endInteraction(this.duration_),!1)},t.prototype.handleDownEvent=function(o){if(2<=this.targetPointers.length){var t=o.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1},t}(la),Ya=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Va=function(o){function t(t){var e=this,a=t||{},n=a;return n.stopDown||(n.stopDown=R),(e=o.call(this,n)||this).anchor_=null,e.duration_=void 0===a.duration?400:a.duration,e.lastDistance_=void 0,e.lastScaleDelta_=1,e}return Ya(t,o),t.prototype.handleDragEvent=function(p){var t=1,d=this.targetPointers[0],r=this.targetPointers[1],n=d.clientX-r.clientX,i=d.clientY-r.clientY,o=ee(n*n+i*i);void 0!==this.lastDistance_&&(t=this.lastDistance_/o),this.lastDistance_=o;var a=p.map,s=a.getView();1!=t&&(this.lastScaleDelta_=t);var _=a.getViewport().getBoundingClientRect(),l=qo(this.targetPointers);l[0]-=_.left,l[1]-=_.top,this.anchor_=a.getCoordinateFromPixelInternal(l),a.render(),s.adjustResolutionInternal(t,this.anchor_)},t.prototype.handleUpEvent=function(o){if(2>this.targetPointers.length){var t=o.map.getView(),e=1<this.lastScaleDelta_?1:-1;return t.endInteraction(this.duration_,e),!1}return!0},t.prototype.handleDownEvent=function(o){if(2<=this.targetPointers.length){var t=o.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1},t}(la),Xa=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Za=function(a){function t(t,e,r,n){var i=a.call(this,t)||this;return i.inversePixelTransform=e,i.frameState=r,i.context=n,i}return Xa(t,a),t}(fh),Ka=(fs={},zh=0,function(o){var t;if(fs.hasOwnProperty(o))t=fs[o];else{if(1024<=zh){var i=0;for(var a in fs)0==(3&i++)&&(delete fs[a],--zh)}t=function(l){var p,d,_,g,c;if(/^([a-z]*)$|^hsla?\(.*\)$/i.exec(l)&&(l=ji(l)),/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i.exec(l)){var y=l.length-1,a;a=4>=y?1:2;var m=4==y||8===y;p=parseInt(l.substr(1+0*a,a),16),d=parseInt(l.substr(1+1*a,a),16),_=parseInt(l.substr(1+2*a,a),16),g=m?parseInt(l.substr(1+3*a,a),16):255,1==a&&(p=(p<<4)+p,d=(d<<4)+d,_=(_<<4)+_,m&&(g=(g<<4)+g)),c=[p,d,_,g/255]}else 0==l.indexOf("rgba(")?Yi(c=l.slice(5,-1).split(",").map(Number)):0==l.indexOf("rgb(")?((c=l.slice(4,-1).split(",").map(Number)).push(1),Yi(c)):O(!1,14);return c}(o),fs[o]=t,++zh}return t}),es=function(){function e(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return e.prototype.clear=function(){this.cache_={},this.cacheSize_=0},e.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},e.prototype.expire=function(){if(this.canExpireCache()){var o=0;for(var n in this.cache_){var e=this.cache_[n];0!=(3&o++)||e.hasListener()||(delete this.cache_[n],--this.cacheSize_)}}},e.prototype.get=function(o,t,e){var r=Xi(o,t,e);return r in this.cache_?this.cache_[r]:null},e.prototype.set=function(o,t,e,r){var n=Xi(o,t,e);this.cache_[n]=r,++this.cacheSize_},e.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},e}(),os=new es,ss=function(){function e(){}return e.prototype.drawCustom=function(){},e.prototype.drawGeometry=function(){},e.prototype.setStyle=function(){},e.prototype.drawCircle=function(){},e.prototype.drawFeature=function(){},e.prototype.drawGeometryCollection=function(){},e.prototype.drawLineString=function(){},e.prototype.drawMultiLineString=function(){},e.prototype.drawMultiPoint=function(){},e.prototype.drawMultiPolygon=function(){},e.prototype.drawPoint=function(){},e.prototype.drawPolygon=function(){},e.prototype.drawText=function(){},e.prototype.setFillStrokeStyle=function(){},e.prototype.setImageStyle=function(){},e.prototype.setTextStyle=function(){},e}(),ls=[],hs=[0,0,0,0],cs=new tt,ps=new Rh,fs,zh;ps.setSize=function(){console.warn("labelCache is deprecated.")};var Xh=null,uf={},vs=function(){function s(e,t,o){for(var a=!0,p=0,d;p<r;++p)if(d=i[p],n=qi(e+" "+t+" 32px "+d,"wmytzilWMYTZIL@#/&?$%10\uF013"),o!=d){var _=qi(e+" "+t+" 32px "+o+","+d,"wmytzilWMYTZIL@#/&?$%10\uF013");a=a&&_!=n}return!!a}function o(){for(var t=!0,o=cs.getKeys(),r=0,l=o.length,i;r<l;++r)i=o[r],100>cs.get(i)&&(s.apply(this,i.split("\n"))?(k(uf),Xh=null,mc=void 0,cs.set(i,100)):(cs.set(i,cs.get(i)+1,!0),t=!1));t&&(clearInterval(p),p=void 0)}var i=["monospace","serif"],r=i.length,p,n;return function(t){var e=Io(t);if(e)for(var r=e.families,n=0,a=r.length;n<a;++n){var d=r[n],_=e.style+"\n"+e.weight+"\n"+d;void 0===cs.get(_)&&(cs.set(_,100,!0),s(e.style,e.weight,d)||(cs.set(_,0,!0),void 0===p&&(p=setInterval(o,32))))}}}(),ms=(ex=uf,function(o){var t=ex[o];if(null==t)if(Dn){var a=Io(o),r=Ki(o,"\u017Dg"),n=isNaN(+a.lineHeight)?1.2:+a.lineHeight;uf[o]=n*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else Xf||((Xf=document.createElement("div")).innerHTML="M",Xf.style.margin="0 !important",Xf.style.padding="0 !important",Xf.style.position="absolute !important",Xf.style.left="-99999px !important"),Xf.style.font=o,document.body.appendChild(Xf),t=Xf.offsetHeight,ex[o]=t,document.body.removeChild(Xf);return t}),xs=null,yf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Rs=function(l){function t(t,e,r,n,i,o,a){var s=l.call(this)||this;return s.context_=t,s.pixelRatio_=e,s.extent_=r,s.transform_=n,s.viewRotation_=i,s.squaredTolerance_=o,s.userTransform_=a,s.contextFillState_=null,s.contextStrokeState_=null,s.contextTextState_=null,s.fillState_=null,s.strokeState_=null,s.image_=null,s.imageAnchorX_=0,s.imageAnchorY_=0,s.imageHeight_=0,s.imageOpacity_=0,s.imageOriginX_=0,s.imageOriginY_=0,s.imageRotateWithView_=!1,s.imageRotation_=0,s.imageScale_=0,s.imageWidth_=0,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=!1,s.textRotation_=0,s.textScale_=0,s.textFillState_=null,s.textStrokeState_=null,s.textState_=null,s.pixelCoordinates_=[],s.tmpLocalTransform_=[1,0,0,1,0,0],s}return yf(t,l),t.prototype.drawImages_=function(n,t,e){if(this.image_){var r=jt(n,t,e,2,this.transform_,this.pixelCoordinates_),i=this.context_,o=this.tmpLocalTransform_,a=i.globalAlpha;1!=this.imageOpacity_&&(i.globalAlpha=a*this.imageOpacity_);var s=this.imageRotation_;this.imageRotateWithView_&&(s+=this.viewRotation_);for(var _=0,g=r.length;_<g;_+=2){var y=r[_]-this.imageAnchorX_,c=r[_+1]-this.imageAnchorY_;if(0!==s||1!=this.imageScale_){var p=y+this.imageAnchorX_,m=c+this.imageAnchorY_;$t(o,p,m,this.imageScale_,this.imageScale_,s,-p,-m),i.setTransform.apply(i,o)}i.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,y,c,this.imageWidth_,this.imageHeight_)}0===s&&1==this.imageScale_||i.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(i.globalAlpha=a)}},t.prototype.drawText_=function(p,t,d,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var n=jt(p,t,d,r,this.transform_,this.pixelCoordinates_),i=this.context_,o=this.textRotation_;for(this.textRotateWithView_&&(o+=this.viewRotation_);t<d;t+=r){var _=n[t]+this.textOffsetX_,s=n[t+1]+this.textOffsetY_;if(0!==o||1!=this.textScale_){var g=$t(this.tmpLocalTransform_,_,s,this.textScale_,this.textScale_,o,-_,-s);i.setTransform.apply(i,g)}this.textStrokeState_&&i.strokeText(this.text_,_,s),this.textFillState_&&i.fillText(this.text_,_,s)}0===o&&1==this.textScale_||i.setTransform(1,0,0,1,0,0)}},t.prototype.moveToLineTo_=function(l,t,e,r,n){var i=this.context_,o=jt(l,t,e,r,this.transform_,this.pixelCoordinates_);i.moveTo(o[0],o[1]);var a=o.length;n&&(a-=2);for(var p=2;p<a;p+=2)i.lineTo(o[p],o[p+1]);return n&&i.closePath(),e},t.prototype.drawRings_=function(a,t,s,r){for(var n=0,l=s.length;n<l;++n)t=this.moveToLineTo_(a,t,s[n],r,!0);return t},t.prototype.drawCircle=function(a){if(Dt(this.extent_,a.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var t=function(o,t,e){var r=o.getFlatCoordinates();if(r){var n=o.getStride();return jt(r,0,r.length,n,t,e)}return null}(a,this.transform_,this.pixelCoordinates_),e=t[2]-t[0],r=t[3]-t[1],n=ee(e*e+r*r),i=this.context_;i.beginPath(),i.arc(t[0],t[1],n,0,2*dh),this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}""!==this.text_&&this.drawText_(a.getCenter(),0,2,2)}},t.prototype.setStyle=function(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())},t.prototype.setTransform=function(e){this.transform_=e},t.prototype.drawGeometry=function(e){switch(e.getType()){case oe.POINT:this.drawPoint(e);break;case oe.LINE_STRING:this.drawLineString(e);break;case oe.POLYGON:this.drawPolygon(e);break;case oe.MULTI_POINT:this.drawMultiPoint(e);break;case oe.MULTI_LINE_STRING:this.drawMultiLineString(e);break;case oe.MULTI_POLYGON:this.drawMultiPolygon(e);break;case oe.GEOMETRY_COLLECTION:this.drawGeometryCollection(e);break;case oe.CIRCLE:this.drawCircle(e);}},t.prototype.drawFeature=function(o,t){var e=t.getGeometryFunction()(o);e&&Dt(this.extent_,e.getExtent())&&(this.setStyle(t),this.drawGeometry(e))},t.prototype.drawGeometryCollection=function(o){for(var t=o.getGeometriesArray(),e=0,i=t.length;e<i;++e)this.drawGeometry(t[e])},t.prototype.drawPoint=function(o){this.squaredTolerance_&&(o=o.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=o.getFlatCoordinates(),e=o.getStride();this.image_&&this.drawImages_(n,0,n.length,e),""!==this.text_&&this.drawText_(n,0,n.length,e)},t.prototype.drawMultiPoint=function(o){this.squaredTolerance_&&(o=o.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var n=o.getFlatCoordinates(),e=o.getStride();this.image_&&this.drawImages_(n,0,n.length,e),""!==this.text_&&this.drawText_(n,0,n.length,e)},t.prototype.drawLineString=function(o){if(this.squaredTolerance_&&(o=o.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Dt(this.extent_,o.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,e=o.getFlatCoordinates();i.beginPath(),this.moveToLineTo_(e,0,e.length,o.getStride(),!1),i.stroke()}if(""!==this.text_){var r=o.getFlatMidpoint();this.drawText_(r,0,2,2)}}},t.prototype.drawMultiLineString=function(p){this.squaredTolerance_&&(p=p.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var d=p.getExtent();if(Dt(this.extent_,d)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,r=p.getFlatCoordinates(),n=0,_=p.getEnds(),o=p.getStride();e.beginPath();for(var a=0,g=_.length;a<g;++a)n=this.moveToLineTo_(r,n,_[a],o,!1);e.stroke()}if(""!==this.text_){var u=p.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},t.prototype.drawPolygon=function(o){if(this.squaredTolerance_&&(o=o.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Dt(this.extent_,o.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var n=this.context_;n.beginPath(),this.drawRings_(o.getOrientedFlatCoordinates(),0,o.getEnds(),o.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(""!==this.text_){var e=o.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}},t.prototype.drawMultiPolygon=function(p){if(this.squaredTolerance_&&(p=p.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Dt(this.extent_,p.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var d=this.context_,e=p.getOrientedFlatCoordinates(),r=0,_=p.getEndss(),i=p.getStride();d.beginPath();for(var o=0,g=_.length,s;o<g;++o)s=_[o],r=this.drawRings_(e,r,s,i);this.fillState_&&d.fill(),this.strokeState_&&d.stroke()}if(""!==this.text_){var c=p.getFlatInteriorPoints();this.drawText_(c,0,c.length,2)}}},t.prototype.setContextFillState_=function(o){var t=this.context_,e=this.contextFillState_;e?e.fillStyle!=o.fillStyle&&(e.fillStyle=o.fillStyle,t.fillStyle=o.fillStyle):(t.fillStyle=o.fillStyle,this.contextFillState_={fillStyle:o.fillStyle})},t.prototype.setContextStrokeState_=function(o){var t=this.context_,e=this.contextStrokeState_;e?(e.lineCap!=o.lineCap&&(e.lineCap=o.lineCap,t.lineCap=o.lineCap),t.setLineDash&&(Kn(e.lineDash,o.lineDash)||t.setLineDash(e.lineDash=o.lineDash),e.lineDashOffset!=o.lineDashOffset&&(e.lineDashOffset=o.lineDashOffset,t.lineDashOffset=o.lineDashOffset)),e.lineJoin!=o.lineJoin&&(e.lineJoin=o.lineJoin,t.lineJoin=o.lineJoin),e.lineWidth!=o.lineWidth&&(e.lineWidth=o.lineWidth,t.lineWidth=o.lineWidth),e.miterLimit!=o.miterLimit&&(e.miterLimit=o.miterLimit,t.miterLimit=o.miterLimit),e.strokeStyle!=o.strokeStyle&&(e.strokeStyle=o.strokeStyle,t.strokeStyle=o.strokeStyle)):(t.lineCap=o.lineCap,t.setLineDash&&(t.setLineDash(o.lineDash),t.lineDashOffset=o.lineDashOffset),t.lineJoin=o.lineJoin,t.lineWidth=o.lineWidth,t.miterLimit=o.miterLimit,t.strokeStyle=o.strokeStyle,this.contextStrokeState_={lineCap:o.lineCap,lineDash:o.lineDash,lineDashOffset:o.lineDashOffset,lineJoin:o.lineJoin,lineWidth:o.lineWidth,miterLimit:o.miterLimit,strokeStyle:o.strokeStyle})},t.prototype.setContextTextState_=function(o){var t=this.context_,e=this.contextTextState_,r=o.textAlign?o.textAlign:"center";e?(e.font!=o.font&&(e.font=o.font,t.font=o.font),e.textAlign!=r&&(e.textAlign=r,t.textAlign=r),e.textBaseline!=o.textBaseline&&(e.textBaseline=o.textBaseline,t.textBaseline=o.textBaseline)):(t.font=o.font,t.textAlign=r,t.textBaseline=o.textBaseline,this.contextTextState_={font:o.font,textAlign:r,textBaseline:o.textBaseline})},t.prototype.setFillStrokeStyle=function(p,t){if(p){var e=p.getColor();this.fillState_={fillStyle:Wi(e||"#000")}}else this.fillState_=null;if(t){var r=t.getColor(),n=t.getLineCap(),i=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),s=t.getWidth(),d=t.getMiterLimit();this.strokeState_={lineCap:void 0===n?"round":n,lineDash:i||ls,lineDashOffset:o||0,lineJoin:void 0===a?"round":a,lineWidth:this.pixelRatio_*(void 0===s?1:s),miterLimit:void 0===d?10:d,strokeStyle:Wi(r||"#000")}}else this.strokeState_=null},t.prototype.setImageStyle=function(o){if(o){var t=o.getAnchor(),e=o.getImage(1),r=o.getOrigin(),n=o.getSize();this.imageAnchorX_=t[0],this.imageAnchorY_=t[1],this.imageHeight_=n[1],this.image_=e,this.imageOpacity_=o.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=o.getRotateWithView(),this.imageRotation_=o.getRotation(),this.imageScale_=o.getScale()*this.pixelRatio_,this.imageWidth_=n[0]}else this.image_=null},t.prototype.setTextStyle=function(x){if(x){var t=x.getFill();if(t){var e=t.getColor();this.textFillState_={fillStyle:Wi(e||"#000")}}else this.textFillState_=null;var r=x.getStroke();if(r){var n=r.getColor(),i=r.getLineCap(),o=r.getLineDash(),a=r.getLineDashOffset(),s=r.getLineJoin(),u=r.getWidth(),l=r.getMiterLimit();this.textStrokeState_={lineCap:void 0===i?"round":i,lineDash:o||ls,lineDashOffset:a||0,lineJoin:void 0===s?"round":s,lineWidth:void 0===u?1:u,miterLimit:void 0===l?10:l,strokeStyle:Wi(n||"#000")}}else this.textStrokeState_=null;var h=x.getFont(),c=x.getOffsetX(),p=x.getOffsetY(),f=x.getRotateWithView(),d=x.getRotation(),_=x.getScale(),g=x.getText(),y=x.getTextAlign(),S=x.getTextBaseline();this.textState_={font:void 0===h?"10px sans-serif":h,textAlign:void 0===y?"center":y,textBaseline:void 0===S?"middle":S},this.text_=void 0===g?"":g,this.textOffsetX_=void 0===c?0:this.pixelRatio_*c,this.textOffsetY_=void 0===p?0:this.pixelRatio_*p,this.textRotateWithView_=void 0!==f&&f,this.textRotation_=void 0===d?0:d,this.textScale_=this.pixelRatio_*(void 0===_?1:_)}else this.text_=""},t}(ss),Os=0,Is=1,Ls=2,Fs=3,Ms="Circle",Ns="Default",Gs="Image",js="LineString",Ds="Polygon",ks="Text",Us={Point:function(l,t,e,r){var n=e.getImage();if(n){if(n.getImageState()!=Ls)return;var i=l.getBuilder(e.getZIndex(),Gs);i.setImageStyle(n,l.addDeclutter(!1)),i.drawPoint(t,r)}var o=e.getText();if(o){var a=l.getBuilder(e.getZIndex(),ks);a.setTextStyle(o,l.addDeclutter(!!n)),a.drawText(t,r)}},LineString:function(l,t,e,r){var n=e.getStroke();if(n){var i=l.getBuilder(e.getZIndex(),js);i.setFillStrokeStyle(null,n),i.drawLineString(t,r)}var o=e.getText();if(o){var a=l.getBuilder(e.getZIndex(),ks);a.setTextStyle(o,l.addDeclutter(!1)),a.drawText(t,r)}},Polygon:function(l,t,e,r){var n=e.getFill(),i=e.getStroke();if(n||i){var o=l.getBuilder(e.getZIndex(),Ds);o.setFillStrokeStyle(n,i),o.drawPolygon(t,r)}var a=e.getText();if(a){var s=l.getBuilder(e.getZIndex(),ks);s.setTextStyle(a,l.addDeclutter(!1)),s.drawText(t,r)}},MultiPoint:function(l,t,e,r){var n=e.getImage();if(n){if(n.getImageState()!=Ls)return;var i=l.getBuilder(e.getZIndex(),Gs);i.setImageStyle(n,l.addDeclutter(!1)),i.drawMultiPoint(t,r)}var o=e.getText();if(o){var a=l.getBuilder(e.getZIndex(),ks);a.setTextStyle(o,l.addDeclutter(!!n)),a.drawText(t,r)}},MultiLineString:function(l,t,e,r){var n=e.getStroke();if(n){var i=l.getBuilder(e.getZIndex(),js);i.setFillStrokeStyle(null,n),i.drawMultiLineString(t,r)}var o=e.getText();if(o){var a=l.getBuilder(e.getZIndex(),ks);a.setTextStyle(o,l.addDeclutter(!1)),a.drawText(t,r)}},MultiPolygon:function(l,t,e,r){var n=e.getFill(),i=e.getStroke();if(i||n){var o=l.getBuilder(e.getZIndex(),Ds);o.setFillStrokeStyle(n,i),o.drawMultiPolygon(t,r)}var a=e.getText();if(a){var s=l.getBuilder(e.getZIndex(),ks);s.setTextStyle(a,l.addDeclutter(!1)),s.drawText(t,r)}},GeometryCollection:function(s,t,e,r){var n=t.getGeometriesArray(),a,l;for(a=0,l=n.length;a<l;++a)(0,Us[n[a].getType()])(s,n[a],e,r)},Circle:function(l,t,e,r){var n=e.getFill(),i=e.getStroke();if(n||i){var o=l.getBuilder(e.getZIndex(),Ms);o.setFillStrokeStyle(n,i),o.drawCircle(t,r)}var a=e.getText();if(a){var s=l.getBuilder(e.getZIndex(),ks);s.setTextStyle(a,l.addDeclutter(!1)),s.drawText(t,r)}}},zs=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ks=function(o){function t(t){var e=o.call(this)||this;return e.map_=t,e.declutterTree_=null,e}return zs(t,o),t.prototype.dispatchRenderEvent=function(){r()},t.prototype.calculateMatrices2D=function(o){var t=o.viewState,e=o.coordinateToPixelTransform,r=o.pixelToCoordinateTransform;$t(e,o.size[0]/2,o.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),er(r,e)},t.prototype.forEachFeatureAtCoordinate=function(P,t,e,r,n,i,o,a){function s(o,t,e){return n.call(i,t,o?e:null)}var h=t.viewState,l=h.projection,c=xi(P.slice(),l),p=[[0,0]],f;if(l.canWrapX()&&r){var R=Gt(l.getExtent());p.push([-R,0],[R,0])}var d=t.layerStatesArray,g=d.length,y;this.declutterTree_&&(y=this.declutterTree_.all().map(function(e){return e.value}));for(var L=[],I=0;I<p.length;I++)for(var v=g-1;0<=v;--v){var F=d[v],w=F.layer;if(w.hasRenderer()&&To(F,h)&&o.call(a,w)){var S=w.getRenderer(),E=w.getSource();if(S&&E){var T=E.getWrapX()?c:P,C=s.bind(null,F.managed);L[0]=T[0]+p[I][0],L[1]=T[1]+p[I][1],f=S.forEachFeatureAtCoordinate(L,t,e,C,y)}if(f)return f}}},t.prototype.forEachLayerAtPixel=function(){return r()},t.prototype.hasFeatureAtCoordinate=function(a,t,e,r,n,i){return void 0!==this.forEachFeatureAtCoordinate(a,t,e,r,T,this,n,i)},t.prototype.getMap=function(){return this.map_},t.prototype.renderFrame=function(e){this.declutterTree_=La(e,this.declutterTree_)},t.prototype.scheduleExpireIconCache=function(e){os.canExpireCache()&&e.postRenderFunctions.push(Ia)},t}(hh),Hs=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Js=function(l){function t(t){var e=l.call(this,t)||this;e.fontChangeListenerKey_=_(cs,h,t.redrawText.bind(t)),e.element_=document.createElement("div");var o=e.element_.style;o.position="absolute",o.width="100%",o.height="100%",o.zIndex="0",e.element_.className="ol-unselectable ol-layers";var r=t.getViewport();return r.insertBefore(e.element_,r.firstChild||null),e.children_=[],e.renderedVisible_=!0,e}return Hs(t,l),t.prototype.dispatchRenderEvent=function(o,t){var e=this.getMap();if(e.hasListener(o)){var r=new Za(o,void 0,t);e.dispatchEvent(r)}},t.prototype.disposeInternal=function(){y(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),l.prototype.disposeInternal.call(this)},t.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(oi,t);var e=t.layerStatesArray.sort(function(o,t){return o.zIndex-t.zIndex}),r=t.viewState;this.children_.length=0;for(var n=null,p=0,d=e.length,a;p<d;++p)if(a=e[p],t.layerIndex=p,To(a,r)&&(a.sourceState==go||a.sourceState==fo)){var _=a.layer.render(t,n);_&&_!==n&&(this.children_.push(_),n=_)}l.prototype.renderFrame.call(this,t),function(a,t){for(var e=a.childNodes,r=0;;++r){var s=e[r],i=t[r];if(!s&&!i)break;s!==i&&(s?i?a.insertBefore(i,s):(a.removeChild(s),--r):a.appendChild(i))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},t.prototype.forEachLayerAtPixel=function(p,t,e,r,n){for(var i=t.viewState,o=t.layerStatesArray,a=o.length-1;0<=a;--a){var d=o[a],_=d.layer;if(_.hasRenderer()&&To(d,i)&&n(_)){var l=_.getRenderer().getDataAtPixel(p,t,e);if(l){var g=r(_,l);if(g)return g}}}},t}(Ks),Qs=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),$s=function(o){function t(t){return(t=yh({},t)).controls||(t.controls=ko()),t.interactions||(t.interactions=Ui()),o.call(this,t)||this}return Qs(t,o),t.prototype.createRenderer=function(){return new Js(this)},t}(Co),tu="bottom-center",ru="bottom-right",nu="center-center",ou="center-right",au=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hu="element",cu="map",pu="offset",fu="position",du="positioning",_u=function(o){function t(t){var e=o.call(this)||this;e.options=t,e.id=t.id,e.insertFirst=void 0===t.insertFirst||t.insertFirst,e.stopEvent=void 0===t.stopEvent||t.stopEvent,e.element=document.createElement("div"),e.element.className=void 0===t.className?"ol-overlay-container ol-selectable":t.className,e.element.style.position="absolute";var r=t.autoPan;return r&&"object"!=typeof r&&(r={animation:t.autoPanAnimation,margin:t.autoPanMargin}),e.autoPan=r||!1,e.rendered={transform_:"",visible:!0},e.mapPostrenderListenerKey=null,e.addEventListener(L(hu),e.handleElementChanged),e.addEventListener(L(cu),e.handleMapChanged),e.addEventListener(L(pu),e.handleOffsetChanged),e.addEventListener(L(fu),e.handlePositionChanged),e.addEventListener(L(du),e.handlePositioningChanged),void 0!==t.element&&e.setElement(t.element),e.setOffset(void 0===t.offset?[0,0]:t.offset),e.setPositioning(void 0===t.positioning?"top-left":t.positioning),void 0!==t.position&&e.setPosition(t.position),e}return au(t,o),t.prototype.getElement=function(){return this.get(hu)},t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.get(cu)},t.prototype.getOffset=function(){return this.get(pu)},t.prototype.getPosition=function(){return this.get(fu)},t.prototype.getPositioning=function(){return this.get(du)},t.prototype.handleElementChanged=function(){eo(this.element);var e=this.getElement();e&&this.element.appendChild(e)},t.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(to(this.element),y(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var o=this.getMap();if(o){this.mapPostrenderListenerKey=_(o,Hn,this.render,this),this.updatePixelPosition();var t=this.stopEvent?o.getOverlayContainerStopEvent():o.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}},t.prototype.render=function(){this.updatePixelPosition()},t.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},t.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},t.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},t.prototype.setElement=function(e){this.set(hu,e)},t.prototype.setMap=function(e){this.set(cu,e)},t.prototype.setOffset=function(e){this.set(pu,e)},t.prototype.setPosition=function(e){this.set(fu,e)},t.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},t.prototype.panIntoView=function(_){var t=this.getMap();if(t&&t.getTargetElement()&&this.get(fu)){var e=this.getRect(t.getTargetElement(),t.getSize()),r=this.getElement(),n=this.getRect(r,[Oi(r),Mi(r)]),i=void 0===_.margin?20:_.margin;if(!dt(e,n)){var o=n[0]-e[0],a=e[2]-n[2],s=n[1]-e[1],g=e[3]-n[3],l=[0,0];if(0>o?l[0]=o-i:0>a&&(l[0]=P(a)+i),0>s?l[1]=s-i:0>g&&(l[1]=P(g)+i),0!==l[0]||0!==l[1]){var u=t.getView().getCenterInternal(),c=t.getPixelFromCoordinateInternal(u),p=[c[0]+l[0],c[1]+l[1]],y=_.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(p),duration:y.duration,easing:y.easing})}}}},t.prototype.getRect=function(o,t){var e=o.getBoundingClientRect(),r=e.left+window.pageXOffset,n=e.top+window.pageYOffset;return[r,n,r+t[0],n+t[1]]},t.prototype.setPositioning=function(e){this.set(du,e)},t.prototype.setVisible=function(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)},t.prototype.updatePixelPosition=function(){var o=this.getMap(),t=this.getPosition();if(o&&o.isRendered()&&t){var e=o.getPixelFromCoordinate(t),r=o.getSize();this.updateRenderedPosition(e,r)}else this.setVisible(!1)},t.prototype.updateRenderedPosition=function(e){var t=this.element.style,r=this.getOffset(),n=this.getPositioning();this.setVisible(!0);var i=Zm(e[0]+r[0])+"px",o=Zm(e[1]+r[1])+"px",a="0%",p="0%";n==ru||n==ou||n=="top-right"?a="-100%":n!=tu&&n!=nu&&n!="top-center"||(a="-50%"),n=="bottom-left"||n==tu||n==ru?p="-100%":n!="center-left"&&n!=nu&&n!=ou||(p="-50%");var d="translate("+a+", "+p+") translate("+i+", "+o+")";this.rendered.transform_!=d&&(this.rendered.transform_=d,t.transform=d,t.msTransform=d)},t.prototype.getOptions=function(){return this.options},t}(tt),gu=!1,hf=function(){function e(o,t,e,r){this.minX=o,this.maxX=t,this.minY=e,this.maxY=r}return e.prototype.contains=function(e){return this.containsXY(e[1],e[2])},e.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},e.prototype.containsXY=function(o,t){return this.minX<=o&&o<=this.maxX&&this.minY<=t&&t<=this.maxY},e.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},e.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},e.prototype.getHeight=function(){return this.maxY-this.minY+1},e.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},e.prototype.getWidth=function(){return this.maxX-this.minX+1},e.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},e}(),Cu=hf,Pu=[0,0,0],Mu=function(){function e(l){var p,d,_,t;if(this.minZoom=void 0===l.minZoom?0:l.minZoom,this.resolutions_=l.resolutions,O((p=this.resolutions_,d=!0,_=function(o,t){return t-o}||Ge,p.every(function(e,t){if(0===t)return!0;var r=_(p[t-1],e);return!(0<r||d&&0===r)})),17),!l.origins)for(var g=0,u=this.resolutions_.length-1;g<u;++g)if(!t)t=this.resolutions_[g]/this.resolutions_[g+1];else if(this.resolutions_[g]/this.resolutions_[g+1]!==t){t=void 0;break}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0===l.origin?null:l.origin,this.origins_=null,void 0!==l.origins&&(this.origins_=l.origins,O(this.origins_.length==this.resolutions_.length,20));var a=l.extent;void 0===a||this.origin_||this.origins_||(this.origin_=Nt(a)),O(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==l.tileSizes&&(this.tileSizes_=l.tileSizes,O(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0===l.tileSize?this.tileSizes_?null:256:l.tileSize,O(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0===a?null:a,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0===l.sizes?a&&this.calculateTileRanges_(a):this.fullTileRanges_=l.sizes.map(function(e){return new Cu(E(0,e[0]),C(e[0]-1,-1),E(0,e[1]),C(e[1]-1,-1))},this)}return e.prototype.forEachTileCoord=function(l,t,e){for(var r=this.getTileRangeForExtentAndZ(l,t),n=r.minX,p=r.maxX;n<=p;++n)for(var o=r.minY,d=r.maxY;o<=d;++o)e([t,n,o])},e.prototype.forEachTileCoordParentTileRange=function(l,t,e,r){var n=null,p=l[0]-1,d,_;for(2===this.zoomFactor_?(d=l[1],_=l[2]):n=this.getTileCoordExtent(l,r);p>=this.minZoom;){if(t(p,2===this.zoomFactor_?Ga(d=N(d/2),d,_=N(_/2),_,e):this.getTileRangeForExtentAndZ(n,p,e)))return!0;--p}return!1},e.prototype.getExtent=function(){return this.extent_},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},e.prototype.getResolution=function(e){return this.resolutions_[e]},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getTileCoordChildTileRange=function(a,t,e){if(a[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*a[1],n=2*a[2];return Ga(r,r+1,n,n+1,t)}var i=this.getTileCoordExtent(a,e);return this.getTileRangeForExtentAndZ(i,a[0]+1,t)}return null},e.prototype.getTileRangeExtent=function(l,t,e){var r=this.getOrigin(l),n=this.getResolution(l),i=Eo(this.getTileSize(l),this.tmpSize_),o=r[0]+t.minX*i[0]*n,a=r[0]+(t.maxX+1)*i[0]*n;return yt(o,r[1]+t.minY*i[1]*n,a,r[1]+(t.maxY+1)*i[1]*n,e)},e.prototype.getTileRangeForExtentAndZ=function(a,t,e){var r=Pu;this.getTileCoordForXYAndZ_(a[0],a[3],t,!1,r);var n=r[1],i=r[2];return this.getTileCoordForXYAndZ_(a[2],a[1],t,!0,r),Ga(n,r[1],i,r[2],e)},e.prototype.getTileCoordCenter=function(o){var t=this.getOrigin(o[0]),e=this.getResolution(o[0]),r=Eo(this.getTileSize(o[0]),this.tmpSize_);return[t[0]+(o[1]+.5)*r[0]*e,t[1]-(o[2]+.5)*r[1]*e]},e.prototype.getTileCoordExtent=function(s,t){var e=this.getOrigin(s[0]),r=this.getResolution(s[0]),n=Eo(this.getTileSize(s[0]),this.tmpSize_),i=e[0]+s[1]*n[0]*r,o=e[1]-(s[2]+1)*n[1]*r;return yt(i,o,i+n[0]*r,o+n[1]*r,t)},e.prototype.getTileCoordForCoordAndResolution=function(o,t,e){return this.getTileCoordForXYAndResolution_(o[0],o[1],t,!1,e)},e.prototype.getTileCoordForXYAndResolution_=function(_,t,e,r,n){var i=this.getZForResolution(e),o=e/this.getResolution(i),a=this.getOrigin(i),s=Eo(this.getTileSize(i),this.tmpSize_),g=r?.5:0,l=r?.5:0,u=N((_-a[0])/e+g),c=N((a[1]-t)/e+l),p=o*u/s[0],y=o*c/s[1];return r?(p=F(p)-1,y=F(y)-1):(p=N(p),y=N(y)),Ua(i,p,y,n)},e.prototype.getTileCoordForXYAndZ_=function(d,t,e,r,n){var i=this.getOrigin(e),o=this.getResolution(e),a=Eo(this.getTileSize(e),this.tmpSize_),s=r?.5:0,_=r?.5:0,l=N((d-i[0])/o+s),g=N((i[1]-t)/o+_),u=l/a[0],c=g/a[1];return r?(u=F(u)-1,c=F(c)-1):(u=N(u),c=N(c)),Ua(e,u,c,n)},e.prototype.getTileCoordForCoordAndZ=function(o,t,e){return this.getTileCoordForXYAndZ_(o[0],o[1],t,!1,e)},e.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},e.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},e.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:null},e.prototype.getZForResolution=function(o,t){return le(w(this.resolutions_,o,t||0),this.minZoom,this.maxZoom)},e.prototype.calculateTileRanges_=function(o){for(var t=this.resolutions_.length,e=Array(t),r=this.minZoom;r<t;++r)e[r]=this.getTileRangeForExtentAndZ(o,r);this.fullTileRanges_=e},e}(),Au=["experimental-webgl","webgl","webkit-3d","moz-webgl"],zu="http://www.w3.org/2001/XMLSchema-instance",Yu=Ws(),rl=void 0,ff=void 0,kf=function(){function e(o,t){this.array=null,this.type=o,O(34962===o||34963===o,62),this.usage=void 0===t?35044:t}return e.prototype.ofSize=function(e){this.array=new(al(this.type))(e)},e.prototype.fromArray=function(e){this.array=al(this.type).from(e)},e.prototype.fromArrayBuffer=function(e){this.array=new(al(this.type))(e)},e.prototype.getType=function(){return this.type},e.prototype.getArray=function(){return this.array},e.prototype.getUsage=function(){return this.usage},e.prototype.getSize=function(){return this.array?this.array.length:0},e}(),dl="webglcontextlost",_l="webglcontextrestored",gl=function(){function e(o){this.gl_=o.webGlContext;var t=this.gl_;this.scaleRatio_=o.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var e=t.createShader(t.VERTEX_SHADER);t.shaderSource(e,o.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),t.compileShader(e);var r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,o.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n"),t.compileShader(r),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,e),t.attachShader(this.renderTargetProgram_,r),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],o.uniforms&&Object.keys(o.uniforms).forEach(function(e){this.uniforms_.push({value:o.uniforms[e],location:t.getUniformLocation(this.renderTargetProgram_,e)})}.bind(this))}return e.prototype.getGL=function(){return this.gl_},e.prototype.init=function(){var t=this.getGL(),e=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,e[0],e[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==e[0]||this.renderTargetTextureSize_[1]!==e[1]){this.renderTargetTextureSize_=e;var r=t.RGBA,n=t.RGBA,i=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,0,r,e[0],e[1],0,n,i,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},e.prototype.apply=function(o,t){var e=this.getGL(),r=o.size;e.bindFramebuffer(e.FRAMEBUFFER,t?t.getFrameBuffer():null),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.useProgram(this.renderTargetProgram_),e.enableVertexAttribArray(this.renderTargetAttribLocation_),e.vertexAttribPointer(this.renderTargetAttribLocation_,2,e.FLOAT,!1,0,0),e.uniform2f(this.renderTargetUniformLocation_,r[0],r[1]),e.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(o),e.drawArrays(e.TRIANGLES,0,6)},e.prototype.getFrameBuffer=function(){return this.frameBuffer_},e.prototype.applyUniforms=function(o){var t=this.getGL(),r=1,a;this.uniforms_.forEach(function(e){if((a="function"==typeof e.value?e.value(o):e.value)instanceof HTMLCanvasElement||a instanceof ImageData)e.texture||(e.texture=t.createTexture()),t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_2D,e.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,a.width,a.height,0,t.UNSIGNED_BYTE,new Uint8Array(a.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.uniform1i(e.location,r++);else if(Array.isArray(a))switch(a.length){case 2:return void t.uniform2f(e.location,a[0],a[1]);case 3:return void t.uniform3f(e.location,a[0],a[1],a[2]);case 4:return void t.uniform4f(e.location,a[0],a[1],a[2],a[3]);default:}else"number"==typeof a&&t.uniform1f(e.location,a)})},e}(),vl=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ml={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126},bl=function(a){function t(t){var e=a.call(this)||this,r=t||{};e.boundHandleWebGLContextLost_=e.handleWebGLContextLost.bind(e),e.boundHandleWebGLContextRestored_=e.handleWebGLContextRestored.bind(e),e.canvas_=document.createElement("canvas"),e.canvas_.style.position="absolute",e.canvas_.style.left="0",e.gl_=us(e.canvas_);var n=e.getGL();if(e.bufferCache_={},e.currentProgram_=null,O(x(function(){if(!ox){var e=us(document.createElement("canvas"));e&&(ox=e.getSupportedExtensions())}return ox}(),"OES_element_index_uint"),63),n.getExtension("OES_element_index_uint"),e.canvas_.addEventListener(dl,e.boundHandleWebGLContextLost_),e.canvas_.addEventListener(_l,e.boundHandleWebGLContextRestored_),e.offsetRotateMatrix_=[1,0,0,1,0,0],e.offsetScaleMatrix_=[1,0,0,1,0,0],e.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e.uniformLocations_={},e.attribLocations_={},e.uniforms_=[],r.uniforms)for(var i in r.uniforms)e.uniforms_.push({name:i,value:r.uniforms[i]});return e.postProcessPasses_=r.postProcesses?r.postProcesses.map(function(e){return new gl({webGlContext:n,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})}):[new gl({webGlContext:n})],e.shaderCompileErrors_=null,e.startTime_=Date.now(),e}return vl(t,a),t.prototype.bindBuffer=function(o){var t=this.getGL(),e=X(o),r=this.bufferCache_[e];r||(r={buffer:o,webGlBuffer:t.createBuffer()},this.bufferCache_[e]=r),t.bindBuffer(o.getType(),r.webGlBuffer)},t.prototype.flushBufferData=function(o){var t=this.getGL();this.bindBuffer(o),t.bufferData(o.getType(),o.getArray(),o.getUsage())},t.prototype.deleteBuffer=function(o){var t=this.getGL(),e=X(o),r=this.bufferCache_[e];t.isContextLost()||t.deleteBuffer(r.buffer),delete this.bufferCache_[e]},t.prototype.disposeInternal=function(){this.canvas_.removeEventListener(dl,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(_l,this.boundHandleWebGLContextRestored_)},t.prototype.prepareDraw=function(a){var t=this.getGL(),e=this.getCanvas(),r=a.size,n=a.pixelRatio;e.width=r[0]*n,e.height=r[1]*n,e.style.width=r[0]+"px",e.style.height=r[1]+"px",t.useProgram(this.currentProgram_);for(var i=this.postProcessPasses_.length-1;0<=i;i--)this.postProcessPasses_[i].init(a);t.bindTexture(t.TEXTURE_2D,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.useProgram(this.currentProgram_),this.applyFrameState(a),this.applyUniforms(a)},t.prototype.prepareDrawToRenderTarget=function(o,t,e){var r=this.getGL(),n=t.getSize();r.bindFramebuffer(r.FRAMEBUFFER,t.getFramebuffer()),r.viewport(0,0,n[0],n[1]),r.bindTexture(r.TEXTURE_2D,t.getTexture()),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,e?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(o),this.applyUniforms(o)},t.prototype.drawElements=function(o,t){var e=this.getGL(),r=e.UNSIGNED_INT;e.drawElements(e.TRIANGLES,t-o,r,4*o)},t.prototype.finalizeDraw=function(o){for(var t=0;t<this.postProcessPasses_.length;t++)this.postProcessPasses_[t].apply(o,this.postProcessPasses_[t+1]||null)},t.prototype.getCanvas=function(){return this.canvas_},t.prototype.getGL=function(){return this.gl_},t.prototype.applyFrameState=function(l){var t=l.size,e=l.viewState.rotation,r=Kt(this.offsetScaleMatrix_);Qt(r,2/t[0],2/t[1]);var n=Kt(this.offsetRotateMatrix_),p,d,_,g;0!==e&&(p=n,d=-e,_=gh(d),g=_h(d),Ht(p,qt(Uh,_,g,-g,_,0,0))),this.setUniformMatrixValue("u_offsetScaleMatrix",sl(this.tmpMat4_,r)),this.setUniformMatrixValue("u_offsetRotateMatrix",sl(this.tmpMat4_,n)),this.setUniformFloatValue("u_time",.001*(Date.now()-this.startTime_)),this.setUniformFloatValue("u_zoom",l.viewState.zoom),this.setUniformFloatValue("u_resolution",l.viewState.resolution)},t.prototype.applyUniforms=function(o){var t=this.getGL(),r=0,a;this.uniforms_.forEach(function(e){if((a="function"==typeof e.value?e.value(o):e.value)instanceof HTMLCanvasElement||a instanceof HTMLImageElement||a instanceof ImageData)e.texture||(e.prevValue=void 0,e.texture=t.createTexture()),t.activeTexture(t["TEXTURE"+r]),t.bindTexture(t.TEXTURE_2D,e.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(!(a instanceof HTMLImageElement)||a.complete)&&e.prevValue!==a&&(e.prevValue=a,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a)),t.uniform1i(this.getUniformLocation(e.name),r++);else if(Array.isArray(a)&&6===a.length)this.setUniformMatrixValue(e.name,sl(this.tmpMat4_,a));else if(Array.isArray(a)&&4>=a.length)switch(a.length){case 2:return void t.uniform2f(this.getUniformLocation(e.name),a[0],a[1]);case 3:return void t.uniform3f(this.getUniformLocation(e.name),a[0],a[1],a[2]);case 4:return void t.uniform4f(this.getUniformLocation(e.name),a[0],a[1],a[2],a[3]);default:}else"number"==typeof a&&t.uniform1f(this.getUniformLocation(e.name),a)}.bind(this))},t.prototype.useProgram=function(e){return e!=this.currentProgram_&&(this.getGL().useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},!0)},t.prototype.compileShader=function(o,t){var e=this.getGL(),r=e.createShader(t);return e.shaderSource(r,o),e.compileShader(r),r},t.prototype.getProgram=function(a,t){var e=this.getGL(),r=this.compileShader(a,e.FRAGMENT_SHADER),n=this.compileShader(t,e.VERTEX_SHADER);this.shaderCompileErrors_=null,e.getShaderInfoLog(r)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+e.getShaderInfoLog(r)),e.getShaderInfoLog(n)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+e.getShaderInfoLog(n));var i=e.createProgram();return e.attachShader(i,r),e.attachShader(i,n),e.linkProgram(i),i},t.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},t.prototype.getUniformLocation=function(e){return void 0===this.uniformLocations_[e]&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]},t.prototype.getAttributeLocation=function(e){return void 0===this.attribLocations_[e]&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]},t.prototype.makeProjectionTransform=function(a,t){var e=a.size,r=a.viewState.rotation,n=a.viewState.resolution,i=a.viewState.center;return Kt(t),$t(t,0,0,2/(n*e[0]),2/(n*e[1]),-r,-i[0],-i[1]),t},t.prototype.setUniformFloatValue=function(o,t){this.getGL().uniform1f(this.getUniformLocation(o),t)},t.prototype.setUniformMatrixValue=function(o,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(o),!1,t)},t.prototype.enableAttributeArray_=function(a,t,e,r,n){var i=this.getAttributeLocation(a);0>i||(this.getGL().enableVertexAttribArray(i),this.getGL().vertexAttribPointer(i,t,e,!1,r,n))},t.prototype.enableAttributes=function(o){for(var t=pl(o),e=0,a=0,s;a<o.length;a++)s=o[a],this.enableAttributeArray_(s.name,s.size,s.type||5126,t,e),e+=s.size*ul(s.type)},t.prototype.handleWebGLContextLost=function(){k(this.bufferCache_),this.currentProgram_=null},t.prototype.handleWebGLContextRestored=function(){},t.prototype.createTexture=function(l,t,e){var r=this.getGL(),n=e||r.createTexture(),i=r.RGBA,o=r.RGBA,a=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,n),t?r.texImage2D(r.TEXTURE_2D,0,i,o,a,t):r.texImage2D(r.TEXTURE_2D,0,i,l[0],l[1],0,o,a,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),n},t}(hh),Ol=new Uint8Array(4),Il=function(){function e(o,t){this.helper_=o;var e=o.getGL();this.texture_=e.createTexture(),this.framebuffer_=e.createFramebuffer(),this.size_=t||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return e.prototype.setSize=function(e){Kn(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())},e.prototype.getSize=function(){return this.size_},e.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},e.prototype.readAll=function(){if(this.dataCacheDirty_){var o=this.size_,t=this.helper_.getGL();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.readPixels(0,0,o[0],o[1],t.RGBA,t.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},e.prototype.readPixel=function(o,t){if(0>o||0>t||o>this.size_[0]||t>=this.size_[1])return Ol[0]=0,Ol[1]=0,Ol[2]=0,Ol[3]=0,Ol;this.readAll();var e=N(o)+(this.size_[1]-N(t)-1)*this.size_[0];return Ol[0]=this.data_[4*e],Ol[1]=this.data_[4*e+1],Ol[2]=this.data_[4*e+2],Ol[3]=this.data_[4*e+3],Ol},e.prototype.getTexture=function(){return this.texture_},e.prototype.getFramebuffer=function(){return this.framebuffer_},e.prototype.updateSize_=function(){var o=this.size_,t=this.helper_.getGL();this.texture_=this.helper_.createTexture(o,null,this.texture_),t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer_),t.viewport(0,0,o[0],o[1]),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(4*(o[0]*o[1]))},e}(),Ll=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fl=function(o){function t(t){var e=o.call(this,{extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes})||this;return e.matrixIds_=t.matrixIds,e}return Ll(t,o),t.prototype.getMatrixId=function(e){return this.matrixIds_[e]},t.prototype.getMatrixIds=function(){return this.matrixIds_},t}(Mu),Ml=function(){function e(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.displacement_=e.displacement}return e.prototype.clone=function(){return new e({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},e.prototype.getOpacity=function(){return this.opacity_},e.prototype.getRotateWithView=function(){return this.rotateWithView_},e.prototype.getRotation=function(){return this.rotation_},e.prototype.getScale=function(){return this.scale_},e.prototype.getDisplacement=function(){return this.displacement_},e.prototype.getAnchor=function(){return r()},e.prototype.getImage=function(){return r()},e.prototype.getHitDetectionImage=function(){return r()},e.prototype.getImageState=function(){return r()},e.prototype.getImageSize=function(){return r()},e.prototype.getHitDetectionImageSize=function(){return r()},e.prototype.getOrigin=function(){return r()},e.prototype.getSize=function(){return r()},e.prototype.setOpacity=function(e){this.opacity_=e},e.prototype.setRotateWithView=function(e){this.rotateWithView_=e},e.prototype.setRotation=function(e){this.rotation_=e},e.prototype.setScale=function(e){this.scale_=e},e.prototype.listenImageChange=function(){r()},e.prototype.load=function(){r()},e.prototype.unlistenImageChange=function(){r()},e}(),Gl=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jl=function(o){function r(t){var e=this,i=void 0!==t.rotateWithView&&t.rotateWithView;return(e=o.call(this,{opacity:1,rotateWithView:i,rotation:void 0===t.rotation?0:t.rotation,scale:1,displacement:void 0===t.displacement?[0,0]:t.displacement})||this).canvas_=null,e.hitDetectionCanvas_=null,e.fill_=void 0===t.fill?null:t.fill,e.origin_=[0,0],e.points_=t.points,e.radius_=void 0===t.radius?t.radius1:t.radius,e.radius2_=t.radius2,e.angle_=void 0===t.angle?0:t.angle,e.stroke_=void 0===t.stroke?null:t.stroke,e.anchor_=null,e.size_=null,e.imageSize_=null,e.hitDetectionImageSize_=null,e.render(),e}return Gl(r,o),r.prototype.clone=function(){var e=new r({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return e.setOpacity(this.getOpacity()),e.setScale(this.getScale()),e},r.prototype.getAnchor=function(){return this.anchor_},r.prototype.getAngle=function(){return this.angle_},r.prototype.getFill=function(){return this.fill_},r.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_},r.prototype.getImage=function(){return this.canvas_},r.prototype.getImageSize=function(){return this.imageSize_},r.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},r.prototype.getImageState=function(){return Ls},r.prototype.getOrigin=function(){return this.origin_},r.prototype.getPoints=function(){return this.points_},r.prototype.getRadius=function(){return this.radius_},r.prototype.getRadius2=function(){return this.radius2_},r.prototype.getSize=function(){return this.size_},r.prototype.getStroke=function(){return this.stroke_},r.prototype.listenImageChange=function(){},r.prototype.load=function(){},r.prototype.unlistenImageChange=function(){},r.prototype.render=function(){var p="round",d="round",_=0,g=null,y=0,m=0,f;this.stroke_&&(null===(f=this.stroke_.getColor())&&(f="#000"),f=Wi(f),void 0===(m=this.stroke_.getWidth())&&(m=1),g=this.stroke_.getLineDash(),y=this.stroke_.getLineDashOffset(),void 0===(d=this.stroke_.getLineJoin())&&(d="round"),void 0===(p=this.stroke_.getLineCap())&&(p="round"),void 0===(_=this.stroke_.getMiterLimit())&&(_=10));var x=2*(this.radius_+m)+1,S={strokeStyle:f,strokeWidth:m,size:x,lineCap:p,lineDash:g,lineDashOffset:y,lineJoin:d,miterLimit:_},u=Fi(x,x);this.canvas_=u.canvas;var l=x=this.canvas_.width,h=this.getDisplacement();this.draw_(S,u,0,0),this.createHitDetectionCanvas_(S),this.anchor_=[x/2-h[0],x/2+h[1]],this.size_=[x,x],this.imageSize_=[l,l]},r.prototype.draw_=function(p,t,e,r){var n,d,_;t.setTransform(1,0,0,1,0,0),t.translate(e,r),t.beginPath();var g=this.points_;if(g===1/0)t.arc(p.size/2,p.size/2,this.radius_,0,2*dh,!0);else{var c=void 0===this.radius2_?this.radius_:this.radius2_;for(c!==this.radius_&&(g*=2),n=0;n<=g;n++)d=2*n*dh/g-dh/2+this.angle_,_=0==n%2?this.radius_:c,t.lineTo(p.size/2+_*gh(d),p.size/2+_*_h(d))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u="#000"),t.fillStyle=Wi(u),t.fill()}this.stroke_&&(t.strokeStyle=p.strokeStyle,t.lineWidth=p.strokeWidth,t.setLineDash&&p.lineDash&&(t.setLineDash(p.lineDash),t.lineDashOffset=p.lineDashOffset),t.lineCap=p.lineCap,t.lineJoin=p.lineJoin,t.miterLimit=p.miterLimit,t.stroke()),t.closePath()},r.prototype.createHitDetectionCanvas_=function(o){if(this.hitDetectionImageSize_=[o.size,o.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var t=this.fill_.getColor(),i=0;if("string"==typeof t&&(t=Bi(t)),null===t?i=1:Array.isArray(t)&&(i=4===t.length?t[3]:1),0===i){var a=Fi(o.size,o.size);this.hitDetectionCanvas_=a.canvas,this.drawHitDetectionCanvas_(o,a,0,0)}}},r.prototype.drawHitDetectionCanvas_=function(l,t,e,r){t.setTransform(1,0,0,1,0,0),t.translate(e,r),t.beginPath();var n=this.points_;if(n===1/0)t.arc(l.size/2,l.size/2,this.radius_,0,2*dh,!0);else{var p=void 0===this.radius2_?this.radius_:this.radius2_;p!==this.radius_&&(n*=2);var o,d,_;for(o=0;o<=n;o++)_=2*o*dh/n-dh/2+this.angle_,d=0==o%2?this.radius_:p,t.lineTo(l.size/2+d*gh(_),l.size/2+d*_h(_))}t.fillStyle="#000",t.fill(),this.stroke_&&(t.strokeStyle=l.strokeStyle,t.lineWidth=l.strokeWidth,l.lineDash&&(t.setLineDash(l.lineDash),t.lineDashOffset=l.lineDashOffset),t.stroke()),t.closePath()},r}(Ml),Dl=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kl=function(o){function r(t){var e=t||{};return o.call(this,{points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,displacement:void 0===e.displacement?[0,0]:e.displacement})||this}return Dl(r,o),r.prototype.clone=function(){var e=new r({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return e.setOpacity(this.getOpacity()),e.setScale(this.getScale()),e},r.prototype.setRadius=function(e){this.radius_=e,this.render()},r}(jl),Ul=function(){function o(o){var t=o||{};this.color_=void 0===t.color?null:t.color}return o.prototype.clone=function(){var t=this.getColor();return new o({color:Array.isArray(t)?t.slice():t||void 0})},o.prototype.getColor=function(){return this.color_},o.prototype.setColor=function(e){this.color_=e},o}(),zl="fraction",Bl="pixels",Yl=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vl=function(a){function t(t,e,r,n){var i=a.call(this)||this;return i.extent=t,i.pixelRatio_=r,i.resolution=e,i.state=n,i}return Yl(t,a),t.prototype.changed=function(){this.dispatchEvent(A)},t.prototype.getExtent=function(){return this.extent},t.prototype.getImage=function(){return r()},t.prototype.getPixelRatio=function(){return this.pixelRatio_},t.prototype.getResolution=function(){return this.resolution},t.prototype.getState=function(){return this.state},t.prototype.load=function(){r()},t}(Rh),Xl=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Wl=function(l){function t(t,e,r,n,i,o){var a=l.call(this,t,e,r,Os)||this;return a.src_=n,a.image_=new Image,null!==i&&(a.image_.crossOrigin=i),a.unlisten_=null,a.state=Os,a.imageLoadFunction_=o,a}return Xl(t,l),t.prototype.getImage=function(){return this.image_},t.prototype.handleImageError_=function(){this.state=Fs,this.unlistenImage_(),this.changed()},t.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Ot(this.extent)/this.image_.height),this.state=Ls,this.unlistenImage_(),this.changed()},t.prototype.load=function(){this.state!=Os&&this.state!=Fs||(this.state=Is,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=yl(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},t.prototype.setImage=function(e){this.image_=e},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(Vl),Kl=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ql=function(l){function t(t,e,r,n,i,o){var a=l.call(this)||this;return a.hitDetectionImage_=null,a.image_=t||new Image,null!==n&&(a.image_.crossOrigin=n),a.canvas_=o?document.createElement("canvas"):null,a.color_=o,a.unlisten_=null,a.imageState_=i,a.size_=r,a.src_=e,a.tainted_,a}return Kl(t,l),t.prototype.isTainted_=function(e){if(void 0===this.tainted_&&this.imageState_===Ls){e||(e=Fi(1,1)).drawImage(this.image_,0,0);try{e.getImageData(0,0,1,1),this.tainted_=!1}catch(e){this.tainted_=!0}}return!0===this.tainted_},t.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(A)},t.prototype.handleImageError_=function(){this.imageState_=Fs,this.unlistenImage_(),this.dispatchChangeEvent_()},t.prototype.handleImageLoad_=function(){this.imageState_=Ls,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},t.prototype.getImage=function(){return this.canvas_?this.canvas_:this.image_},t.prototype.getImageState=function(){return this.imageState_},t.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],o=Fi(t,e);o.fillRect(0,0,t,e),this.hitDetectionImage_=o.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},t.prototype.getSize=function(){return this.size_},t.prototype.getSrc=function(){return this.src_},t.prototype.load=function(){if(this.imageState_==Os){this.imageState_=Is;try{this.image_.src=this.src_}catch(e){this.handleImageError_()}this.unlisten_=yl(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},t.prototype.replaceColor_=function(){if(this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var l=this.canvas_.getContext("2d");if(l.drawImage(this.image_,0,0),this.isTainted_(l)){var t=this.color_;return l.globalCompositeOperation="multiply",l.fillStyle="rgb("+t[0]+","+t[1]+","+t[2]+")",l.fillRect(0,0,this.image_.width,this.image_.height),l.globalCompositeOperation="destination-in",void l.drawImage(this.image_,0,0)}for(var e=l.getImageData(0,0,this.image_.width,this.image_.height),r=e.data,n=this.color_[0]/255,i=this.color_[1]/255,o=this.color_[2]/255,a=0,p=r.length;a<p;a+=4)r[a]*=n,r[a+1]*=i,r[a+2]*=o;l.putImageData(e,0,0)}},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(Rh),Hl="bottom-left",Jl="bottom-right",Ql="top-left",$l="top-right",th=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),eh=function(o){function t(t){var e=this,d=t||{},n=void 0===d.opacity?1:d.opacity,i=void 0===d.rotation?0:d.rotation,a=void 0===d.scale?1:d.scale,s=void 0!==d.rotateWithView&&d.rotateWithView;(e=o.call(this,{opacity:n,rotation:i,scale:a,displacement:void 0===d.displacement?[0,0]:d.displacement,rotateWithView:s})||this).anchor_=void 0===d.anchor?[.5,.5]:d.anchor,e.normalizedAnchor_=null,e.anchorOrigin_=void 0===d.anchorOrigin?Ql:d.anchorOrigin,e.anchorXUnits_=void 0===d.anchorXUnits?zl:d.anchorXUnits,e.anchorYUnits_=void 0===d.anchorYUnits?zl:d.anchorYUnits,e.crossOrigin_=void 0===d.crossOrigin?null:d.crossOrigin;var _=void 0===d.img?null:d.img,l=void 0===d.imgSize?null:d.imgSize,g=d.src;O(!(void 0!==g&&_),4),O(!_||_&&l,5),(void 0===g||0===g.length)&&_&&(g=_.src||X(_)),O(void 0!==g&&0<g.length,6);var u=void 0===d.src?Ls:Os;return e.color_=void 0===d.color?null:Bi(d.color),e.iconImage_=function(s,t,e,r,n,i){var o=os.get(t,r,i);return o||(o=new ql(s,t,e,r,n,i),os.set(t,r,i,o)),o}(_,g,l,e.crossOrigin_,u,e.color_),e.offset_=void 0===d.offset?[0,0]:d.offset,e.offsetOrigin_=void 0===d.offsetOrigin?Ql:d.offsetOrigin,e.origin_=null,e.size_=void 0===d.size?null:d.size,e}return th(t,o),t.prototype.clone=function(){return new t({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null===this.size_?void 0:this.size_.slice(),opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var o=this.anchor_,r=this.getSize();if(this.anchorXUnits_==zl||this.anchorYUnits_==zl){if(!r)return null;o=this.anchor_.slice(),this.anchorXUnits_==zl&&(o[0]*=r[0]),this.anchorYUnits_==zl&&(o[1]*=r[1])}if(this.anchorOrigin_!=Ql){if(!r)return null;o===this.anchor_&&(o=this.anchor_.slice()),this.anchorOrigin_!=$l&&this.anchorOrigin_!=Jl||(o[0]=-o[0]+r[0]),this.anchorOrigin_!=Hl&&this.anchorOrigin_!=Jl||(o[1]=-o[1]+r[1])}return this.normalizedAnchor_=o,this.normalizedAnchor_},t.prototype.setAnchor=function(e){this.anchor_=e,this.normalizedAnchor_=null},t.prototype.getColor=function(){return this.color_},t.prototype.getImage=function(e){return this.iconImage_.getImage(e)},t.prototype.getImageSize=function(){return this.iconImage_.getSize()},t.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},t.prototype.getImageState=function(){return this.iconImage_.getImageState()},t.prototype.getHitDetectionImage=function(e){return this.iconImage_.getHitDetectionImage(e)},t.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var o=this.offset_,i=this.getDisplacement();if(this.offsetOrigin_!=Ql){var e=this.getSize(),r=this.iconImage_.getSize();if(!e||!r)return null;o=o.slice(),this.offsetOrigin_!=$l&&this.offsetOrigin_!=Jl||(o[0]=r[0]-e[0]-o[0]),this.offsetOrigin_!=Hl&&this.offsetOrigin_!=Jl||(o[1]=r[1]-e[1]-o[1])}return o[0]+=i[0],o[1]+=i[1],this.origin_=o,this.origin_},t.prototype.getSrc=function(){return this.iconImage_.getSrc()},t.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},t.prototype.listenImageChange=function(e){this.iconImage_.addEventListener(A,e)},t.prototype.load=function(){this.iconImage_.load()},t.prototype.unlistenImageChange=function(e){this.iconImage_.removeEventListener(A,e)},t}(Ml),rh=function(){function o(o){var t=o||{};this.color_=void 0===t.color?null:t.color,this.lineCap_=t.lineCap,this.lineDash_=void 0===t.lineDash?null:t.lineDash,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return o.prototype.clone=function(){var t=this.getColor();return new o({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},o.prototype.getColor=function(){return this.color_},o.prototype.getLineCap=function(){return this.lineCap_},o.prototype.getLineDash=function(){return this.lineDash_},o.prototype.getLineDashOffset=function(){return this.lineDashOffset_},o.prototype.getLineJoin=function(){return this.lineJoin_},o.prototype.getMiterLimit=function(){return this.miterLimit_},o.prototype.getWidth=function(){return this.width_},o.prototype.setColor=function(e){this.color_=e},o.prototype.setLineCap=function(e){this.lineCap_=e},o.prototype.setLineDash=function(e){this.lineDash_=e},o.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},o.prototype.setLineJoin=function(e){this.lineJoin_=e},o.prototype.setMiterLimit=function(e){this.miterLimit_=e},o.prototype.setWidth=function(e){this.width_=e},o}(),nh=function(){function o(o){var t=o||{};this.geometry_=null,this.geometryFunction_=Sl,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0===t.fill?null:t.fill,this.image_=void 0===t.image?null:t.image,this.renderer_=void 0===t.renderer?null:t.renderer,this.stroke_=void 0===t.stroke?null:t.stroke,this.text_=void 0===t.text?null:t.text,this.zIndex_=t.zIndex}return o.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new o({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},o.prototype.getRenderer=function(){return this.renderer_},o.prototype.setRenderer=function(e){this.renderer_=e},o.prototype.getGeometry=function(){return this.geometry_},o.prototype.getGeometryFunction=function(){return this.geometryFunction_},o.prototype.getFill=function(){return this.fill_},o.prototype.setFill=function(e){this.fill_=e},o.prototype.getImage=function(){return this.image_},o.prototype.setImage=function(e){this.image_=e},o.prototype.getStroke=function(){return this.stroke_},o.prototype.setStroke=function(e){this.stroke_=e},o.prototype.getText=function(){return this.text_},o.prototype.setText=function(e){this.text_=e},o.prototype.getZIndex=function(){return this.zIndex_},o.prototype.setGeometry=function(o){"function"==typeof o?this.geometryFunction_=o:"string"==typeof o?this.geometryFunction_=function(t){return t.get(o)}:o?void 0!==o&&(this.geometryFunction_=function(){return o}):this.geometryFunction_=Sl,this.geometry_=o},o.prototype.setZIndex=function(e){this.zIndex_=e},o}(),ih=null,Vf=nh,lh=function(){function e(o){var t=o||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.text_=t.text,this.textAlign_=t.textAlign,this.textBaseline_=t.textBaseline,this.fill_=void 0===t.fill?new Ul({color:"#333"}):t.fill,this.maxAngle_=void 0===t.maxAngle?dh/4:t.maxAngle,this.placement_=void 0===t.placement?"point":t.placement,this.overflow_=!!t.overflow,this.stroke_=void 0===t.stroke?null:t.stroke,this.offsetX_=void 0===t.offsetX?0:t.offsetX,this.offsetY_=void 0===t.offsetY?0:t.offsetY,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}return e.prototype.clone=function(){return new e({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},e.prototype.getOverflow=function(){return this.overflow_},e.prototype.getFont=function(){return this.font_},e.prototype.getMaxAngle=function(){return this.maxAngle_},e.prototype.getPlacement=function(){return this.placement_},e.prototype.getOffsetX=function(){return this.offsetX_},e.prototype.getOffsetY=function(){return this.offsetY_},e.prototype.getFill=function(){return this.fill_},e.prototype.getRotateWithView=function(){return this.rotateWithView_},e.prototype.getRotation=function(){return this.rotation_},e.prototype.getScale=function(){return this.scale_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.getText=function(){return this.text_},e.prototype.getTextAlign=function(){return this.textAlign_},e.prototype.getTextBaseline=function(){return this.textBaseline_},e.prototype.getBackgroundFill=function(){return this.backgroundFill_},e.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},e.prototype.getPadding=function(){return this.padding_},e.prototype.setOverflow=function(e){this.overflow_=e},e.prototype.setFont=function(e){this.font_=e},e.prototype.setMaxAngle=function(e){this.maxAngle_=e},e.prototype.setOffsetX=function(e){this.offsetX_=e},e.prototype.setOffsetY=function(e){this.offsetY_=e},e.prototype.setPlacement=function(e){this.placement_=e},e.prototype.setRotateWithView=function(e){this.rotateWithView_=e},e.prototype.setFill=function(e){this.fill_=e},e.prototype.setRotation=function(e){this.rotation_=e},e.prototype.setScale=function(e){this.scale_=e},e.prototype.setStroke=function(e){this.stroke_=e},e.prototype.setText=function(e){this.text_=e},e.prototype.setTextAlign=function(e){this.textAlign_=e},e.prototype.setTextBaseline=function(e){this.textBaseline_=e},e.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},e.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},e.prototype.setPadding=function(e){this.padding_=e},e}(),ph=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),mh=function(a){function t(t,e,r){var n=a.call(this)||this,i=r||{};return n.tileCoord=t,n.state=e,n.interimTile=null,n.hifi=!0,n.key="",n.transition_=void 0===i.transition?250:i.transition,n.transitionStarts_={},n}return ph(t,a),t.prototype.changed=function(){this.dispatchEvent(A)},t.prototype.release=function(){},t.prototype.getKey=function(){return this.key+"/"+this.tileCoord},t.prototype.getInterimTile=function(){if(!this.interimTile)return this;var e=this.interimTile;do{if(e.getState()==hi)return this.transition_=0,e;e=e.interimTile}while(e);return this},t.prototype.refreshInterimChain=function(){if(this.interimTile){var o=this.interimTile,r=this;do{if(o.getState()==hi){o.interimTile=null;break}o.getState()==li?r=o:o.getState()==ui?r.interimTile=o.interimTile:r=o,o=r.interimTile}while(o)}},t.prototype.getTileCoord=function(){return this.tileCoord},t.prototype.getState=function(){return this.state},t.prototype.setState=function(e){if(this.state!==ci&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()},t.prototype.load=function(){r()},t.prototype.getAlpha=function(o,t){if(!this.transition_)return 1;var e=this.transitionStarts_[o];if(!e)e=t,this.transitionStarts_[o]=e;else if(-1===e)return 1;var i=t-e+1e3/60;return i>=this.transition_?1:Si(i/this.transition_)},t.prototype.inTransition=function(e){return!!this.transition_&&-1!==this.transitionStarts_[e]},t.prototype.endTransition=function(e){this.transition_&&(this.transitionStarts_[e]=-1)},t}(Rh),xh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wh=function(l){function t(t,e,r,n,i,o){var a=l.call(this,t,e,o)||this;return a.crossOrigin_=n,a.src_=r,a.image_=new Image,null!==n&&(a.image_.crossOrigin=n),a.unlisten_=null,a.tileLoadFunction_=i,a}return xh(t,l),t.prototype.getImage=function(){return this.image_},t.prototype.getKey=function(){return this.src_},t.prototype.handleImageError_=function(){var e;this.state=ci,this.unlistenImage_(),this.image_=((e=Fi(1,1)).fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),e.canvas),this.changed()},t.prototype.handleImageLoad_=function(){var e=this.image_;this.state=e.naturalWidth&&e.naturalHeight?hi:pi,this.unlistenImage_(),this.changed()},t.prototype.load=function(){this.state==ci&&(this.state=ui,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ui&&(this.state=li,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=yl(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(mh),Sh=function(){function e(e){this.highWaterMark=void 0===e?2048:e,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},e.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},e.prototype.forEach=function(o){for(var t=this.oldest_;t;)o(t.value_,t.key_,this),t=t.newer},e.prototype.get=function(e){var t=this.entries_[e];return O(void 0!==t,15),t===this.newest_||(t===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(t.newer.older=t.older,t.older.newer=t.newer),t.newer=null,t.older=this.newest_,this.newest_.newer=t,this.newest_=t),t.value_},e.prototype.remove=function(o){var t=this.entries_[o];return O(void 0!==t,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[o],--this.count_,t.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var o=Array(this.count_),e=0,n;for(n=this.newest_;n;n=n.older)o[e++]=n.key_;return o},e.prototype.getValues=function(){var o=Array(this.count_),e=0,n;for(n=this.newest_;n;n=n.older)o[e++]=n.value_;return o},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},e.prototype.replace=function(o,t){this.get(o),this.entries_[o].value_=t},e.prototype.set=function(o,t){O(!(o in this.entries_),16);var e={key_:o,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=e:this.oldest_=e,this.newest_=e,this.entries_[o]=e,++this.count_},e.prototype.setSize=function(e){this.highWaterMark=e},e}(),Eh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Th=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Eh(t,o),t.prototype.expireCache=function(e){for(;this.canExpireCache()&&!(this.peekLast().getKey()in e);)this.pop().release()},t.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var o=qa(this.peekFirstKey())[0];this.forEach(function(t){t.tileCoord[0]!==o&&(this.remove(Ha(t.tileCoord)),t.release())}.bind(this))}},t}(Sh),Ch=function(){function e(m,t,e,r,n,i){this.sourceProj_=m,this.targetProj_=t;var o={},x=Qe(this.targetProj_,this.sourceProj_);this.transformInv_=function(r){var t=r[0]+"/"+r[1];return o[t]||(o[t]=x(r)),o[t]},this.maxSourceExtent_=r,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&Gt(r)==Gt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Gt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Gt(this.targetProj_.getExtent()):null;var s=Nt(e),u=At(e),l=It(e),h=Lt(e),c=this.transformInv_(s),p=this.transformInv_(u),f=this.transformInv_(l),d=this.transformInv_(h),_=10+(i?C(0,F(Math.log2(wt(e)/(256*(256*(i*i)))))):0);if(this.addQuad_(s,u,l,h,c,p,f,d,_),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach(function(e){g=E(g,e.source[0][0],e.source[1][0],e.source[2][0])}),this.triangles_.forEach(function(o){if(C(o.source[0][0],o.source[1][0],o.source[2][0])-g>this.sourceWorldWidth_/2){var t=[[o.source[0][0],o.source[0][1]],[o.source[1][0],o.source[1][1]],[o.source[2][0],o.source[2][1]]];t[0][0]-g>this.sourceWorldWidth_/2&&(t[0][0]-=this.sourceWorldWidth_),t[1][0]-g>this.sourceWorldWidth_/2&&(t[1][0]-=this.sourceWorldWidth_),t[2][0]-g>this.sourceWorldWidth_/2&&(t[2][0]-=this.sourceWorldWidth_);var e=E(t[0][0],t[1][0],t[2][0]);C(t[0][0],t[1][0],t[2][0])-e<this.sourceWorldWidth_/2&&(o.source=t)}}.bind(this))}o={}}return e.prototype.addTriangle_=function(a,t,e,r,n,i){this.triangles_.push({source:[r,n,i],target:[a,t,e]})},e.prototype.addQuad_=function(R,t,e,r,n,i,o,a,s){var u=Y([n,i,o,a]),l=this.sourceWorldWidth_?Gt(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,c=this.sourceProj_.canWrapX()&&.5<l&&1>l,p=!1;if(0<s&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(p=.25<Gt(Y([R,t,e,r]))/this.targetWorldWidth_||p),!c&&this.sourceProj_.isGlobal()&&l&&(p=.25<l||p)),p||!this.maxSourceExtent_||Dt(u,this.maxSourceExtent_)){if(!(p||isFinite(n[0])&&isFinite(n[1])&&isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(0<s))return;p=!0}if(0<s){if(!p){var L=[(R[0]+e[0])/2,(R[1]+e[1])/2],d=this.transformInv_(L),_;_=c?(_e(n[0],h)+_e(o[0],h))/2-_e(d[0],h):(n[0]+o[0])/2-d[0];var I=(n[1]+o[1])/2-d[1];p=_*_+I*I>this.errorThresholdSquared_}if(p){if(P(R[0]-e[0])<=P(R[1]-e[1])){var y=[(t[0]+e[0])/2,(t[1]+e[1])/2],v=this.transformInv_(y),m=[(r[0]+R[0])/2,(r[1]+R[1])/2],x=this.transformInv_(m);this.addQuad_(R,t,y,m,n,i,v,x,s-1),this.addQuad_(m,y,e,r,x,v,o,a,s-1)}else{var w=[(R[0]+t[0])/2,(R[1]+t[1])/2],S=this.transformInv_(w),E=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(E);this.addQuad_(R,w,E,r,n,S,T,a,s-1),this.addQuad_(w,t,e,E,S,i,o,T,s-1)}return}}if(c){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(R,e,r,n,o,a),this.addTriangle_(R,t,e,n,i,o)}},e.prototype.calculateSourceExtent=function(){var o=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(t){var e=t.source;Et(o,e[0]),Et(o,e[1]),Et(o,e[2])}),o},e.prototype.getTriangles=function(){return this.triangles_},e}(),Oh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ih=function(P){function t(t,e,r,n,i,o,a,s,u,l,h){var c=P.call(this,i,ui)||this;c.renderEdges_=void 0!==h&&h,c.pixelRatio_=a,c.gutter_=s,c.canvas_=null,c.sourceTileGrid_=e,c.targetTileGrid_=n,c.wrappedTileCoord_=o||i,c.sourceTiles_=[],c.sourcesListenerKeys_=null,c.sourceZ_=0;var p=n.getTileCoordExtent(c.wrappedTileCoord_),f=c.targetTileGrid_.getExtent(),d=c.sourceTileGrid_.getExtent(),R=f?Mt(p,f):p;if(0===wt(R))return c.state=pi,c;var g=t.getExtent();g&&(d=d?Mt(d,g):g);var y=n.getResolution(c.wrappedTileCoord_[0]),L=Nl(t,r,vt(R),y);if(!isFinite(L)||0>=L)return c.state=pi,c;var m=void 0===l?.5:l;if(c.triangulation_=new Ch(t,r,R,d,L*m,y),0===c.triangulation_.getTriangles().length)return c.state=pi,c;c.sourceZ_=e.getZForResolution(L);var x=c.triangulation_.calculateSourceExtent();if(d&&(t.canWrapX()?(x[1]=le(x[1],d[1],d[3]),x[3]=le(x[3],d[1],d[3])):x=Mt(x,d)),wt(x)){for(var I=e.getTileRangeForExtentAndZ(x,c.sourceZ_),S=I.minX;S<=I.maxX;S++)for(var v=I.minY,b;v<=I.maxY;v++)b=u(c.sourceZ_,S,v,a),b&&c.sourceTiles_.push(b);0===c.sourceTiles_.length&&(c.state=pi)}else c.state=pi;return c}return Oh(t,P),t.prototype.getImage=function(){return this.canvas_},t.prototype.reproject_=function(){var l=[];if(this.sourceTiles_.forEach(function(t){t&&t.getState()==hi&&l.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===l.length)this.state=ci;else{var t=this.wrappedTileCoord_[0],e=this.targetTileGrid_.getTileSize(t),r="number"==typeof e?e:e[0],n="number"==typeof e?e:e[1],i=this.targetTileGrid_.getResolution(t),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Zl(r,n,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),i,a,this.triangulation_,l,this.gutter_,this.renderEdges_),this.state=hi}this.changed()},t.prototype.load=function(){if(this.state==ui){this.state=li,this.changed();var r=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(t){var e=t.getState();if(e==ui||e==li){r++;var i=_(t,A,function(){var e=t.getState();e!=hi&&e!=ci&&e!=pi||(y(i),0==--r&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(i)}}.bind(this)),this.sourceTiles_.forEach(function(e){e.getState()==ui&&e.load()}),0==r&&setTimeout(this.reproject_.bind(this),0)}},t.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(y),this.sourcesListenerKeys_=null},t}(mh),Lh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Fh=function(o){function t(t){var e=o.call(this)||this;return e.projection_=Ve(t.projection),e.attributions_=Cp(t.attributions),e.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,e.loading=!1,e.state_=void 0===t.state?go:t.state,e.wrapX_=void 0!==t.wrapX&&t.wrapX,e}return Lh(t,o),t.prototype.getAttributions=function(){return this.attributions_},t.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},t.prototype.getProjection=function(){return this.projection_},t.prototype.getResolutions=function(){return r()},t.prototype.getState=function(){return this.state_},t.prototype.getWrapX=function(){return this.wrapX_},t.prototype.refresh=function(){this.changed()},t.prototype.setAttributions=function(e){this.attributions_=Cp(e),this.changed()},t.prototype.setState=function(e){this.state_=e,this.changed()},t}(tt),Ah=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nh=function(l){function t(t){var e=l.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX})||this;e.opaque_=void 0!==t.opaque&&t.opaque,e.tilePixelRatio_=void 0===t.tilePixelRatio?1:t.tilePixelRatio,e.tileGrid=void 0===t.tileGrid?null:t.tileGrid;var r=[256,256],n=t.tileGrid;n&&Eo(n.getTileSize(n.getMinZoom()),r);var i="undefined"!=typeof screen,o=i?screen.availWidth||screen.width:1920,a=i?screen.availHeight||screen.height:1080,s=4*F(o/r[0])*F(a/r[1]);return e.tileCache=new Th(C(s,t.cacheSize||0)),e.tmpSize=[0,0],e.key_=t.key||"",e.tileOptions={transition:t.transition},e.zDirection=t.zDirection?t.zDirection:0,e}return Ah(t,l),t.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},t.prototype.expireCache=function(o,t){var e=this.getTileCacheForProjection(o);e&&e.expireCache(t)},t.prototype.forEachLoadedTile=function(p,t,e,r){var n=this.getTileCacheForProjection(p);if(!n)return!1;for(var i=!0,d=e.minX,_,g,c;d<=e.maxX;++d)for(var y=e.minY;y<=e.maxY;++y)g=Wa(t,d,y),c=!1,n.containsKey(g)&&(c=(_=n.get(g)).getState()===hi)&&(c=!1!==r(_)),c||(i=!1);return i},t.prototype.getGutterForProjection=function(){return 0},t.prototype.getKey=function(){return this.key_},t.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},t.prototype.getOpaque=function(){return this.opaque_},t.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},t.prototype.getTile=function(){return r()},t.prototype.getTileGrid=function(){return this.tileGrid},t.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:Qa(e)},t.prototype.getTileCacheForProjection=function(o){var t=this.getProjection();return t&&!qe(t,o)?null:this.tileCache},t.prototype.getTilePixelRatio=function(){return this.tilePixelRatio_},t.prototype.getTilePixelSize=function(a,t,e){var r=this.getTileGridForProjection(e),n=this.getTilePixelRatio(t),i=Eo(r.getTileSize(a),this.tmpSize);return 1==n?i:So(i,n,this.tmpSize)},t.prototype.getTileCoordForTileUrlFunction=function(o,i){var e=void 0===i?this.getProjection():i,r=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(o=function(l,t,e){var r=t[0],n=l.getTileCoordCenter(t),i=as(e);if(pt(i,n))return t;var o=Gt(i),a=F((i[0]-n[0])/o);return n[0]+=o*a,l.getTileCoordForCoordAndZ(n,r)}(r,o,e)),function(s,t){var e=s[0],r=s[1],n=s[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;var i=t.getExtent(),a;return!(a=i?t.getTileRangeForExtentAndZ(i,e):t.getFullTileRange(e))||a.containsXY(r,n)}(o,r)?o:null},t.prototype.clear=function(){this.tileCache.clear()},t.prototype.refresh=function(){this.clear(),l.prototype.refresh.call(this)},t.prototype.useTile=function(){},t}(Fh),Gh=function(o){function t(t,e){var r=o.call(this,t)||this;return r.tile=e,r}return Ah(t,o),t}(fh),jh=Nh,Dh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bh=function(o){function t(t){var e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return e.generateTileUrlFunction_=!t.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,e.tileUrlFunction=t.tileUrlFunction?t.tileUrlFunction.bind(e):Pl,e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.tileLoadingKeys_={},e}return Dh(t,o),t.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},t.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},t.prototype.getUrls=function(){return this.urls},t.prototype.handleTileChange=function(o){var t=o.target,r=X(t),n=t.getState(),i;n==li?(this.tileLoadingKeys_[r]=!0,i="tileloadstart"):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],i=n==ci?"tileloaderror":n==hi?"tileloadend":void 0),null!=i&&this.dispatchEvent(new Gh(i,t))},t.prototype.setTileLoadFunction=function(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()},t.prototype.setTileUrlFunction=function(o,t){this.tileUrlFunction=o,this.tileCache.pruneExceptNewestZ(),void 0===t?this.changed():this.setKey(t)},t.prototype.setUrl=function(o){var t=Rl(o);this.urls=t,this.setUrls(t)},t.prototype.setUrls=function(o){this.urls=o;var t=o.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Tl(o,this.tileGrid),t):this.setKey(t)},t.prototype.useTile=function(o,t,e){var r=Wa(o,t,e);this.tileCache.containsKey(r)&&this.tileCache.get(r)},t}(jh),Yh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vh=function(o){function t(t){var e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Pp,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return e.crossOrigin=void 0===t.crossOrigin?null:t.crossOrigin,e.tileClass=void 0===t.tileClass?wh:t.tileClass,e.tileCacheForProjection={},e.tileGridForProjection={},e.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,e.renderReprojectionEdges_=!1,e}return Yh(t,o),t.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},t.prototype.expireCache=function(o,t){var e=this.getTileCacheForProjection(o);for(var r in this.tileCache.expireCache(this.tileCache==e?t:{}),this.tileCacheForProjection){var n=this.tileCacheForProjection[r];n.expireCache(n==e?t:{})}},t.prototype.getGutterForProjection=function(e){return this.getProjection()&&e&&!qe(this.getProjection(),e)?0:this.getGutter()},t.prototype.getGutter=function(){return 0},t.prototype.getOpaque=function(t){return!(this.getProjection()&&t&&!qe(this.getProjection(),t))&&o.prototype.getOpaque.call(this,t)},t.prototype.getTileGridForProjection=function(o){var t=this.getProjection();if(!this.tileGrid||t&&!qe(t,o)){var e=X(o);return e in this.tileGridForProjection||(this.tileGridForProjection[e]=Qa(o)),this.tileGridForProjection[e]}return this.tileGrid},t.prototype.getTileCacheForProjection=function(o){var t=this.getProjection();if(!t||qe(t,o))return this.tileCache;var e=X(o);return e in this.tileCacheForProjection||(this.tileCacheForProjection[e]=new Th(this.tileCache.highWaterMark)),this.tileCacheForProjection[e]},t.prototype.createTile_=function(p,t,e,r,n,i){var o=[p,t,e],a=this.getTileCoordForTileUrlFunction(o,n),s=a?this.tileUrlFunction(a,r,n):void 0,d=new this.tileClass(o,void 0===s?pi:ui,void 0===s?"":s,this.crossOrigin,this.tileLoadFunction,this.tileOptions);return d.key=i,d.addEventListener(A,this.handleTileChange.bind(this)),d},t.prototype.getTile=function(_,t,e,r,n){var i=this.getProjection();if(i&&n&&!qe(i,n)){var o=this.getTileCacheForProjection(n),a=[_,t,e],s=Ha(a),l;o.containsKey(s)&&(l=o.get(s));var g=this.getKey();if(l&&l.key==g)return l;var y=this.getTileGridForProjection(i),c=this.getTileGridForProjection(n),p=this.getTileCoordForTileUrlFunction(a,n),m=new Ih(i,y,n,c,a,p,this.getTilePixelRatio(r),this.getGutter(),function(o,t,e,r){return this.getTileInternal(o,t,e,r,i)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return m.key=g,l?(m.interimTile=l,m.refreshInterimChain(),o.replace(s,m)):o.set(s,m),m}return this.getTileInternal(_,t,e,r,i||n)},t.prototype.getTileInternal=function(l,t,e,r,n){var i=null,p=Wa(l,t,e),a=this.getKey();if(!this.tileCache.containsKey(p))i=this.createTile_(l,t,e,r,n,a),this.tileCache.set(p,i);else if((i=this.tileCache.get(p)).key!=a){var s=i;i=this.createTile_(l,t,e,r,n,a),i.interimTile=s.getState()==ui?s.interimTile:s,i.refreshInterimChain(),this.tileCache.replace(p,i)}return i},t.prototype.setRenderReprojectionEdges=function(o){if(this.renderReprojectionEdges_!=o){for(var t in this.renderReprojectionEdges_=o,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}},t.prototype.setTileGridForProjection=function(o,t){var e=Ve(o);if(e){var r=X(e);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}},t}(Bh),Wh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zh=function(o){function t(t){var e=this,i=void 0!==t.hidpi&&t.hidpi;return(e=o.call(this,{cacheSize:t.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:Ve("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:_o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:i?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this).hidpi_=i,e.culture_=void 0===t.culture?"en-us":t.culture,e.maxZoom_=void 0===t.maxZoom?-1:t.maxZoom,e.apiKey_=t.key,e.imagerySet_=t.imagerySet,wl("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+e.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+e.apiKey_+"&c="+e.culture_,e.handleImageryMetadataResponse.bind(e),void 0,"jsonp"),e}return Wh(t,o),t.prototype.getApiKey=function(){return this.apiKey_},t.prototype.getImagerySet=function(){return this.imagerySet_},t.prototype.handleImageryMetadataResponse=function(d){if(200==d.statusCode&&"OK"==d.statusDescription&&"ValidCredentials"==d.authenticationResultCode&&1==d.resourceSets.length&&1==d.resourceSets[0].resources.length){var _=d.resourceSets[0].resources[0],e=-1==this.maxZoom_?_.zoomMax:this.maxZoom_,t=as(this.getProjection()),r=this.hidpi_?2:1,n=_.imageWidth==_.imageHeight?_.imageWidth/r:[_.imageWidth/r,_.imageHeight/r],o=rs({extent:t,minZoom:_.zoomMin,maxZoom:e,tileSize:n});this.tileGrid=o;var i=this.culture_,a=this.hidpi_;if(this.tileUrlFunction=Cl(_.imageUrlSubdomains.map(function(e){var s=[0,0,0],r=_.imageUrl.replace("{subdomain}",e).replace("{culture}",i);return function(e){if(e){Ua(e[0],e[1],e[2],s);var t=r;return a&&(t+="&dpi=d1&device=mobile"),t.replace("{quadkey}",function(a){var t=a[0],n=Array(t),i=1<<t-1,s,l;for(s=0;s<t;++s)l=48,a[1]&i&&(l+=1),a[2]&i&&(l+=2),n[s]=p(l),i>>=1;return n.join("")}(s))}}})),_.imageryProviders){var s=Je(Ve("EPSG:4326"),this.getProjection());this.setAttributions(function(e){var t=[],r=e.viewState,n=this.getTileGrid(),i=n.getZForResolution(r.resolution,this.zDirection),l=n.getTileCoordForCoordAndZ(r.center,i)[0];return _.imageryProviders.map(function(r){for(var a=!1,p=r.coverageAreas,i=0,d=p.length,_;i<d;++i)if(_=p[i],l>=_.zoomMin&&l<=_.zoomMax){var g=_.bbox;if(Dt(zt([g[1],g[0],g[3],g[2]],s),e.extent)){a=!0;break}}a&&t.push(r.attribution)}),t.push("<a class=\"ol-attribution-bing-tos\" href=\"https://www.microsoft.com/maps/product/terms.html\" target=\"_blank\">Terms of Use</a>"),t}.bind(this))}this.setState(go)}else this.setState(yo)},t}(Vh),Kh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qh=function(o){function t(t){var e=t||{},r=void 0===e.projection?"EPSG:3857":e.projection,n=void 0===e.tileGrid?rs({extent:as(r),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize}):e.tileGrid;return o.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,opaque:e.opaque,projection:r,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this}return Kh(t,o),t}(Vh),Hh=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jh=function(o){function t(t){var e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,maxZoom:void 0===t.maxZoom?18:t.maxZoom,minZoom:t.minZoom,projection:t.projection,wrapX:t.wrapX})||this;return e.account_=t.account,e.mapId_=t.map||"",e.config_=t.config||{},e.templateCache_={},e.initializeMap_(),e}return Hh(t,o),t.prototype.getConfig=function(){return this.config_},t.prototype.updateConfig=function(e){yh(this.config_,e),this.initializeMap_()},t.prototype.setConfig=function(e){this.config_=e||{},this.initializeMap_()},t.prototype.initializeMap_=function(){var o=JSON.stringify(this.config_);if(this.templateCache_[o])this.applyTemplate_(this.templateCache_[o]);else{var t="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(t+="/named/"+this.mapId_);var n=new XMLHttpRequest;n.addEventListener("load",this.handleInitResponse_.bind(this,o)),n.addEventListener("error",this.handleInitError_.bind(this)),n.open("POST",t),n.setRequestHeader("Content-type","application/json"),n.send(JSON.stringify(this.config_))}},t.prototype.handleInitResponse_=function(o,t){var e=t.target;if(!e.status||200<=e.status&&300>e.status){var r;try{r=JSON.parse(e.responseText)}catch(e){return void this.setState(yo)}this.applyTemplate_(r),this.templateCache_[o]=r,this.setState(go)}else this.setState(yo)},t.prototype.handleInitError_=function(){this.setState(yo)},t.prototype.applyTemplate_=function(o){var t="https://"+o.cdn_url.https+"/"+this.account_+"/api/v1/map/"+o.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(t)},t}(qh),Qh="addfeature",$h="changefeature",tc="clear",ec="removefeature",rc=e(0),nc=e.n(rc),ic=function(){function e(e){this.rbush_=new nc.a(e),this.items_={}}return e.prototype.insert=function(o,t){var e={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:t};this.rbush_.insert(e),this.items_[X(t)]=e},e.prototype.load=function(o,t){for(var e=Array(t.length),r=0,l=t.length;r<l;r++){var i=o[r],a=t[r],s={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3],value:a};e[r]=s,this.items_[X(a)]=s}this.rbush_.load(e)},e.prototype.remove=function(o){var t=X(o),e=this.items_[t];return delete this.items_[t],null!==this.rbush_.remove(e)},e.prototype.update=function(o,t){var e=this.items_[X(t)];xt([e.minX,e.minY,e.maxX,e.maxY],o)||(this.remove(t),this.insert(o,t))},e.prototype.getAll=function(){return this.rbush_.all().map(function(e){return e.value})},e.prototype.getInExtent=function(o){var t={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]};return this.rbush_.search(t).map(function(e){return e.value})},e.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},e.prototype.forEachInExtent=function(o,t){return this.forEach_(this.getInExtent(o),t)},e.prototype.forEach_=function(o,t){for(var e=0,a=o.length,i;e<a;e++)if(i=t(o[e]))return i;return i},e.prototype.isEmpty=function(){return f(this.items_)},e.prototype.clear=function(){this.rbush_.clear(),this.items_={}},e.prototype.getExtent=function(o){var t=this.rbush_.toJSON();return yt(t.minX,t.minY,t.maxX,t.maxY,o)},e.prototype.concat=function(o){for(var t in this.rbush_.load(o.rbush_.all()),o.items_)this.items_[t]=o.items_[t]},e}(),oc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ac=function(o){function t(t,e){var r=o.call(this,t)||this;return r.feature=e,r}return oc(t,o),t}(fh),sc=function(s){function t(t){var e=this,l=t||{};(e=s.call(this,{attributions:l.attributions,projection:void 0,state:go,wrapX:void 0===l.wrapX||l.wrapX})||this).loader_=b,e.format_=l.format,e.overlaps_=void 0===l.overlaps||l.overlaps,e.url_=l.url,void 0===l.loader?void 0!==e.url_&&(O(e.format_,7),e.loader_=Oa(e.url_,e.format_)):e.loader_=l.loader,e.strategy_=void 0===l.strategy?Ma:l.strategy;var n=void 0===l.useSpatialIndex||l.useSpatialIndex,a,p;return e.featuresRtree_=n?new ic:null,e.loadedExtentsRtree_=new ic,e.nullGeometryFeatures_={},e.idIndex_={},e.uidIndex_={},e.featureChangeKeys_={},e.featuresCollection_=null,Array.isArray(l.features)?p=l.features:l.features&&(p=(a=l.features).getArray()),n||void 0!==a||(a=new ot(p)),void 0!==p&&e.addFeaturesInternal(p),void 0!==a&&e.bindFeaturesCollection_(a),e}return oc(t,s),t.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},t.prototype.addFeatureInternal=function(o){var t=X(o);if(this.addToIndex_(t,o)){this.setupChangeEvents_(t,o);var e=o.getGeometry();if(e){var r=e.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,o)}else this.nullGeometryFeatures_[t]=o;this.dispatchEvent(new ac(Qh,o))}else this.featuresCollection_&&this.featuresCollection_.remove(o)},t.prototype.setupChangeEvents_=function(o,t){this.featureChangeKeys_[o]=[_(t,A,this.handleFeatureChange_,this),_(t,h,this.handleFeatureChange_,this)]},t.prototype.addToIndex_=function(o,t){var e=!0,i=t.getId();return void 0!==i&&(i.toString()in this.idIndex_?e=!1:this.idIndex_[i.toString()]=t),e&&(O(!(o in this.uidIndex_),30),this.uidIndex_[o]=t),e},t.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},t.prototype.addFeaturesInternal=function(o){for(var t=[],e=[],r=[],n=0,d=o.length,a;n<d;n++)a=X(g=o[n]),this.addToIndex_(a,g)&&e.push(g);n=0;for(var _=e.length;n<_;n++){var g;a=X(g=e[n]),this.setupChangeEvents_(a,g);var u=g.getGeometry();if(u){var y=u.getExtent();t.push(y),r.push(g)}else this.nullGeometryFeatures_[a]=g}this.featuresRtree_&&this.featuresRtree_.load(t,r),n=0;for(var c=e.length;n<c;n++)this.dispatchEvent(new ac(Qh,e[n]))},t.prototype.bindFeaturesCollection_=function(o){var n=!1;this.addEventListener(Qh,function(e){n||(n=!0,o.push(e.feature),n=!1)}),this.addEventListener(ec,function(e){n||(n=!0,o.remove(e.feature),n=!1)}),o.addEventListener(u,function(e){n||(n=!0,this.addFeature(e.element),n=!1)}.bind(this)),o.addEventListener(l,function(e){n||(n=!0,this.removeFeature(e.element),n=!1)}.bind(this)),this.featuresCollection_=o},t.prototype.clear=function(o){if(o){for(var t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(y);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var e in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[e]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var r=new ac(tc);this.dispatchEvent(r),this.changed()},t.prototype.forEachFeature=function(e){return this.featuresRtree_?this.featuresRtree_.forEach(e):void(this.featuresCollection_&&this.featuresCollection_.forEach(e))},t.prototype.forEachFeatureAtCoordinateDirect=function(o,t){var e=[o[0],o[1],o[0],o[1]];return this.forEachFeatureInExtent(e,function(e){return e.getGeometry().intersectsCoordinate(o)?t(e):void 0})},t.prototype.forEachFeatureInExtent=function(o,t){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(o,t):void(this.featuresCollection_&&this.featuresCollection_.forEach(t))},t.prototype.forEachFeatureIntersectingExtent=function(o,t){return this.forEachFeatureInExtent(o,function(e){if(e.getGeometry().intersectsExtent(o)){var r=t(e);if(r)return r}})},t.prototype.getFeaturesCollection=function(){return this.featuresCollection_},t.prototype.getFeatures=function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),f(this.nullGeometryFeatures_)||v(e,c(this.nullGeometryFeatures_))),e},t.prototype.getFeaturesAtCoordinate=function(o){var r=[];return this.forEachFeatureAtCoordinateDirect(o,function(e){r.push(e)}),r},t.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_?this.featuresRtree_.getInExtent(e):this.featuresCollection_?this.featuresCollection_.getArray():[]},t.prototype.getClosestFeatureToCoordinate=function(l,t){var p=l[0],r=l[1],e=null,n=[NaN,NaN],o=1/0,d=[-1/0,-1/0,1/0,1/0];return this.featuresRtree_.forEachInExtent(d,function(i){if((t||T)(i)){var t=i.getGeometry(),a=o;if((o=t.closestPointXY(p,r,n,o))<a){e=i;var s=ee(o);d[0]=p-s,d[1]=r-s,d[2]=p+s,d[3]=r+s}}}),e},t.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},t.prototype.getFeatureById=function(o){var t=this.idIndex_[o.toString()];return void 0===t?null:t},t.prototype.getFeatureByUid=function(o){var t=this.uidIndex_[o];return void 0===t?null:t},t.prototype.getFormat=function(){return this.format_},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.getUrl=function(){return this.url_},t.prototype.handleFeatureChange_=function(o){var t=o.target,e=X(t),r=t.getGeometry();if(r){var n=r.getExtent();e in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[e],this.featuresRtree_&&this.featuresRtree_.insert(n,t)):this.featuresRtree_&&this.featuresRtree_.update(n,t)}else e in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[e]=t);var i=t.getId();if(void 0!==i){var a=i.toString();this.idIndex_[a]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[a]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[e]=t;this.changed(),this.dispatchEvent(new ac($h,t))},t.prototype.hasFeature=function(o){var t=o.getId();return void 0===t?X(o)in this.uidIndex_:t in this.idIndex_},t.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&f(this.nullGeometryFeatures_)},t.prototype.loadFeatures=function(l,p,e){var r=this.loadedExtentsRtree_,n=this.strategy_(l,p);this.loading=!1;for(var t=function(i){var a=n[i];r.forEachInExtent(a,function(e){return dt(e.extent,a)})||(o.loader_.call(o,a,p,e),r.insert(a,{extent:a.slice()}),o.loading=o.loader_!==b)},o=this,i=0,a=n.length;i<a;++i)t(i)},t.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),s.prototype.refresh.call(this)},t.prototype.removeLoadedExtent=function(o){var t=this.loadedExtentsRtree_,n;t.forEachInExtent(o,function(e){if(xt(e.extent,o))return n=e,!0}),n&&t.remove(n)},t.prototype.removeFeature=function(o){var t=X(o);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(o),this.removeFeatureInternal(o),this.changed()},t.prototype.removeFeatureInternal=function(o){var t=X(o);this.featureChangeKeys_[t].forEach(y),delete this.featureChangeKeys_[t];var e=o.getId();void 0!==e&&delete this.idIndex_[e.toString()],delete this.uidIndex_[t],this.dispatchEvent(new ac(ec,o))},t.prototype.removeFromIdIndex_=function(o){var t=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===o){delete this.idIndex_[n],t=!0;break}return t},t.prototype.setLoader=function(e){this.loader_=e},t.prototype.setUrl=function(e){O(this.format_,7),this.setLoader(Oa(e,this.format_))},t}(Fh),uc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lc=function(o){function t(t){var e=o.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return e.resolution=void 0,e.distance=void 0===t.distance?20:t.distance,e.features=[],e.geometryFunction=t.geometryFunction||function(o){var t=o.getGeometry();return O(t.getType()==oe.POINT,10),t},e.boundRefresh_=e.refresh.bind(e),e.setSource(t.source||null),e}return uc(t,o),t.prototype.clear=function(t){this.features.length=0,o.prototype.clear.call(this,t)},t.prototype.getDistance=function(){return this.distance},t.prototype.getSource=function(){return this.source},t.prototype.loadFeatures=function(o,t,e){this.source.loadFeatures(o,t,e),t!==this.resolution&&(this.clear(),this.resolution=t,this.cluster(),this.addFeatures(this.features))},t.prototype.setDistance=function(e){this.distance=e,this.refresh()},t.prototype.setSource=function(e){this.source&&this.source.removeEventListener(A,this.boundRefresh_),this.source=e,e&&e.addEventListener(A,this.boundRefresh_),this.refresh()},t.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},t.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var o=[1/0,1/0,-1/0,-1/0],t=this.distance*this.resolution,e=this.source.getFeatures(),r={},n=0,p=e.length,a;n<p;n++)if(a=e[n],!(X(a)in r)){var d=this.geometryFunction(a);if(d){ht(d.getCoordinates(),o),V(o,t,o);var _=this.source.getFeaturesInExtent(o);_=_.filter(function(o){var t=X(o);return!(t in r)&&(r[t]=!0,!0)}),this.features.push(this.createCluster(_))}}},t.prototype.createCluster=function(o){for(var t=[0,0],e=o.length-1,a;0<=e;--e)a=this.geometryFunction(o[e]),a?pn(t,a.getCoordinates()):o.splice(e,1);$n(t,1/o.length);var s=new ut(new Zr(t));return s.set("features",o),s},t}(sc),hc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cc="default",pc=function(l){function t(t,e,r,n,i,o,a){var s=l.call(this,e,r,n,i,o,a)||this;return s.zoomifyImage_=null,s.tileSize_=t,s}return hc(t,l),t.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var t=l.prototype.getImage.call(this);if(this.state==hi){var e=this.tileSize_;if(t.width==e[0]&&t.height==e[1])return this.zoomifyImage_=t,t;var o=Fi(e[0],e[1]);return o.drawImage(t,0,0),this.zoomifyImage_=o.canvas,o.canvas}return t},t}(wh),dc=function(P){function t(t){var e=this,R=t,n=R.size,i=void 0===R.tierSizeCalculation?cc:R.tierSizeCalculation,o=R.tilePixelRatio||1,a=n[0],s=n[1],L=[],l=R.tileSize||256,u=l*o;switch(i){case cc:for(;a>u||s>u;)L.push([F(a/u),F(s/u)]),u+=u;break;case"truncated":for(var h=a,I=s;h>u||I>u;)L.push([F(h/u),F(I/u)]),h>>=1,I>>=1;break;default:O(!1,53);}L.push([1,1]),L.reverse();for(var b=[o],d=[0],_=1,M=L.length;_<M;_++)b.push(o<<_),d.push(L[_-1][0]*L[_-1][1]+d[_-1]);b.reverse();var y=new Mu({tileSize:l,extent:R.extent||[0,-s,a,0],resolutions:b}),v=R.url;v&&-1==v.indexOf("{TileGroup}")&&-1==v.indexOf("{tileIndex}")&&(v+="{TileGroup}/{z}-{x}-{y}.jpg");var N=Rl(v),x=l*o,A=Cl(N.map(function(r){return function(t){if(t){var e=t[0],n=t[1],o=t[2],i=n+o*L[e][0],a={z:e,x:n,y:o,tileIndex:i,TileGroup:"TileGroup"+(0|(i+d[e])/x)};return r.replace(/\{(\w+?)\}/g,function(o,t){return a[t]})}}})),S=pc.bind(null,Eo(l*o));(e=P.call(this,{attributions:R.attributions,cacheSize:R.cacheSize,crossOrigin:R.crossOrigin,projection:R.projection,tilePixelRatio:o,reprojectionErrorThreshold:R.reprojectionErrorThreshold,tileClass:S,tileGrid:y,tileUrlFunction:A,transition:R.transition})||this).zDirection=R.zDirection;var E=A(y.getTileCoordForCoordAndResolution(vt(y.getExtent()),b[b.length-1]),1,null),T=new Image;return T.addEventListener("error",function(){x=l,this.changed()}.bind(e)),T.src=E,e}return hc(t,P),t}(Vh),_c="version1",gc="version2",yc="version3",vc={},mc,Xf,ex,ox;vc[_c]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},vc[gc]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},vc[yc]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},vc.none={none:{supports:[],formats:[],qualities:[]}};var rx=/^https?:\/\/iiif.io\/api\/image\/2\/level[0-2](.json)?$/,wc={};wc[_c]=function(o){var t=o.getComplianceLevelSupportedFeatures();return void 0===t&&(t=vc[_c].level0),{url:void 0===o.imageInfo["@id"]?void 0:o.imageInfo["@id"].replace(/\/?(info.json)?$/g,""),supports:t.supports,formats:t.formats.concat([void 0===o.imageInfo.formats?[]:o.imageInfo.formats]),qualities:t.qualities.concat([void 0===o.imageInfo.qualities?[]:o.imageInfo.qualities]),resolutions:o.imageInfo.scale_factors,tileSize:void 0===o.imageInfo.tile_width?null==o.imageInfo.tile_height?void 0:[o.imageInfo.tile_height,o.imageInfo.tile_height]:void 0===o.imageInfo.tile_height?[o.imageInfo.tile_width,o.imageInfo.tile_width]:[o.imageInfo.tile_width,o.imageInfo.tile_height]}},wc[gc]=function(a){var t=a.getComplianceLevelSupportedFeatures(),e=Array.isArray(a.imageInfo.profile)&&1<a.imageInfo.profile.length,r=e&&a.imageInfo.profile[1].supports?a.imageInfo.profile[1].supports:[],n=e&&a.imageInfo.profile[1].formats?a.imageInfo.profile[1].formats:[],i=e&&a.imageInfo.profile[1].qualities?a.imageInfo.profile[1].qualities:[];return{url:a.imageInfo["@id"].replace(/\/?(info.json)?$/g,""),sizes:void 0===a.imageInfo.sizes?void 0:a.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===a.imageInfo.tiles?void 0:[a.imageInfo.tiles.map(function(e){return e.width})[0],a.imageInfo.tiles.map(function(e){return void 0===e.height?e.width:e.height})[0]],resolutions:void 0===a.imageInfo.tiles?void 0:a.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:t.supports.concat(r),formats:t.formats.concat(n),qualities:t.qualities.concat(i)}},wc[yc]=function(o){var t=o.getComplianceLevelSupportedFeatures(),i=void 0===o.imageInfo.extraFormats?t.formats:t.formats.concat(o.imageInfo.extraFormats),e=void 0!==o.imageInfo.preferredFormats&&Array.isArray(o.imageInfo.preferredFormats)&&0<o.imageInfo.preferredFormats.length?o.imageInfo.preferredFormats.filter(function(e){return["jpg","png","gif"].includes(e)}).reduce(function(o,t){return void 0===o&&i.includes(t)?t:o},void 0):void 0;return{url:o.imageInfo.id,sizes:void 0===o.imageInfo.sizes?void 0:o.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===o.imageInfo.tiles?void 0:[o.imageInfo.tiles.map(function(e){return e.width})[0],o.imageInfo.tiles.map(function(e){return e.height})[0]],resolutions:void 0===o.imageInfo.tiles?void 0:o.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:void 0===o.imageInfo.extraFeatures?t.supports:t.supports.concat(o.imageInfo.extraFeatures),formats:i,qualities:void 0===o.imageInfo.extraQualities?t.qualities:t.qualities.concat(o.imageInfo.extraQualities),preferredFormat:e}};var Ec=function(){function e(e){this.setImageInfo(e)}return e.prototype.setImageInfo=function(e){this.imageInfo="string"==typeof e?JSON.parse(e):e},e.prototype.getImageApiVersion=function(){if(void 0!==this.imageInfo){var o=this.imageInfo["@context"]||"ol-no-context";"string"==typeof o&&(o=[o]);for(var r=0;r<o.length;r++)switch(o[r]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return _c;case"http://iiif.io/api/image/2/context.json":return gc;case"http://iiif.io/api/image/3/context.json":return yc;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(_c)&&this.imageInfo.identifier)return _c;}O(!1,61)}},e.prototype.getComplianceLevelEntryFromProfile=function(e){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===e&&(e=this.getImageApiVersion()),e){case _c:if(/^https?:\/\/library.stanford.edu\/iiif\/image-api\/(1.1\/)?compliance.html#level[0-2]$/.test(this.imageInfo.profile))return this.imageInfo.profile;break;case yc:if(/(^https?:\/\/iiif.io\/api\/image\/3\/level[0-2](.json)?$)|(^level[0-2]$)/.test(this.imageInfo.profile))return this.imageInfo.profile;break;case gc:if("string"==typeof this.imageInfo.profile&&rx.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&0<this.imageInfo.profile.length&&"string"==typeof this.imageInfo.profile[0]&&rx.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0];}},e.prototype.getComplianceLevelFromProfile=function(o){var t=this.getComplianceLevelEntryFromProfile(o);if(void 0!==t){var e=t.match(/level[0-2](\.json)?$/g);return Array.isArray(e)?e[0].replace(".json",""):void 0}},e.prototype.getComplianceLevelSupportedFeatures=function(){if(void 0!==this.imageInfo){var o=this.getImageApiVersion(),t=this.getComplianceLevelFromProfile(o);return void 0===t?vc.none.none:vc[o][t]}},e.prototype.getTileSourceOptions=function(o){var t=o||{},e=this.getImageApiVersion();if(void 0!==e){var r=void 0===e?void 0:wc[e](this);if(void 0!==r)return{url:r.url,version:e,size:[this.imageInfo.width,this.imageInfo.height],sizes:r.sizes,format:void 0!==t.format&&r.formats.includes(t.format)?t.format:void 0===r.preferredFormat?"jpg":r.preferredFormat,supports:r.supports,quality:t.quality&&r.qualities.includes(t.quality)?t.quality:r.qualities.includes("native")?"native":"default",resolutions:Array.isArray(r.resolutions)?r.resolutions.sort(function(o,t){return t-o}):void 0,tileSize:r.tileSize}}},e}(),Tc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cc=function(L){function t(t){var e=Number.isInteger,I=this,A=t||{},G=A.url||"";G+=G.lastIndexOf("/")===G.length-1||""===G?"":"/";var D=A.version||gc,n=A.sizes||[],a=A.size;O(null!=a&&Array.isArray(a)&&2==a.length&&!isNaN(a[0])&&0<a[0]&&!isNaN(a[1])&&0<a[1],60);var k=a[0],c=a[1],s=A.tileSize,p=A.tilePixelRatio||1,U=A.format||"jpg",_=A.quality||(A.version==_c?"native":"default"),g=A.resolutions||[],f=A.supports||[],d=A.extent||[0,-c,k,0],v=null!=n&&Array.isArray(n)&&0<n.length,x=void 0!==s&&("number"==typeof s&&e(s)&&0<s||Array.isArray(s)&&0<s.length),w=null!=f&&Array.isArray(f)&&(f.includes("regionByPx")||f.includes("regionByPct"))&&(f.includes("sizeByWh")||f.includes("sizeByH")||f.includes("sizeByW")||f.includes("sizeByPct")),S,z,j;if(g.sort(function(o,t){return t-o}),x||w){if(null!=s&&("number"==typeof s&&e(s)&&0<s?(S=s,z=s):Array.isArray(s)&&0<s.length&&((1==s.length||null==s[1]&&e(s[0]))&&(S=s[0],z=s[0]),2==s.length&&(e(s[0])&&e(s[1])?(S=s[0],z=s[1]):null==s[0]&&e(s[1])&&(S=s[1],z=s[1])))),void 0!==S&&void 0!==z||(S=256,z=256),0==g.length)for(var B=j=C(F(m(k/S)/o),F(m(c/z)/o));0<=B;B--)g.push(M(2,B));else{var Y=C.apply(Math,g);j=Zm(m(Y)/o)}}else if(S=k,z=c,g=[],v){n.sort(function(o,t){return o[0]-t[0]}),j=-1;var T=[];for(B=0;B<n.length;B++){var V=k/n[B][0];0<g.length&&g[g.length-1]==V?T.push(B):(g.push(V),j++)}if(0<T.length)for(B=0;B<T.length;B++)n.splice(T[B]-B,1)}else g.push(1),n.push([k,c]),j=0;var b=new Mu({tileSize:[S,z],extent:d,origin:Nt(d),resolutions:g}),P=pc.bind(null,Eo(s||256).map(function(e){return e*p}));return(I=L.call(this,{attributions:A.attributions,attributionsCollapsible:A.attributionsCollapsible,cacheSize:A.cacheSize,crossOrigin:A.crossOrigin,projection:A.projection,reprojectionErrorThreshold:A.reprojectionErrorThreshold,state:A.state,tileClass:P,tileGrid:b,tilePixelRatio:A.tilePixelRatio,tileUrlFunction:function(e){var t=e[0],o,r;if(!(t>j)){var i=e[1],a=e[2],l=g[t];if(!(void 0===i||void 0===a||void 0===l||0>i||F(k/l/S)<=i||0>a||F(c/l/z)<=a)){if(w||x){var p=i*S*l,d=a*z*l,u=S*l,y=z*l,m=S,h=z;(p+u>k&&(u=k-p),d+y>c&&(y=c-d),p+S*l>k&&(m=N((k-p+l-1)/l)),d+z*l>c&&(h=N((c-d+l-1)/l)),0==p&&u==k&&0==d&&y==c)?o="full":!w||f.includes("regionByPx")?o=p+","+d+","+u+","+y:f.includes("regionByPct")&&(o="pct:"+Rp(100*(p/k))+","+Rp(100*(d/c))+","+Rp(100*(u/k))+","+Rp(100*(y/c))),D!=yc||w&&!f.includes("sizeByWh")?!w||f.includes("sizeByW")?r=m+",":f.includes("sizeByH")?r=","+h:f.includes("sizeByWh")?r=m+","+h:f.includes("sizeByPct")&&(r="pct:"+Rp(100/l)):r=m+","+h}else if(o="full",v){var E=n[t][0],T=n[t][1];r=D==yc?E==k&&T==c?"max":E+","+T:E==k?"full":E+","}else r=D==yc?"max":"full";return G+o+"/"+r+"/0/"+_+"."+U}}},transition:A.transition})||this).zDirection=A.zDirection,I}return Tc(t,L),t}(Vh),Pc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Rc=function(g){function t(t,e,r,n,i,o){var a=this,y=t.getExtent(),u=e.getExtent(),l=u?Mt(r,u):r,m=Nl(t,e,vt(l),n),c=new Ch(t,e,l,y,.5*m,n),p=o(c.calculateSourceExtent(),m,i),h=p?Os:4,d=p?p.getPixelRatio():1;return(a=g.call(this,r,n,d,h)||this).targetProj_=e,a.maxSourceExtent_=y,a.triangulation_=c,a.targetResolution_=n,a.targetExtent_=r,a.sourceImage_=p,a.sourcePixelRatio_=d,a.canvas_=null,a.sourceListenerKey_=null,a}return Pc(t,g),t.prototype.disposeInternal=function(){this.state==Is&&this.unlistenSource_(),g.prototype.disposeInternal.call(this)},t.prototype.getImage=function(){return this.canvas_},t.prototype.getProjection=function(){return this.targetProj_},t.prototype.reproject_=function(){var o=this.sourceImage_.getState();if(o==Ls){var t=Gt(this.targetExtent_)/this.targetResolution_,e=Ot(this.targetExtent_)/this.targetResolution_;this.canvas_=Zl(t,e,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=o,this.changed()},t.prototype.load=function(){if(this.state==Os){this.state=Is,this.changed();var e=this.sourceImage_.getState();e==Ls||e==Fs?this.reproject_():(this.sourceListenerKey_=_(this.sourceImage_,A,function(){var t=this.sourceImage_.getState();t!=Ls&&t!=Fs||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},t.prototype.unlistenSource_=function(){y(this.sourceListenerKey_),this.sourceListenerKey_=null},t}(Vl),Oc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ic=function(o){function t(t,e){var r=o.call(this,t)||this;return r.image=e,r}return Oc(t,o),t}(fh),Ac=function(o){function t(t){var e=o.call(this,{attributions:t.attributions,projection:t.projection,state:t.state})||this;return e.resolutions_=void 0===t.resolutions?null:t.resolutions,e.reprojectedImage_=null,e.reprojectedRevision_=0,e}return Oc(t,o),t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.findNearestResolution=function(o){if(this.resolutions_){var r=w(this.resolutions_,o,0);o=this.resolutions_[r]}return o},t.prototype.getImage=function(o,t,e,r){var a=this.getProjection();if(a&&r&&!qe(a,r)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&qe(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==t&&xt(this.reprojectedImage_.getExtent(),o))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Rc(a,r,o,t,e,function(o,t,e){return this.getImageInternal(o,t,e,a)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return a&&(r=a),this.getImageInternal(o,t,e,r)},t.prototype.getImageInternal=function(){return r()},t.prototype.handleImageChange=function(o){var t=o.target;switch(t.getState()){case Is:this.loading=!0,this.dispatchEvent(new Ic("imageloadstart",t));break;case Ls:this.loading=!1,this.dispatchEvent(new Ic("imageloadend",t));break;case Fs:this.loading=!1,this.dispatchEvent(new Ic("imageloaderror",t));}},t}(Fh),Gc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Dc=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0===i.crossOrigin?null:i.crossOrigin,e.hidpi_=void 0===i.hidpi||i.hidpi,e.url_=i.url,e.imageLoadFunction_=void 0===i.imageLoadFunction?bp:i.imageLoadFunction,e.params_=i.params||{},e.image_=null,e.imageSize_=[0,0],e.renderedRevision_=0,e.ratio_=void 0===i.ratio?1.5:i.ratio,e}return Gc(t,o),t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(p,_,g,y){if(void 0===this.url_)return null;_=this.findNearestResolution(_),g=this.hidpi_?g:1;var n=this.image_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==_&&n.getPixelRatio()==g&&dt(n.getExtent(),p))return n;var i={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};yh(i,this.params_);var o=((p=p.slice())[0]+p[2])/2,a=(p[1]+p[3])/2;if(1!=this.ratio_){var s=this.ratio_*Gt(p)/2,u=this.ratio_*Ot(p)/2;p[0]=o-s,p[1]=a-u,p[2]=o+s,p[3]=a+u}var l=_/g,m=F(Gt(p)/l),c=F(Ot(p)/l);p[0]=o-l*m/2,p[2]=o+l*m/2,p[1]=a-l*c/2,p[3]=a+l*c/2,this.imageSize_[0]=m,this.imageSize_[1]=c;var h=this.getRequestUrl_(p,this.imageSize_,g,y,i);return this.image_=new Wl(p,_,g,h,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(A,this.handleImageChange.bind(this)),this.image_},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.getRequestUrl_=function(l,t,e,r,n){var i=r.getCode().split(":").pop();n.SIZE=t[0]+","+t[1],n.BBOX=l.join(","),n.BBOXSR=i,n.IMAGESR=i,n.DPI=Zm(90*e);var o=this.url_,a=o.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return a==o&&O(!1,50),Ap(a,n)},t.prototype.getUrl=function(){return this.url_},t.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},t.prototype.setUrl=function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())},t.prototype.updateParams=function(e){yh(this.params_,e),this.image_=null,this.changed()},t}(Ac),kc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Uc=function(l){function t(t,e,r,n,i){var o=this,p=void 0===i?Ls:Os;return(o=l.call(this,t,e,r,p)||this).loader_=void 0===i?null:i,o.canvas_=n,o.error_=null,o}return kc(t,l),t.prototype.getError=function(){return this.error_},t.prototype.handleLoad_=function(e){e?(this.error_=e,this.state=Fs):this.state=Ls,this.changed()},t.prototype.load=function(){this.state==Os&&(this.state=Is,this.changed(),this.loader_(this.handleLoad_.bind(this)))},t.prototype.getImage=function(){return this.canvas_},t}(Vl),zc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bc=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions,state:i.state})||this).canvasFunction_=i.canvasFunction,e.canvas_=null,e.renderedRevision_=0,e.ratio_=void 0===i.ratio?1.5:i.ratio,e}return zc(t,o),t.prototype.getImageInternal=function(s,l,p,r){l=this.findNearestResolution(l);var n=this.canvas_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==l&&n.getPixelRatio()==p&&dt(n.getExtent(),s))return n;Ut(s=s.slice(),this.ratio_);var d=[Gt(s)/l*p,Ot(s)/l*p],o=this.canvasFunction_.call(this,s,l,p,d,r);return o&&(n=new Uc(s,l,p,o)),this.canvas_=n,this.renderedRevision_=this.getRevision(),n},t}(Ac),Yc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Vc=function(o){function t(t){var e=o.call(this,{projection:t.projection,resolutions:t.resolutions})||this;return e.crossOrigin_=void 0===t.crossOrigin?null:t.crossOrigin,e.displayDpi_=void 0===t.displayDpi?96:t.displayDpi,e.params_=t.params||{},e.url_=t.url,e.imageLoadFunction_=void 0===t.imageLoadFunction?bp:t.imageLoadFunction,e.hidpi_=void 0===t.hidpi||t.hidpi,e.metersPerUnit_=void 0===t.metersPerUnit?1:t.metersPerUnit,e.ratio_=void 0===t.ratio?1:t.ratio,e.useOverlay_=void 0!==t.useOverlay&&t.useOverlay,e.image_=null,e.renderedRevision_=0,e}return Yc(t,o),t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(s,l,p,d){l=this.findNearestResolution(l),p=this.hidpi_?p:1;var n=this.image_;if(n&&this.renderedRevision_==this.getRevision()&&n.getResolution()==l&&n.getPixelRatio()==p&&dt(n.getExtent(),s))return n;1!=this.ratio_&&Ut(s=s.slice(),this.ratio_);var _=[Gt(s)/l*p,Ot(s)/l*p];if(void 0!==this.url_){var o=this.getUrl(this.url_,this.params_,s,_,d);(n=new Wl(s,l,p,o,this.crossOrigin_,this.imageLoadFunction_)).addEventListener(A,this.handleImageChange.bind(this))}else n=null;return this.image_=n,this.renderedRevision_=this.getRevision(),n},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.updateParams=function(e){yh(this.params_,e),this.changed()},t.prototype.getUrl=function(i,t,e,r){var n=function(l,t,e,r){var n=Gt(l),i=Ot(l),o=t[0],a=t[1],s=.0254/r;return a*n>o*i?n*e/(o*s):i*e/(a*s)}(e,r,this.metersPerUnit_,this.displayDpi_),o=vt(e),a={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Zm(r[0]),SETDISPLAYHEIGHT:Zm(r[1]),SETVIEWSCALE:n,SETVIEWCENTERX:o[0],SETVIEWCENTERY:o[1]};return yh(a,t),Ap(i,a)},t.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},t}(Ac),Xc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Wc=function(p){function t(t){var e=this,o=void 0===t.crossOrigin?null:t.crossOrigin,n=void 0===t.imageLoadFunction?bp:t.imageLoadFunction;return(e=p.call(this,{attributions:t.attributions,projection:Ve(t.projection)})||this).url_=t.url,e.imageExtent_=t.imageExtent,e.image_=new Wl(e.imageExtent_,void 0,1,e.url_,o,n),e.imageSize_=t.imageSize?t.imageSize:null,e.image_.addEventListener(A,e.handleImageChange.bind(e)),e}return Xc(t,p),t.prototype.getImageExtent=function(){return this.imageExtent_},t.prototype.getImageInternal=function(e){return Dt(e,this.image_.getExtent())?this.image_:null},t.prototype.getUrl=function(){return this.url_},t.prototype.handleImageChange=function(t){if(this.image_.getState()==Ls){var e=this.image_.getExtent(),r=this.image_.getImage(),n,d;this.imageSize_?(n=this.imageSize_[0],d=this.imageSize_[1]):(n=r.width,d=r.height);var _=Ot(e)/d,a=F(Gt(e)/_);if(a!=n){var s=Fi(a,d),g=s.canvas;s.drawImage(r,0,0,n,d,0,0,g.width,g.height),this.image_.setImage(g)}}p.prototype.handleImageChange.call(this,t)},t}(Ac),Zc="carmentaserver",Kc="geoserver",qc="mapserver",Hc="qgis",Jc=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Qc=[101,101],$c=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0===i.crossOrigin?null:i.crossOrigin,e.url_=i.url,e.imageLoadFunction_=void 0===i.imageLoadFunction?bp:i.imageLoadFunction,e.params_=i.params||{},e.v13_=!0,e.updateV13_(),e.serverType_=i.serverType,e.hidpi_=void 0===i.hidpi||i.hidpi,e.image_=null,e.imageSize_=[0,0],e.renderedRevision_=0,e.ratio_=void 0===i.ratio?1.5:i.ratio,e}return Jc(t,o),t.prototype.getFeatureInfoUrl=function(p,d,_,r){if(void 0!==this.url_){var n=Ve(_),i=this.getProjection();i&&i!==n&&(d=Nl(i,n,p,d),p=$e(p,n,i));var o=Ft(p,d,0,Qc),a={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};yh(a,this.params_,r);var s=N((p[0]-o[0])/d),g=N((o[3]-p[1])/d);return a[this.v13_?"I":"X"]=s,a[this.v13_?"J":"Y"]=g,this.getRequestUrl_(o,Qc,1,i||n,a)}},t.prototype.getLegendUrl=function(o,t){if(void 0!==this.url_){var e={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){var r=this.params_.LAYERS;if(Array.isArray(r)&&1!==r.length)return;e.LAYER=r}if(void 0!==o){var n=this.getProjection()?this.getProjection().getMetersPerUnit():1;e.SCALE=39.37*(o*n)*(25.4/.28)}return yh(e,t),Ap(this.url_,e)}},t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(p,t,d,_){if(void 0===this.url_)return null;t=this.findNearestResolution(t),1==d||this.hidpi_&&void 0!==this.serverType_||(d=1);var n=t/d,i=vt(p),o=Ft(i,n,0,[F(Gt(p)/n),F(Ot(p)/n)]),a=Ft(i,n,0,[F(this.ratio_*Gt(p)/n),F(this.ratio_*Ot(p)/n)]),s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==d&&dt(s.getExtent(),o))return s;var g={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};yh(g,this.params_),this.imageSize_[0]=Zm(Gt(a)/n),this.imageSize_[1]=Zm(Ot(a)/n);var l=this.getRequestUrl_(a,this.imageSize_,d,_,g);return this.image_=new Wl(a,t,d,l,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(A,this.handleImageChange.bind(this)),this.image_},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.getRequestUrl_=function(l,t,e,r,n){if(O(void 0!==this.url_,9),n[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(n.STYLES=""),1!=e)switch(this.serverType_){case Kc:var i=0|90*e+.5;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+i:n.FORMAT_OPTIONS="dpi:"+i;break;case qc:n.MAP_RESOLUTION=90*e;break;case Zc:case Hc:n.DPI=90*e;break;default:O(!1,8);}n.WIDTH=t[0],n.HEIGHT=t[1];var o=r.getAxisOrientation(),s;return s=this.v13_&&"ne"==o.substr(0,2)?[l[1],l[0],l[3],l[2]]:l,n.BBOX=s.join(","),Ap(this.url_,n)},t.prototype.getUrl=function(){return this.url_},t.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},t.prototype.setUrl=function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())},t.prototype.updateParams=function(e){yh(this.params_,e),this.updateV13_(),this.image_=null,this.changed()},t.prototype.updateV13_=function(){var e=this.params_.VERSION||"1.3.0";this.v13_=0<=sn(e,"1.3")},t}(Ac),tp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ep="&#169; <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors.",rp=function(a){function t(t){var e=t||{},n;n=void 0===e.attributions?[ep]:e.attributions;var s=void 0===e.crossOrigin?"anonymous":e.crossOrigin,i=void 0===e.url?"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png":e.url;return a.call(this,{attributions:n,cacheSize:e.cacheSize,crossOrigin:s,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0===e.maxZoom?19:e.maxZoom,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:i,wrapX:e.wrapX,attributionsCollapsible:!1})||this}return tp(t,a),t}(qh),np=e(3),ip=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),op=function(o){function t(t){return o.call(this,t||{})||this}return ip(t,o),t}(Fo),ap=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),sp=function(o){function t(t){var e=o.call(this)||this;return e.boundHandleImageChange_=e.handleImageChange_.bind(e),e.layer_=t,e}return ap(t,o),t.prototype.getFeatures=function(){return r()},t.prototype.prepareFrame=function(){return r()},t.prototype.renderFrame=function(){return r()},t.prototype.loadedTileCallback=function(o,t,e){o[t]||(o[t]={}),o[t][e.tileCoord.toString()]=e},t.prototype.createLoadedTileFinder=function(a,t,e){return function(r,n){var i=this.loadedTileCallback.bind(this,e,r);return a.forEachLoadedTile(t,r,n,i)}.bind(this)},t.prototype.forEachFeatureAtCoordinate=function(){},t.prototype.getDataAtPixel=function(){return r()},t.prototype.getLayer=function(){return this.layer_},t.prototype.handleFontsChanged=function(){},t.prototype.handleImageChange_=function(e){e.target.getState()===Ls&&this.renderIfReadyAndVisible()},t.prototype.loadImage=function(o){var t=o.getState();return t!=Ls&&t!=Fs&&o.addEventListener(A,this.boundHandleImageChange_),t==Os&&(o.load(),t=o.getState()),t==Ls},t.prototype.renderIfReadyAndVisible=function(){var e=this.getLayer();e.getVisible()&&e.getSourceState()==go&&e.changed()},t}(q),up=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lp=function(o){function t(t){var e=o.call(this,t)||this;return e.container=null,e.renderedResolution,e.tempTransform_=[1,0,0,1,0,0],e.pixelTransform=[1,0,0,1,0,0],e.inversePixelTransform=[1,0,0,1,0,0],e.context=null,e.containerReused=!1,e}return up(t,o),t.prototype.useContainer=function(r,t){var e=this.getLayer().getClassName(),o,l;if(r&&""===r.style.opacity&&r.className===e&&(d=r.firstElementChild)instanceof HTMLCanvasElement&&(l=d.getContext("2d")),l&&l.canvas.style.transform===t?(this.container=r,this.context=l,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(o=document.createElement("div")).className=e;var p=o.style;p.position="absolute",p.width="100%",p.height="100%";var d=(l=Fi()).canvas;o.appendChild(d),(p=d.style).position="absolute",p.left="0",p.transformOrigin="top left",this.container=o,this.context=l}},t.prototype.clip=function(p,t,e){var r=t.pixelRatio,n=t.size[0]*r/2,i=t.size[1]*r/2,o=t.viewState.rotation,a=Nt(e),s=At(e),d=It(e),l=Lt(e);Jt(t.coordinateToPixelTransform,a),Jt(t.coordinateToPixelTransform,s),Jt(t.coordinateToPixelTransform,d),Jt(t.coordinateToPixelTransform,l),p.save(),Qi(p,-o,n,i),p.beginPath(),p.moveTo(a[0]*r,a[1]*r),p.lineTo(s[0]*r,s[1]*r),p.lineTo(d[0]*r,d[1]*r),p.lineTo(l[0]*r,l[1]*r),p.clip(),Qi(p,o,n,i)},t.prototype.clipUnrotated=function(l,t,e){var r=Nt(e),n=At(e),i=It(e),o=Lt(e);Jt(t.coordinateToPixelTransform,r),Jt(t.coordinateToPixelTransform,n),Jt(t.coordinateToPixelTransform,i),Jt(t.coordinateToPixelTransform,o);var a=this.inversePixelTransform;Jt(a,r),Jt(a,n),Jt(a,i),Jt(a,o),l.save(),l.beginPath(),l.moveTo(Zm(r[0]),Zm(r[1])),l.lineTo(Zm(n[0]),Zm(n[1])),l.lineTo(Zm(i[0]),Zm(i[1])),l.lineTo(Zm(o[0]),Zm(o[1])),l.clip()},t.prototype.dispatchRenderEvent_=function(o,t,e){var r=this.getLayer();if(r.hasListener(o)){var n=new Za(o,this.inversePixelTransform,e,t);r.dispatchEvent(n)}},t.prototype.preRender=function(o,t){this.dispatchRenderEvent_("prerender",o,t)},t.prototype.postRender=function(o,t){this.dispatchRenderEvent_(ni,o,t)},t.prototype.getRenderTransform=function(s,t,e,r,n,i,o){var a=r/t,l=-s[0]+o,d=-s[1];return $t(this.tempTransform_,n/2,i/2,a,-a,-e,l,d)},t.prototype.getDataAtPixel=function(e){var t=Jt(this.inversePixelTransform,e.slice()),r=this.context,o;try{o=r.getImageData(Zm(t[0]),Zm(t[1]),1,1).data}catch(e){return"SecurityError"===e.name?new Uint8Array:o}return 0===o[3]?null:o},t}(sp),hp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cp=function(o){function t(t){var e=o.call(this,t)||this;return e.image_=null,e}return hp(t,o),t.prototype.getImage=function(){return this.image_?this.image_.getImage():null},t.prototype.prepareFrame=function(p){var t=p.layerStatesArray[p.layerIndex],e=p.pixelRatio,r=p.viewState,n=r.resolution,i=this.getLayer().getSource(),o=p.viewHints,a=p.extent;if(void 0!==t.extent&&(a=Mt(a,Zt(t.extent,r.projection))),!o[gi]&&!o[Ti]&&!kt(a))if(i){var d=r.projection,_=i.getImage(a,n,e,d);_&&this.loadImage(_)&&(this.image_=_)}else this.image_=null;return!!this.image_},t.prototype.renderFrame=function(L,t){var e=this.image_,r=e.getExtent(),n=e.getResolution(),i=e.getPixelRatio(),o=L.layerStatesArray[L.layerIndex],a=L.pixelRatio,s=L.viewState,u=s.center,l=s.resolution,h=L.size,c=a*n/(l*i),p=Zm(h[0]*a),I=Zm(h[1]*a),F=s.rotation;if(F){var _=Zm(ee(p*p+I*I));p=_,I=_}$t(this.pixelTransform,L.size[0]/2,L.size[1]/2,1/a,1/a,F,-p/2,-I/2),er(this.inversePixelTransform,this.pixelTransform);var g=ha(this.pixelTransform);this.useContainer(t,g,o.opacity);var y=this.context,v=y.canvas;v.width!=p||v.height!=I?(v.width=p,v.height=I):this.containerReused||y.clearRect(0,0,p,I);var m=!1;if(o.extent){var M=Zt(o.extent,s.projection);(m=!dt(M,L.extent)&&Dt(M,L.extent))&&this.clipUnrotated(y,L,M)}var w=e.getImage(),S=$t(this.tempTransform_,p/2,I/2,c,c,0,i*(r[0]-u[0])/n,i*(u[1]-r[3])/n);this.renderedResolution=n*a/i;var E=S[4],T=S[5],C=w.width*S[0],b=w.height*S[3];if(this.preRender(y,L),.5<=C&&.5<=b){var P=o.opacity,R;1!==P&&(R=this.context.globalAlpha,this.context.globalAlpha=P),this.context.drawImage(w,0,0,+w.width,+w.height,Zm(E),Zm(T),Zm(C),Zm(b)),1!==P&&(this.context.globalAlpha=R)}return this.postRender(y,L),m&&y.restore(),g!==v.style.transform&&(v.style.transform=g),this.container},t}(lp),pp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fp=function(o){function t(t){return o.call(this,t)||this}return pp(t,o),t.prototype.createRenderer=function(){return new cp(this)},t}(op),dp="preload",_p="useInterimTilesOnError",gp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),yp=function(o){function t(t){var e=this,a=t||{},n=yh({},a);return delete n.preload,delete n.useInterimTilesOnError,(e=o.call(this,n)||this).setPreload(void 0===a.preload?0:a.preload),e.setUseInterimTilesOnError(void 0===a.useInterimTilesOnError||a.useInterimTilesOnError),e}return gp(t,o),t.prototype.getPreload=function(){return this.get(dp)},t.prototype.setPreload=function(e){this.set(dp,e)},t.prototype.getUseInterimTilesOnError=function(){return this.get(_p)},t.prototype.setUseInterimTilesOnError=function(e){this.set(_p,e)},t}(Fo),vp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),mp=function(o){function t(t){var e=o.call(this,t)||this;return e.extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=[1/0,1/0,-1/0,-1/0],e.tmpTileRange_=new Cu(0,0,0,0),e}return vp(t,o),t.prototype.isDrawableTile=function(o){var t=this.getLayer(),e=o.getState(),r=t.getUseInterimTilesOnError();return e==hi||e==pi||e==ci&&!r},t.prototype.getTile=function(l,t,e,r){var n=r.pixelRatio,i=r.viewState.projection,o=this.getLayer(),a=o.getSource().getTile(l,t,e,n,i);return a.getState()==ci&&(o.getUseInterimTilesOnError()?0<o.getPreload()&&(this.newTiles_=!0):a.setState(hi)),this.isDrawableTile(a)||(a=a.getInterimTile()),a},t.prototype.loadedTileCallback=function(t,e,r){return!!this.isDrawableTile(r)&&o.prototype.loadedTileCallback.call(this,t,e,r)},t.prototype.prepareFrame=function(){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(o,t){var e=o.layerStatesArray[o.layerIndex],r=o.viewState,n=r.projection,i=r.resolution,a=r.center,s=r.rotation,u=o.pixelRatio,l=this.getLayer(),h=l.getSource(),c=h.getRevision(),p=h.getTileGridForProjection(n),f=p.getZForResolution(i,h.zDirection),d=p.getResolution(f),_=o.extent,x=e.extent&&Zt(e.extent,n);x&&(_=Mt(_,Zt(e.extent,n)));var y=h.getTilePixelRatio(u),v=Zm(o.size[0]*y),te=Zm(o.size[1]*y);if(s){var oe=Zm(ee(v*v+te*te));v=oe,te=oe}var S=d*v/2/y,E=d*te/2/y,T=[a[0]-S,a[1]-E,a[0]+S,a[1]+E],C=p.getTileRangeForExtentAndZ(_,f),b={};b[f]={};var P=this.createLoadedTileFinder(h,n,b),R=this.tmpExtent,O=this.tmpTileRange_;this.newTiles_=!1;for(var I=C.minX;I<=C.maxX;++I)for(var re=C.minY,ne;re<=C.maxY;++re){if(ne=this.getTile(f,I,re,o),this.isDrawableTile(ne)){var ie=X(this);if(ne.getState()==hi){b[f][ne.tileCoord.toString()]=ne;var A=ne.inTransition(ie);this.newTiles_||!A&&-1!==this.renderedTiles.indexOf(ne)||(this.newTiles_=!0)}if(1===ne.getAlpha(ie,o.time))continue}var ae=p.getTileCoordChildTileRange(ne.tileCoord,O,R),G=!1;ae&&(G=P(f+1,ae)),G||p.forEachTileCoordParentTileRange(ne.tileCoord,P,O,R)}var se=d/i;$t(this.pixelTransform,o.size[0]/2,o.size[1]/2,1/y,1/y,s,-v/2,-te/2);var D=ha(this.pixelTransform);this.useContainer(t,D,e.opacity);var k=this.context,U=k.canvas;er(this.inversePixelTransform,this.pixelTransform),$t(this.tempTransform_,v/2,te/2,se,se,0,-v/2,-te/2),U.width!=v||U.height!=te?(U.width=v,U.height=te):this.containerReused||k.clearRect(0,0,v,te),x&&this.clipUnrotated(k,o,x),this.preRender(k,o),this.renderedTiles.length=0;var z=Object.keys(b).map(Number),le,pe,de;z.sort(Ge),1!==e.opacity||this.containerReused&&!h.getOpaque(o.viewState.projection)?(le=[],pe=[]):z=z.reverse();for(var _e=z.length-1;0<=_e;--_e){var ge=z[_e],Z=h.getTilePixelSize(ge,u,n),K=p.getResolution(ge)/d,q=Z[0]*K*se,H=Z[1]*K*se,J=p.getTileCoordForCoordAndZ(Nt(T),ge),Q=p.getTileCoordExtent(J),$=Jt(this.tempTransform_,[y*(Q[0]-T[0])/d,y*(T[3]-Q[3])/d]),ue=y*h.getGutterForProjection(n),ce=b[ge];for(var ye in ce){var me=(ne=ce[ye]).tileCoord,he=$[0]-(J[1]-me[1])*q,fe=Zm(he+q),xe=$[1]-(J[2]-me[2])*H,Se=Zm(xe+H),Ee=fe-(I=Zm(he)),Te=Se-(re=Zm(xe)),Ce=f===ge;if(!(A=Ce&&1!==ne.getAlpha(X(this),o.time)))if(le){k.save(),de=[I,re,I+Ee,re,I+Ee,re+Te,I,re+Te];for(var Pe=0,Re=le.length;Pe<Re;++Pe)if(f!==ge&&ge<pe[Pe]){var we=le[Pe];k.beginPath(),k.moveTo(de[0],de[1]),k.lineTo(de[2],de[3]),k.lineTo(de[4],de[5]),k.lineTo(de[6],de[7]),k.moveTo(we[6],we[7]),k.lineTo(we[4],we[5]),k.lineTo(we[2],we[3]),k.lineTo(we[0],we[1]),k.clip()}le.push(de),pe.push(ge)}else k.clearRect(I,re,Ee,Te);this.drawTileImage(ne,o,I,re,Ee,Te,ue,Ce,e.opacity),le&&!A&&k.restore(),this.renderedTiles.push(ne),this.updateUsedTiles(o.usedTiles,h,ne)}}return this.renderedRevision=c,this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!xt(this.renderedExtent_,T),this.renderedExtent_=T,this.renderedPixelRatio=u,this.renderedProjection=n,this.manageTilePyramid(o,h,p,u,n,_,f,l.getPreload()),this.scheduleExpireCache(o,h),this.postRender(k,o),e.extent&&k.restore(),D!==U.style.transform&&(U.style.transform=D),this.container},t.prototype.drawTileImage=function(o,t,e,r,n,i,a,s,_){var l=this.getTileImage(o);if(l){var g=X(this),u=s?o.getAlpha(g,t.time):1,p=_*u,c=p!==this.context.globalAlpha;c&&(this.context.save(),this.context.globalAlpha=p),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,e,r,n,i),c&&this.context.restore(),1===u?s&&o.endTransition(g):t.animate=!0}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(o,t){if(t.canExpireCache()){var e=function(o,t,e){var r=X(o);r in e.usedTiles&&o.expireCache(e.viewState.projection,e.usedTiles[r])}.bind(null,t);o.postRenderFunctions.push(e)}},t.prototype.updateUsedTiles=function(o,t,e){var r=X(t);r in o||(o[r]={}),o[r][e.getKey()]=!0},t.prototype.manageTilePyramid=function(o,t,e,r,n,i,a,s,u){var l=X(t);l in o.wantedTiles||(o.wantedTiles[l]={});var m=o.wantedTiles[l],y=o.tileQueue,h,x,S,E,T,C;for(C=e.getMinZoom();C<=a;++C)for(x=e.getTileRangeForExtentAndZ(i,C,x),S=e.getResolution(C),E=x.minX;E<=x.maxX;++E)for(T=x.minY;T<=x.maxY;++T)a-C<=s?((h=t.getTile(C,E,T,r,n)).getState()==ui&&(m[h.getKey()]=!0,y.isKeyQueued(h.getKey())||y.enqueue([h,l,e.getTileCoordCenter(h.tileCoord),S])),void 0!==u&&u(h)):t.useTile(C,E,T,n)},t}(lp);mp.prototype.getLayer;var xp=mp,wp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Sp=function(o){function t(t){return o.call(this,t)||this}return wp(t,o),t.prototype.createRenderer=function(){return new xp(this)},t}(yp),Ep=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tp=function(o){function t(t,e,r){var n=o.call(this,t)||this;return n.extent=e.extent,n.resolution=e.viewState.resolution/e.pixelRatio,n.data=r,n}return Ep(t,o),t}(fh),Op=function(s){function t(l){var e=s.call(this,{projection:null})||this;e.worker_=null,e.operationType_=void 0===l.operationType?"pixel":l.operationType,e.threads_=void 0===l.threads?1:l.threads,e.layers_=function(o){for(var t=o.length,e=Array(t),r=0;r<t;++r)e[r]=Fp(o[r]);return e}(l.sources);for(var t=e.changed.bind(e),r=0,i=e.layers_.length,a;r<i;++r)e.layers_[r].addEventListener(A,t);return e.tileQueue_=new _i(function(){return 1},e.changed.bind(e)),e.requestedFrameState_,e.renderedImageCanvas_=null,e.renderedRevision_,e.frameState_={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],extent:null,index:0,layerIndex:0,layerStatesArray:(a=e.layers_,a.map(function(e){return e.getLayerState()})),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:e.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},declutterItems:[]},e.setAttributions(function(e){for(var t=[],r=0,p=l.sources.length;r<p;++r){var i=l.sources[r],o=(i instanceof Fh?i:i.getSource()).getAttributions();if("function"==typeof o){var a=o(e);t.push.apply(t,a)}}return 0===t.length?null:t}),void 0!==l.operation&&e.setOperation(l.operation,l.lib),e}return Ep(t,s),t.prototype.setOperation=function(o,t){this.worker_=new np.Processor({operation:o,imageOps:this.operationType_==="image",queue:1,lib:t,threads:this.threads_}),this.changed()},t.prototype.updateFrameState_=function(a,t,e){var r=yh({},this.frameState_);r.viewState=yh({},r.viewState);var n=vt(a);r.extent=a.slice(),r.size[0]=Zm(Gt(a)/t),r.size[1]=Zm(Ot(a)/t),r.time=1/0;var i=r.viewState;return i.center=n,i.projection=e,i.resolution=t,r},t.prototype.allSourcesReady_=function(){for(var o=!0,n=0,i=this.layers_.length;n<i;++n)if(this.layers_[n].getSource().getState()!==go){o=!1;break}return o},t.prototype.getImage=function(s,t,e,r){if(!this.allSourcesReady_())return null;var n=this.updateFrameState_(s,t,r);if(this.requestedFrameState_=n,this.renderedImageCanvas_){var i=this.renderedImageCanvas_.getResolution(),o=this.renderedImageCanvas_.getExtent();t===i&&xt(s,o)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),n.tileQueue.loadMoreTiles(16,16),n.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},t.prototype.processSources_=function(){for(var a=this.requestedFrameState_,t=this.layers_.length,e=Array(t),r=0;r<t;++r){a.layerIndex=r;var s=Ud(this.layers_[r],a);if(!s)return;e[r]=s}var i={};this.dispatchEvent(new Tp("beforeoperations",a,i)),this.worker_.process(e,i,this.onWorkerComplete_.bind(this,a))},t.prototype.onWorkerComplete_=function(s,t,e,r){if(!t&&e){var n=s.extent,i=s.viewState.resolution;if(i===this.requestedFrameState_.viewState.resolution&&xt(n,this.requestedFrameState_.extent)){var o;this.renderedImageCanvas_?o=this.renderedImageCanvas_.getImage().getContext("2d"):(o=Fi(Zm(Gt(n)/i),Zm(Ot(n)/i)),this.renderedImageCanvas_=new Uc(n,i,1,o.canvas)),o.putImageData(e,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new Tp("afteroperations",s,r))}}},t.prototype.getImageInternal=function(){return null},t}(Ac),Ip=null,nx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Np=["Map tiles by <a href=\"https://stamen.com/\" target=\"_blank\">Stamen Design</a>, under <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\">CC BY 3.0</a>.",ep],Gp={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},jp={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},Dp=function(s){function t(t){var e=t.layer.indexOf("-"),r=-1==e?t.layer:t.layer.slice(0,e),n=jp[r],i=Gp[t.layer],o=void 0===t.url?"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+t.layer+"/{z}/{x}/{y}."+i.extension:t.url;return s.call(this,{attributions:Np,cacheSize:t.cacheSize,crossOrigin:"anonymous",maxZoom:null==t.maxZoom?n.maxZoom:t.maxZoom,minZoom:null==t.minZoom?n.minZoom:t.minZoom,opaque:i.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:o,wrapX:t.wrapX})||this}return nx(t,s),t}(qh),kp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Up=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:Mp,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).params_=i.params||{},e.hidpi_=void 0===i.hidpi||i.hidpi,e.tmpExtent_=[1/0,1/0,-1/0,-1/0],e.setKey(e.getKeyForParams_()),e}return kp(t,o),t.prototype.getKeyForParams_=function(){var o=0,n=[];for(var e in this.params_)n[o++]=e+"-"+this.params_[e];return n.join("/")},t.prototype.getParams=function(){return this.params_},t.prototype.getRequestUrl_=function(l,t,e,r,n,i){var o=this.urls;if(o){var a=n.getCode().split(":").pop(),p;return p=(i.SIZE=t[0]+","+t[1],i.BBOX=e.join(","),i.BBOXSR=a,i.IMAGESR=a,i.DPI=Zm(i.DPI?i.DPI*r:90*r),1==o.length)?o[0]:o[_e(Ja(l),o.length)],Ap(p.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),i)}},t.prototype.getTilePixelRatio=function(e){return this.hidpi_?e:1},t.prototype.updateParams=function(e){yh(this.params_,e),this.setKey(this.getKeyForParams_())},t}(Vh),Bp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yp=function(o){function t(t,e,r){var n=o.call(this,t,hi)||this;return n.tileSize_=e,n.text_=r,n.canvas_=null,n}return Bp(t,o),t.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var o=this.tileSize_,t=Fi(o[0],o[1]);return t.strokeStyle="grey",t.strokeRect(.5,.5,o[0]+.5,o[1]+.5),t.fillStyle="grey",t.strokeStyle="white",t.textAlign="center",t.textBaseline="middle",t.font="24px sans-serif",t.lineWidth=4,t.strokeText(this.text_,o[0]/2,o[1]/2,o[0]),t.fillText(this.text_,o[0]/2,o[1]/2,o[0]),this.canvas_=t.canvas,t.canvas},t.prototype.load=function(){},t}(mh),Vp=function(o){function t(t){var e=t||{};return o.call(this,{opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:void 0===e.wrapX||e.wrapX,zDirection:e.zDirection})||this}return Bp(t,o),t.prototype.getTile=function(l,t,e){var r=Wa(l,t,e);if(this.tileCache.containsKey(r))return this.tileCache.get(r);var n=Eo(this.tileGrid.getTileSize(l)),i=[l,t,e],o=this.getTileCoordForTileUrlFunction(i),a;a=o?"z:"+o[0]+" x:"+o[1]+" y:"+o[2]:"none";var p=new Yp(i,n,a);return this.tileCache.set(r,p),p},t}(qh),Xp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Wp=function(o){function t(t){var e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:Ve("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:_o,tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this;if(!(e.tileJSON_=null,e.tileSize_=t.tileSize,t.url))t.tileJSON?e.handleTileJSONResponse(t.tileJSON):O(!1,51);else if(t.jsonp)wl(t.url,e.handleTileJSONResponse.bind(e),e.handleTileJSONError.bind(e));else{var r=new XMLHttpRequest;r.addEventListener("load",e.onXHRLoad_.bind(e)),r.addEventListener("error",e.onXHRError_.bind(e)),r.open("GET",t.url),r.send()}return e}return Xp(t,o),t.prototype.onXHRLoad_=function(o){var t=o.target;if(!t.status||200<=t.status&&300>t.status){var e;try{e=JSON.parse(t.responseText)}catch(e){return void this.handleTileJSONError()}this.handleTileJSONResponse(e)}else this.handleTileJSONError()},t.prototype.onXHRError_=function(){this.handleTileJSONError()},t.prototype.getTileJSON=function(){return this.tileJSON_},t.prototype.handleTileJSONResponse=function(l){var t=Ve("EPSG:4326"),r=this.getProjection(),n;if(void 0!==l.bounds){var p=Je(t,r);n=zt(l.bounds,p)}var i=l.minzoom||0,o=l.maxzoom||22,a=rs({extent:as(r),maxZoom:o,minZoom:i,tileSize:this.tileSize_});if(this.tileGrid=a,this.tileUrlFunction=Tl(l.tiles,a),void 0!==l.attribution&&!this.getAttributions()){var s=void 0===n?t.getExtent():n;this.setAttributions(function(t){return Dt(s,t.extent)?[l.attribution]:null})}this.tileJSON_=l,this.setState(go)},t.prototype.handleTileJSONError=function(){this.setState(yo)},t}(Vh),Zp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Kp=function(a){function t(t){var e=this,s=t||{},n=s.params||{},i=!("TRANSPARENT"in n)||n.TRANSPARENT;return(e=a.call(this,{attributions:s.attributions,cacheSize:s.cacheSize,crossOrigin:s.crossOrigin,opaque:!i,projection:s.projection,reprojectionErrorThreshold:s.reprojectionErrorThreshold,tileClass:s.tileClass,tileGrid:s.tileGrid,tileLoadFunction:s.tileLoadFunction,tileUrlFunction:zp,url:s.url,urls:s.urls,wrapX:void 0===s.wrapX||s.wrapX,transition:s.transition})||this).gutter_=void 0===s.gutter?0:s.gutter,e.params_=n,e.v13_=!0,e.serverType_=s.serverType,e.hidpi_=void 0===s.hidpi||s.hidpi,e.tmpExtent_=[1/0,1/0,-1/0,-1/0],e.updateV13_(),e.setKey(e.getKeyForParams_()),e}return Zp(t,a),t.prototype.getFeatureInfoUrl=function(p,y,e,r){var n=Ve(e),i=this.getProjection(),o=this.getTileGrid();o||(o=this.getTileGridForProjection(n));var m=o.getZForResolution(y,this.zDirection),s=o.getTileCoordForCoordAndZ(p,m);if(!(o.getResolutions().length<=s[0])){var u=o.getResolution(s[0]),x=o.getTileCoordExtent(s,this.tmpExtent_),S=Eo(o.getTileSize(s[0]),this.tmpSize),E=this.gutter_;0!==E&&(S=ro(S,E,this.tmpSize),x=V(x,u*E,x)),i&&i!==n&&(u=Nl(i,n,p,u),x=Bt(x,n,i),p=$e(p,n,i));var f={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};yh(f,this.params_,r);var d=N((p[0]-x[0])/u),_=N((x[3]-p[1])/u);return f[this.v13_?"I":"X"]=d,f[this.v13_?"J":"Y"]=_,this.getRequestUrl_(s,S,x,1,i||n,f)}},t.prototype.getLegendUrl=function(o,t){if(void 0!==this.urls[0]){var e={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){var r=this.params_.LAYERS;if(Array.isArray(r)&&1!==r.length)return;e.LAYER=r}if(void 0!==o){var n=this.getProjection()?this.getProjection().getMetersPerUnit():1;e.SCALE=39.37*(o*n)*(25.4/.28)}return yh(e,t),Ap(this.urls[0],e)}},t.prototype.getGutter=function(){return this.gutter_},t.prototype.getParams=function(){return this.params_},t.prototype.getRequestUrl_=function(p,t,e,r,n,i){var o=this.urls;if(o){if(i.WIDTH=t[0],i.HEIGHT=t[1],i[this.v13_?"CRS":"SRS"]=n.getCode(),"STYLES"in this.params_||(i.STYLES=""),1!=r)switch(this.serverType_){case Kc:var a=0|90*r+.5;"FORMAT_OPTIONS"in i?i.FORMAT_OPTIONS+=";dpi:"+a:i.FORMAT_OPTIONS="dpi:"+a;break;case qc:i.MAP_RESOLUTION=90*r;break;case Zc:case Hc:i.DPI=90*r;break;default:O(!1,52);}var s=n.getAxisOrientation(),l=e,d;if(this.v13_&&"ne"==s.substr(0,2)){var _;_=e[0],l[0]=e[1],l[1]=_,_=e[2],l[2]=e[3],l[3]=_}return d=(i.BBOX=l.join(","),1==o.length)?o[0]:o[_e(Ja(p),o.length)],Ap(d,i)}},t.prototype.getTilePixelRatio=function(e){return this.hidpi_&&void 0!==this.serverType_?e:1},t.prototype.getKeyForParams_=function(){var o=0,n=[];for(var e in this.params_)n[o++]=e+"-"+this.params_[e];return n.join("/")},t.prototype.updateParams=function(e){yh(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())},t.prototype.updateV13_=function(){var e=this.params_.VERSION||"1.3.0";this.v13_=0<=sn(e,"1.3")},t}(Vh),Hp=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jp=function(l){function t(t,e,r,n,i,o){var a=l.call(this,t,e)||this;return a.src_=r,a.extent_=n,a.preemptive_=i,a.grid_=null,a.keys_=null,a.data_=null,a.jsonp_=o,a}return Hp(t,l),t.prototype.getImage=function(){return null},t.prototype.getData=function(s){if(!this.grid_||!this.keys_)return null;var t=(s[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),e=(s[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[N((1-e)*this.grid_.length)];if("string"!=typeof r)return null;var n=r.charCodeAt(N(t*r.length));93<=n&&n--,35<=n&&n--;var l=null;if((n-=32)in this.keys_){var p=this.keys_[n];l=this.data_&&p in this.data_?this.data_[p]:p}return l},t.prototype.forDataAtCoordinate=function(o,t,e){this.state==pi&&!0===e?(this.state=ui,g(this,A,function(){t(this.getData(o))},this),this.loadInternal_()):!0===e?setTimeout(function(){t(this.getData(o))}.bind(this),0):t(this.getData(o))},t.prototype.getKey=function(){return this.src_},t.prototype.handleError_=function(){this.state=ci,this.changed()},t.prototype.handleLoad_=function(e){this.grid_=e.grid,this.keys_=e.keys,this.data_=e.data,this.state=hi,this.changed()},t.prototype.loadInternal_=function(){if(this.state==ui)if(this.state=li,this.jsonp_)wl(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",this.src_),e.send()}},t.prototype.onXHRLoad_=function(o){var t=o.target;if(!t.status||200<=t.status&&300>t.status){var e;try{e=JSON.parse(t.responseText)}catch(e){return void this.handleError_()}this.handleLoad_(e)}else this.handleError_()},t.prototype.onXHRError_=function(){this.handleError_()},t.prototype.load=function(){this.preemptive_?this.loadInternal_():this.setState(pi)},t}(mh),Qp=function(o){function t(t){var e=o.call(this,{projection:Ve("EPSG:3857"),state:_o})||this;if(!(e.preemptive_=void 0===t.preemptive||t.preemptive,e.tileUrlFunction_=Pl,e.template_=void 0,e.jsonp_=t.jsonp||!1,t.url))t.tileJSON?e.handleTileJSONResponse(t.tileJSON):O(!1,51);else if(e.jsonp_)wl(t.url,e.handleTileJSONResponse.bind(e),e.handleTileJSONError.bind(e));else{var r=new XMLHttpRequest;r.addEventListener("load",e.onXHRLoad_.bind(e)),r.addEventListener("error",e.onXHRError_.bind(e)),r.open("GET",t.url),r.send()}return e}return Hp(t,o),t.prototype.onXHRLoad_=function(o){var t=o.target;if(!t.status||200<=t.status&&300>t.status){var e;try{e=JSON.parse(t.responseText)}catch(e){return void this.handleTileJSONError()}this.handleTileJSONResponse(e)}else this.handleTileJSONError()},t.prototype.onXHRError_=function(){this.handleTileJSONError()},t.prototype.getTemplate=function(){return this.template_},t.prototype.forDataAtCoordinateAndResolution=function(a,t,e,r){if(this.tileGrid){var n=this.tileGrid.getZForResolution(t,this.zDirection),i=this.tileGrid.getTileCoordForCoordAndZ(a,n);this.getTile(i[0],i[1],i[2],1,this.getProjection()).forDataAtCoordinate(a,e,r)}else!0===r?setTimeout(function(){e(null)},0):e(null)},t.prototype.handleTileJSONError=function(){this.setState(yo)},t.prototype.handleTileJSONResponse=function(p){var t=Ve("EPSG:4326"),r=this.getProjection(),n;if(void 0!==p.bounds){var d=Je(t,r);n=zt(p.bounds,d)}var i=p.minzoom||0,o=p.maxzoom||22,a=rs({extent:as(r),maxZoom:o,minZoom:i});this.tileGrid=a,this.template_=p.template;var s=p.grids;if(s){if(this.tileUrlFunction_=Tl(s,a),void 0!==p.attribution){var _=void 0===n?t.getExtent():n;this.setAttributions(function(t){return Dt(_,t.extent)?[p.attribution]:null})}this.setState(go)}else this.setState(yo)},t.prototype.getTile=function(p,t,e,r,n){var i=Wa(p,t,e);if(this.tileCache.containsKey(i))return this.tileCache.get(i);var o=[p,t,e],a=this.getTileCoordForTileUrlFunction(o,n),s=this.tileUrlFunction_(a,r,n),d=new Jp(o,void 0===s?pi:ui,void 0===s?"":s,this.tileGrid.getTileCoordExtent(o),this.preemptive_,this.jsonp_);return this.tileCache.set(i,d),d},t.prototype.useTile=function(o,t,e){var r=Wa(o,t,e);this.tileCache.containsKey(r)&&this.tileCache.get(r)},t}(jh),$p=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),tf=[],ef=function(a){function t(t,e,r,n){var i=a.call(this,t,e,{transition:0})||this;return i.context_={},i.executorGroups={},i.loadingSourceTiles=0,i.errorSourceTileKeys={},i.hitDetectionImageData={},i.replayState_={},i.sourceTiles=null,i.wantedResolution,i.getSourceTiles=n.bind(void 0,i),i.sourceZ=-1,i.hifi=!1,i.wrappedTileCoord=r,i}return $p(t,a),t.prototype.getContext=function(o){var t=X(o);return t in this.context_||(this.context_[t]=Fi(1,1,tf)),this.context_[t]},t.prototype.hasContext=function(e){return X(e)in this.context_},t.prototype.getImage=function(e){return this.hasContext(e)?this.getContext(e).canvas:null},t.prototype.getReplayState=function(o){var t=X(o);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[t]},t.prototype.load=function(){this.getSourceTiles()},t.prototype.release=function(){for(var t in this.context_)tf.push(this.context_[t].canvas);a.prototype.release.call(this)},t}(mh),rf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),nf=function(l){function t(t,e,r,n,i,o){var a=l.call(this,t,e,o)||this;return a.extent=null,a.format_=n,a.features_=null,a.loader_,a.projection=null,a.resolution,a.tileLoadFunction_=i,a.url_=r,a}return rf(t,l),t.prototype.getFormat=function(){return this.format_},t.prototype.getFeatures=function(){return this.features_},t.prototype.getKey=function(){return this.url_},t.prototype.load=function(){this.state==ui&&(this.setState(li),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))},t.prototype.onLoad=function(e){this.setFeatures(e)},t.prototype.onError=function(){this.setState(ci)},t.prototype.setFeatures=function(e){this.features_=e,this.setState(hi)},t.prototype.setLoader=function(e){this.loader_=e},t}(mh),of=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),af=function(a){function t(t){var e=this,s=t.projection||"EPSG:3857",n=t.extent||as(s),i=t.tileGrid||rs({extent:n,maxResolution:t.maxResolution,maxZoom:void 0===t.maxZoom?22:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize||512});return(e=a.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,opaque:!1,projection:s,state:t.state,tileGrid:i,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:qp,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection})||this).format_=t.format?t.format:null,e.loadingTiles_={},e.sourceTileCache=new Th(e.tileCache.highWaterMark),e.overlaps_=null==t.overlaps||t.overlaps,e.tileClass=t.tileClass?t.tileClass:nf,e.tileGrids_={},e}return of(t,a),t.prototype.getFeaturesInExtent=function(s){var t=[],e=this.tileCache;if(0===e.getCount())return t;var _=qa(e.peekFirstKey())[0],r=this.tileGrid;return e.forEach(function(e){if(e.tileCoord[0]===_&&e.getState()===hi)for(var n=e.getSourceTiles(),o=0,i=n.length;o<i;++o){var g=n[o],u=g.tileCoord;if(Dt(s,r.getTileCoordExtent(u))){var l=g.getFeatures();if(l)for(var y=0,m=l.length;y<m;++y){var p=l[y],h=p.getGeometry();Dt(s,h.getExtent())&&t.push(p)}}}}),t},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},t.prototype.expireCache=function(t,e){a.prototype.expireCache.call(this,t,e),this.sourceTileCache.expireCache({})},t.prototype.getSourceTiles=function(g,t,y){var e=y.wrappedTileCoord,r=this.getTileGridForProjection(t),n=r.getTileCoordExtent(e),o=e[0],i=r.getResolution(o);V(n,-i,n);var s=this.tileGrid,a=s.getExtent();a&&Mt(n,a,n);var l=s.getZForResolution(i,1),u=s.getMinZoom(),d=y.sourceTiles,_,m,f;if(d&&0<d.length&&d[0].tileCoord[0]===l)_=d,m=!0,f=l;else{_=[],f=l+1;do--f,m=!0,s.forEachTileCoord(n,f,function(e){var r=this.tileUrlFunction(e,g,t),p;if(void 0!==r)if(this.sourceTileCache.containsKey(r)){var o=(p=this.sourceTileCache.get(r)).getState();if(o===hi||o===ci||o===pi)return void _.push(p)}else f===l&&((p=new this.tileClass(e,ui,r,this.format_,this.tileLoadFunction)).extent=s.getTileCoordExtent(e),p.projection=t,p.resolution=s.getResolution(e[0]),this.sourceTileCache.set(r,p),p.addEventListener(A,this.handleTileChange.bind(this)),p.load());m=m&&p&&p.getState()===hi,p&&p.getState()!==pi&&y.getState()===ui&&(y.loadingSourceTiles++,p.addEventListener(A,function r(){var t=p.getState(),e=p.getKey();if(t===hi||t===ci){t===hi?(p.removeEventListener(A,r),y.loadingSourceTiles--,delete y.errorSourceTileKeys[e]):t===ci&&(y.errorSourceTileKeys[e]=!0);var n=Object.keys(y.errorSourceTileKeys).length;0==y.loadingSourceTiles-n&&(y.hifi=0===n,y.sourceZ=l,y.setState(hi))}}))}.bind(this)),m||(_.length=0);while(!m&&f>u)}return y.getState()===ui&&y.setState(li),m&&(y.hifi=l===f,y.sourceZ=f,y.getState()<hi?y.setState(hi):d&&Kn(_,d)||(y.sourceTiles=_)),_},t.prototype.getTile=function(m,t,e,r,n){var i=Wa(m,t,e),a=this.getKey(),s;if(this.tileCache.containsKey(i)&&(s=this.tileCache.get(i)).key===a)return s;var x=[m,t,e],u=this.getTileCoordForTileUrlFunction(x,n),S=this.getTileGrid().getExtent(),h=this.getTileGridForProjection(n);if(u&&S){var c=h.getTileCoordExtent(u);V(c,-h.getResolution(m),c),Dt(S,c)||(u=null)}var p=!0;if(null!==u){var E=this.tileGrid,d=h.getResolution(m),_=E.getZForResolution(d,1),g=h.getTileCoordExtent(u);V(g,-d,g),E.forEachTileCoord(g,_,function(e){p=p&&!this.tileUrlFunction(e,r,n)}.bind(this))}var y=new ef(x,p?pi:ui,u,this.getSourceTiles.bind(this,r,n));return y.key=a,s?(y.interimTile=s,y.refreshInterimChain(),this.tileCache.replace(i,y)):this.tileCache.set(i,y),y},t.prototype.getTileGridForProjection=function(o){var t=o.getCode(),e=this.tileGrids_[t];if(!e){var i=this.tileGrid;e=is(o,void 0,i?i.getTileSize(i.getMinZoom()):void 0),this.tileGrids_[t]=e}return e},t.prototype.getTilePixelRatio=function(e){return e},t.prototype.getTilePixelSize=function(o,t,e){var r=Eo(this.getTileGridForProjection(e).getTileSize(o),this.tmpSize);return[Zm(r[0]*t),Zm(r[1]*t)]},t}(Bh),sf="KVP",lf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cf=function(a){function t(t){var e=this,s=void 0===t.requestEncoding?sf:t.requestEncoding,n=t.tileGrid,i=t.urls;return void 0===i&&void 0!==t.url&&(i=Rl(t.url)),(e=a.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:Pl,urls:i,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition})||this).version_=void 0===t.version?"1.0.0":t.version,e.format_=void 0===t.format?"image/jpeg":t.format,e.dimensions_=void 0===t.dimensions?{}:t.dimensions,e.layer_=t.layer,e.matrixSet_=t.matrixSet,e.style_=t.style,e.requestEncoding_=s,e.setKey(e.getKeyForDimensions_()),i&&0<i.length&&(e.tileUrlFunction=Cl(i.map(l_.bind(e)))),e}return lf(t,a),t.prototype.setUrls=function(o){this.urls=o;var t=o.join("\n");this.setTileUrlFunction(Cl(o.map(l_.bind(this))),t)},t.prototype.getDimensions=function(){return this.dimensions_},t.prototype.getFormat=function(){return this.format_},t.prototype.getLayer=function(){return this.layer_},t.prototype.getMatrixSet=function(){return this.matrixSet_},t.prototype.getRequestEncoding=function(){return this.requestEncoding_},t.prototype.getStyle=function(){return this.style_},t.prototype.getVersion=function(){return this.version_},t.prototype.getKeyForDimensions_=function(){var o=0,n=[];for(var e in this.dimensions_)n[o++]=e+"-"+this.dimensions_[e];return n.join("/")},t.prototype.updateDimensions=function(e){yh(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())},t}(Vh),pf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),df="GENERATE_BUFFERS",_f=function(o){function t(t,e){var r=o.call(this,t)||this,n=e||{};return r.helper=new bl({postProcesses:n.postProcesses,uniforms:n.uniforms}),r}return pf(t,o),t.prototype.disposeInternal=function(){this.helper.dispose(),o.prototype.disposeInternal.call(this)},t.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},t}(sp),gf=new Blob(["var e=\"function\"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n=\"GENERATE_BUFFERS\",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};"],{type:"application/javascript"}),vf=URL.createObjectURL(gf),mf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),xf="renderOrder",wf=function(o){function t(t){var e=this,a=t||{},n=yh({},a);return delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,(e=o.call(this,n)||this).declutter_=void 0!==a.declutter&&a.declutter,e.renderBuffer_=void 0===a.renderBuffer?100:a.renderBuffer,e.style_=null,e.styleFunction_=void 0,e.setStyle(a.style),e.updateWhileAnimating_=void 0!==a.updateWhileAnimating&&a.updateWhileAnimating,e.updateWhileInteracting_=void 0!==a.updateWhileInteracting&&a.updateWhileInteracting,e}return mf(t,o),t.prototype.getDeclutter=function(){return this.declutter_},t.prototype.getFeatures=function(t){return o.prototype.getFeatures.call(this,t)},t.prototype.getRenderBuffer=function(){return this.renderBuffer_},t.prototype.getRenderOrder=function(){return this.get(xf)},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},t.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},t.prototype.setRenderOrder=function(e){this.set(xf,e)},t.prototype.setStyle=function(e){this.style_=void 0===e?fl:e,this.styleFunction_=null===e?void 0:function(o){var t;if("function"==typeof o)t=o;else{var n;Array.isArray(o)?n=o:(O("function"==typeof o.getZIndex,41),n=[o]),t=function(){return n}}return t}(this.style_),this.changed()},t}(Fo),Sf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ef=function(o){function t(t,e){var r=this,l=e.uniforms||{},i=[1,0,0,1,0,0];l["u_projectionMatrix"]=i,(r=o.call(this,t,{uniforms:l,postProcesses:e.postProcesses})||this).sourceRevision_=-1,r.verticesBuffer_=new kf(34962,35048),r.hitVerticesBuffer_=new kf(34962,35048),r.indicesBuffer_=new kf(34963,35048),r.program_=r.helper.getProgram(e.fragmentShader,e.vertexShader),r.hitDetectionEnabled_=e.hitFragmentShader&&e.hitVertexShader,r.hitProgram_=r.hitDetectionEnabled_&&r.helper.getProgram(e.hitFragmentShader,e.hitVertexShader);var a=e.attributes?e.attributes.map(function(e){return{name:"a_"+e.name,size:1,type:ml.FLOAT}}):[];r.attributes=[{name:"a_position",size:2,type:ml.FLOAT},{name:"a_index",size:1,type:ml.FLOAT}].concat(a),r.hitDetectionAttributes=[{name:"a_position",size:2,type:ml.FLOAT},{name:"a_index",size:1,type:ml.FLOAT},{name:"a_hitColor",size:4,type:ml.FLOAT},{name:"a_featureUid",size:1,type:ml.FLOAT}].concat(a),r.customAttributes=e.attributes?e.attributes:[],r.previousExtent_=[1/0,1/0,-1/0,-1/0],r.currentTransform_=i,r.renderTransform_=[1,0,0,1,0,0],r.invertRenderTransform_=[1,0,0,1,0,0],r.renderInstructions_=new Float32Array(0),r.hitRenderInstructions_=new Float32Array(0),r.hitRenderTarget_=r.hitDetectionEnabled_&&new Il(r.helper),r.worker_=new Worker(vf),r.worker_.addEventListener("message",function(o){var t=o.data;if(t.type===df){var e=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=e,er(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(o.data.renderInstructions):this.renderInstructions_=new Float32Array(o.data.renderInstructions),this.getLayer().changed()}}.bind(r)),r.featureCache_={},r.featureCount_=0;var s=r.getLayer().getSource();return r.sourceListenKeys_=[_(s,Qh,r.handleSourceFeatureAdded_,r),_(s,$h,r.handleSourceFeatureChanged_,r),_(s,ec,r.handleSourceFeatureDelete_,r),_(s,tc,r.handleSourceFeatureClear_,r)],s.forEachFeature(function(e){this.featureCache_[X(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(r)),r}return Sf(t,o),t.prototype.handleSourceFeatureAdded_=function(o){var t=o.feature;this.featureCache_[X(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(o){var t=o.feature;this.featureCache_[X(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(o){var t=o.feature;delete this.featureCache_[X(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(o){var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t),this.helper.finalizeDraw(o);var e=this.helper.getCanvas(),r=o.layerStatesArray[o.layerIndex].opacity;return r!==parseFloat(e.style.opacity)&&(e.style.opacity=r),this.hitDetectionEnabled_&&(this.renderHitDetection(o),this.hitRenderTarget_.clearCachedData()),e},t.prototype.prepareFrame=function(p){var t=this.getLayer(),e=t.getSource(),r=p.viewState,n=!p.viewHints[gi]&&!p.viewHints[Ti],i=!xt(this.previousExtent_,p.extent),o=this.sourceRevision_<e.getRevision();if(o&&(this.sourceRevision_=e.getRevision()),n&&(i||o)){var a=r.projection,s=r.resolution,d=t instanceof wf?t.getRenderBuffer():0,l=V(p.extent,d*s);e.loadFeatures(l,s,a),this.rebuildBuffers_(p),this.previousExtent_=p.extent.slice()}return this.helper.makeProjectionTransform(p,this.currentTransform_),Ht(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(p),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(m){var t=[1,0,0,1,0,0];this.helper.makeProjectionTransform(m,t);var e=(2+this.customAttributes.length)*this.featureCount_,i,x;if(this.renderInstructions_&&this.renderInstructions_.length===e||(this.renderInstructions_=new Float32Array(e)),this.hitDetectionEnabled_){var S=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===S||(this.hitRenderInstructions_=new Float32Array(S))}var o=[],l=[],h=0,E=0,T,C,P;for(var R in this.featureCache_)if((x=(i=this.featureCache_[R]).geometry)&&x.getType()===oe.POINT){o[0]=x.getFlatCoordinates()[0],o[1]=x.getFlatCoordinates()[1],Jt(t,o),C=E+6,P=void 0,(P=l)[0]=N(C/256/256/256)/255,P[1]=N(C/256/256)%256/255,P[2]=N(C/256)%256/255,P[3]=C%256/255,T=P,this.renderInstructions_[h++]=o[0],this.renderInstructions_[h++]=o[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[E++]=o[0],this.hitRenderInstructions_[E++]=o[1],this.hitRenderInstructions_[E++]=T[0],this.hitRenderInstructions_[E++]=T[1],this.hitRenderInstructions_[E++]=T[2],this.hitRenderInstructions_[E++]=T[3],this.hitRenderInstructions_[E++]=+R);for(var f=void 0,w=0;w<this.customAttributes.length;w++)f=this.customAttributes[w].callback(i.feature,i.properties),this.renderInstructions_[h++]=f,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[E++]=f)}var L={type:df,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(L.projectionTransform=t,this.worker_.postMessage(L,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var g={type:df,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};g.projectionTransform=t,g.hitDetection=!0,this.worker_.postMessage(g,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(i,t,e,r){if(O(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var n=Jt(t.coordinateToPixelTransform,i.slice()),o=this.hitRenderTarget_.readPixel(n[0]/2,n[1]/2),a=function(o){var t=0;return t+=Zm(255*(256*(256*(256*o[0])))),t+=Zm(255*(256*(256*o[1]))),t+=Zm(255*(256*o[2])),t+=Zm(255*o[3])}([o[0]/255,o[1]/255,o[2]/255,o[3]/255]),s=this.hitRenderInstructions_[a],p=N(s).toString(),l=this.getLayer().getSource().getFeatureByUid(p);return l?r(l,this.getLayer()):void 0}},t.prototype.renderHitDetection=function(o){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([N(o.size[0]/2),N(o.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(o,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){y(e)}),this.sourceListenKeys_=null,o.prototype.disposeInternal.call(this)},t}(_f),Tf={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Cf=[Tf.FILL],bf=[Tf.STROKE],Pf=[Tf.BEGIN_PATH],Rf=[Tf.CLOSE_PATH],Of=Tf,If=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Lf=function(a){function t(t,e,r,n){var i=a.call(this)||this;return i.tolerance=t,i.maxExtent=e,i.pixelRatio=n,i.maxLineWidth=0,i.resolution=r,i.beginGeometryInstruction1_=null,i.beginGeometryInstruction2_=null,i.bufferedMaxExtent_=null,i.instructions=[],i.coordinates=[],i.tmpCoordinate_=[],i.hitDetectionInstructions=[],i.state={},i}return If(t,a),t.prototype.applyPixelRatio=function(o){var r=this.pixelRatio;return 1==r?o:o.map(function(e){return e*r})},t.prototype.appendFlatCoordinates=function(_,t,g,r,n,i){var o=this.coordinates.length,y=this.getBufferedMaxExtent();i&&(t+=r);var s=_[t],m=_[t+1],x=this.tmpCoordinate_,f=!0,S,E,T;for(S=t+r;S<g;S+=r)x[0]=_[S],x[1]=_[S+1],(T=gt(y,x))===E?T===1?(this.coordinates[o++]=x[0],this.coordinates[o++]=x[1],f=!1):f=!0:(f&&(this.coordinates[o++]=s,this.coordinates[o++]=m),this.coordinates[o++]=x[0],this.coordinates[o++]=x[1],f=!1),s=x[0],m=x[1],E=T;return(n&&f||S===t+r)&&(this.coordinates[o++]=s,this.coordinates[o++]=m),o},t.prototype.drawCustomCoordinates_=function(l,t,p,r,n){for(var i=0,d=p.length;i<d;++i){var a=p[i],s=this.appendFlatCoordinates(l,t,a,r,!1,!1);n.push(s),t=a}return t},t.prototype.drawCustom=function(_,g,e){this.beginGeometry(_,g);var r=_.getType(),u=_.getStride(),l=this.coordinates.length,y,m,h,x,S;if(r==oe.MULTI_POLYGON){y=(_=_).getOrientedFlatCoordinates(),x=[];var E=_.getEndss();S=0;for(var c=0,T=E.length,f;c<T;++c)f=[],S=this.drawCustomCoordinates_(y,S,E[c],u,f),x.push(f);this.instructions.push([Of.CUSTOM,l,x,_,e,Cr])}else r==oe.POLYGON||r==oe.MULTI_LINE_STRING?(h=[],y=r==oe.POLYGON?_.getOrientedFlatCoordinates():_.getFlatCoordinates(),S=this.drawCustomCoordinates_(y,0,_.getEnds(),u,h),this.instructions.push([Of.CUSTOM,l,h,_,e,xr])):r==oe.LINE_STRING||r==oe.MULTI_POINT?(y=_.getFlatCoordinates(),m=this.appendFlatCoordinates(y,0,y.length,u,!1,!1),this.instructions.push([Of.CUSTOM,l,m,_,e,fr])):r==oe.POINT&&(y=_.getFlatCoordinates(),this.coordinates.push(y[0],y[1]),m=this.coordinates.length,this.instructions.push([Of.CUSTOM,l,m,_,e]));this.endGeometry(g)},t.prototype.beginGeometry=function(o,t){var e=o.getExtent();this.beginGeometryInstruction1_=[Of.BEGIN_GEOMETRY,t,0,e],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Of.BEGIN_GEOMETRY,t,0,e],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},t.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},t.prototype.reverseHitDetectionInstructions=function(){var a=this.hitDetectionInstructions,e;a.reverse();var s=a.length,i=-1,l,p;for(e=0;e<s;++e)(p=(l=a[e])[0])==Of.END_GEOMETRY?i=e:p==Of.BEGIN_GEOMETRY&&(l[2]=e,S(this.hitDetectionInstructions,i,e),i=-1)},t.prototype.setFillStrokeStyle=function(p,t){var e=this.state;if(p){var r=p.getColor();e.fillStyle=Wi(r||"#000")}else e.fillStyle=void 0;if(t){var n=t.getColor();e.strokeStyle=Wi(n||"#000");var i=t.getLineCap();e.lineCap=void 0===i?"round":i;var o=t.getLineDash();e.lineDash=o?o.slice():ls;var a=t.getLineDashOffset();e.lineDashOffset=a||0;var s=t.getLineJoin();e.lineJoin=void 0===s?"round":s;var d=t.getWidth();e.lineWidth=void 0===d?1:d;var l=t.getMiterLimit();e.miterLimit=void 0===l?10:l,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0},t.prototype.createFill=function(o){var t=o.fillStyle,e=[Of.SET_FILL_STYLE,t];return"string"!=typeof t&&e.push(!0),e},t.prototype.applyStroke=function(e){this.instructions.push(this.createStroke(e))},t.prototype.createStroke=function(e){return[Of.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]},t.prototype.updateFillStyle=function(o,t){var e=o.fillStyle;"string"==typeof e&&o.currentFillStyle==e||(void 0!==e&&this.instructions.push(t.call(this,o)),o.currentFillStyle=e)},t.prototype.updateStrokeStyle=function(l,t){var e=l.strokeStyle,r=l.lineCap,n=l.lineDash,i=l.lineDashOffset,o=l.lineJoin,a=l.lineWidth,s=l.miterLimit;l.currentStrokeStyle==e&&l.currentLineCap==r&&(n==l.currentLineDash||Kn(l.currentLineDash,n))&&l.currentLineDashOffset==i&&l.currentLineJoin==o&&l.currentLineWidth==a&&l.currentMiterLimit==s||(void 0!==e&&t.call(this,l),l.currentStrokeStyle=e,l.currentLineCap=r,l.currentLineDash=n,l.currentLineDashOffset=i,l.currentLineJoin=o,l.currentLineWidth=a,l.currentMiterLimit=s)},t.prototype.endGeometry=function(o){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var t=[Of.END_GEOMETRY,o];this.instructions.push(t),this.hitDetectionInstructions.push(t)},t.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=et(this.maxExtent),0<this.maxLineWidth)){var e=this.resolution*(this.maxLineWidth+1)/2;V(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},t}(ss),Ff=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mf=function(a){function t(t,e,r,n){var i=a.call(this,t,e,r,n)||this;return i.declutterGroups_=null,i.hitDetectionImage_=null,i.image_=null,i.anchorX_=void 0,i.anchorY_=void 0,i.height_=void 0,i.opacity_=void 0,i.originX_=void 0,i.originY_=void 0,i.rotateWithView_=void 0,i.rotation_=void 0,i.scale_=void 0,i.width_=void 0,i}return Ff(t,a),t.prototype.drawCoordinates_=function(o,t,e,r){return this.appendFlatCoordinates(o,t,e,r,!1,!1)},t.prototype.drawPoint=function(a,t){if(this.image_){this.beginGeometry(a,t);var e=a.getFlatCoordinates(),r=a.getStride(),n=this.coordinates.length,i=this.drawCoordinates_(e,0,e.length,r);this.instructions.push([Of.DRAW_IMAGE,n,i,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([Of.DRAW_IMAGE,n,i,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t)}},t.prototype.drawMultiPoint=function(a,t){if(this.image_){this.beginGeometry(a,t);var e=a.getFlatCoordinates(),r=a.getStride(),n=this.coordinates.length,i=this.drawCoordinates_(e,0,e.length,r);this.instructions.push([Of.DRAW_IMAGE,n,i,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([Of.DRAW_IMAGE,n,i,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t)}},t.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,a.prototype.finish.call(this)},t.prototype.setImageStyle=function(s,t){var e=s.getAnchor(),r=s.getSize(),n=s.getHitDetectionImage(1),i=s.getImage(1),o=s.getOrigin();this.anchorX_=e[0],this.anchorY_=e[1],this.declutterGroups_=t,this.hitDetectionImage_=n,this.image_=i,this.height_=r[1],this.opacity_=s.getOpacity(),this.originX_=o[0],this.originY_=o[1],this.rotateWithView_=s.getRotateWithView(),this.rotation_=s.getRotation(),this.scale_=s.getScale(),this.width_=r[0]},t}(Lf),Af=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nf=function(o){function t(t,e,r,n){return o.call(this,t,e,r,n)||this}return Af(t,o),t.prototype.drawFlatCoordinates_=function(s,t,e,r){var n=this.coordinates.length,i=this.appendFlatCoordinates(s,t,e,r,!1,!1),o=[Of.MOVE_TO_LINE_TO,n,i];return this.instructions.push(o),this.hitDetectionInstructions.push(o),e},t.prototype.drawLineString=function(s,t){var e=this.state,r=e.strokeStyle,n=e.lineWidth;if(void 0!==r&&void 0!==n){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(s,t),this.hitDetectionInstructions.push([Of.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Pf);var i=s.getFlatCoordinates(),o=s.getStride();this.drawFlatCoordinates_(i,0,i.length,o),this.hitDetectionInstructions.push(bf),this.endGeometry(t)}},t.prototype.drawMultiLineString=function(p,t){var e=this.state,r=e.strokeStyle,n=e.lineWidth;if(void 0!==r&&void 0!==n){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(p,t),this.hitDetectionInstructions.push([Of.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Pf);for(var i=p.getEnds(),o=p.getFlatCoordinates(),a=p.getStride(),s=0,d=0,_=i.length;d<_;++d)s=this.drawFlatCoordinates_(o,s,i[d],a);this.hitDetectionInstructions.push(bf),this.endGeometry(t)}},t.prototype.finish=function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(bf),this.reverseHitDetectionInstructions(),this.state=null,o.prototype.finish.call(this)},t.prototype.applyStroke=function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(bf),t.lastStroke=this.coordinates.length),t.lastStroke=0,o.prototype.applyStroke.call(this,t),this.instructions.push(Pf)},t}(Lf),Gf=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jf=function(o){function t(t,e,r,n){return o.call(this,t,e,r,n)||this}return Gf(t,o),t.prototype.drawFlatCoordinatess_=function(d,t,_,r){var n=this.state,i=void 0!==n.fillStyle,o=void 0!==n.strokeStyle,a=_.length;this.instructions.push(Pf),this.hitDetectionInstructions.push(Pf);for(var s=0;s<a;++s){var g=_[s],l=this.coordinates.length,y=this.appendFlatCoordinates(d,t,g,r,!0,!o),c=[Of.MOVE_TO_LINE_TO,l,y];this.instructions.push(c),this.hitDetectionInstructions.push(c),o&&(this.instructions.push(Rf),this.hitDetectionInstructions.push(Rf)),t=g}return i&&(this.instructions.push(Cf),this.hitDetectionInstructions.push(Cf)),o&&(this.instructions.push(bf),this.hitDetectionInstructions.push(bf)),t},t.prototype.drawCircle=function(l,t){var e=this.state,r=e.fillStyle,n=e.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(l,t),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([Of.SET_FILL_STYLE,"#000"]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([Of.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var i=l.getFlatCoordinates(),o=l.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(i,0,i.length,o,!1,!1);var s=[Of.CIRCLE,a];this.instructions.push(Pf,s),this.hitDetectionInstructions.push(Pf,s),void 0!==e.fillStyle&&(this.instructions.push(Cf),this.hitDetectionInstructions.push(Cf)),void 0!==e.strokeStyle&&(this.instructions.push(bf),this.hitDetectionInstructions.push(bf)),this.endGeometry(t)}},t.prototype.drawPolygon=function(l,t){var e=this.state,r=e.fillStyle,n=e.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(l,t),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([Of.SET_FILL_STYLE,"#000"]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([Of.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var i=l.getEnds(),o=l.getOrientedFlatCoordinates(),a=l.getStride();this.drawFlatCoordinatess_(o,0,i,a),this.endGeometry(t)}},t.prototype.drawMultiPolygon=function(p,t){var e=this.state,r=e.fillStyle,n=e.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(p,t),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([Of.SET_FILL_STYLE,"#000"]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([Of.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);for(var i=p.getEndss(),o=p.getOrientedFlatCoordinates(),a=p.getStride(),s=0,d=0,_=i.length;d<_;++d)s=this.drawFlatCoordinatess_(o,s,i[d],a);this.endGeometry(t)}},t.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,r=0,a=e.length;r<a;++r)e[r]=Lr(e[r],t);return o.prototype.finish.call(this)},t.prototype.setFillStrokeStyles_=function(){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)},t}(Lf),Df=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Uf={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},zf={Circle:jf,Default:Lf,Image:Mf,LineString:Nf,Polygon:jf,Text:function(a){function t(t,e,r,n){var i=a.call(this,t,e,r,n)||this;return i.declutterGroups_,i.labels_=null,i.text_="",i.textOffsetX_=0,i.textOffsetY_=0,i.textRotateWithView_=void 0,i.textRotation_=0,i.textFillState_=null,i.fillStates={},i.textStrokeState_=null,i.strokeStates={},i.textState_={},i.textStates={},i.textKey_="",i.fillKey_="",i.strokeKey_="",i}return Df(t,a),t.prototype.finish=function(){var t=a.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},t.prototype.drawText=function(T,t){var e=this.textFillState_,r=this.textStrokeState_,n=this.textState_;if(""!==this.text_&&n&&(e||r)){var i=this.coordinates.length,C=T.getType(),u=null,P=2,R=2,L,I;if(n.placement==="line"){if(!Dt(this.getBufferedMaxExtent(),T.getExtent()))return;var b;if(u=T.getFlatCoordinates(),R=T.getStride(),C==oe.LINE_STRING)b=[u.length];else if(C==oe.MULTI_LINE_STRING)b=T.getEnds();else if(C==oe.POLYGON)b=T.getEnds().slice(0,1);else if(C==oe.MULTI_POLYGON){var F=T.getEndss();for(b=[],L=0,I=F.length;L<I;++L)b.push(F[L][0])}this.beginGeometry(T,t);for(var f=n.textAlign,d=0,O=void 0,M=0,N=b.length;M<N;++M){if(null==f){var v=d_(n.maxAngle,u,d,b[M],R);d=v[0],O=v[1]}else O=b[M];for(L=d;L<O;L+=R)this.coordinates.push(u[L],u[L+1]);P=this.coordinates.length,d=b[M];var m=this.declutterGroups_?0===M?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(i,P,m),i=P}this.endGeometry(t)}else{var x=null;switch(n.overflow||(x=[]),C){case oe.POINT:case oe.MULTI_POINT:P=(u=T.getFlatCoordinates()).length;break;case oe.LINE_STRING:u=T.getFlatMidpoint();break;case oe.CIRCLE:u=T.getCenter();break;case oe.MULTI_LINE_STRING:P=(u=T.getFlatMidpoints()).length;break;case oe.POLYGON:u=T.getFlatInteriorPoint(),n.overflow||x.push(u[2]/this.resolution),R=3;break;case oe.MULTI_POLYGON:var A=T.getFlatInteriorPoints();for(u=[],L=0,I=A.length;L<I;L+=3)n.overflow||x.push(A[L+2]/this.resolution),u.push(A[L],A[L+1]);if(0==(P=u.length))return;}P=this.appendFlatCoordinates(u,0,P,R,!1,!1),this.saveTextStates_(),(n.backgroundFill||n.backgroundStroke)&&(this.setFillStrokeStyle(n.backgroundFill,n.backgroundStroke),n.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),n.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(T,t);var S=this.pixelRatio;this.instructions.push([Of.DRAW_IMAGE,i,P,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,n.padding==hs?hs:n.padding.map(function(e){return e*S}),!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,x]),this.hitDetectionInstructions.push([Of.DRAW_IMAGE,i,P,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,n.padding,!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,x]),this.endGeometry(t)}}},t.prototype.saveTextStates_=function(){var a=this.textStrokeState_,t=this.textState_,e=this.textFillState_,r=this.strokeKey_;a&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:a.strokeStyle,lineCap:a.lineCap,lineDashOffset:a.lineDashOffset,lineWidth:a.lineWidth,lineJoin:a.lineJoin,miterLimit:a.miterLimit,lineDash:a.lineDash}));var n=this.textKey_;n in this.textStates||(this.textStates[n]={font:t.font,textAlign:t.textAlign||"center",textBaseline:t.textBaseline||"middle",scale:t.scale});var i=this.fillKey_;e&&(i in this.fillStates||(this.fillStates[i]={fillStyle:e.fillStyle}))},t.prototype.drawChars_=function(d,t,e){var r=this.textStrokeState_,n=this.textState_,i=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();var s=this.pixelRatio,_=Uf[n.textBaseline],l=this.textOffsetY_*s,g=this.text_,u=n.scale,p=r?r.lineWidth*u/2:0;this.instructions.push([Of.DRAW_CHARS,d,t,_,e,n.overflow,a,n.maxAngle,s,l,i,p*s,g,o,1]),this.hitDetectionInstructions.push([Of.DRAW_CHARS,d,t,_,e,n.overflow,a,n.maxAngle,1,l,i,p,g,o,1/s])},t.prototype.setTextStyle=function(o,t){var e,m,x;if(o){this.declutterGroups_=t;var S=o.getFill();S?((m=this.textFillState_)||(m={},this.textFillState_=m),m.fillStyle=Wi(S.getColor()||"#000")):(m=null,this.textFillState_=m);var a=o.getStroke();if(a){(x=this.textStrokeState_)||(x={},this.textStrokeState_=x);var s=a.getLineDash(),u=a.getLineDashOffset(),l=a.getWidth(),h=a.getMiterLimit();x.lineCap=a.getLineCap()||"round",x.lineDash=s?s.slice():ls,x.lineDashOffset=void 0===u?0:u,x.lineJoin=a.getLineJoin()||"round",x.lineWidth=void 0===l?1:l,x.miterLimit=void 0===h?10:h,x.strokeStyle=Wi(a.getColor()||"#000")}else x=null,this.textStrokeState_=x;e=this.textState_;var c=o.getFont()||"10px sans-serif";vs(c);var p=o.getScale();e.overflow=o.getOverflow(),e.font=c,e.maxAngle=o.getMaxAngle(),e.placement=o.getPlacement(),e.textAlign=o.getTextAlign(),e.textBaseline=o.getTextBaseline()||"middle",e.backgroundFill=o.getBackgroundFill(),e.backgroundStroke=o.getBackgroundStroke(),e.padding=o.getPadding()||hs,e.scale=void 0===p?1:p;var f=o.getOffsetX(),d=o.getOffsetY(),_=o.getRotateWithView(),g=o.getRotation();this.text_=o.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==_&&_,this.textRotation_=void 0===g?0:g,this.strokeKey_=x?("string"==typeof x.strokeStyle?x.strokeStyle:X(x.strokeStyle))+x.lineCap+x.lineDashOffset+"|"+x.lineWidth+x.lineJoin+x.miterLimit+"["+x.lineDash.join()+"]":"",this.textKey_=e.font+e.scale+(e.textAlign||"?")+(e.textBaseline||"?"),this.fillKey_=m?"string"==typeof m.fillStyle?m.fillStyle:"|"+X(m.fillStyle):""}else this.text_=""},t}(Lf)},Bf=function(){function e(o,t,e,r,n){this.declutter_=n,this.declutterGroups_=null,this.tolerance_=o,this.maxExtent_=t,this.pixelRatio_=r,this.resolution_=e,this.buildersByZIndex_={}}return e.prototype.addDeclutter=function(o){var t=null;return this.declutter_&&(o?(t=this.declutterGroups_)[0][4]++:(t=[[1/0,1/0,-1/0,-1/0]],this.declutterGroups_=t,t[0].push(1))),t},e.prototype.finish=function(){var o={};for(var t in this.buildersByZIndex_){o[t]=o[t]||{};var e=this.buildersByZIndex_[t];for(var r in e){var n=e[r].finish();o[t][r]=n}}return o},e.prototype.getBuilder=function(o,t){var e=void 0===o?"0":o.toString(),r=this.buildersByZIndex_[e];void 0===r&&(r={},this.buildersByZIndex_[e]=r);var a=r[t];return void 0===a&&(a=new(0,zf[t])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[t]=a),a},e}(),Yf=[1/0,1/0,-1/0,-1/0],Wf=[1,0,0,1,0,0],Zf=[],Kf=[],qf=[],Hf=[],Jf=function(){function e(o,t,e,r){this.overlaps=e,this.pixelRatio=t,this.resolution=o,this.alignFill_,this.declutterItems=[],this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return e.prototype.createLabel=function(y,t,e,r){var n=y+t+e+r;if(this.labels_[n])return this.labels_[n];var i=r?this.strokeStates[r]:null,o=e?this.fillStates[e]:null,a=this.textStates[t],s=this.pixelRatio,u=a.scale*s,l=Uf[a.textAlign||"center"],h=r&&i.lineWidth?i.lineWidth:0,c=y.split("\n"),p=c.length,f=[],d=function(s,t,e){for(var r=t.length,n=0,l=0,p;l<r;++l)p=qi(s,t[l]),n=C(n,p),e.push(p);return n}(a.font,c,f),_=ms(a.font),g=d+h,T=[],m={width:F((g+2)*u),height:F((_*p+h)*u),contextInstructions:T};(1!=u&&T.push("scale",[u,u]),T.push("font",a.font),r)&&(T.push("strokeStyle",i.strokeStyle),T.push("lineWidth",h),T.push("lineCap",i.lineCap),T.push("lineJoin",i.lineJoin),T.push("miterLimit",i.miterLimit),(Dn?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(T.push("setLineDash",[i.lineDash]),T.push("lineDashOffset",i.lineDashOffset))),e&&T.push("fillStyle",o.fillStyle),T.push("textBaseline","middle"),T.push("textAlign","center");var x=.5-l,S=l*g+x*h,E;if(r)for(E=0;E<p;++E)T.push("strokeText",[c[E],S+x*f[E],.5*(h+_)+E*_]);if(e)for(E=0;E<p;++E)T.push("fillText",[c[E],S+x*f[E],.5*(h+_)+E*_]);return this.labels_[n]=m,m},e.prototype.replayTextBackground_=function(s,t,e,r,n,i,o){s.beginPath(),s.moveTo.apply(s,t),s.lineTo.apply(s,e),s.lineTo.apply(s,r),s.lineTo.apply(s,n),s.lineTo.apply(s,t),i&&(this.alignFill_=i[2],this.fill_(s)),o&&(this.setStrokeStyle_(s,o),s.stroke())},e.prototype.replayImageOrLabel_=function(F,t,M,N,n,A,G,a,s,u,l,h,c,p,f,d,_,g){var y=_||g;t-=n*=c,M-=A*=c;var v=f+u>N.width?N.width-u:f,m=a+l>N.height?N.height-l:a,x=d[3]+v*c+d[1],w=d[0]+m*c+d[2],S=t-d[3],D=M-d[0];(y||0!==h)&&(Zf[0]=S,Hf[0]=S,Zf[1]=D,Kf[1]=D,Kf[0]=S+x,qf[0]=Kf[0],qf[1]=D+w,Hf[1]=qf[1]);var T=null;if(0!==h){var k=t+n,b=M+A;T=$t(Wf,k,b,1,1,h,-k,-b),Jt(Wf,Zf),Jt(Wf,Kf),Jt(Wf,qf),Jt(Wf,Hf),yt(E(Zf[0],Kf[0],qf[0],Hf[0]),E(Zf[1],Kf[1],qf[1],Hf[1]),C(Zf[0],Kf[0],qf[0],Hf[0]),C(Zf[1],Kf[1],qf[1],Hf[1]),Yf)}else yt(S,D,S+x,D+w,Yf);var P=F.canvas,R=g?g[2]*c/2:0,O=Yf[0]-R<=P.width&&0<=Yf[2]+R&&Yf[1]-R<=P.height&&0<=Yf[3]+R;if(p&&(t=Zm(t),M=Zm(M)),G){if(!O&&1==G[4])return;St(G,Yf);var I=O?[F,T?T.slice(0):null,s,N,u,l,v,m,t,M,c]:null;I&&(y&&I.push(_,g,Zf.slice(0),Kf.slice(0),qf.slice(0),Hf.slice(0)),G.push(I))}else O&&(y&&this.replayTextBackground_(F,Zf,Kf,qf,Hf,_,g),$i(F,T,s,N,u,l,v,m,t,M,c))},e.prototype.fill_=function(o){if(this.alignFill_){var t=Jt(this.renderedTransform_,[0,0]),e=512*this.pixelRatio;o.save(),o.translate(t[0]%e,t[1]%e),o.rotate(this.viewRotation_)}o.fill(),this.alignFill_&&o.restore()},e.prototype.setStrokeStyle_=function(o,t){o.strokeStyle=t[1],o.lineWidth=t[2],o.lineCap=t[3],o.lineJoin=t[4],o.miterLimit=t[5],o.setLineDash&&(o.lineDashOffset=t[7],o.setLineDash(t[6]))},e.prototype.renderDeclutter=function(p,t,e,r){if(p&&5<p.length){var d=p[4];if(1==d||d==p.length-5){var i={minX:p[0],minY:p[1],maxX:p[2],maxY:p[3],value:t};if(r||(r=new nc.a(9)),!r.collides(i)){r.insert(i);for(var o=5,_=p.length;o<_;++o){var s=p[o],g=s[0],l=g.globalAlpha;l!==e&&(g.globalAlpha=e),11<s.length&&this.replayTextBackground_(s[0],s[13],s[14],s[15],s[16],s[11],s[12]),$i.apply(void 0,s),l!==e&&(g.globalAlpha=l)}}p.length=5,mt(p)}}return r},e.prototype.drawLabelWithPointPlacement_=function(p,t,e,r){var n=this.textStates[t],i=this.createLabel(p,t,r,e),o=this.strokeStates[e],a=this.pixelRatio,s=Uf[n.textAlign||"center"],d=Uf[n.textBaseline||"middle"],l=o&&o.lineWidth?o.lineWidth:0;return{label:i,anchorX:s*(i.width/a-2*n.scale)+2*(.5-s)*l,anchorY:d*i.height/a+2*(.5-d)*l}},e.prototype.execute_=function(b,t,e,r,n,i){var o,te,oe;this.declutterItems.length=0,this.pixelCoordinates_&&Kn(t,this.renderedTransform_)?o=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),o=jt(this.coordinates,0,this.coordinates.length,2,t,this.pixelCoordinates_),te=this.renderedTransform_,oe=t,te[0]=oe[0],te[1]=oe[1],te[2]=oe[2],te[3]=oe[3],te[4]=oe[4],te[5]=oe[5]);for(var re=0,ne=e.length,R=0,ie=0,ae=0,se=null,le=null,pe=this.coordinateCache_,A=this.viewRotation_,de=Zm(1e12*sh(-t[1],t[0]))/1e12,G={context:b,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:A},j=this.instructions!=e||this.overlaps?0:200,D,_e,ge,ue,ce,ye,me,he,fe,xe,Se,Ee,Te,Ce,Pe,Re,we,Le;re<ne;)switch(Le=e[re],Le[0]){case Of.BEGIN_GEOMETRY:(Pe=Le[1]).getGeometry()?void 0===i||Dt(i,Le[3])?++re:re=Le[2]+1:re=Le[2];break;case Of.BEGIN_PATH:ie>j&&(this.fill_(b),ie=0),ae>j&&(b.stroke(),ae=0),ie||ae||(b.beginPath(),ue=NaN,ce=NaN),++re;break;case Of.CIRCLE:var Ie=o[R=Le[1]],U=o[R+1],z=o[R+2]-Ie,B=o[R+3]-U,Y=ee(z*z+B*B);b.moveTo(Ie+Y,U),b.arc(Ie,U,Y,0,2*dh,!0),++re;break;case Of.CLOSE_PATH:b.closePath(),++re;break;case Of.CUSTOM:R=Le[1],D=Le[2];var V=Le[3],X=Le[4],W=6==Le.length?Le[5]:void 0;G.geometry=V,G.feature=Pe,re in pe||(pe[re]=[]);var Z=pe[re];W?W(o,R,D,2,Z):(Z[0]=o[R],Z[1]=o[R+1],Z.length=2),X(Z,G),++re;break;case Of.DRAW_IMAGE:R=Le[1],D=Le[2],xe=Le[3],_e=Le[4],ge=Le[5],fe=n?null:Le[6];var K=Le[7],ve=Le[8],H=Le[9],J=Le[10],Q=Le[11],$=Le[12],be=Le[13],Fe=Le[14];if(!xe&&19<=Le.length){Se=Le[18],Ee=Le[19],Te=Le[20],Ce=Le[21];var Oe=this.drawLabelWithPointPlacement_(Se,Ee,Te,Ce);xe=Oe.label,Le[3]=xe;var Me=Le[22];_e=(Oe.anchorX-Me)*this.pixelRatio,Le[4]=_e;var Ne=Le[23];ge=(Oe.anchorY-Ne)*this.pixelRatio,Le[5]=ge,K=xe.height,Le[7]=K,Fe=xe.width,Le[14]=Fe}var Ae=void 0;24<Le.length&&(Ae=Le[24]);var Ge=void 0,De=void 0,ke=void 0;16<Le.length?(Ge=Le[15],De=Le[16],ke=Le[17]):(Ge=hs,De=!1,ke=!1),Q&&de?$+=A:Q||de||($-=A);for(var Ue=0,ze=0;R<D;R+=2)if(!(Ae&&Ae[Ue++]<Fe/this.pixelRatio)){if(fe){var je=N(ze);fe.length<je+1&&((he=[1/0,1/0,-1/0,-1/0]).push(fe[0][4]),fe.push(he)),he=fe[je]}this.replayImageOrLabel_(b,o[R],o[R+1],xe,_e,ge,he,K,ve,H,J,$,be,r,Fe,Ge,De?se:null,ke?le:null),he&&(ze===N(ze)&&this.declutterItems.push(this,he,Pe),ze+=1/he[4])}++re;break;case Of.DRAW_CHARS:var Be=Le[1],Ye=Le[2],Ve=Le[3];he=n?null:Le[4];var Xe=Le[5];Ce=Le[6];var We=Le[7],Ze=Le[8],Ke=Le[9];Te=Le[10];var He=Le[11];Se=Le[12],Ee=Le[13];var qe=Le[14],Je=this.textStates[Ee],Qe=Je.font,$e=Je.scale*Ze,et=void 0;Qe in this.widths_?et=this.widths_[Qe]:(et={},this.widths_[Qe]=et);var ot=h_(o,Be,Ye,2),nt=$e*Ji(Qe,Se,et);if(Xe||nt<=ot){var it=this.textStates[Ee].textAlign,pt=E_(o,Be,Ye,2,Se,(ot-nt)*Uf[it],We,$e,Ji,Qe,et);if(pt){var dt=void 0,_t=void 0,gt=void 0,yt=void 0,mt=void 0;if(Te)for(dt=0,_t=pt.length;dt<_t;++dt)gt=(mt=pt[dt])[4],yt=this.createLabel(gt,Ee,"",Te),_e=mt[2]+He,ge=Ve*yt.height+2*(.5-Ve)*He-Ke,this.replayImageOrLabel_(b,mt[0],mt[1],yt,_e,ge,he,yt.height,1,0,0,mt[3],qe,!1,yt.width,hs,null,null);if(Ce)for(dt=0,_t=pt.length;dt<_t;++dt)gt=(mt=pt[dt])[4],yt=this.createLabel(gt,Ee,Ce,""),_e=mt[2],ge=Ve*yt.height-Ke,this.replayImageOrLabel_(b,mt[0],mt[1],yt,_e,ge,he,yt.height,1,0,0,mt[3],qe,!1,yt.width,hs,null,null)}}this.declutterItems.push(this,he,Pe),++re;break;case Of.END_GEOMETRY:if(void 0!==n){var ft=n(Pe=Le[1]);if(ft)return ft}++re;break;case Of.FILL:j?ie++:this.fill_(b),++re;break;case Of.MOVE_TO_LINE_TO:for(R=Le[1],D=Le[2],Re=o[R],me=0|(we=o[R+1])+.5,(ye=0|Re+.5)===ue&&me===ce||(b.moveTo(Re,we),ue=ye,ce=me),R+=2;R<D;R+=2)ye=0|(Re=o[R])+.5,me=0|(we=o[R+1])+.5,R!=D-2&&ye===ue&&me===ce||(b.lineTo(Re,we),ue=ye,ce=me);++re;break;case Of.SET_FILL_STYLE:se=Le,this.alignFill_=Le[2],ie&&(this.fill_(b),ie=0,ae&&(b.stroke(),ae=0)),b.fillStyle=Le[1],++re;break;case Of.SET_STROKE_STYLE:le=Le,ae&&(b.stroke(),ae=0),this.setStrokeStyle_(b,Le),++re;break;case Of.STROKE:j?ae++:b.stroke(),++re;break;default:++re;}ie&&this.fill_(b),ae&&b.stroke()},e.prototype.execute=function(o,t,e,r){this.viewRotation_=e,this.execute_(o,t,this.instructions,r,void 0,void 0)},e.prototype.executeHitDetection=function(o,t,e,r,n){return this.viewRotation_=e,this.execute_(o,t,this.hitDetectionInstructions,!0,r,n)},e}(),Qf=[Ds,Ms,js,Gs,ks,Ns],$f=function(){function e(a,t,e,r,n,i){this.maxExtent_=a,this.overlaps_=r,this.pixelRatio_=e,this.resolution_=t,this.renderBuffer_=i,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(n)}return e.prototype.clip=function(o,t){var e=this.getClipCoords(t);o.beginPath(),o.moveTo(e[0],e[1]),o.lineTo(e[2],e[3]),o.lineTo(e[4],e[5]),o.lineTo(e[6],e[7]),o.clip()},e.prototype.createExecutors_=function(a){for(var t in a){var e=this.executorsByZIndex_[t];void 0===e&&(e={},this.executorsByZIndex_[t]=e);var s=a[t];for(var n in s){var i=s[n];e[n]=new Jf(this.resolution_,this.pixelRatio_,this.overlaps_,i)}}},e.prototype.hasExecutors=function(o){for(var t in this.executorsByZIndex_)for(var e=this.executorsByZIndex_[t],r=0,a=o.length;r<a;++r)if(o[r]in e)return!0;return!1},e.prototype.forEachFeatureAtCoordinate=function(x,t,e,r,S,i){function o(o){for(var t=E.getImageData(0,0,p,p).data,e=0;e<p;e++)for(var a=0;a<p;a++)if(l[e][a]&&0<t[4*(a*p+e)+3]){var d=void 0;return(!i||T!=Gs&&T!=ks||-1!==i.indexOf(o))&&(d=S(o)),d||void E.clearRect(0,0,p,p)}}var p=2*(r=Zm(r))+1,a=$t(this.hitDetectionTransform_,r+.5,r+.5,1/t,-1/t,-e,-x[0],-x[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Fi(p,p));var E=this.hitDetectionContext_,s;E.canvas.width!==p||E.canvas.height!==p?(E.canvas.width=p,E.canvas.height=p):E.clearRect(0,0,p,p),void 0!==this.renderBuffer_&&(Et(s=[1/0,1/0,-1/0,-1/0],x),V(s,t*(this.renderBuffer_+r),s));var l=function(s){if(void 0!==td[s])return td[s];for(var t=2*s+1,e=Array(t),r=0;r<t;r++)e[r]=Array(t);for(var l=s,p=0,d=0;l>=p;)L_(e,s+l,s+p),L_(e,s+p,s+l),L_(e,s-p,s+l),L_(e,s-l,s+p),L_(e,s-l,s-p),L_(e,s-p,s-l),L_(e,s+p,s-l),L_(e,s+l,s-p),p++,0<2*((d+=1+2*p)-l)+1&&(d+=1-2*(l-=1));return td[s]=e,e}(r),c=Object.keys(this.executorsByZIndex_).map(Number),T,C,P,R,w,L;for(c.sort(Ge),C=c.length-1;0<=C;--C){var I=c[C].toString();for(R=this.executorsByZIndex_[I],P=Qf.length-1;0<=P;--P)if(void 0!==(w=R[T=Qf[P]])&&(L=w.executeHitDetection(E,a,e,o,s)))return L}},e.prototype.getClipCoords=function(s){var t=this.maxExtent_;if(!t)return null;var e=t[0],r=t[1],n=t[2],i=t[3],o=[e,r,e,i,n,i,n,r];return jt(o,0,8,2,s,o),o},e.prototype.isEmpty=function(){return f(this.executorsByZIndex_)},e.prototype.execute=function(y,t,e,r,n,i){var o=Object.keys(this.executorsByZIndex_).map(Number);o.sort(Ge),this.maxExtent_&&(y.save(),this.clip(y,t));var a=n||Qf,m,f,x,S,E,T;for(m=0,f=o.length;m<f;++m){var C=o[m].toString();for(E=this.executorsByZIndex_[C],x=0,S=a.length;x<S;++x){var d=a[x];if(void 0!==(T=E[d]))if(!i||d!=Gs&&d!=ks)T.execute(y,t,e,r);else{var _=i[C];_?_.push(T,t.slice(0)):i[C]=[T,t.slice(0)]}}}this.maxExtent_&&y.restore()},e}(),td={0:[[!0]]},ed=$f,id=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),sd=function(o){function t(t){var e=o.call(this,t)||this;return e.boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(e),e.animatingOrInteracting_,e.dirty_=!1,e.hitDetectionImageData_=null,e.renderedFeatures_=null,e.renderedRevision_=-1,e.renderedResolution_=NaN,e.renderedExtent_=[1/0,1/0,-1/0,-1/0],e.renderedRotation_,e.renderedCenter_=null,e.renderedProjection_=null,e.renderedRenderOrder_=null,e.replayGroup_=null,e.replayGroupChanged=!0,e}return id(t,o),t.prototype.useContainer=function(t,i,r){1>r&&(t=null),o.prototype.useContainer.call(this,t,i,r)},t.prototype.renderFrame=function(M,t){var e=M.pixelRatio,r=M.layerStatesArray[M.layerIndex];!function(o,t,e){qt(o,t,0,0,e,0,0)}(this.pixelTransform,1/e,1/e),er(this.inversePixelTransform,this.pixelTransform);var n=tr(this.pixelTransform);this.useContainer(t,n,r.opacity);var i=this.context,o=i.canvas,a=this.replayGroup_;if(!a||a.isEmpty())return!this.containerReused&&0<o.width&&(o.width=0),this.container;var s=Zm(M.size[0]*e),u=Zm(M.size[1]*e);o.width!=s||o.height!=u?(o.width=s,o.height=u,o.style.transform!==n&&(o.style.transform=n)):this.containerReused||i.clearRect(0,0,s,u),this.preRender(i,M);var l=M.extent,h=M.viewState,c=h.center,p=h.resolution,f=h.projection,d=h.rotation,_=f.getExtent(),g=this.getLayer().getSource(),y=!1;if(r.extent){var N=Zt(r.extent,f);(y=!dt(N,M.extent)&&Dt(N,M.extent))&&this.clip(i,M,N)}var m=M.viewHints,x=!(m[gi]||m[Ti]),w=this.getRenderTransform(c,p,d,e,s,u,0),S=this.getLayer().getDeclutter()?{}:null;if(a.execute(i,w,d,x,void 0,S),g.getWrapX()&&f.canWrapX()&&!dt(_,l)){for(var E=l[0],A=Gt(_),C=0,G=void 0;E<_[0];){G=A*--C;var D=this.getRenderTransform(c,p,d,e,s,u,G);a.execute(i,D,d,x,void 0,S),E+=A}for(C=0,E=l[2];E>_[2];){G=A*++C;var R=this.getRenderTransform(c,p,d,e,s,u,G);a.execute(i,R,d,x,void 0,S),E-=A}}if(S){var O=M.viewHints;rd(S,i,d,1,!(O[gi]||O[Ti]),M.declutterItems)}y&&i.restore(),this.postRender(i,M);var I=r.opacity,L=this.container;return I!==parseFloat(L.style.opacity)&&(L.style.opacity=1===I?"":I),this.container},t.prototype.getFeatures=function(r){return new Promise(function(t){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var e=[this.context.canvas.width,this.context.canvas.height];Jt(this.pixelTransform,e);var n=this.renderedCenter_,i=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,s=this.renderedExtent_,u=this.getLayer(),l=[],m=e[0]/2,c=e[1]/2;l.push(this.getRenderTransform(n,i,o,.5,m,c,0).slice());var p=u.getSource(),h=a.getExtent();if(p.getWrapX()&&a.canWrapX()&&!dt(h,s)){for(var d=s[0],f=Gt(h),g=0,x=void 0;d<h[0];)x=f*--g,l.push(this.getRenderTransform(n,i,o,.5,m,c,x).slice()),d+=f;for(g=0,d=s[2];d>h[2];)x=f*++g,l.push(this.getRenderTransform(n,i,o,.5,m,c,x).slice()),d-=f}this.hitDetectionImageData_=nd(e,l,this.renderedFeatures_,u.getStyleFunction(),s,i,o)}t(od(r,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},t.prototype.forEachFeatureAtCoordinate=function(o,t,e,r,n){if(this.replayGroup_){var i=t.viewState.resolution,a=t.viewState.rotation,s=this.getLayer(),p={};return this.replayGroup_.forEachFeatureAtCoordinate(o,i,a,e,function(o){var t=X(o);if(!(t in p))return p[t]=!0,r(o,s)},s.getDeclutter()?n:null)}},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},t.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(M){var N=this.getLayer(),e=N.getSource();if(!e)return!1;var t=M.viewHints[gi],r=M.viewHints[Ti],n=N.getUpdateWhileAnimating(),o=N.getUpdateWhileInteracting();if(!this.dirty_&&!n&&t||!o&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var i=M.extent,a=M.viewState,s=a.projection,l=a.resolution,u=M.pixelRatio,c=N.getRevision(),p=N.getRenderBuffer(),h=N.getRenderOrder();void 0===h&&(h=fa);var f=a.center.slice(),_=V(i,p*l),g=[_.slice()],y=s.getExtent();if(e.getWrapX()&&s.canWrapX()&&!dt(y,M.extent)){var v=Gt(y),m=C(Gt(_)/2,v);_[0]=y[0]-m,_[2]=y[2]+m,xi(f,s);var x=te(g[0],s);x[0]<y[0]&&x[2]<y[2]?g.push([x[0]+v,x[1],x[2]+v,x[3]]):x[0]>y[0]&&x[2]>y[2]&&g.push([x[0]-v,x[1],x[2]-v,x[3]])}if(!this.dirty_&&this.renderedResolution_==l&&this.renderedRevision_==c&&this.renderedRenderOrder_==h&&dt(this.renderedExtent_,_))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var w=new Bf(Sa(l,u),_,l,u,N.getDeclutter()),E=Yt(),T;if(E){for(var A=0,G=g.length;A<G;++A)e.loadFeatures(Wt(g[A],s),l,E);T=Je(E,s)}else for(A=0,G=g.length;A<G;++A)e.loadFeatures(g[A],l,s);var D=xa(l,u),P=function(e){var t=e.getStyleFunction()||N.getStyleFunction(),o;if(t&&(o=t(e,l)),o){var n=this.renderFeature(e,D,o,w,T);this.dirty_=this.dirty_||n}}.bind(this),R=Wt(_,s),O=e.getFeaturesInExtent(R);for(h&&O.sort(h),A=0,G=O.length;A<G;++A)P(O[A]);this.renderedFeatures_=O;var I=w.finish(),L=new ed(_,l,u,e.getOverlaps(),I,N.getRenderBuffer());return this.renderedResolution_=l,this.renderedRevision_=c,this.renderedRenderOrder_=h,this.renderedExtent_=_,this.renderedRotation_=a.rotation,this.renderedCenter_=f,this.renderedProjection_=s,this.replayGroup_=L,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(l,t,e,r,n){if(!e)return!1;var i=!1;if(Array.isArray(e))for(var p=0,d=e.length;p<d;++p)i=Ra(r,l,e[p],t,this.boundHandleStyleImageChange_,n)||i;else i=Ra(r,l,e,t,this.boundHandleStyleImageChange_,n);return i},t}(lp),ud=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ld=function(a){function t(t){var e=a.call(this,t)||this;return e.vectorRenderer_=new sd(t),e.layerImageRatio_=t.getImageRatio(),e.coordinateToVectorPixelTransform_=[1,0,0,1,0,0],e.renderedPixelToCoordinateTransform_=null,e}return ud(t,a),t.prototype.disposeInternal=function(){this.vectorRenderer_.dispose(),a.prototype.disposeInternal.call(this)},t.prototype.getFeatures=function(o){if(this.vectorRenderer_){var t=Jt(this.coordinateToVectorPixelTransform_,Jt(this.renderedPixelToCoordinateTransform_,o.slice()));return this.vectorRenderer_.getFeatures(t)}return new Promise(function(e){e([])})},t.prototype.handleFontsChanged=function(){this.vectorRenderer_.handleFontsChanged()},t.prototype.prepareFrame=function(p){var t=p.pixelRatio,e=p.viewState,r=e.resolution,n=p.viewHints,i=this.vectorRenderer_,o=p.extent;1!==this.layerImageRatio_&&Ut(o=o.slice(0),this.layerImageRatio_);var _=Gt(o)/r,s=Ot(o)/r;if(!n[gi]&&!n[Ti]&&!kt(o)){i.useContainer(null,null,1);var g=i.context,l=yh({},p,{declutterItems:[],extent:o,size:[_,s],viewState:yh({},p.viewState,{rotation:0})}),u=new Uc(o,r,t,g.canvas,function(e){i.prepareFrame(l)&&i.replayGroupChanged&&(i.renderFrame(l,null),La(l,null),e())});u.addEventListener(A,function(){u.getState()===Ls&&(this.image_=u)}.bind(this)),u.load()}if(this.image_){var c=this.image_,y=c.getResolution()*t/c.getPixelRatio();this.renderedResolution=y,this.renderedPixelToCoordinateTransform_=p.pixelToCoordinateTransform.slice(),this.coordinateToVectorPixelTransform_=$t(this.coordinateToVectorPixelTransform_,_/2,s/2,1/y,-1/y,0,-e.center[0],-e.center[1])}return!!this.image_},t.prototype.preRender=function(){},t.prototype.postRender=function(){},t.prototype.forEachFeatureAtCoordinate=function(t,e,r,n,i){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(t,e,r,n,i):a.prototype.forEachFeatureAtCoordinate.call(this,t,e,r,n,i)},t}(cp),hd="image",cd="hybrid",pd="vector",fd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),dd={image:[Ds,Ms,js,Gs,ks],hybrid:[Ds,js],vector:[]},_d={image:[Ns],hybrid:[Gs,ks,Ns],vector:[Ds,Ms,js,Gs,ks,Ns]},gd=function(o){function t(t){var e=o.call(this,t)||this;return e.boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(e),e.dirty_=!1,e.renderedLayerRevision_,e.renderedPixelToCoordinateTransform_=null,e.renderedRotation_,e.renderTileImageQueue_={},e.tileListenerKeys_={},e.tmpTransform_=[1,0,0,1,0,0],e}return fd(t,o),t.prototype.prepareTile=function(o,t,e,r){var n=X(o),a=o.getState(),s;return(a===hi&&o.hifi||a===ci)&&n in this.tileListenerKeys_&&(y(this.tileListenerKeys_[n]),delete this.tileListenerKeys_[n]),a!==hi&&a!==ci||(this.updateExecutorGroup_(o,t,e),this.tileImageNeedsRender_(o,t,e)&&(s=!0,r&&(this.renderTileImageQueue_[n]=o))),s},t.prototype.getTile=function(t,e,r,n){var i=n.pixelRatio,a=n.viewState,s=a.resolution,g=a.projection,l=this.getLayer(),u=l.getSource().getTile(t,e,r,i,g);if(u.getState()<hi){u.wantedResolution=s;var c=X(u);if(!(c in this.tileListenerKeys_)){var p=_(u,A,this.prepareTile.bind(this,u,i,g,!0));this.tileListenerKeys_[c]=p}}else{var y=n.viewHints;!!(y[gi]||y[Ti])&&u.wantedResolution||(u.wantedResolution=s),this.prepareTile(u,i,g,!1)&&l.getRenderMode()!==pd&&this.renderTileImage_(u,n)}return o.prototype.getTile.call(this,t,e,r,n)},t.prototype.isDrawableTile=function(t){var e=this.getLayer();return o.prototype.isDrawableTile.call(this,t)&&e.getRenderMode()===pd||t.hasContext(e)},t.prototype.getTileImage=function(e){return e.getImage(this.getLayer())},t.prototype.prepareFrame=function(t){var e=this.getLayer().getRevision();return this.renderedLayerRevision_!=e&&(this.renderedTiles.length=0),this.renderedLayerRevision_=e,o.prototype.prepareFrame.call(this,t)},t.prototype.updateExecutorGroup_=function(L,t,e){var I=this.getLayer(),o=I.getRevision(),n=I.getRenderOrder()||null,a=L.wantedResolution,s=L.getReplayState(I);if(s.dirty||s.renderedResolution!==a||s.renderedRevision!=o||s.renderedRenderOrder!=n||s.renderedZ!==L.sourceZ){var i=I.getSource(),l=i.getTileGrid(),u=i.getTileGridForProjection(e).getTileCoordExtent(L.wrappedTileCoord),c=i.getSourceTiles(t,e,L),p=X(I);delete L.hitDetectionImageData[p],L.executorGroups[p]=[];for(var r=function(e){var r=c[e];if(r.getState()!=hi)return"continue";var o=r.tileCoord,d=l.getTileCoordExtent(o),_=Mt(u,d),g=xt(d,_)?null:V(_,I.getRenderBuffer()*a,h.tmpExtent);s.dirty=!1;var y=new Bf(0,_,a,t,I.getDeclutter()),m=xa(a,t),f=function(o){var t=o.getStyleFunction()||I.getStyleFunction(),r;if(t&&(r=t(o,a)),r){var n=this.renderFeature(o,m,r,y);this.dirty_=this.dirty_||n,s.dirty=s.dirty||n}},x=r.getFeatures();n&&n!==s.renderedRenderOrder&&x.sort(n);for(var S=0,w=x.length,T;S<w;++S)T=x[S],g&&!Dt(g,T.getGeometry().getExtent())||f.call(h,T);var v=y.finish(),b=I.getRenderMode()!==pd&&I.getDeclutter()&&1===c.length?null:_,P=new ed(b,a,t,i.getOverlaps(),v,I.getRenderBuffer());L.executorGroups[p].push(P)},h=this,d=0,_=c.length;d<_;++d)r(d);s.renderedRevision=o,s.renderedZ=L.sourceZ,s.renderedRenderOrder=n,s.renderedResolution=a}},t.prototype.forEachFeatureAtCoordinate=function(o,t,x,y,n){var i=t.viewState.resolution,a=t.viewState.rotation;x=null==x?0:x;var s=this.getLayer(),c=s.getDeclutter(),p=s.getSource().getTileGridForProjection(t.viewState.projection),m={},d=this.renderedTiles,e=function(){var t=d[f],r=pt(p.getTileCoordExtent(t.wrappedTileCoord),o);if(!c&&!r)return"continue";for(var e=t.executorGroups[X(s)],l=0,g=e.length,u;l<g;++l)u=e[l],_=_||u.forEachFeatureAtCoordinate(o,i,a,x,function(o){if(r||n&&-1!==n.indexOf(o)){var t=o.getId();if(void 0===t&&(t=X(o)),!(t in m))return m[t]=!0,y(o,s)}},s.getDeclutter()?n:null)},_,f,g;for(f=0,g=d.length;f<g;++f)e();return _},t.prototype.getFeatures=function(e){return new Promise(function(t){for(var o=this.getLayer(),r=X(o),i=o.getSource(),a=this.renderedProjection,s=a.getExtent(),l=this.renderedResolution,u=i.getTileGridForProjection(a),c=Jt(this.renderedPixelToCoordinateTransform_,e.slice()),p=u.getTileCoordForCoordAndResolution(c,l),h=0,f=this.renderedTiles.length,_;h<f;++h)if(p.toString()===this.renderedTiles[h].tileCoord.toString()){if((_=this.renderedTiles[h]).getState()===hi&&_.hifi){var T=u.getTileCoordExtent(_.tileCoord);i.getWrapX()&&a.canWrapX()&&!dt(s,T)&&xi(c,a);break}_=void 0}if(!_||0<_.loadingSourceTiles)t([]);else{var g=Nt(u.getTileCoordExtent(_.wrappedTileCoord)),y=[(c[0]-g[0])/l,(g[1]-c[1])/l],C=_.getSourceTiles().reduce(function(o,t){return o.concat(t.getFeatures())},[]),m=_.hitDetectionImageData[r];if(!m&&!this.animatingOrInteracting_){var P=Eo(u.getTileSize(u.getZForResolution(l))),R=[P[0]/2,P[1]/2],S=this.renderedRotation_;m=nd(P,[this.getRenderTransform(u.getTileCoordCenter(_.wrappedTileCoord),l,0,.5,R[0],R[1],0)],C,o.getStyleFunction(),u.getTileCoordExtent(_.wrappedTileCoord),_.getReplayState(o).renderedResolution,S),_.hitDetectionImageData[r]=m}t(od(y,C,m))}}.bind(this))},t.prototype.handleFontsChanged=function(){k(this.renderTileImageQueue_);var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},t.prototype.handleStyleImageChange_=function(){this.renderIfReadyAndVisible()},t.prototype.renderFrame=function(t,e){var r=t.viewHints,n=!(r[gi]||r[Ti]);this.renderQueuedTileImages_(n,t),o.prototype.renderFrame.call(this,t,e),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;var i=this.getLayer(),a=i.getRenderMode();if(a===hd)return this.container;var s=i.getSource(),u=t.usedTiles[X(s)];for(var l in this.renderTileImageQueue_)u&&l in u||delete this.renderTileImageQueue_[l];for(var h=this.context,c=i.getDeclutter()?{}:null,p=_d[a],f=t.pixelRatio,d=t.viewState,_=d.center,g=d.resolution,y=d.rotation,v=t.size,m=Zm(v[0]*f),x=Zm(v[1]*f),w=this.renderedTiles,S=s.getTileGridForProjection(t.viewState.projection),E=[],T=[],C=w.length-1;0<=C;--C)for(var B=w[C],P=B.tileCoord,R=S.getTileCoordExtent(B.wrappedTileCoord),O=S.getTileCoordExtent(P,this.tmpExtent)[0]-R[0],I=Ht(Qt(this.inversePixelTransform.slice(),1/f,1/f),this.getRenderTransform(_,g,y,f,m,x,O)),L=B.executorGroups[X(i)],F=!1,Y=0,V=L.length,N;Y<V;++Y)if(N=L[Y],N.hasExecutors(p)){var W=B.tileCoord[0],j=void 0;if(!c&&!F){j=N.getClipCoords(I),h.save();for(var Z=0,K=E.length,U;Z<K;++Z)U=E[Z],W<T[Z]&&(h.beginPath(),h.moveTo(j[0],j[1]),h.lineTo(j[2],j[3]),h.lineTo(j[4],j[5]),h.lineTo(j[6],j[7]),h.moveTo(U[6],U[7]),h.lineTo(U[4],U[5]),h.lineTo(U[2],U[3]),h.lineTo(U[0],U[1]),h.clip())}N.execute(h,I,y,n,p,c),c||F||(h.restore(),E.push(j),T.push(W),F=!0)}return c&&rd(c,h,y,t.layerStatesArray[t.layerIndex].opacity,n,t.declutterItems),this.container},t.prototype.renderQueuedTileImages_=function(o,t){for(var e in this.renderTileImageQueue_){if(!o&&8<Date.now()-t.time){t.animate=!0;break}var r=this.renderTileImageQueue_[e];delete this.renderTileImageQueue_[e],this.renderTileImage_(r,t)}},t.prototype.renderFeature=function(s,t,e,r){if(!e)return!1;var n=!1;if(Array.isArray(e))for(var l=0,p=e.length;l<p;++l)n=Ra(r,s,e[l],t,this.boundHandleStyleImageChange_)||n;else n=Ra(r,s,e,t,this.boundHandleStyleImageChange_);return n},t.prototype.tileImageNeedsRender_=function(e){var t=this.getLayer(),r=e.getReplayState(t),n=t.getRevision(),o=e.sourceZ,i=e.wantedResolution;return r.renderedTileResolution!==i||r.renderedTileRevision!==n||r.renderedTileZ!==o},t.prototype.renderTileImage_=function(o,t){var e=this.getLayer(),r=o.getReplayState(e),n=e.getRevision(),i=o.executorGroups[X(e)];r.renderedTileRevision=n,r.renderedTileZ=o.sourceZ;var a=o.wrappedTileCoord,s=a[0],u=e.getSource(),l=t.pixelRatio,P=t.viewState.projection,c=u.getTileGridForProjection(P),p=c.getResolution(o.tileCoord[0]),f=t.pixelRatio/o.wantedResolution*p,d=c.getResolution(s),_=o.getContext(e);l=C(l,f/l);var g=u.getTilePixelSize(s,l,P);_.canvas.width=g[0],_.canvas.height=g[1];var y=l/f;if(1!=y){var R=Kt(this.tmpTransform_);Qt(R,y,y),_.setTransform.apply(_,R)}var m=c.getTileCoordExtent(a,this.tmpExtent),x=f/d,w=Kt(this.tmpTransform_);Qt(w,x,-x),function(o,t,e){Ht(o,qt(Uh,1,0,0,1,t,e))}(w,-m[0],-m[3]);for(var S=0,L=i.length;S<L;++S)i[S].execute(_,w,0,!0,dd[e.getRenderMode()]);r.renderedTileResolution=o.wantedResolution},t}(xp),yd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vd=function(o){function t(t){return o.call(this,t)||this}return yd(t,o),t.prototype.createRenderer=function(){return new sd(this)},t}(wf),md=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Sd=function(o){function n(t,e){var r=o.call(this)||this;return r.flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r}return md(n,o),n.prototype.appendCoordinate=function(e){this.flatCoordinates?v(this.flatCoordinates,e):this.flatCoordinates=e.slice(),this.changed()},n.prototype.clone=function(){return new n(this.flatCoordinates.slice(),this.layout)},n.prototype.closestPointXY=function(o,t,e,r){return r<st(this.getExtent(),o,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=ee(_r(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,o,t,e,r))},n.prototype.forEachSegment=function(e){return Gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)},n.prototype.getCoordinateAtM=function(o,t){if(this.layout!=ne&&this.layout!=ie)return null;return xd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,o,void 0!==t&&t)},n.prototype.getCoordinates=function(){return fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getCoordinateAt=function(o,t){return ad(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,o,t)},n.prototype.getLength=function(){return h_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},n.prototype.getSimplifiedGeometryInternal=function(e){var t=[];return t.length=Pr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new n(t,lt)},n.prototype.getType=function(){return oe.LINE_STRING},n.prototype.intersectsExtent=function(e){return Dr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)},n.prototype.setCoordinates=function(o,t){this.setLayout(t,o,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mr(this.flatCoordinates,0,o,this.stride),this.changed()},n}(Tr),Ed=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cd=new rh({color:"rgba(0,0,0,0.2)"}),bd=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],Pd=function(o){function t(t){var e=this,a=t||{},n=yh({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},a);return delete n.maxLines,delete n.strokeStyle,delete n.targetSize,delete n.showLabels,delete n.lonLabelFormatter,delete n.latLabelFormatter,delete n.lonLabelPosition,delete n.latLabelPosition,delete n.lonLabelStyle,delete n.latLabelStyle,delete n.intervals,(e=o.call(this,n)||this).projection_=null,e.maxLat_=1/0,e.maxLon_=1/0,e.minLat_=-1/0,e.minLon_=-1/0,e.maxX_=1/0,e.maxY_=1/0,e.minX_=-1/0,e.minY_=-1/0,e.targetSize_=void 0===a.targetSize?100:a.targetSize,e.maxLines_=void 0===a.maxLines?100:a.maxLines,e.meridians_=[],e.parallels_=[],e.strokeStyle_=void 0===a.strokeStyle?Cd:a.strokeStyle,e.fromLonLatTransform_=void 0,e.toLonLatTransform_=void 0,e.projectionCenterLonLat_=null,e.bottomLeft_=null,e.bottomRight_=null,e.topLeft_=null,e.topRight_=null,e.meridiansLabels_=null,e.parallelsLabels_=null,a.showLabels&&(e.lonLabelFormatter_=null==a.lonLabelFormatter?_n.bind(e,"EW"):a.lonLabelFormatter,e.latLabelFormatter_=null==a.latLabelFormatter?_n.bind(e,"NS"):a.latLabelFormatter,e.lonLabelPosition_=null==a.lonLabelPosition?0:a.lonLabelPosition,e.latLabelPosition_=null==a.latLabelPosition?1:a.latLabelPosition,e.lonLabelStyleBase_=new Vf({text:void 0===a.lonLabelStyle?new lh({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new Ul({color:"rgba(0,0,0,1)"}),stroke:new rh({color:"rgba(255,255,255,1)",width:3})}):a.lonLabelStyle.clone()}),e.lonLabelStyle_=function(o){var t=o.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(t),this.lonLabelStyleBase_}.bind(e),e.latLabelStyleBase_=new Vf({text:void 0===a.latLabelStyle?new lh({font:"12px Calibri,sans-serif",textAlign:"right",fill:new Ul({color:"rgba(0,0,0,1)"}),stroke:new rh({color:"rgba(255,255,255,1)",width:3})}):a.latLabelStyle.clone()}),e.latLabelStyle_=function(o){var t=o.get("graticule_label");return this.latLabelStyleBase_.getText().setText(t),this.latLabelStyleBase_}.bind(e),e.meridiansLabels_=[],e.parallelsLabels_=[],e.addEventListener(ni,e.drawLabels_.bind(e))),e.intervals_=void 0===a.intervals?bd:a.intervals,e.setSource(new sc({loader:e.loaderFunction.bind(e),strategy:e.strategyFunction.bind(e),features:new ot,overlaps:!1,useSpatialIndex:!1,wrapX:a.wrapX})),e.featurePool_=[],e.lineStyle_=new Vf({stroke:e.strokeStyle_}),e.loadedExtent_=null,e.renderedExtent_=null,e.setRenderOrder(null),e}return Ed(t,o),t.prototype.strategyFunction=function(a,t){var e=a.slice(),s,l,p;return this.projection_&&this.getSource().getWrapX()&&te(e,this.projection_),this.loadedExtent_&&(s=this.loadedExtent_,l=e,p=t,P(s[0]-l[0])<p&&P(s[2]-l[2])<p&&P(s[1]-l[1])<p&&P(s[3]-l[3])<p?e=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[e]},t.prototype.loaderFunction=function(a,t,e){this.loadedExtent_=a;var r=this.getSource(),n=Mt(this.getExtent()||[-1/0,-1/0,1/0,1/0],a);if(!(this.renderedExtent_&&xt(this.renderedExtent_,n)||(this.renderedExtent_=n,kt(n)))){var i=vt(n);this.projection_&&qe(this.projection_,e)||this.updateProjectionInfo_(e),this.createGraticule_(n,i,t,t*t/4);var o=this.meridians_.length+this.parallels_.length,d;for(this.meridiansLabels_&&(o+=this.meridians_.length),this.parallelsLabels_&&(o+=this.parallels_.length);o>this.featurePool_.length;)d=new ut,this.featurePool_.push(d);var _=r.getFeaturesCollection();_.clear();var l=0,g,y;for(g=0,y=this.meridians_.length;g<y;++g)(d=this.featurePool_[l++]).setGeometry(this.meridians_[g]),d.setStyle(this.lineStyle_),_.push(d);for(g=0,y=this.parallels_.length;g<y;++g)(d=this.featurePool_[l++]).setGeometry(this.parallels_[g]),d.setStyle(this.lineStyle_),_.push(d)}},t.prototype.addMeridian_=function(l,t,e,r,n,i){var p=this.getMeridian_(l,t,e,r,i);if(Dt(p.getExtent(),n)){if(this.meridiansLabels_){var a=this.lonLabelFormatter_(l);i in this.meridiansLabels_?this.meridiansLabels_[i].text=a:this.meridiansLabels_[i]={geom:new Zr([]),text:a}}this.meridians_[i++]=p}return i},t.prototype.addParallel_=function(l,t,e,r,n,i){var p=this.getParallel_(l,t,e,r,i);if(Dt(p.getExtent(),n)){if(this.parallelsLabels_){var a=this.latLabelFormatter_(l);i in this.parallelsLabels_?this.parallelsLabels_[i].text=a:this.parallelsLabels_[i]={geom:new Zr([]),text:a}}this.parallels_[i++]=p}return i},t.prototype.drawLabels_=function(C){var t=C.frameState.viewState.rotation,e=C.frameState.extent,r=vt(e),n=e;if(t){var R=Gt(e),o=Ot(e),a=P(gh(t)),s=P(_h(t)),u=(s*o-a*R)/(s*s-a*a),l=(s*R-a*o)/(s*s-a*a);n=[r[0]-u/2,r[1]-l/2,r[0]+u/2,r[1]+l/2]}var h=0,L=0,I=.5>this.latLabelPosition_,b=this.projection_.getExtent(),d=Gt(b);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!dt(b,e)&&(h=N((e[0]-b[0])/d),L=F((e[2]-b[2])/d),I=I!==P(t)>dh/2);for(var _=wa(C),g=h;g<=L;++g){var O=this.meridians_.length+this.parallels_.length,M=void 0,A=void 0,G=void 0,D=void 0;if(this.meridiansLabels_)for(A=0,G=this.meridiansLabels_.length;A<G;++A){var k=this.meridians_[A];t||0!==g?((U=k.clone()).translate(g*d,0),U.rotate(-t,r),(D=this.getMeridianPoint_(U,n,A)).rotate(t,r)):D=this.getMeridianPoint_(k,e,A),(M=this.featurePool_[O++]).setGeometry(D),M.set("graticule_label",this.meridiansLabels_[A].text),_.drawFeature(M,this.lonLabelStyle_(M))}if(this.parallelsLabels_&&(g===h&&I||g===L&&!I))for(A=0,G=this.parallels_.length;A<G;++A){var U;k=this.parallels_[A],t||0!==g?((U=k.clone()).translate(g*d,0),U.rotate(-t,r),(D=this.getParallelPoint_(U,n,A)).rotate(t,r)):D=this.getParallelPoint_(k,e,A),(M=this.featurePool_[O++]).setGeometry(D),M.set("graticule_label",this.parallelsLabels_[A].text),_.drawFeature(M,this.latLabelStyle_(M))}}},t.prototype.createGraticule_=function(T,t,e,r){var n=this.getInterval_(e);if(-1==n)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var i=!1,R=this.projection_.getExtent(),a=Gt(R);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!dt(R,T)&&(Gt(T)>=a?(T[0]=R[0],T[2]=R[2]):i=!0);var s=[le(t[0],this.minX_,this.maxX_),le(t[1],this.minY_,this.maxY_)],u=this.toLonLatTransform_(s);isNaN(u[1])&&(u[1]=P(this.maxLat_)>=P(this.minLat_)?this.maxLat_:this.minLat_);var l=le(u[0],this.minLon_,this.maxLon_),L=le(u[1],this.minLat_,this.maxLat_),I=this.maxLines_,g=T,b,F,O,M;i||(g=[le(T[0],this.minX_,this.maxX_),le(T[1],this.minY_,this.maxY_),le(T[2],this.minX_,this.maxX_),le(T[3],this.minY_,this.maxY_)]);var A=zt(g,this.toLonLatTransform_,void 0,8),v=A[3],G=A[2],D=A[1],k=A[0];if(i||(pt(g,this.bottomLeft_)&&(k=this.minLon_,D=this.minLat_),pt(g,this.bottomRight_)&&(G=this.maxLon_,D=this.minLat_),pt(g,this.topLeft_)&&(k=this.minLon_,v=this.maxLat_),pt(g,this.topRight_)&&(G=this.maxLon_,v=this.maxLat_),v=le(v,L,this.maxLat_),G=le(G,l,this.maxLon_),D=le(D,this.minLat_,L),k=le(k,this.minLon_,l)),M=le(l=N(l/n)*n,this.minLon_,this.maxLon_),F=this.addMeridian_(M,D,v,r,T,0),b=0,i)for(;(M-=n)>=k&&b++<I;)F=this.addMeridian_(M,D,v,r,T,F);else for(;M!=this.minLon_&&b++<I;)M=C(M-n,this.minLon_),F=this.addMeridian_(M,D,v,r,T,F);if(M=le(l,this.minLon_,this.maxLon_),b=0,i)for(;(M+=n)<=G&&b++<I;)F=this.addMeridian_(M,D,v,r,T,F);else for(;M!=this.maxLon_&&b++<I;)M=E(M+n,this.maxLon_),F=this.addMeridian_(M,D,v,r,T,F);for(this.meridians_.length=F,this.meridiansLabels_&&(this.meridiansLabels_.length=F),O=le(L=N(L/n)*n,this.minLat_,this.maxLat_),F=this.addParallel_(O,k,G,r,T,0),b=0;O!=this.minLat_&&b++<I;)O=C(O-n,this.minLat_),F=this.addParallel_(O,k,G,r,T,F);for(O=le(L,this.minLat_,this.maxLat_),b=0;O!=this.maxLat_&&b++<I;)O=E(O+n,this.maxLat_),F=this.addParallel_(O,k,G,r,T,F);this.parallels_.length=F,this.parallelsLabels_&&(this.parallelsLabels_.length=F)},t.prototype.getInterval_=function(p){for(var t=this.projectionCenterLonLat_[0],e=this.projectionCenterLonLat_[1],r=-1,d=M(this.targetSize_*p,2),i=[],o=[],a=0,_=this.intervals_.length;a<_;++a){var g=le(this.intervals_[a]/2,0,90),l=le(e,-90+g,90-g);if(i[0]=t-g,i[1]=l-g,o[0]=t+g,o[1]=l+g,this.fromLonLatTransform_(i,i),this.fromLonLatTransform_(o,o),M(o[0]-i[0],2)+M(o[1]-i[1],2)<=d)break;r=this.intervals_[a]}return r},t.prototype.getMeridian_=function(s,t,e,r,n){var i=function(o,t,e,r,n){return wd(function(r){return[o,t+(e-t)*r]},Qe(Ve("EPSG:4326"),r),n)}(s,t,e,this.projection_,r),o=this.meridians_[n];return o?(o.setFlatCoordinates(lt,i),o.changed()):(o=new Sd(i,lt),this.meridians_[n]=o),o},t.prototype.getMeridianPoint_=function(p,t,e){var r=p.getFlatCoordinates(),n=1,d=r.length-1;r[n]>r[d]&&(n=d,d=1);var _=C(t[1],r[n]),a=E(t[3],r[d]),s=le(t[1]+P(t[1]-t[3])*this.lonLabelPosition_,_,a),g=[r[n-1]+(r[d-1]-r[n-1])*(s-r[n])/(r[d]-r[n]),s],l=this.meridiansLabels_[e].geom;return l.setCoordinates(g),l},t.prototype.getMeridians=function(){return this.meridians_},t.prototype.getParallel_=function(s,t,e,r,n){var i=function(o,t,e,r,n){return wd(function(r){return[t+(e-t)*r,o]},Qe(Ve("EPSG:4326"),r),n)}(s,t,e,this.projection_,r),o=this.parallels_[n];return o?(o.setFlatCoordinates(lt,i),o.changed()):o=new Sd(i,lt),o},t.prototype.getParallelPoint_=function(p,t,e){var r=p.getFlatCoordinates(),n=0,d=r.length-2;r[n]>r[d]&&(n=d,d=0);var _=C(t[0],r[n]),a=E(t[2],r[d]),s=le(t[0]+P(t[0]-t[2])*this.latLabelPosition_,_,a),g=[s,r[n+1]+(r[d+1]-r[n+1])*(s-r[n])/(r[d]-r[n])],l=this.parallelsLabels_[e].geom;return l.setCoordinates(g),l},t.prototype.getParallels=function(){return this.parallels_},t.prototype.updateProjectionInfo_=function(a){var t=Ve("EPSG:4326"),e=a.getWorldExtent();this.maxLat_=e[3],this.maxLon_=e[2],this.minLat_=e[1],this.minLon_=e[0];var l=Qe(a,t);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=l;else{var n=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(i,t,e){for(var r=e||2,o=l(i,t,r),a=0,p=o.length;a<p;a+=r)o[a]<n&&(o[a]+=360);return o}}this.fromLonLatTransform_=Qe(t,a);var r=zt([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=r[0],this.maxX_=r[2],this.minY_=r[1],this.maxY_=r[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_(vt(a.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=P(this.maxLat_)>=P(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=a},t}(vd),Rd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Od="blur",Id="gradient",Ld="radius",Fd=["#00f","#0ff","#0f0","#ff0","#f00"],Md=function(a){function t(t){var e=this,s=t||{},n=yh({},s);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,(e=a.call(this,n)||this).gradient_=null,e.addEventListener(L(Id),e.handleGradientChanged_),e.setGradient(s.gradient?s.gradient:Fd),e.setBlur(void 0===s.blur?15:s.blur),e.setRadius(void 0===s.radius?8:s.radius);var i=s.weight?s.weight:"weight";return e.weightFunction_="string"==typeof i?function(e){return e.get(i)}:i,e.setRenderOrder(null),e}return Rd(t,a),t.prototype.getBlur=function(){return this.get(Od)},t.prototype.getGradient=function(){return this.get(Id)},t.prototype.getRadius=function(){return this.get(Ld)},t.prototype.handleGradientChanged_=function(){this.gradient_=function(a){for(var t=Fi(1,256),e=t.createLinearGradient(0,0,1,256),r=1/(a.length-1),n=0,s=a.length;n<s;++n)e.addColorStop(n*r,a[n]);return t.fillStyle=e,t.fillRect(0,0,1,256),t.canvas}(this.getGradient())},t.prototype.setBlur=function(e){this.set(Od,e)},t.prototype.setGradient=function(e){this.set(Id,e)},t.prototype.setRadius=function(e){this.set(Ld,e)},t.prototype.createRenderer=function(){return new Ef(this,{attributes:[{name:"weight",callback:function(o){var t=this.weightFunction_(o);return void 0===t?1:le(t,0,1)}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(Ld)+this.get(Od))}.bind(this),u_blurSlope:function(){return this.get(Ld)/C(1,this.get(Od))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},t}(vd),Ad=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nd=function(o){function t(t){var e=this,a=t||{},n=yh({},a);return delete n.imageRatio,(e=o.call(this,n)||this).imageRatio_=void 0===a.imageRatio?1:a.imageRatio,e}return Ad(t,o),t.prototype.getImageRatio=function(){return this.imageRatio_},t.prototype.createRenderer=function(){return new ld(this)},t}(wf),Gd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jd=function(a){function t(t){var e=this,s=t||{},n=yh({},s);delete n.preload,delete n.useInterimTilesOnError,e=a.call(this,n)||this;var i=s.renderMode||cd;return O(null==i||i==hd||i==cd||i==pd,28),e.renderMode_=i,e.setPreload(s.preload?s.preload:0),e.setUseInterimTilesOnError(void 0===s.useInterimTilesOnError||s.useInterimTilesOnError),e}return Gd(t,a),t.prototype.createRenderer=function(){return new gd(this)},t.prototype.getFeatures=function(t){return a.prototype.getFeatures.call(this,t)},t.prototype.getRenderMode=function(){return this.renderMode_},t.prototype.getPreload=function(){return this.get(dp)},t.prototype.getUseInterimTilesOnError=function(){return this.get(_p)},t.prototype.setPreload=function(e){this.set(dp,e)},t.prototype.setUseInterimTilesOnError=function(e){this.set(_p,e)},t}(wf),Dd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kd=function(a){function t(t,e,r,n){var i=a.call(this,t)||this;return i.features=r,i.file=e,i.projection=n,i}return Dd(t,a),t}(fh),zd=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,{handleEvent:T})||this).formatConstructors_=i.formatConstructors?i.formatConstructors:[],e.projection_=i.projection?Ve(i.projection):null,e.dropListenKeys_=null,e.source_=i.source||null,e.target=i.target?i.target:null,e}return Dd(t,o),t.prototype.handleResult_=function(p,t){var e=t.target.result,r=this.getMap(),n=this.projection_;n||(n=r.getView().getProjection());for(var d=this.formatConstructors_,o=[],_=0,g=d.length,u;_<g&&(u=new d[_],!((o=this.tryReadFeatures_(u,e,{featureProjection:n}))&&0<o.length));++_);this.source_&&(this.source_.clear(),this.source_.addFeatures(o)),this.dispatchEvent(new kd("addfeatures",p,o,n))},t.prototype.registerListeners_=function(){var o=this.getMap();if(o){var t=this.target?this.target:o.getViewport();this.dropListenKeys_=[_(t,D,Td,this),_(t,"dragenter",Bd,this),_(t,"dragover",Bd,this),_(t,D,Bd,this)]}},t.prototype.setActive=function(t){!this.getActive()&&t&&this.registerListeners_(),this.getActive()&&!t&&this.unregisterListeners_(),o.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.unregisterListeners_(),o.prototype.setMap.call(this,t),this.getActive()&&this.registerListeners_()},t.prototype.tryReadFeatures_=function(o,t,e){try{return o.readFeatures(t,e)}catch(e){return null}},t.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(y),this.dropListenKeys_=null)},t}(Xo),Vd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xd=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,i)||this).condition_=i.condition?i.condition:ia,e.lastAngle_=void 0,e.lastMagnitude_=void 0,e.lastScaleDelta_=0,e.duration_=void 0===i.duration?400:i.duration,e}return Vd(t,o),t.prototype.handleDragEvent=function(p){if(aa(p)){var t=p.map,e=t.getSize(),r=p.pixel,n=r[0]-e[0]/2,i=e[1]/2-r[1],o=sh(i,n),a=ee(n*n+i*i),s=t.getView();if(void 0!==this.lastAngle_){var d=this.lastAngle_-o;s.adjustRotationInternal(d)}this.lastAngle_=o,void 0!==this.lastMagnitude_&&s.adjustResolutionInternal(this.lastMagnitude_/a),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/a),this.lastMagnitude_=a}},t.prototype.handleUpEvent=function(o){if(!aa(o))return!0;var t=o.map.getView(),e=1<this.lastScaleDelta_?1:-1;return t.endInteraction(this.duration_,e),this.lastScaleDelta_=0,!1},t.prototype.handleDownEvent=function(e){return!!aa(e)&&!!this.condition_(e)&&(e.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0)},t}(la),Wd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zd=function(o){function t(t,e,r){var n=o.call(this)||this;if(void 0!==r&&void 0===e)n.setFlatCoordinates(r,t);else{n.setCenterAndRadius(t,e||0,r)}return n}return Wd(t,o),t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),void 0,this.layout)},t.prototype.closestPointXY=function(p,t,e,r){var n=this.flatCoordinates,i=p-n[0],o=t-n[1],a=i*i+o*o;if(a<r){if(0===a)for(var s=0;s<this.stride;++s)e[s]=n[s];else{var d=this.getRadius()/ee(a);for(e[0]=n[0]+d*i,e[1]=n[1]+d*o,s=2;s<this.stride;++s)e[s]=n[s]}return e.length=this.stride,a}return r},t.prototype.containsXY=function(o,t){var e=this.flatCoordinates,r=o-e[0],n=t-e[1];return r*r+n*n<=this.getRadiusSquared_()},t.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.computeExtent=function(o){var t=this.flatCoordinates,e=t[this.stride]-t[0];return yt(t[0]-e,t[1]-e,t[0]+e,t[1]+e,o)},t.prototype.getRadius=function(){return ee(this.getRadiusSquared_())},t.prototype.getRadiusSquared_=function(){var o=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return o*o+t*t},t.prototype.getType=function(){return oe.CIRCLE},t.prototype.intersectsExtent=function(o){if(Dt(o,this.getExtent())){var t=this.getCenter();return o[0]<=t[0]&&o[2]>=t[0]||o[1]<=t[1]&&o[3]>=t[1]||Rt(o,this.intersectsCoordinate.bind(this))}return!1},t.prototype.setCenter=function(o){var t=this.stride,e=this.flatCoordinates[t]-this.flatCoordinates[0],r=o.slice();r[t]=r[0]+e;for(var n=1;n<t;++n)r[t+n]=o[n];this.setFlatCoordinates(this.layout,r),this.changed()},t.prototype.setCenterAndRadius=function(s,t,e){this.setLayout(e,s,0),this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,n=yr(r,0,s,this.stride);r[n++]=r[0]+t;for(var l=1,p=this.stride;l<p;++l)r[n++]=r[l];r.length=n,this.changed()},t.prototype.getCoordinates=function(){return null},t.prototype.setCoordinates=function(){},t.prototype.setRadius=function(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()},t.prototype.rotate=function(o,t){var e=this.getCenter(),r=this.getStride();this.setCenter(se(e,0,e.length,r,o,t,e)),this.changed()},t.prototype.translate=function(o,t){var e=this.getCenter(),r=this.getStride();this.setCenter(ue(e,0,e.length,r,o,t,e)),this.changed()},t}(Tr);Zd.prototype.transform;var Kd=Zd,qd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Hd=function(p){function o(t,e,r){var n=p.call(this)||this;if(n.ends_=[],n.maxDelta_=-1,n.maxDeltaRevision_=-1,Array.isArray(t[0]))n.setCoordinates(t,e);else if(void 0!==e&&r)n.setFlatCoordinates(e,t),n.ends_=r;else{for(var i=n.getLayout(),d=t,a=[],s=[],_=0,g=d.length,u;_<g;++_)u=d[_],0==_&&(i=u.getLayout()),v(a,u.getFlatCoordinates()),s.push(a.length);n.setFlatCoordinates(i,a),n.ends_=s}return n}return qd(o,p),o.prototype.appendLineString=function(e){this.flatCoordinates?v(this.flatCoordinates,e.getFlatCoordinates().slice()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},o.prototype.clone=function(){return new o(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},o.prototype.closestPointXY=function(o,t,e,r){return r<st(this.getExtent(),o,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=ee(gr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,o,t,e,r))},o.prototype.getCoordinateAtM=function(o,t,e){if(this.layout!=ne&&this.layout!=ie||0===this.flatCoordinates.length)return null;return function(p,t,d,r,n,i,o){if(o)return xd(p,t,d[d.length-1],r,n,i);var a;if(n<p[r-1])return i?((a=p.slice(0,r))[r-1]=n,a):null;if(p[p.length-1]<n)return i?((a=p.slice(p.length-r))[r-1]=n,a):null;for(var _=0,g=d.length,l;_<g;++_)if(l=d[_],t!=l){if(n<p[t+r-1])return null;if(n<=p[l-1])return xd(p,t,l,r,n,!1);t=l}return null}(this.flatCoordinates,0,this.ends_,this.stride,o,void 0!==t&&t,void 0!==e&&e)},o.prototype.getCoordinates=function(){return xr(this.flatCoordinates,0,this.ends_,this.stride)},o.prototype.getEnds=function(){return this.ends_},o.prototype.getLineString=function(e){return 0>e||this.ends_.length<=e?null:new Sd(this.flatCoordinates.slice(0===e?0:this.ends_[e-1],this.ends_[e]),this.layout)},o.prototype.getLineStrings=function(){for(var l=this.flatCoordinates,t=this.ends_,e=this.layout,r=[],n=0,p=0,d=t.length;p<d;++p){var a=t[p],s=new Sd(l.slice(n,a),e);r.push(s),n=a}return r},o.prototype.getFlatMidpoints=function(){for(var l=[],t=this.flatCoordinates,e=0,p=this.ends_,n=this.stride,i=0,d=p.length,a;i<d;++i)a=p[i],v(l,ad(t,e,a,n,.5)),e=a;return l},o.prototype.getSimplifiedGeometryInternal=function(e){var t=[],r=[];return t.length=Rr(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new o(t,lt,r)},o.prototype.getType=function(){return oe.MULTI_LINE_STRING},o.prototype.intersectsExtent=function(e){return function(s,t,l,r,n){for(var i=0,p=l.length;i<p;++i){if(Dr(s,t,l[i],r,n))return!0;t=l[i]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,e)},o.prototype.setCoordinates=function(o,t){this.setLayout(t,o,2),this.flatCoordinates||(this.flatCoordinates=[]);var e=hr(this.flatCoordinates,0,o,this.stride,this.ends_);this.flatCoordinates.length=0===e.length?0:e[e.length-1],this.changed()},o}(Tr),Jd=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Qd=function(o){function t(t,e){var r=o.call(this)||this;return e&&!Array.isArray(t[0])?r.setFlatCoordinates(e,t):r.setCoordinates(t,e),r}return Jd(t,o),t.prototype.appendPoint=function(e){this.flatCoordinates?v(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.changed()},t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(p,t,e,r){if(r<st(this.getExtent(),p,t))return r;for(var d=this.flatCoordinates,i=this.stride,o=0,_=d.length,s;o<_;o+=i)if(s=pe(p,t,d[o],d[o+1]),s<r){r=s;for(var g=0;g<i;++g)e[g]=d[o+g];e.length=i}return r},t.prototype.getCoordinates=function(){return fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getPoint=function(o){var t=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return 0>o||t<=o?null:new Zr(this.flatCoordinates.slice(o*this.stride,(o+1)*this.stride),this.layout)},t.prototype.getPoints=function(){for(var s=this.flatCoordinates,t=this.layout,e=this.stride,r=[],n=0,l=s.length,o;n<l;n+=e)o=new Zr(s.slice(n,n+e),t),r.push(o);return r},t.prototype.getType=function(){return oe.MULTI_POINT},t.prototype.intersectsExtent=function(o){for(var t=this.flatCoordinates,e=this.stride,r=0,a=t.length;r<a;r+=e)if(_t(o,t[r],t[r+1]))return!0;return!1},t.prototype.setCoordinates=function(o,t){this.setLayout(t,o,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mr(this.flatCoordinates,0,o,this.stride),this.changed()},t}(Tr),$d=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),e_=function(g){function o(t,y,m){var x=g.call(this)||this;if(x.endss_=[],x.flatInteriorPointsRevision_=-1,x.flatInteriorPoints_=null,x.maxDelta_=-1,x.maxDeltaRevision_=-1,x.orientedRevision_=-1,x.orientedFlatCoordinates_=null,!m&&!Array.isArray(t[0])){for(var i=x.getLayout(),S=t,a=[],s=[],u=0,E=S.length,h;u<E;++u){h=S[u],0==u&&(i=h.getLayout());for(var T=a.length,p=h.getEnds(),f=0,C=p.length;f<C;++f)p[f]+=T;v(a,h.getFlatCoordinates()),s.push(p)}y=i,t=a,m=s}return void 0!==y&&m?(x.setFlatCoordinates(y,t),x.endss_=m):x.setCoordinates(t,y),x}return $d(o,g),o.prototype.appendPolygon=function(o){var t;if(this.flatCoordinates){var a=this.flatCoordinates.length;v(this.flatCoordinates,o.getFlatCoordinates());for(var r=0,s=(t=o.getEnds().slice()).length;r<s;++r)t[r]+=a}else this.flatCoordinates=o.getFlatCoordinates().slice(),t=o.getEnds().slice(),this.endss_.push();this.endss_.push(t),this.changed()},o.prototype.clone=function(){for(var e=this.endss_.length,t=Array(e),r=0;r<e;++r)t[r]=this.endss_[r].slice();return new o(this.flatCoordinates.slice(),this.layout,t)},o.prototype.closestPointXY=function(o,t,e,r){return r<st(this.getExtent(),o,t)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=ee(function(l,t,p,r,n){for(var d=0,_=p.length,a;d<_;++d)a=p[d],n=gr(l,t,a,r,n),t=a[a.length-1];return n}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(_,t,g,r,n,i,o,a,s,u,y){for(var m=y||[NaN,NaN],c=0,h=g.length,f;c<h;++c)f=g[c],u=cr(_,t,f,r,n,i,o,a,s,u,m),t=f[f.length-1];return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,o,t,e,r))},o.prototype.containsXY=function(o,t){return function(l,t,p,r,n,i){if(0===p.length)return!1;for(var o=0,d=p.length,s;o<d;++o){if(s=p[o],Mr(l,t,s,r,n,i))return!0;t=s[s.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,o,t)},o.prototype.getArea=function(){return function(l,t,p,r){for(var n=0,d=0,_=p.length,a;d<_;++d)a=p[d],n+=lr(l,t,a,r),t=a[a.length-1];return n}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},o.prototype.getCoordinates=function(o){var t;return void 0===o?t=this.flatCoordinates:Yr(t=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,o),Cr(t,0,this.endss_,this.stride)},o.prototype.getEndss=function(){return this.endss_},o.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var e=Yd(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Ar(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},o.prototype.getInteriorPoints=function(){return new Qd(this.getFlatInteriorPoints().slice(),ne)},o.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;(function(l,t,p,r,n){for(var i=0,d=p.length,a;i<d;++i){if(a=p[i],!jr(l,t,a,r,n))return!1;a.length&&(t=a[a.length-1])}return!0})(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Yr(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},o.prototype.getSimplifiedGeometryInternal=function(e){var t=[],r=[];return t.length=function(p,t,d,r,n,i,o,_){for(var s=0,g=d.length;s<g;++s){var l=d[s],y=[];o=vr(p,t,l,r,n,i,o,y),_.push(y),t=l[l.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,ee(e),t,0,r),new o(t,lt,r)},o.prototype.getPolygon=function(s){if(0>s||this.endss_.length<=s)return null;var t;if(0===s)t=0;else{var l=this.endss_[s-1];t=l[l.length-1]}var r=this.endss_[s].slice(),n=r[r.length-1];if(0!==t)for(var i=0,p=r.length;i<p;++i)r[i]-=t;return new hn(this.flatCoordinates.slice(t,n),this.layout,r)},o.prototype.getPolygons=function(){for(var p=this.layout,t=this.flatCoordinates,e=this.endss_,r=[],n=0,d=0,_=e.length;d<_;++d){var a=e[d].slice(),s=a[a.length-1];if(0!==n)for(var g=0,u=a.length;g<u;++g)a[g]-=n;var y=new hn(t.slice(n,s),p,a);r.push(y),n=s}return r},o.prototype.getType=function(){return oe.MULTI_POLYGON},o.prototype.intersectsExtent=function(e){return function(l,t,p,r,n){for(var i=0,d=p.length,a;i<d;++i){if(a=p[i],kr(l,t,a,r,n))return!0;t=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)},o.prototype.setCoordinates=function(o,t){this.setLayout(t,o,3),this.flatCoordinates||(this.flatCoordinates=[]);var e=function(p,t,d,r,n){for(var i=n||[],o=0,_=0,g=d.length,u;_<g;++_)u=hr(p,t,d[_],r,i[o]),i[o++]=u,t=u[u.length-1];return i.length=o,i}(this.flatCoordinates,0,o,this.stride,this.endss_);if(0===e.length)this.flatCoordinates.length=0;else{var r=e[e.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},o}(Tr),r_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),n_="Point",i_="LineString",o_="Polygon",a_="Circle",s_="drawstart",u_=function(o){function t(t,e){var r=o.call(this,t)||this;return r.feature=e,r}return r_(t,o),t}(fh),c_=function(l){function t(t){var e=this,p=t;p.stopDown||(p.stopDown=R),(e=l.call(this,p)||this).shouldHandle_=!1,e.downPx_=null,e.downTimeout_,e.lastDragTime_,e.freehand_=!1,e.source_=t.source?t.source:null,e.features_=t.features?t.features:null,e.snapTolerance_=t.snapTolerance?t.snapTolerance:12,e.type_=t.type,e.mode_=function(o){var t;return o===oe.POINT||o===oe.MULTI_POINT?t=n_:o===oe.LINE_STRING||o===oe.MULTI_LINE_STRING?t=i_:o===oe.POLYGON||o===oe.MULTI_POLYGON?t=o_:o===oe.CIRCLE&&(t=a_),t}(e.type_),e.stopClick_=!!t.stopClick,e.minPoints_=t.minPoints?t.minPoints:e.mode_===o_?3:2,e.maxPoints_=t.maxPoints?t.maxPoints:1/0,e.finishCondition_=t.finishCondition?t.finishCondition:T;var n=t.geometryFunction,d;if(!n)if(e.type_===oe.CIRCLE)n=function(s,t,e){var r=t||new Kd([NaN,NaN]),n=Xt(s[0],e),i=ii(n,Xt(s[1],e));r.setCenterAndRadius(n,ee(i));var o=Yt();return o&&r.transform(e,o),r};else{var _=e.mode_,s;_===n_?s=Zr:_===i_?s=Sd:_===o_&&(s=hn),n=function(o,t){var e=t;return e?_===o_?o[0].length?e.setCoordinates([o[0].concat([o[0][0]])]):e.setCoordinates([]):e.setCoordinates(o):e=new s(o),e}}return e.geometryFunction_=n,e.dragVertexDelay_=void 0===t.dragVertexDelay?500:t.dragVertexDelay,e.finishCoordinate_=null,e.sketchFeature_=null,e.sketchPoint_=null,e.sketchCoords_=null,e.sketchLine_=null,e.sketchLineCoords_=null,e.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,e.overlay_=new vd({source:new sc({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(d=xl(),function(e){return d[e.getGeometry().getType()]}),updateWhileInteracting:!0}),e.geometryName_=t.geometryName,e.condition_=t.condition?t.condition:na,e.freehandCondition_,e.freehandCondition_=t.freehand?$o:t.freehandCondition?t.freehandCondition:ia,e.addEventListener(L(Bo),e.updateState_),e}return r_(t,l),t.prototype.setMap=function(t){l.prototype.setMap.call(this,t),this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===vh&&t.preventDefault(),this.freehand_=this.mode_!==n_&&this.freehandCondition_(t);var e=t.type===zn.POINTERMOVE,o=!0;return!this.freehand_&&this.lastDragTime_&&t.type===zn.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===zn.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),o=!1):this.freehand_&&t.type===zn.POINTERDOWN?o=!1:e?(o=t.type===zn.POINTERMOVE)&&this.freehand_?o=this.handlePointerMove_(t):("mouse"==t.pointerEvent.pointerType||t.type===zn.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===zn.DBLCLICK&&(o=!1),l.prototype.handleEvent.call(this,t)&&o},t.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Yn(zn.POINTERMOVE,e.map,e.pointerEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)},t.prototype.handleUpEvent=function(o){var t=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(o);var n=this.mode_===a_;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||n?this.finishDrawing():this.atFinish_(o)?this.finishCondition_(o)&&this.finishDrawing():this.addToDrawing_(o.coordinate):(this.startDrawing_(o),this.mode_===n_&&this.finishDrawing()),t=!1):this.freehand_&&this.abortDrawing(),!t&&this.stopClick_&&o.stopPropagation(),t},t.prototype.handlePointerMove_=function(a){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,e=a.pixel,r=t[0]-e[0],n=t[1]-e[1],i=r*r+n*n;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(a):this.createOrUpdateSketchPoint_(a),!0},t.prototype.atFinish_=function(d){var t=!1;if(this.sketchFeature_){var _=!1,g=[this.finishCoordinate_];if(this.mode_===i_)_=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===o_){var y=this.sketchCoords_;_=y[0].length>this.minPoints_,g=[y[0][0],y[0][y[0].length-2]]}if(_)for(var i=d.map,o=0,m=g.length;o<m;o++){var s=g[o],u=i.getPixelFromCoordinate(s),l=d.pixel,h=l[0]-u[0],c=l[1]-u[1],p=this.freehand_?1:this.snapTolerance_;if(t=ee(h*h+c*c)<=p){this.finishCoordinate_=s;break}}}return t},t.prototype.createOrUpdateSketchPoint_=function(o){var t=o.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new ut(new Zr(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(o){var t=o.coordinate,e=o.map.getView().getProjection();this.finishCoordinate_=t,this.mode_===n_?this.sketchCoords_=t.slice():this.mode_===o_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ut(new Sd(this.sketchLineCoords_)));var r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new ut,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new u_(s_,this.sketchFeature_))},t.prototype.modifyDrawing_=function(l){var t=l.coordinate,p=this.sketchFeature_.getGeometry(),o=l.map.getView().getProjection(),a,d,_;if((this.mode_===n_?d=this.sketchCoords_:this.mode_===o_?(d=(a=this.sketchCoords_[0])[a.length-1],this.atFinish_(l)&&(t=this.finishCoordinate_.slice())):d=(a=this.sketchCoords_)[a.length-1],d[0]=t[0],d[1]=t[1],this.geometryFunction_(this.sketchCoords_,p,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(t),p.getType()==oe.POLYGON&&this.mode_!==o_){this.sketchLine_||(this.sketchLine_=new ut);var g=p.getLinearRing(0);(_=this.sketchLine_.getGeometry())?(_.setFlatCoordinates(g.getLayout(),g.getFlatCoordinates()),_.changed()):(_=new Sd(g.getFlatCoordinates(),g.getLayout()),this.sketchLine_.setGeometry(_))}else this.sketchLineCoords_&&(_=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(o){var t=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),i,a;this.mode_===i_?(this.finishCoordinate_=o.slice(),(a=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?a.pop():i=!0),a.push(o.slice()),this.geometryFunction_(a,t,n)):this.mode_===o_&&((a=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?a.pop():i=!0),a.push(o.slice()),i&&(this.finishCoordinate_=a[0]),this.geometryFunction_(this.sketchCoords_,t,n)),this.updateSketchFeatures_(),i&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var o=this.sketchFeature_.getGeometry(),e=this.getMap().getView().getProjection(),r;this.mode_===i_?((r=this.sketchCoords_).splice(-2,1),this.geometryFunction_(r,o,e),2<=r.length&&(this.finishCoordinate_=r[r.length-2].slice())):this.mode_===o_&&((r=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(r),this.geometryFunction_(this.sketchCoords_,o,e)),0===r.length&&this.abortDrawing(),this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var o=this.abortDrawing_();if(o){var t=this.sketchCoords_,i=o.getGeometry(),r=this.getMap().getView().getProjection();this.mode_===i_?(t.pop(),this.geometryFunction_(t,i,r)):this.mode_===o_&&(t[0].pop(),this.geometryFunction_(t,i,r),t=i.getCoordinates()),this.type_===oe.MULTI_POINT?o.setGeometry(new Qd([t])):this.type_===oe.MULTI_LINE_STRING?o.setGeometry(new Hd([t])):this.type_===oe.MULTI_POLYGON&&o.setGeometry(new e_([t])),this.dispatchEvent(new u_("drawend",o)),this.features_&&this.features_.push(o),this.source_&&this.source_.addFeature(o)}},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),e},t.prototype.abortDrawing=function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new u_("drawabort",e))},t.prototype.appendCoordinates=function(o){var t=this.mode_,e=[];t===i_?e=this.sketchCoords_:t===o_&&(e=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]);for(var a=e.pop(),n=0;n<o.length;n++)this.addToDrawing_(o[n]);this.addToDrawing_(a)},t.prototype.extend=function(o){var t=o.getGeometry();this.sketchFeature_=o,this.sketchCoords_=t.getCoordinates();var e=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=e.slice(),this.sketchCoords_.push(e.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new u_(s_,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var o=[];this.sketchFeature_&&o.push(this.sketchFeature_),this.sketchLine_&&o.push(this.sketchLine_),this.sketchPoint_&&o.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(o)},t.prototype.updateState_=function(){var o=this.getMap(),t=this.getActive();o&&t||this.abortDrawing(),this.overlay_.setMap(t?o:null)},t}(la),p_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),f_=function(o){function t(t){var e=o.call(this,"extentchanged")||this;return e.extent=t,e}return p_(t,o),t}(fh),__=function(o){function t(t){var a=this,s=t||{},i;return(a=o.call(this,s)||this).extent_=null,a.pointerHandler_=null,a.pixelTolerance_=void 0===s.pixelTolerance?10:s.pixelTolerance,a.snappedToVertex_=!1,a.extentFeature_=null,a.vertexFeature_=null,t||(t={}),a.extentOverlay_=new vd({source:new sc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:(i=xl(),function(){return i[oe.POLYGON]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),a.vertexOverlay_=new vd({source:new sc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:t_(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&a.setExtent(t.extent),a}return p_(t,o),t.prototype.snapToVertex_=function(d,t){var _=t.getCoordinateFromPixelInternal(d),e=this.getExtentInternal();if(e){var r=function(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(e);r.sort(function(o,t){return yi(_,o)-yi(_,t)});var n=r[0],o=dn(_,n),i=t.getPixelFromCoordinateInternal(o);if(si(d,i)<=this.pixelTolerance_){var s=t.getPixelFromCoordinateInternal(n[0]),g=t.getPixelFromCoordinateInternal(n[1]),l=ii(i,s),u=ii(i,g),c=ee(E(l,u));return this.snappedToVertex_=c<=this.pixelTolerance_,this.snappedToVertex_&&(o=l>u?n[1]:n[0]),o}}return null},t.prototype.handlePointerMove_=function(o){var t=o.pixel,e=o.map,r=this.snapToVertex_(t,e);r||(r=e.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)},t.prototype.createOrUpdateExtentFeature_=function(o){var t=this.extentFeature_;return t?o?t.setGeometry(Hr(o)):t.setGeometry(void 0):(t=new ut(o?Hr(o):{}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},t.prototype.createOrUpdatePointerFeature_=function(o){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(o):(t=new ut(new Zr(o)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(t.type!=zn.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),o.prototype.handleEvent.call(this,t),!1)},t.prototype.handleDownEvent=function(l){var t=l.pixel,e=l.map,p=this.getExtentInternal(),r=this.snapToVertex_(t,e),n=function(o){var t=null,n=null;return o[0]==p[0]?t=p[2]:o[0]==p[2]&&(t=p[0]),o[1]==p[1]?n=p[3]:o[1]==p[3]&&(n=p[1]),null!==t&&null!==n?[t,n]:null};if(r&&p){var o=r[0]==p[0]||r[0]==p[2]?r[0]:null,a=r[1]==p[1]||r[1]==p[3]?r[1]:null;null!==o&&null!==a?this.pointerHandler_=g_(n(r)):null===o?null!==a&&(this.pointerHandler_=y_(n([p[0],a]),n([p[2],a]))):this.pointerHandler_=y_(n([o,p[1]]),n([o,p[3]]))}else r=e.getCoordinateFromPixelInternal(t),this.setExtent([r[0],r[1],r[0],r[1]]),this.pointerHandler_=g_(r);return!0},t.prototype.handleDragEvent=function(o){if(this.pointerHandler_){var t=o.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0},t.prototype.handleUpEvent=function(){this.pointerHandler_=null;var t=this.getExtentInternal();return t&&0!==wt(t)||this.setExtent(null),!1},t.prototype.setMap=function(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),o.prototype.setMap.call(this,t)},t.prototype.getExtent=function(){return Wt(this.getExtentInternal(),this.getMap().getView().getProjection())},t.prototype.getExtentInternal=function(){return this.extent_},t.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new f_(this.extent_))},t}(la),m_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),x_=[0,0,0,0],w_=[],S_="modifyend",T_=function(o){function t(t,e,r){var n=o.call(this,t)||this;return n.features=e,n.mapBrowserEvent=r,n}return m_(t,o),t}(fh),C_=function(o){function t(t){var e=o.call(this,t)||this,i,a;if(e.boundHandleFeatureChange_=e.handleFeatureChange_.bind(e),e.condition_=t.condition?t.condition:sa,e.defaultDeleteCondition_=function(e){return Ho(e)&&ra(e)},e.deleteCondition_=t.deleteCondition?t.deleteCondition:e.defaultDeleteCondition_,e.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:$o,e.vertexFeature_=null,e.vertexSegments_=null,e.lastPixel_=[0,0],e.ignoreNextSingleClick_=!1,e.modified_=!1,e.rBush_=new ic,e.pixelTolerance_=void 0===t.pixelTolerance?10:t.pixelTolerance,e.snappedToVertex_=!1,e.changingFeature_=!1,e.dragSegments_=[],e.overlay_=new vd({source:new sc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(i=xl(),function(){return i[oe.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.SEGMENT_WRITERS_={Point:e.writePointGeometry_.bind(e),LineString:e.writeLineStringGeometry_.bind(e),LinearRing:e.writeLineStringGeometry_.bind(e),Polygon:e.writePolygonGeometry_.bind(e),MultiPoint:e.writeMultiPointGeometry_.bind(e),MultiLineString:e.writeMultiLineStringGeometry_.bind(e),MultiPolygon:e.writeMultiPolygonGeometry_.bind(e),Circle:e.writeCircleGeometry_.bind(e),GeometryCollection:e.writeGeometryCollectionGeometry_.bind(e)},e.source_=null,t.source?(e.source_=t.source,a=new ot(e.source_.getFeatures()),e.source_.addEventListener(Qh,e.handleSourceAdd_.bind(e)),e.source_.addEventListener(ec,e.handleSourceRemove_.bind(e))):a=t.features,!a)throw new Error("The modify interaction requires features or a source");return e.features_=a,e.features_.forEach(e.addFeature_.bind(e)),e.features_.addEventListener(u,e.handleFeatureAdd_.bind(e)),e.features_.addEventListener(l,e.handleFeatureRemove_.bind(e)),e.lastPointerEvent_=null,e}return m_(t,o),t.prototype.addFeature_=function(o){var t=o.getGeometry();if(t){var e=this.SEGMENT_WRITERS_[t.getType()];e&&e(o,t)}var r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),o.addEventListener(A,this.boundHandleFeatureChange_)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new T_("modifystart",this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(A,this.boundHandleFeatureChange_)},t.prototype.removeFeatureSegmentData_=function(a){var t=this.rBush_,s=[];t.forEach(function(t){a===t.feature&&s.push(t)});for(var e=s.length-1;0<=e;--e){for(var r=s[e],i=this.dragSegments_.length-1;0<=i;--i)this.dragSegments_[i][0]===r&&this.dragSegments_.splice(i,1);t.remove(r)}},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),o.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),o.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(o){if(!this.changingFeature_){var t=o.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(o){var t=o.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(o,t){var e=t.getCoordinates();this.rBush_.insert(t.getExtent(),{feature:o,geometry:t,segment:[e,e]})},t.prototype.writeMultiPointGeometry_=function(s,t){for(var e=t.getCoordinates(),r=0,l=e.length;r<l;++r){var i=e[r],o={feature:s,geometry:t,depth:[r],index:r,segment:[i,i]};this.rBush_.insert(t.getExtent(),o)}},t.prototype.writeLineStringGeometry_=function(s,t){for(var e=t.getCoordinates(),r=0,l=e.length-1;r<l;++r){var i=e.slice(r,r+2),o={feature:s,geometry:t,index:r,segment:i};this.rBush_.insert(Y(i),o)}},t.prototype.writeMultiLineStringGeometry_=function(p,t){for(var e=t.getCoordinates(),r=0,d=e.length;r<d;++r)for(var i=e[r],o=0,_=i.length-1;o<_;++o){var s=i.slice(o,o+2),g={feature:p,geometry:t,depth:[r],index:o,segment:s};this.rBush_.insert(Y(s),g)}},t.prototype.writePolygonGeometry_=function(p,t){for(var e=t.getCoordinates(),r=0,d=e.length;r<d;++r)for(var i=e[r],o=0,_=i.length-1;o<_;++o){var s=i.slice(o,o+2),g={feature:p,geometry:t,depth:[r],index:o,segment:s};this.rBush_.insert(Y(s),g)}},t.prototype.writeMultiPolygonGeometry_=function(d,t){for(var e=t.getCoordinates(),r=0,_=e.length;r<_;++r)for(var i=e[r],o=0,g=i.length;o<g;++o)for(var s=i[o],u=0,y=s.length-1;u<y;++u){var m=s.slice(u,u+2),c={feature:d,geometry:t,depth:[o,r],index:u,segment:m};this.rBush_.insert(Y(m),c)}},t.prototype.writeCircleGeometry_=function(l,t){var e=t.getCenter(),r={feature:l,geometry:t,index:0,segment:[e,e]},n={feature:l,geometry:t,index:1,segment:[e,e]},i=[r,n];r.featureSegments=i,n.featureSegments=i,this.rBush_.insert(ht(e),r);var o=t,p=Yt();if(p&&this.getMap()){var s=this.getMap().getView().getProjection();o=qr(o=o.clone().transform(p,s)).transform(s,p)}this.rBush_.insert(o.getExtent(),n)},t.prototype.writeGeometryCollectionGeometry_=function(o,t){for(var e=t.getGeometriesArray(),r=0,a;r<e.length;++r)a=e[r],(0,this.SEGMENT_WRITERS_[a.getType()])(o,a)},t.prototype.createOrUpdateVertexFeature_=function(o){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(o):(t=new ut(new Zr(o)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=zn.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=t.type==zn.SINGLECLICK&&this.ignoreNextSingleClick_||this.removePoint()),t.type==zn.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),o.prototype.handleEvent.call(this,t)&&!e);var e},t.prototype.handleDragEvent=function(_){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(_);for(var t=_.coordinate,e=0,g=this.dragSegments_.length;e<g;++e){for(var n=this.dragSegments_[e],i=n[0],o=i.depth,a=i.geometry,s=void 0,y=i.segment,l=n[1];t.length<a.getStride();)t.push(y[l][t.length]);switch(a.getType()){case oe.POINT:s=t,y[0]=t,y[1]=t;break;case oe.MULTI_POINT:(s=a.getCoordinates())[i.index]=t,y[0]=t,y[1]=t;break;case oe.LINE_STRING:(s=a.getCoordinates())[i.index+l]=t,y[l]=t;break;case oe.MULTI_LINE_STRING:case oe.POLYGON:(s=a.getCoordinates())[o[0]][i.index+l]=t,y[l]=t;break;case oe.MULTI_POLYGON:(s=a.getCoordinates())[o[1]][o[0]][i.index+l]=t,y[l]=t;break;case oe.CIRCLE:if(y[0]=t,y[1]=t,0===i.index)this.changingFeature_=!0,a.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var m=_.map.getView().getProjection(),c=si(Xt(a.getCenter(),m),Xt(t,m)),h=Yt();if(h){var f=a.clone().transform(h,m);f.setRadius(c),c=f.transform(m,h).getRadius()}a.setRadius(c),this.changingFeature_=!1}}s&&this.setGeometryCoordinates_(a,s)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(o){if(!this.condition_(o))return!1;var t=o.coordinate;this.handlePointerAtPixel_(o.pixel,o.map,t),this.dragSegments_.length=0,this.modified_=!1;var e=this.vertexFeature_;if(e){var r=o.map.getView().getProjection(),n=[],i=e.getGeometry().getCoordinates(),a=Y([i]),s=this.rBush_.getInExtent(a),u={};s.sort(v_);for(var l=0,y=s.length;l<y;++l){var c=s[l],p=c.segment,m=X(c.feature),f=c.depth;if(!(f&&(m+="-"+f.join("-")),u[m]||(u[m]=[,,]),c.geometry.getType()!==oe.CIRCLE||1!==c.index))fn(P_(t,c,r),i)&&!u[m][0]&&(this.dragSegments_.push([c,0]),u[m][0]=c);else if(!(!fn(p[0],i)||u[m][0]))this.dragSegments_.push([c,0]),u[m][0]=c;else if(!fn(p[1],i)||u[m][1])X(p)in this.vertexSegments_&&!u[m][0]&&!u[m][1]&&this.insertVertexCondition_(o)&&n.push([c,i]);else{if((c.geometry.getType()===oe.LINE_STRING||c.geometry.getType()===oe.MULTI_LINE_STRING)&&u[m][0]&&0===u[m][0].index)continue;this.dragSegments_.push([c,1]),u[m][1]=c}}n.length&&this.willModifyFeatures_(o);for(var _=n.length-1;0<=_;--_)this.insertVertex_.apply(this,n[_])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(p){for(var t=this.dragSegments_.length-1;0<=t;--t){var d=this.dragSegments_[t][0],r=d.geometry;if(r.getType()===oe.CIRCLE){var n=r.getCenter(),i=d.featureSegments[0],o=d.featureSegments[1];i.segment[0]=n,i.segment[1]=n,o.segment[0]=n,o.segment[1]=n,this.rBush_.update(ht(n),i);var a=r,_=Yt();if(_){var g=p.map.getView().getProjection();a=qr(a=a.clone().transform(_,g)).transform(g,_)}this.rBush_.update(a.getExtent(),o)}else this.rBush_.update(Y(d.segment),d)}return this.modified_&&(this.dispatchEvent(new T_(S_,this.features_,p)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)},t.prototype.handlePointerAtPixel_=function(o,t,e){var r=e||t.getCoordinateFromPixel(o),n=t.getView().getProjection(),i=Wt(V(Zt(ht(r,x_),n),t.getView().getResolution()*this.pixelTolerance_,x_),n),a=this.rBush_.getInExtent(i);if(0<a.length){a.sort(function(o,t){return b_(r,o,n)-b_(r,t,n)});var s=a[0],u=s.segment,l=P_(r,s,n),S=t.getPixelFromCoordinate(l),c=si(o,S);if(c<=this.pixelTolerance_){var T={};if(s.geometry.getType()===oe.CIRCLE&&1===s.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l);else{var f=t.getPixelFromCoordinate(u[0]),d=t.getPixelFromCoordinate(u[1]),_=ii(S,f),g=ii(S,d);c=ee(E(_,g)),this.snappedToVertex_=c<=this.pixelTolerance_,this.snappedToVertex_&&(l=_>g?u[1]:u[0]),this.createOrUpdateVertexFeature_(l);for(var y=1,C=a.length,m;y<C&&(m=a[y].segment,!!(fn(u[0],m[0])&&fn(u[1],m[1])||fn(u[0],m[1])&&fn(u[1],m[0])));++y)T[X(m)]=!0}return T[X(u)]=!0,void(this.vertexSegments_=T)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(p,t){for(var e=p.segment,n=p.feature,i=p.geometry,o=p.depth,a=p.index,s;t.length<i.getStride();)t.push(0);switch(i.getType()){case oe.MULTI_LINE_STRING:case oe.POLYGON:(s=i.getCoordinates())[o[0]].splice(a+1,0,t);break;case oe.MULTI_POLYGON:(s=i.getCoordinates())[o[1]][o[0]].splice(a+1,0,t);break;case oe.LINE_STRING:(s=i.getCoordinates()).splice(a+1,0,t);break;default:return;}this.setGeometryCoordinates_(i,s);var d=this.rBush_;d.remove(p),this.updateSegmentIndices_(i,a,o,1);var _={segment:[e[0],t],feature:n,geometry:i,depth:o,index:a};d.insert(Y(_.segment),_),this.dragSegments_.push([_,1]);var l={segment:[t,e[1]],feature:n,geometry:i,depth:o,index:a+1};d.insert(Y(l.segment),l),this.dragSegments_.push([l,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=zn.POINTERDRAG){var o=this.lastPointerEvent_;this.willModifyFeatures_(o);var t=this.removeVertex_();return this.dispatchEvent(new T_(S_,this.features_,o)),this.modified_=!1,t}return!1},t.prototype.removeVertex_=function(){var o=this.dragSegments_,p={},y=!1,m,f,x,S,E,T,C,P,R,w,L;for(E=o.length-1;0<=E;--E)L=X((w=(x=o[E])[0]).feature),w.depth&&(L+="-"+w.depth.join("-")),L in p||(p[L]={}),0===x[1]?(p[L].right=w,p[L].index=w.index):1==x[1]&&(p[L].left=w,p[L].index=w.index+1);for(L in p){switch(R=p[L].right,C=p[L].left,0>(P=(T=p[L].index)-1)&&(P=0),m=f=(S=(w=void 0===C?R:C).geometry).getCoordinates(),y=!1,S.getType()){case oe.MULTI_LINE_STRING:2<f[w.depth[0]].length&&(f[w.depth[0]].splice(T,1),y=!0);break;case oe.LINE_STRING:2<f.length&&(f.splice(T,1),y=!0);break;case oe.MULTI_POLYGON:m=m[w.depth[1]];case oe.POLYGON:4<(m=m[w.depth[0]]).length&&(T==m.length-1&&(T=0),m.splice(T,1),y=!0,0===T&&(m.pop(),m.push(m[0]),P=m.length-1));}if(y){this.setGeometryCoordinates_(S,f);var I=[];if(void 0!==C&&(this.rBush_.remove(C),I.push(C.segment[0])),void 0!==R&&(this.rBush_.remove(R),I.push(R.segment[1])),void 0!==C&&void 0!==R){var _={depth:w.depth,feature:w.feature,geometry:w.geometry,index:P,segment:I};this.rBush_.insert(Y(_.segment),_)}this.updateSegmentIndices_(S,T,w.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),o.length=0}}return y},t.prototype.setGeometryCoordinates_=function(o,t){this.changingFeature_=!0,o.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(o,t,e,r){this.rBush_.forEachInExtent(o.getExtent(),function(n){n.geometry===o&&(void 0===e||void 0===n.depth||Kn(n.depth,e))&&n.index>t&&(n.index+=r)})},t}(la),O_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),I_=function(a){function t(t,e,r,n){var i=a.call(this,t)||this;return i.selected=e,i.deselected=r,i.mapBrowserEvent=n,i}return O_(t,a),t}(fh),F_={},M_=function(s){function o(t){var e=s.call(this,{handleEvent:R_})||this,i=t||{},o,l;if(!(e.boundAddFeature_=e.addFeature_.bind(e),e.boundRemoveFeature_=e.removeFeature_.bind(e),e.condition_=i.condition?i.condition:ra,e.addCondition_=i.addCondition?i.addCondition:ea,e.removeCondition_=i.removeCondition?i.removeCondition:ea,e.toggleCondition_=i.toggleCondition?i.toggleCondition:ia,e.multi_=!!i.multi&&i.multi,e.filter_=i.filter?i.filter:T,e.hitTolerance_=i.hitTolerance?i.hitTolerance:0,e.style_=void 0===i.style?(v((o=xl())[oe.POLYGON],o[oe.LINE_STRING]),v(o[oe.GEOMETRY_COLLECTION],o[oe.LINE_STRING]),function(e){return e.getGeometry()?o[e.getGeometry().getType()]:null}):i.style,e.features_=i.features||new ot,i.layers))l=T;else if("function"==typeof i.layers)l=i.layers;else{var p=i.layers;l=function(e){return x(p,e)}}return e.layerFilter_=l,e.featureLayerAssociation_={},e}return O_(o,s),o.prototype.addFeatureLayerAssociation_=function(o,t){this.featureLayerAssociation_[X(o)]=t},o.prototype.getFeatures=function(){return this.features_},o.prototype.getHitTolerance=function(){return this.hitTolerance_},o.prototype.getLayer=function(e){return this.featureLayerAssociation_[X(e)]},o.prototype.setHitTolerance=function(e){this.hitTolerance_=e},o.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),s.prototype.setMap.call(this,t),t?(this.features_.addEventListener(u,this.boundAddFeature_),this.features_.addEventListener(l,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(u,this.boundAddFeature_),this.features_.removeEventListener(l,this.boundRemoveFeature_))},o.prototype.addFeature_=function(o){var t=o.element;this.style_&&this.applySelectedStyle_(t)},o.prototype.removeFeature_=function(o){var t=o.element;this.style_&&this.restorePreviousStyle_(t)},o.prototype.getStyle=function(){return this.style_},o.prototype.applySelectedStyle_=function(o){var t=X(o);t in F_||(F_[t]=o.getStyle()),o.setStyle(this.style_)},o.prototype.restorePreviousStyle_=function(e){var t=X(e),r=this.getMap().getInteractions().getArray().filter(function(t){return t instanceof o&&t.getStyle()&&-1!==t.getFeatures().getArray().indexOf(e)});0<r.length?e.setStyle(r[r.length-1].getStyle()):(e.setStyle(F_[t]),delete F_[t])},o.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[X(e)]},o}(Xo),N_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),G_=[],D_=function(o){function t(t){var e=this,a=t||{},n=a;return n.handleDownEvent||(n.handleDownEvent=T),n.stopDown||(n.stopDown=R),(e=o.call(this,n)||this).source_=a.source?a.source:null,e.vertex_=void 0===a.vertex||a.vertex,e.edge_=void 0===a.edge||a.edge,e.features_=a.features?a.features:null,e.featuresListenerKeys_=[],e.featureChangeListenerKeys_={},e.indexedFeaturesExtents_={},e.pendingFeatures_={},e.pixelTolerance_=void 0===a.pixelTolerance?10:a.pixelTolerance,e.rBush_=new ic,e.SEGMENT_WRITERS_={Point:e.writePointGeometry_.bind(e),LineString:e.writeLineStringGeometry_.bind(e),LinearRing:e.writeLineStringGeometry_.bind(e),Polygon:e.writePolygonGeometry_.bind(e),MultiPoint:e.writeMultiPointGeometry_.bind(e),MultiLineString:e.writeMultiLineStringGeometry_.bind(e),MultiPolygon:e.writeMultiPolygonGeometry_.bind(e),GeometryCollection:e.writeGeometryCollectionGeometry_.bind(e),Circle:e.writeCircleGeometry_.bind(e)},e}return N_(t,o),t.prototype.addFeature=function(o,t){var e=X(o),r=o.getGeometry();if(r){var n=this.SEGMENT_WRITERS_[r.getType()];n&&(this.indexedFeaturesExtents_[e]=r.getExtent([1/0,1/0,-1/0,-1/0]),n(o,r))}(void 0===t||t)&&(this.featureChangeListenerKeys_[e]=_(o,A,this.handleFeatureChange_,this))},t.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},t.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},t.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},t.prototype.handleEvent=function(t){var e=this.snapTo(t.pixel,t.coordinate,t.map);return e.snapped&&(t.coordinate=e.vertex.slice(0,2),t.pixel=e.vertexPixel),o.prototype.handleEvent.call(this,t)},t.prototype.handleFeatureAdd_=function(o){var t=A_(o);this.addFeature(t)},t.prototype.handleFeatureRemove_=function(o){var t=A_(o);this.removeFeature(t)},t.prototype.handleFeatureChange_=function(o){var t=o.target;if(this.handlingDownUpSequence){var e=X(t);e in this.pendingFeatures_||(this.pendingFeatures_[e]=t)}else this.updateFeature_(t)},t.prototype.handleUpEvent=function(){var t=c(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},t.prototype.removeFeature=function(o,t){var e=X(o),r=this.indexedFeaturesExtents_[e];if(r){var n=this.rBush_,i=[];n.forEachInExtent(r,function(t){o===t.feature&&i.push(t)});for(var a=i.length-1;0<=a;--a)n.remove(i[a])}(void 0===t||t)&&(y(this.featureChangeListenerKeys_[e]),delete this.featureChangeListenerKeys_[e])},t.prototype.setMap=function(t){var e=this.getMap(),r=this.featuresListenerKeys_,n=this.getFeatures_();e&&(r.forEach(y),r.length=0,n.forEach(this.forEachFeatureRemove_.bind(this))),o.prototype.setMap.call(this,t),t&&(this.features_?r.push(_(this.features_,u,this.handleFeatureAdd_,this),_(this.features_,l,this.handleFeatureRemove_,this)):this.source_&&r.push(_(this.source_,Qh,this.handleFeatureAdd_,this),_(this.source_,ec,this.handleFeatureRemove_,this)),n.forEach(this.forEachFeatureAdd_.bind(this)))},t.prototype.snapTo=function(T,t,e){var r=Y([e.getCoordinateFromPixel([T[0]-this.pixelTolerance_,T[1]+this.pixelTolerance_]),e.getCoordinateFromPixel([T[0]+this.pixelTolerance_,T[1]-this.pixelTolerance_])]),n=this.rBush_.getInExtent(r);this.vertex_&&!this.edge_&&(n=n.filter(function(e){return e.feature.getGeometry().getType()!==oe.CIRCLE}));var C=!1,P=null,R=null;if(0===n.length)return{snapped:C,vertex:P,vertexPixel:R};for(var L=e.getView().getProjection(),l=Xt(t,L),h=1/0,I=0,b,F;I<n.length;++I){F=n[I],G_[0]=Xt(F.segment[0],L),G_[1]=Xt(F.segment[1],L);var O=yi(l,G_);O<h&&(b=F,h=O)}var d=b.segment;if(this.vertex_&&!this.edge_){var _=e.getPixelFromCoordinate(d[0]),M=e.getPixelFromCoordinate(d[1]),N=ii(T,_),A=ii(T,M);ee(E(N,A))<=this.pixelTolerance_&&(C=!0,P=N>A?d[1]:d[0],R=e.getPixelFromCoordinate(P))}else if(this.edge_){var G=b.feature.getGeometry().getType()===oe.CIRCLE;if(G){var x=b.feature.getGeometry(),D=Yt();D&&(x=x.clone().transform(D,L)),P=Vt(function(l,t){var e=t.getRadius(),r=t.getCenter(),n=r[0],i=r[1],o=l[0]-n,p=l[1]-i;0==o&&0===p&&(o=1);var s=ee(o*o+p*p);return[n+e*o/s,i+e*p/s]}(l,x),L)}else G_[0]=Xt(d[0],L),G_[1]=Xt(d[1],L),P=Vt(dn(l,G_),L);si(T,R=e.getPixelFromCoordinate(P))<=this.pixelTolerance_&&(C=!0,this.vertex_&&!G)&&(_=e.getPixelFromCoordinate(d[0]),M=e.getPixelFromCoordinate(d[1]),N=ii(R,_),A=ii(R,M),ee(E(N,A))<=this.pixelTolerance_&&(P=N>A?d[1]:d[0],R=e.getPixelFromCoordinate(P)))}return C&&(R=[Zm(R[0]),Zm(R[1])]),{snapped:C,vertex:P,vertexPixel:R}},t.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},t.prototype.writeCircleGeometry_=function(p,t){var e=this.getMap().getView().getProjection(),r=t,d=Yt();d&&(r=r.clone().transform(d,e));var i=qr(r);d&&i.transform(e,d);for(var o=i.getCoordinates()[0],a=0,_=o.length-1;a<_;++a){var g=o.slice(a,a+2);this.rBush_.insert(Y(g),{feature:p,segment:g})}},t.prototype.writeGeometryCollectionGeometry_=function(o,t){for(var e=t.getGeometriesArray(),r=0,a;r<e.length;++r)a=this.SEGMENT_WRITERS_[e[r].getType()],a&&a(o,e[r])},t.prototype.writeLineStringGeometry_=function(a,t){for(var e=t.getCoordinates(),r=0,s=e.length-1;r<s;++r){var i=e.slice(r,r+2);this.rBush_.insert(Y(i),{feature:a,segment:i})}},t.prototype.writeMultiLineStringGeometry_=function(l,t){for(var e=t.getCoordinates(),r=0,p=e.length;r<p;++r)for(var i=e[r],o=0,d=i.length-1;o<d;++o){var s=i.slice(o,o+2);this.rBush_.insert(Y(s),{feature:l,segment:s})}},t.prototype.writeMultiPointGeometry_=function(a,t){for(var e=t.getCoordinates(),r=0,s=e.length;r<s;++r){var i=e[r];this.rBush_.insert(t.getExtent(),{feature:a,segment:[i,i]})}},t.prototype.writeMultiPolygonGeometry_=function(p,t){for(var e=t.getCoordinates(),r=0,d=e.length;r<d;++r)for(var i=e[r],o=0,_=i.length;o<_;++o)for(var s=i[o],g=0,u=s.length-1;g<u;++g){var y=s.slice(g,g+2);this.rBush_.insert(Y(y),{feature:p,segment:y})}},t.prototype.writePointGeometry_=function(o,t){var e=t.getCoordinates();this.rBush_.insert(t.getExtent(),{feature:o,segment:[e,e]})},t.prototype.writePolygonGeometry_=function(l,t){for(var e=t.getCoordinates(),r=0,p=e.length;r<p;++r)for(var i=e[r],o=0,d=i.length-1;o<d;++o){var s=i.slice(o,o+2);this.rBush_.insert(Y(s),{feature:l,segment:s})}},t}(la),k_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),U_=function(s){function t(t,e,r,n,i){var o=s.call(this,t)||this;return o.features=e,o.coordinate=r,o.startCoordinate=n,o.mapBrowserEvent=i,o}return k_(t,s),t}(fh),V_=function(a){function t(t){var e=this,s=t||{},i;if(!((e=a.call(this,s)||this).lastCoordinate_=null,e.startCoordinate_=null,e.features_=void 0===s.features?null:s.features,s.layers))i=T;else if("function"==typeof s.layers)i=s.layers;else{var l=s.layers;i=function(e){return x(l,e)}}return e.layerFilter_=i,e.filter_=s.filter?s.filter:T,e.hitTolerance_=s.hitTolerance?s.hitTolerance:0,e.lastFeature_=null,e.addEventListener(L(Bo),e.handleActiveChanged_),e}return k_(t,a),t.prototype.handleDownEvent=function(o){if(this.lastFeature_=this.featuresAtPixel_(o.pixel,o.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=o.coordinate,this.lastCoordinate_=o.coordinate,this.handleMoveEvent(o);var t=this.features_||new ot([this.lastFeature_]);return this.dispatchEvent(new U_("translatestart",t,o.coordinate,this.startCoordinate_,o)),!0}return!1},t.prototype.handleUpEvent=function(o){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(o);var t=this.features_||new ot([this.lastFeature_]);return this.dispatchEvent(new U_("translateend",t,o.coordinate,this.startCoordinate_,o)),this.startCoordinate_=null,!0}return!1},t.prototype.handleDragEvent=function(o){if(this.lastCoordinate_){var t=o.coordinate,a=t[0]-this.lastCoordinate_[0],r=t[1]-this.lastCoordinate_[1],e=this.features_||new ot([this.lastFeature_]);e.forEach(function(o){var t=o.getGeometry();t.translate(a,r),o.setGeometry(t)}),this.lastCoordinate_=t,this.dispatchEvent(new U_("translating",e,t,this.startCoordinate_,o))}},t.prototype.handleMoveEvent=function(o){var t=o.map.getViewport();this.featuresAtPixel_(o.pixel,o.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")},t.prototype.featuresAtPixel_=function(o,t){return t.forEachFeatureAtPixel(o,function(o,t){if(this.filter_(o,t)&&(!this.features_||x(this.features_.getArray(),o)))return o}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){var e=this.getMap();a.prototype.setMap.call(this,t),this.updateState_(e)},t.prototype.handleActiveChanged_=function(){this.updateState_(null)},t.prototype.updateState_=function(o){var t=this.getMap(),n=this.getActive();t&&n||(t=t||o)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")},t}(la),X_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),W_=function(o){function n(t){var e=o.call(this)||this;return e.geometries_=t||null,e.changeEventsKeys_=[],e.listenGeometriesChange_(),e}return X_(n,o),n.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(y),this.changeEventsKeys_.length=0},n.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var o=0,r=this.geometries_.length;o<r;++o)this.changeEventsKeys_.push(_(this.geometries_[o],A,this.changed,this))},n.prototype.clone=function(){var e=new n(null);return e.setGeometries(this.geometries_),e},n.prototype.closestPointXY=function(s,t,e,r){if(r<st(this.getExtent(),s,t))return r;for(var l=this.geometries_,i=0,p=l.length;i<p;++i)r=l[i].closestPointXY(s,t,e,r);return r},n.prototype.containsXY=function(o,t){for(var e=this.geometries_,r=0,a=e.length;r<a;++r)if(e[r].containsXY(o,t))return!0;return!1},n.prototype.computeExtent=function(o){mt(o);for(var t=this.geometries_,e=0,i=t.length;e<i;++e)St(o,t[e].getExtent());return o},n.prototype.getGeometries=function(){return z_(this.geometries_)},n.prototype.getGeometriesArray=function(){return this.geometries_},n.prototype.getGeometriesArrayRecursive=function(){for(var o=[],i=this.geometries_,e=0,a=i.length;e<a;++e)i[e].getType()===this.getType()?o=o.concat(i[e].getGeometriesArrayRecursive()):o.push(i[e]);return o},n.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),0>e||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var t=[],r=this.geometries_,p=!1,d=0,_=r.length;d<_;++d){var a=r[d],s=a.getSimplifiedGeometry(e);t.push(s),s!==a&&(p=!0)}if(p){var g=new n(null);return g.setGeometriesArray(t),g}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this},n.prototype.getType=function(){return oe.GEOMETRY_COLLECTION},n.prototype.intersectsExtent=function(o){for(var t=this.geometries_,e=0,i=t.length;e<i;++e)if(t[e].intersectsExtent(o))return!0;return!1},n.prototype.isEmpty=function(){return 0===this.geometries_.length},n.prototype.rotate=function(o,t){for(var e=this.geometries_,r=0,a=e.length;r<a;++r)e[r].rotate(o,t);this.changed()},n.prototype.scale=function(s,t,e){var r=e;r||(r=vt(this.getExtent()));for(var l=this.geometries_,i=0,p=l.length;i<p;++i)l[i].scale(s,t,r);this.changed()},n.prototype.setGeometries=function(e){this.setGeometriesArray(z_(e))},n.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},n.prototype.applyTransform=function(o){for(var t=this.geometries_,e=0,i=t.length;e<i;++e)t[e].applyTransform(o);this.changed()},n.prototype.translate=function(o,t){for(var e=this.geometries_,r=0,a=e.length;r<a;++r)e[r].translate(o,t);this.changed()},n.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),o.prototype.disposeInternal.call(this)},n}(Sr),K_=function(){function e(){this.dataProjection=null,this.defaultFeatureProjection=null}return e.prototype.getReadOptions=function(o,t){var e;if(t){var i=t.dataProjection?Ve(t.dataProjection):this.readProjection(o);t.extent&&i&&i.getUnits()===bh.TILE_PIXELS&&(i=Ve(i)).setWorldExtent(t.extent),e={dataProjection:i,featureProjection:t.featureProjection}}return this.adaptOptions(e)},e.prototype.adaptOptions=function(e){return yh({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},e)},e.prototype.getType=function(){return r()},e.prototype.readFeature=function(){return r()},e.prototype.readFeatures=function(){return r()},e.prototype.readGeometry=function(){return r()},e.prototype.readProjection=function(){return r()},e.prototype.writeFeature=function(){return r()},e.prototype.writeFeatures=function(){return r()},e.prototype.writeGeometry=function(){return r()},e}(),q_=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Q_=function(o){function t(){return o.call(this)||this}return q_(t,o),t.prototype.getType=function(){return"json"},t.prototype.readFeature=function(o,t){return this.readFeatureFromObject(Y_(o),this.getReadOptions(o,t))},t.prototype.readFeatures=function(o,t){return this.readFeaturesFromObject(Y_(o),this.getReadOptions(o,t))},t.prototype.readFeatureFromObject=function(){return r()},t.prototype.readFeaturesFromObject=function(){return r()},t.prototype.readGeometry=function(o,t){return this.readGeometryFromObject(Y_(o),this.getReadOptions(o,t))},t.prototype.readGeometryFromObject=function(){return r()},t.prototype.readProjection=function(e){return this.readProjectionFromObject(Y_(e))},t.prototype.readProjectionFromObject=function(){return r()},t.prototype.writeFeature=function(o,t){return JSON.stringify(this.writeFeatureObject(o,t))},t.prototype.writeFeatureObject=function(){return r()},t.prototype.writeFeatures=function(o,t){return JSON.stringify(this.writeFeaturesObject(o,t))},t.prototype.writeFeaturesObject=function(){return r()},t.prototype.writeGeometry=function(o,t){return JSON.stringify(this.writeGeometryObject(o,t))},t.prototype.writeGeometryObject=function(){return r()},t}(K_),tg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),eg={};eg[oe.POINT]=function(o){var t;return t=void 0!==o.m&&void 0!==o.z?new Zr([o.x,o.y,o.z,o.m],ie):void 0===o.z?void 0===o.m?new Zr([o.x,o.y]):new Zr([o.x,o.y,o.m],ne):new Zr([o.x,o.y,o.z],re),t},eg[oe.LINE_STRING]=function(o){var t=H_(o);return new Sd(o.paths[0],t)},eg[oe.POLYGON]=function(o){var t=H_(o);return new hn(o.rings,t)},eg[oe.MULTI_POINT]=function(o){var t=H_(o);return new Qd(o.points,t)},eg[oe.MULTI_LINE_STRING]=function(o){var t=H_(o);return new Hd(o.paths,t)},eg[oe.MULTI_POLYGON]=function(o){var t=H_(o);return new e_(o.rings,t)};var rg={};rg[oe.POINT]=function(e){var t=e.getCoordinates(),o=e.getLayout(),n;return o===re?n={x:t[0],y:t[1],z:t[2]}:o===ne?n={x:t[0],y:t[1],m:t[2]}:o===ie?n={x:t[0],y:t[1],z:t[2],m:t[3]}:o===lt?n={x:t[0],y:t[1]}:O(!1,34),n},rg[oe.LINE_STRING]=function(e){var t=J_(e);return{hasZ:t.hasZ,hasM:t.hasM,paths:[e.getCoordinates()]}},rg[oe.POLYGON]=function(e){var t=J_(e);return{hasZ:t.hasZ,hasM:t.hasM,rings:e.getCoordinates(!1)}},rg[oe.MULTI_POINT]=function(e){var t=J_(e);return{hasZ:t.hasZ,hasM:t.hasM,points:e.getCoordinates()}},rg[oe.MULTI_LINE_STRING]=function(e){var t=J_(e);return{hasZ:t.hasZ,hasM:t.hasM,paths:e.getCoordinates()}},rg[oe.MULTI_POLYGON]=function(e){for(var t=J_(e),r=e.getCoordinates(!1),n=[],i=0;i<r.length;i++)for(var s=r[i].length-1;0<=s;s--)n.push(r[i][s]);return{hasZ:t.hasZ,hasM:t.hasM,rings:n}};var ng=function(o){function t(t){var e=this;return(e=o.call(this)||this).geometryName_=(t||{}).geometryName,e}return tg(t,o),t.prototype.readFeatureFromObject=function(o,t){var e=o,r=Z_(e.geometry,t),n=new ut;return this.geometryName_&&n.setGeometryName(this.geometryName_),n.setGeometry(r),t&&t.idField&&e.attributes[t.idField]&&n.setId(e.attributes[t.idField]),e.attributes&&n.setProperties(e.attributes,!0),n},t.prototype.readFeaturesFromObject=function(s,t){var e=t||{};if(s.features){var r=[],n=s.features;e.idField=s.objectIdFieldName;for(var i=0,l=n.length;i<l;++i)r.push(this.readFeatureFromObject(n[i],e));return r}return[this.readFeatureFromObject(s,e)]},t.prototype.readGeometryFromObject=function(o,t){return Z_(o,t)},t.prototype.readProjectionFromObject=function(e){return e.spatialReference&&void 0!==e.spatialReference.wkid?Ve("EPSG:"+e.spatialReference.wkid):null},t.prototype.writeGeometryObject=function(o,t){return $_(o,this.adaptOptions(t))},t.prototype.writeFeatureObject=function(o,t){t=this.adaptOptions(t);var a={},r=o.getGeometry();r&&(a.geometry=$_(r,t),t&&t.featureProjection&&(a.geometry.spatialReference={wkid:+Ve(t.featureProjection).getCode().split(":").pop()}));var n=o.getProperties();return delete n[o.getGeometryName()],a.attributes=f(n)?{}:n,a},t.prototype.writeFeaturesObject=function(o,t){t=this.adaptOptions(t);for(var a=[],r=0,s=o.length;r<s;++r)a.push(this.writeFeatureObject(o[r],t));return{features:a}},t}(Q_),ug=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lg=function(o){function t(){var t=o.call(this)||this;return t.xmlSerializer_=(void 0===rl&&"undefined"!=typeof XMLSerializer&&(rl=new XMLSerializer),rl),t}return ug(t,o),t.prototype.getType=function(){return"xml"},t.prototype.readFeature=function(o,t){if(o){if("string"==typeof o){var e=Cs(o);return this.readFeatureFromDocument(e,t)}return Ts(o)?this.readFeatureFromDocument(o,t):this.readFeatureFromNode(o,t)}return null},t.prototype.readFeatureFromDocument=function(o,t){var e=this.readFeaturesFromDocument(o,t);return 0<e.length?e[0]:null},t.prototype.readFeatureFromNode=function(){return null},t.prototype.readFeatures=function(o,t){if(o){if("string"==typeof o){var e=Cs(o);return this.readFeaturesFromDocument(e,t)}return Ts(o)?this.readFeaturesFromDocument(o,t):this.readFeaturesFromNode(o,t)}return[]},t.prototype.readFeaturesFromDocument=function(o,t){for(var e=[],r=o.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&v(e,this.readFeaturesFromNode(r,t));return e},t.prototype.readFeaturesFromNode=function(){return r()},t.prototype.readGeometry=function(o,t){if(o){if("string"==typeof o){var e=Cs(o);return this.readGeometryFromDocument(e,t)}return Ts(o)?this.readGeometryFromDocument(o,t):this.readGeometryFromNode(o,t)}return null},t.prototype.readGeometryFromDocument=function(){return null},t.prototype.readGeometryFromNode=function(){return null},t.prototype.readProjection=function(o){if(o){if("string"==typeof o){var t=Cs(o);return this.readProjectionFromDocument(t)}return Ts(o)?this.readProjectionFromDocument(o):this.readProjectionFromNode(o)}return null},t.prototype.readProjectionFromDocument=function(){return this.dataProjection},t.prototype.readProjectionFromNode=function(){return this.dataProjection},t.prototype.writeFeature=function(o,t){var e=this.writeFeatureNode(o,t);return this.xmlSerializer_.serializeToString(e)},t.prototype.writeFeatureNode=function(){return null},t.prototype.writeFeatures=function(o,t){var e=this.writeFeaturesNode(o,t);return this.xmlSerializer_.serializeToString(e)},t.prototype.writeFeaturesNode=function(){return null},t.prototype.writeGeometry=function(o,t){var e=this.writeGeometryNode(o,t);return this.xmlSerializer_.serializeToString(e)},t.prototype.writeGeometryNode=function(){return null},t}(K_),hg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cg=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.featureType=r.featureType,e.featureNS=r.featureNS,e.srsName=r.srsName,e.schemaLocation="",e.FEATURE_COLLECTION_PARSERS={},e.FEATURE_COLLECTION_PARSERS[e.namespace]={featureMember:ws(e.readFeaturesInternal),featureMembers:As(e.readFeaturesInternal)},e}return hg(t,o),t.prototype.readFeaturesInternal=function(x,t){var e=x.localName,r=null;if("FeatureCollection"==e)r=tl([],this.FEATURE_COLLECTION_PARSERS,x,t,this);else if("featureMembers"==e||"featureMember"==e){var S=t[0],i=S.featureType,E=S.featureNS;if(!i&&x.childNodes){i=[],E={};for(var T=0,C=x.childNodes.length,P;T<C;++T)if(P=x.childNodes[T],1===P.nodeType){var R=P.nodeName.split(":").pop();if(-1===i.indexOf(R)){var h="",w=0,L=P.namespaceURI;for(var f in E){if(E[f]===L){h=f;break}++w}h||(E[h="p"+w]=L),i.push(h+":"+R)}}"featureMember"!=e&&(S.featureType=i,S.featureNS=E)}if("string"==typeof E){var d=E;(E={}).p0=d}var _={},g=Array.isArray(i)?i:[i];for(var y in E){var I={};for(T=0,C=g.length;T<C;++T)(-1===g[T].indexOf(":")?"p0":g[T].split(":")[0])===y&&(I[g[T].split(":").pop()]="featureMembers"==e?ws(this.readFeatureElement,this):As(this.readFeatureElement,this));_[E[y]]=I}r=tl("featureMember"==e?void 0:[],_,x,t)}return null===r&&(r=[]),r},t.prototype.readGeometryElement=function(o,t){var e=t[0];e.srsName=o.firstElementChild.getAttribute("srsName"),e.srsDimension=o.firstElementChild.getAttribute("srsDimension");var r=tl(null,this.GEOMETRY_PARSERS,o,t,this);return r?Array.isArray(r)?B_(r,e):j_(r,!1,e):void 0},t.prototype.readFeatureElementInternal=function(d,t,e){for(var r={},i=d.firstElementChild,_;i;i=i.nextElementSibling){var g=void 0,y=i.localName;0===i.childNodes.length||1===i.childNodes.length&&(3===i.firstChild.nodeType||4===i.firstChild.nodeType)?(g=Es(i,!1),/^[\s\xa0]*$/.test(g)&&(g=void 0)):(e&&(g=this.readGeometryElement(i,t)),g?"boundedBy"!==y&&(_=y):g=this.readFeatureElementInternal(i,t,!1)),r[y]?(r[y]instanceof Array||(r[y]=[r[y]]),r[y].push(g)):r[y]=g;var s=i.attributes.length;if(0<s){r[y]={_content_:r[y]};for(var u=0,m;u<s;u++)m=i.attributes[u].name,r[y][m]=i.attributes[u].value}}if(e){var f=new ut(r);_&&f.setGeometryName(_);var c=d.getAttribute("fid")||function(o,t,e){return o.getAttributeNS(t,e)||""}(d,this.namespace,"id");return c&&f.setId(c),f}return r},t.prototype.readFeatureElement=function(o,t){return this.readFeatureElementInternal(o,t,!0)},t.prototype.readPoint=function(o,t){var e=this.readFlatCoordinatesFromNode_(o,t);if(e)return new Zr(e,re)},t.prototype.readMultiPoint=function(o,t){var e=tl([],this.MULTIPOINT_PARSERS_,o,t,this);return e?new Qd(e):void 0},t.prototype.readMultiLineString=function(o,t){var e=tl([],this.MULTILINESTRING_PARSERS_,o,t,this);if(e)return new Hd(e)},t.prototype.readMultiPolygon=function(o,t){var e=tl([],this.MULTIPOLYGON_PARSERS_,o,t,this);if(e)return new e_(e)},t.prototype.pointMemberParser_=function(o,t){el(this.POINTMEMBER_PARSERS_,o,t,this)},t.prototype.lineStringMemberParser_=function(o,t){el(this.LINESTRINGMEMBER_PARSERS_,o,t,this)},t.prototype.polygonMemberParser_=function(o,t){el(this.POLYGONMEMBER_PARSERS_,o,t,this)},t.prototype.readLineString=function(o,t){var e=this.readFlatCoordinatesFromNode_(o,t);return e?new Sd(e,re):void 0},t.prototype.readFlatLinearRing_=function(o,t){var e=tl(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,o,t,this);return e||void 0},t.prototype.readLinearRing=function(o,t){var e=this.readFlatCoordinatesFromNode_(o,t);if(e)return new Xr(e,re)},t.prototype.readPolygon=function(s,t){var e=tl([null],this.FLAT_LINEAR_RINGS_PARSERS,s,t,this);if(e&&e[0]){var r=e[0],i=[r.length],o,l;for(l=1,o=e.length;l<o;++l)v(r,e[l]),i.push(r.length);return new hn(r,re,i)}},t.prototype.readFlatCoordinatesFromNode_=function(o,t){return tl(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,o,t,this)},t.prototype.readGeometryFromNode=function(o,t){var e=this.readGeometryElement(o,[this.getReadOptions(o,t||{})]);return e||null},t.prototype.readFeaturesFromNode=function(o,t){var e={featureType:this.featureType,featureNS:this.featureNS};return t&&yh(e,this.getReadOptions(o,t)),this.readFeaturesInternal(o,[e])||[]},t.prototype.readProjectionFromNode=function(e){return Ve(this.srsName?this.srsName:e.firstElementChild.getAttribute("srsName"))},t}(lg);cg.prototype.namespace="http://www.opengis.net/gml",cg.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},cg.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},cg.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},cg.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml":{pointMember:ws(cg.prototype.pointMemberParser_),pointMembers:ws(cg.prototype.pointMemberParser_)}},cg.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml":{lineStringMember:ws(cg.prototype.lineStringMemberParser_),lineStringMembers:ws(cg.prototype.lineStringMemberParser_)}},cg.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml":{polygonMember:ws(cg.prototype.polygonMemberParser_),polygonMembers:ws(cg.prototype.polygonMemberParser_)}},cg.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml":{Point:ws(cg.prototype.readFlatCoordinatesFromNode_)}},cg.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ws(cg.prototype.readLineString)}},cg.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ws(cg.prototype.readPolygon)}},cg.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:As(cg.prototype.readFlatLinearRing_)}};var dg=cg,_g=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Rg={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Og=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,i)||this).surface_=void 0!==i.surface&&i.surface,e.curve_=void 0!==i.curve&&i.curve,e.multiCurve_=void 0===i.multiCurve||i.multiCurve,e.multiSurface_=void 0===i.multiSurface||i.multiSurface,e.schemaLocation=i.schemaLocation?i.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",e.hasZ=void 0!==i.hasZ&&i.hasZ,e}return _g(t,o),t.prototype.readMultiCurve_=function(o,t){var e=tl([],this.MULTICURVE_PARSERS_,o,t,this);return e?new Hd(e):void 0},t.prototype.readMultiSurface_=function(o,t){var e=tl([],this.MULTISURFACE_PARSERS_,o,t,this);if(e)return new e_(e)},t.prototype.curveMemberParser_=function(o,t){el(this.CURVEMEMBER_PARSERS_,o,t,this)},t.prototype.surfaceMemberParser_=function(o,t){el(this.SURFACEMEMBER_PARSERS_,o,t,this)},t.prototype.readPatch_=function(o,t){return tl([null],this.PATCHES_PARSERS_,o,t,this)},t.prototype.readSegment_=function(o,t){return tl([null],this.SEGMENTS_PARSERS_,o,t,this)},t.prototype.readPolygonPatch_=function(o,t){return tl([null],this.FLAT_LINEAR_RINGS_PARSERS,o,t,this)},t.prototype.readLineStringSegment_=function(o,t){return tl([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,o,t,this)},t.prototype.interiorParser_=function(o,t){var e=tl(void 0,this.RING_PARSERS,o,t,this);e&&t[t.length-1].push(e)},t.prototype.exteriorParser_=function(o,t){var e=tl(void 0,this.RING_PARSERS,o,t,this);e&&(t[t.length-1][0]=e)},t.prototype.readSurface_=function(s,t){var e=tl([null],this.SURFACE_PARSERS_,s,t,this);if(e&&e[0]){var r=e[0],i=[r.length],o,l;for(l=1,o=e.length;l<o;++l)v(r,e[l]),i.push(r.length);return new hn(r,re,i)}},t.prototype.readCurve_=function(o,t){var e=tl([null],this.CURVE_PARSERS_,o,t,this);return e?new Sd(e,re):void 0},t.prototype.readEnvelope_=function(o,t){var e=tl([null],this.ENVELOPE_PARSERS_,o,t,this);return yt(e[1][0],e[1][1],e[2][0],e[2][1])},t.prototype.readFlatPos_=function(i,t){for(var e=Es(i,!1),d=[],o;o=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/.exec(e);)d.push(parseFloat(o[1])),e=e.substr(o[0].length);if(""===e){var _=t[0].srsName,a="enu";if(_&&(a=Ve(_).getAxisOrientation()),"neu"===a){var g,y;for(y=0,g=d.length;y<g;y+=3){var m=d[y],h=d[y+1];d[y]=h,d[y+1]=m}}var c=d.length;if(2==c&&d.push(0),0!==c)return d}},t.prototype.readFlatPosList_=function(_,t){var e=Es(_,!1).replace(/^\s*|\s*$/g,""),r=t[0],n=r.srsName,i=r.srsDimension,o="enu";n&&(o=Ve(n).getAxisOrientation());var g=e.split(/\s+/),y=2,m,h,x;_.getAttribute("srsDimension")?y=yg(_.getAttribute("srsDimension")):_.getAttribute("dimension")?y=yg(_.getAttribute("dimension")):_.parentNode.getAttribute("srsDimension")?y=yg(_.parentNode.getAttribute("srsDimension")):i&&(y=yg(i));for(var S=[],p=0,E=g.length;p<E;p+=y)m=parseFloat(g[p]),h=parseFloat(g[p+1]),x=3===y?parseFloat(g[p+2]):0,"en"===o.substr(0,2)?S.push(m,h,x):S.push(h,m,x);return S},t.prototype.writePos_=function(p,t,e){var r=e[e.length-1],n=r.hasZ,i=n?"3":"2";p.setAttribute("srsDimension",i);var o=r.srsName,a="enu";o&&(a=Ve(o).getAxisOrientation());var d=t.getCoordinates(),l;(l="en"===a.substr(0,2)?d[0]+" "+d[1]:d[1]+" "+d[0],n)&&(l+=" "+(d[2]||0)),Eg(p,l)},t.prototype.getCoords_=function(o,t,e){var r="enu";t&&(r=Ve(t).getAxisOrientation());var a="en"===r.substr(0,2)?o[0]+" "+o[1]:o[1]+" "+o[0];return e&&(a+=" "+(o[2]||0)),a},t.prototype.writePosList_=function(p,t,e){var r=e[e.length-1],n=r.hasZ,i=n?"3":"2";p.setAttribute("srsDimension",i);for(var o=r.srsName,s=t.getCoordinates(),d=s.length,l=Array(d),_=0,g;_<d;++_)g=s[_],l[_]=this.getCoords_(g,o,n);Eg(p,l.join(" "))},t.prototype.writePoint_=function(o,t,e){var r=e[e.length-1].srsName;r&&o.setAttribute("srsName",r);var n=Ss(o.namespaceURI,"pos");o.appendChild(n),this.writePos_(n,t,e)},t.prototype.writeEnvelope=function(o,t,e){var r=e[e.length-1].srsName;r&&o.setAttribute("srsName",r);var n=[t[0]+" "+t[1],t[2]+" "+t[3]];nl({node:o},this.ENVELOPE_SERIALIZERS_,Yu,n,e,["lowerCorner","upperCorner"],this)},t.prototype.writeLinearRing_=function(o,t,e){var r=e[e.length-1].srsName;r&&o.setAttribute("srsName",r);var n=Ss(o.namespaceURI,"posList");o.appendChild(n),this.writePosList_(n,t,e)},t.prototype.RING_NODE_FACTORY_=function(r,t){var e=t[t.length-1],n=e.node,i=e.exteriorWritten;return void 0===i&&(e.exteriorWritten=!0),Ss(n.namespaceURI,void 0===i?"exterior":"interior")},t.prototype.writeSurfaceOrPolygon_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName;if("PolygonPatch"!==l.nodeName&&i&&l.setAttribute("srsName",i),"Polygon"===l.nodeName||"PolygonPatch"===l.nodeName){var o=t.getLinearRings();nl({node:l,hasZ:n,srsName:i},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,o,e,void 0,this)}else if("Surface"===l.nodeName){var a=Ss(l.namespaceURI,"patches");l.appendChild(a),this.writeSurfacePatches_(a,t,e)}},t.prototype.writeCurveOrLineString_=function(a,t,e){var r=e[e.length-1].srsName;if("LineStringSegment"!==a.nodeName&&r&&a.setAttribute("srsName",r),"LineString"===a.nodeName||"LineStringSegment"===a.nodeName){var n=Ss(a.namespaceURI,"posList");a.appendChild(n),this.writePosList_(n,t,e)}else if("Curve"===a.nodeName){var i=Ss(a.namespaceURI,"segments");a.appendChild(i),this.writeCurveSegments_(i,t,e)}},t.prototype.writeMultiSurfaceOrPolygon_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName,o=r.surface;i&&l.setAttribute("srsName",i);var a=t.getPolygons();nl({node:l,hasZ:n,srsName:i,surface:o},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,e,void 0,this)},t.prototype.writeMultiPoint_=function(s,t,e){var r=e[e.length-1],n=r.srsName,i=r.hasZ;n&&s.setAttribute("srsName",n);var o=t.getPoints();nl({node:s,hasZ:i,srsName:n},this.POINTMEMBER_SERIALIZERS_,Ws("pointMember"),o,e,void 0,this)},t.prototype.writeMultiCurveOrLineString_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName,o=r.curve;i&&l.setAttribute("srsName",i);var a=t.getLineStrings();nl({node:l,hasZ:n,srsName:i,curve:o},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,e,void 0,this)},t.prototype.writeRing_=function(o,t,e){var r=Ss(o.namespaceURI,"LinearRing");o.appendChild(r),this.writeLinearRing_(r,t,e)},t.prototype.writeSurfaceOrPolygonMember_=function(o,t,e){var r=this.GEOMETRY_NODE_FACTORY_(t,e);r&&(o.appendChild(r),this.writeSurfaceOrPolygon_(r,t,e))},t.prototype.writePointMember_=function(o,t,e){var r=Ss(o.namespaceURI,"Point");o.appendChild(r),this.writePoint_(r,t,e)},t.prototype.writeLineStringOrCurveMember_=function(o,t,e){var r=this.GEOMETRY_NODE_FACTORY_(t,e);r&&(o.appendChild(r),this.writeCurveOrLineString_(r,t,e))},t.prototype.writeSurfacePatches_=function(o,t,e){var r=Ss(o.namespaceURI,"PolygonPatch");o.appendChild(r),this.writeSurfaceOrPolygon_(r,t,e)},t.prototype.writeCurveSegments_=function(o,t,e){var r=Ss(o.namespaceURI,"LineStringSegment");o.appendChild(r),this.writeCurveOrLineString_(r,t,e)},t.prototype.writeGeometryElement=function(a,t,e){var r=e[e.length-1],i=yh({},r),o;i.node=a,o=Array.isArray(t)?B_(t,r):j_(t,!0,r),nl(i,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[o],e,void 0,this)},t.prototype.writeFeatureElement=function(p,t,e){var r=t.getId();r&&p.setAttribute("fid",r);var n=e[e.length-1],i=n.featureNS,o=t.getGeometryName();n.serializers||(n.serializers={},n.serializers[i]={});var a=t.getProperties(),s=[],d=[];for(var l in a){var _=a[l];null!==_&&(s.push(l),d.push(_),l==o||"function"==typeof _.getSimplifiedGeometry?l in n.serializers[i]||(n.serializers[i][l]=Vs(this.writeGeometryElement,this)):l in n.serializers[i]||(n.serializers[i][l]=Vs(Eg)))}var g=yh({},n);g.node=p,nl(g,n.serializers,Ws(void 0,i),d,e,s)},t.prototype.writeFeatureMembers_=function(l,t,e){var r=e[e.length-1],n=r.featureType,i=r.featureNS,o={};o[i]={},o[i][n]=Vs(this.writeFeatureElement,this);var a=yh({},r);a.node=l,nl(a,o,Ws(n,i),t,e)},t.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(o,t){var e=t[t.length-1].node;return Ss(this.namespace,Rg[e.nodeName])},t.prototype.GEOMETRY_NODE_FACTORY_=function(r,t){var e=t[t.length-1],i=e.multiSurface,o=e.surface,a=e.curve,s=e.multiCurve,l;return Array.isArray(r)?l="Envelope":"MultiPolygon"===(l=r.getType())&&!0===i?l="MultiSurface":"Polygon"===l&&!0===o?l="Surface":"LineString"===l&&!0===a?l="Curve":"MultiLineString"===l&&!0===s&&(l="MultiCurve"),Ss(this.namespace,l)},t.prototype.writeGeometryNode=function(o,t){t=this.adaptOptions(t);var i=Ss(this.namespace,"geom"),r={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&yh(r,t),this.writeGeometryElement(i,o,[r]),i},t.prototype.writeFeaturesNode=function(o,t){t=this.adaptOptions(t);var i=Ss(this.namespace,"featureMembers");i.setAttributeNS(zu,"xsi:schemaLocation",this.schemaLocation);var r={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return t&&yh(r,t),this.writeFeatureMembers_(i,o,[r]),i},t}(dg);Og.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:As(Og.prototype.readFlatPos_),posList:As(Og.prototype.readFlatPosList_)}},Og.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:Og.prototype.interiorParser_,exterior:Og.prototype.exteriorParser_}},Og.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:As(dg.prototype.readPoint),MultiPoint:As(dg.prototype.readMultiPoint),LineString:As(dg.prototype.readLineString),MultiLineString:As(dg.prototype.readMultiLineString),LinearRing:As(dg.prototype.readLinearRing),Polygon:As(dg.prototype.readPolygon),MultiPolygon:As(dg.prototype.readMultiPolygon),Surface:As(Og.prototype.readSurface_),MultiSurface:As(Og.prototype.readMultiSurface_),Curve:As(Og.prototype.readCurve_),MultiCurve:As(Og.prototype.readMultiCurve_),Envelope:As(Og.prototype.readEnvelope_)}},Og.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml":{curveMember:ws(Og.prototype.curveMemberParser_),curveMembers:ws(Og.prototype.curveMemberParser_)}},Og.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml":{surfaceMember:ws(Og.prototype.surfaceMemberParser_),surfaceMembers:ws(Og.prototype.surfaceMemberParser_)}},Og.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml":{LineString:ws(dg.prototype.readLineString),Curve:ws(Og.prototype.readCurve_)}},Og.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml":{Polygon:ws(dg.prototype.readPolygon),Surface:ws(Og.prototype.readSurface_)}},Og.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml":{patches:As(Og.prototype.readPatch_)}},Og.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml":{segments:As(Og.prototype.readSegment_)}},Og.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml":{lowerCorner:ws(Og.prototype.readFlatPosList_),upperCorner:ws(Og.prototype.readFlatPosList_)}},Og.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml":{PolygonPatch:As(Og.prototype.readPolygonPatch_)}},Og.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml":{LineStringSegment:As(Og.prototype.readLineStringSegment_)}},Og.prototype.writeFeatures,Og.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{exterior:Vs(Og.prototype.writeRing_),interior:Vs(Og.prototype.writeRing_)}},Og.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:Vs(Eg),upperCorner:Vs(Eg)}},Og.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:Vs(Og.prototype.writeSurfaceOrPolygonMember_),polygonMember:Vs(Og.prototype.writeSurfaceOrPolygonMember_)}},Og.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:Vs(Og.prototype.writePointMember_)}},Og.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:Vs(Og.prototype.writeLineStringOrCurveMember_),curveMember:Vs(Og.prototype.writeLineStringOrCurveMember_)}},Og.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:Vs(Og.prototype.writeCurveOrLineString_),MultiCurve:Vs(Og.prototype.writeMultiCurveOrLineString_),Point:Vs(Og.prototype.writePoint_),MultiPoint:Vs(Og.prototype.writeMultiPoint_),LineString:Vs(Og.prototype.writeCurveOrLineString_),MultiLineString:Vs(Og.prototype.writeMultiCurveOrLineString_),LinearRing:Vs(Og.prototype.writeLinearRing_),Polygon:Vs(Og.prototype.writeSurfaceOrPolygon_),MultiPolygon:Vs(Og.prototype.writeMultiSurfaceOrPolygon_),Surface:Vs(Og.prototype.writeSurfaceOrPolygon_),MultiSurface:Vs(Og.prototype.writeMultiSurfaceOrPolygon_),Envelope:Vs(Og.prototype.writeEnvelope)}};var Ig=Og,Lg=Ig;Lg.prototype.writeFeatures,Lg.prototype.writeFeaturesNode;var Fg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ag={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Ng=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,i)||this).FEATURE_COLLECTION_PARSERS["http://www.opengis.net/gml"].featureMember=ws(e.readFeaturesInternal),e.schemaLocation=i.schemaLocation?i.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",e}return Fg(t,o),t.prototype.readFlatCoordinates_=function(d,t){var e=Es(d,!1).replace(/^\s*|\s*$/g,""),r=t[0].srsName,n="enu";if(r){var _=Ve(r);_&&(n=_.getAxisOrientation())}for(var o=e.trim().split(/\s+/),a=[],s=0,g=o.length;s<g;s++){var l=o[s].split(/,+/),y=parseFloat(l[0]),c=parseFloat(l[1]),p=3===l.length?parseFloat(l[2]):0;"en"===n.substr(0,2)?a.push(y,c,p):a.push(c,y,p)}return a},t.prototype.readBox_=function(o,t){var e=tl([null],this.BOX_PARSERS_,o,t,this);return yt(e[1][0],e[1][1],e[1][3],e[1][4])},t.prototype.innerBoundaryIsParser_=function(o,t){var e=tl(void 0,this.RING_PARSERS,o,t,this);e&&t[t.length-1].push(e)},t.prototype.outerBoundaryIsParser_=function(o,t){var e=tl(void 0,this.RING_PARSERS,o,t,this);e&&(t[t.length-1][0]=e)},t.prototype.GEOMETRY_NODE_FACTORY_=function(r,t){var e=t[t.length-1],i=e.multiSurface,o=e.surface,a=e.multiCurve,s;return Array.isArray(r)?s="Envelope":"MultiPolygon"===(s=r.getType())&&!0===i?s="MultiSurface":"Polygon"===s&&!0===o?s="Surface":"MultiLineString"===s&&!0===a&&(s="MultiCurve"),Ss("http://www.opengis.net/gml",s)},t.prototype.writeFeatureElement=function(p,t,e){var r=t.getId();r&&p.setAttribute("fid",r);var n=e[e.length-1],i=n.featureNS,o=t.getGeometryName();n.serializers||(n.serializers={},n.serializers[i]={});var a=t.getProperties(),s=[],d=[];for(var l in a){var _=a[l];null!==_&&(s.push(l),d.push(_),l==o||"function"==typeof _.getSimplifiedGeometry?l in n.serializers[i]||(n.serializers[i][l]=Vs(this.writeGeometryElement,this)):l in n.serializers[i]||(n.serializers[i][l]=Vs(Eg)))}var g=yh({},n);g.node=p,nl(g,n.serializers,Ws(void 0,i),d,e,s)},t.prototype.writeCurveOrLineString_=function(a,t,e){var r=e[e.length-1].srsName;if("LineStringSegment"!==a.nodeName&&r&&a.setAttribute("srsName",r),"LineString"===a.nodeName||"LineStringSegment"===a.nodeName){var n=this.createCoordinatesNode_(a.namespaceURI);a.appendChild(n),this.writeCoordinates_(n,t,e)}else if("Curve"===a.nodeName){var i=Ss(a.namespaceURI,"segments");a.appendChild(i),this.writeCurveSegments_(i,t,e)}},t.prototype.writeLineStringOrCurveMember_=function(o,t,e){var r=this.GEOMETRY_NODE_FACTORY_(t,e);r&&(o.appendChild(r),this.writeCurveOrLineString_(r,t,e))},t.prototype.writeMultiCurveOrLineString_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName,o=r.curve;i&&l.setAttribute("srsName",i);var a=t.getLineStrings();nl({node:l,hasZ:n,srsName:i,curve:o},this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,e,void 0,this)},t.prototype.writeGeometryElement=function(a,t,e){var r=e[e.length-1],i=yh({},r),o;i.node=a,o=Array.isArray(t)?B_(t,r):j_(t,!0,r),nl(i,this.GEOMETRY_SERIALIZERS_,this.GEOMETRY_NODE_FACTORY_,[o],e,void 0,this)},t.prototype.createCoordinatesNode_=function(o){var t=Ss(o,"coordinates");return t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," "),t},t.prototype.writeCoordinates_=function(p,t,e){for(var r=e[e.length-1],n=r.hasZ,i=r.srsName,o=t.getCoordinates(),a=o.length,s=Array(a),d=0,_;d<a;++d)_=o[d],s[d]=this.getCoords_(_,i,n);Eg(p,s.join(" "))},t.prototype.writeCurveSegments_=function(o,t,e){var r=Ss(o.namespaceURI,"LineStringSegment");o.appendChild(r),this.writeCurveOrLineString_(r,t,e)},t.prototype.writeSurfaceOrPolygon_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName;if("PolygonPatch"!==l.nodeName&&i&&l.setAttribute("srsName",i),"Polygon"===l.nodeName||"PolygonPatch"===l.nodeName){var o=t.getLinearRings();nl({node:l,hasZ:n,srsName:i},this.RING_SERIALIZERS_,this.RING_NODE_FACTORY_,o,e,void 0,this)}else if("Surface"===l.nodeName){var a=Ss(l.namespaceURI,"patches");l.appendChild(a),this.writeSurfacePatches_(a,t,e)}},t.prototype.RING_NODE_FACTORY_=function(r,t){var e=t[t.length-1],n=e.node,i=e.exteriorWritten;return void 0===i&&(e.exteriorWritten=!0),Ss(n.namespaceURI,void 0===i?"outerBoundaryIs":"innerBoundaryIs")},t.prototype.writeSurfacePatches_=function(o,t,e){var r=Ss(o.namespaceURI,"PolygonPatch");o.appendChild(r),this.writeSurfaceOrPolygon_(r,t,e)},t.prototype.writeRing_=function(o,t,e){var r=Ss(o.namespaceURI,"LinearRing");o.appendChild(r),this.writeLinearRing_(r,t,e)},t.prototype.getCoords_=function(o,t,e){var r="enu";t&&(r=Ve(t).getAxisOrientation());var a="en"===r.substr(0,2)?o[0]+","+o[1]:o[1]+","+o[0];return e&&(a+=","+(o[2]||0)),a},t.prototype.writePoint_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName;i&&l.setAttribute("srsName",i);var o=this.createCoordinatesNode_(l.namespaceURI);l.appendChild(o);var a=t.getCoordinates();Eg(o,this.getCoords_(a,i,n))},t.prototype.writeMultiPoint_=function(s,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName;i&&s.setAttribute("srsName",i);var o=t.getPoints();nl({node:s,hasZ:n,srsName:i},this.POINTMEMBER_SERIALIZERS_,Ws("pointMember"),o,e,void 0,this)},t.prototype.writePointMember_=function(o,t,e){var r=Ss(o.namespaceURI,"Point");o.appendChild(r),this.writePoint_(r,t,e)},t.prototype.writeLinearRing_=function(o,t,e){var r=e[e.length-1].srsName;r&&o.setAttribute("srsName",r);var n=this.createCoordinatesNode_(o.namespaceURI);o.appendChild(n),this.writeCoordinates_(n,t,e)},t.prototype.writeMultiSurfaceOrPolygon_=function(l,t,e){var r=e[e.length-1],n=r.hasZ,i=r.srsName,o=r.surface;i&&l.setAttribute("srsName",i);var a=t.getPolygons();nl({node:l,hasZ:n,srsName:i,surface:o},this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,a,e,void 0,this)},t.prototype.writeSurfaceOrPolygonMember_=function(o,t,e){var r=this.GEOMETRY_NODE_FACTORY_(t,e);r&&(o.appendChild(r),this.writeSurfaceOrPolygon_(r,t,e))},t.prototype.writeEnvelope=function(o,t,e){var r=e[e.length-1].srsName;r&&o.setAttribute("srsName",r);var n=[t[0]+" "+t[1],t[2]+" "+t[3]];nl({node:o},this.ENVELOPE_SERIALIZERS_,Yu,n,e,["lowerCorner","upperCorner"],this)},t.prototype.MULTIGEOMETRY_MEMBER_NODE_FACTORY_=function(o,t){var e=t[t.length-1].node;return Ss("http://www.opengis.net/gml",Ag[e.nodeName])},t}(dg);Ng.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:As(Ng.prototype.readFlatCoordinates_)}},Ng.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:Ng.prototype.innerBoundaryIsParser_,outerBoundaryIs:Ng.prototype.outerBoundaryIsParser_}},Ng.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:ws(Ng.prototype.readFlatCoordinates_)}},Ng.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:As(dg.prototype.readPoint),MultiPoint:As(dg.prototype.readMultiPoint),LineString:As(dg.prototype.readLineString),MultiLineString:As(dg.prototype.readMultiLineString),LinearRing:As(dg.prototype.readLinearRing),Polygon:As(dg.prototype.readPolygon),MultiPolygon:As(dg.prototype.readMultiPolygon),Box:As(Ng.prototype.readBox_)}},Ng.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml":{Curve:Vs(Ng.prototype.writeCurveOrLineString_),MultiCurve:Vs(Ng.prototype.writeMultiCurveOrLineString_),Point:Vs(Ng.prototype.writePoint_),MultiPoint:Vs(Ng.prototype.writeMultiPoint_),LineString:Vs(Ng.prototype.writeCurveOrLineString_),MultiLineString:Vs(Ng.prototype.writeMultiCurveOrLineString_),LinearRing:Vs(Ng.prototype.writeLinearRing_),Polygon:Vs(Ng.prototype.writeSurfaceOrPolygon_),MultiPolygon:Vs(Ng.prototype.writeMultiSurfaceOrPolygon_),Surface:Vs(Ng.prototype.writeSurfaceOrPolygon_),MultiSurface:Vs(Ng.prototype.writeMultiSurfaceOrPolygon_),Envelope:Vs(Ng.prototype.writeEnvelope)}},Ng.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{lineStringMember:Vs(Ng.prototype.writeLineStringOrCurveMember_),curveMember:Vs(Ng.prototype.writeLineStringOrCurveMember_)}},Ng.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml":{outerBoundaryIs:Vs(Ng.prototype.writeRing_),innerBoundaryIs:Vs(Ng.prototype.writeRing_)}},Ng.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{pointMember:Vs(Ng.prototype.writePointMember_)}},Ng.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml":{surfaceMember:Vs(Ng.prototype.writeSurfaceOrPolygonMember_),polygonMember:Vs(Ng.prototype.writeSurfaceOrPolygonMember_)}},Ng.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml":{lowerCorner:Vs(Eg),upperCorner:Vs(Eg)}};var Gg=Ng,jg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Dg=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this,i)||this).schemaLocation=i.schemaLocation?i.schemaLocation:e.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",e}return jg(t,o),t}(Ig);Dg.prototype.namespace="http://www.opengis.net/gml/3.2",Dg.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:As(Ig.prototype.readFlatPos_),posList:As(Ig.prototype.readFlatPosList_)}},Dg.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:Ig.prototype.interiorParser_,exterior:Ig.prototype.exteriorParser_}},Dg.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:As(dg.prototype.readPoint),MultiPoint:As(dg.prototype.readMultiPoint),LineString:As(dg.prototype.readLineString),MultiLineString:As(dg.prototype.readMultiLineString),LinearRing:As(dg.prototype.readLinearRing),Polygon:As(dg.prototype.readPolygon),MultiPolygon:As(dg.prototype.readMultiPolygon),Surface:As(Dg.prototype.readSurface_),MultiSurface:As(Ig.prototype.readMultiSurface_),Curve:As(Dg.prototype.readCurve_),MultiCurve:As(Ig.prototype.readMultiCurve_),Envelope:As(Dg.prototype.readEnvelope_)}},Dg.prototype.MULTICURVE_PARSERS_={"http://www.opengis.net/gml/3.2":{curveMember:ws(Ig.prototype.curveMemberParser_),curveMembers:ws(Ig.prototype.curveMemberParser_)}},Dg.prototype.MULTISURFACE_PARSERS_={"http://www.opengis.net/gml/3.2":{surfaceMember:ws(Ig.prototype.surfaceMemberParser_),surfaceMembers:ws(Ig.prototype.surfaceMemberParser_)}},Dg.prototype.CURVEMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{LineString:ws(dg.prototype.readLineString),Curve:ws(Ig.prototype.readCurve_)}},Dg.prototype.SURFACEMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Polygon:ws(dg.prototype.readPolygon),Surface:ws(Ig.prototype.readSurface_)}},Dg.prototype.SURFACE_PARSERS_={"http://www.opengis.net/gml/3.2":{patches:As(Ig.prototype.readPatch_)}},Dg.prototype.CURVE_PARSERS_={"http://www.opengis.net/gml/3.2":{segments:As(Ig.prototype.readSegment_)}},Dg.prototype.ENVELOPE_PARSERS_={"http://www.opengis.net/gml/3.2":{lowerCorner:ws(Ig.prototype.readFlatPosList_),upperCorner:ws(Ig.prototype.readFlatPosList_)}},Dg.prototype.PATCHES_PARSERS_={"http://www.opengis.net/gml/3.2":{PolygonPatch:As(Ig.prototype.readPolygonPatch_)}},Dg.prototype.SEGMENTS_PARSERS_={"http://www.opengis.net/gml/3.2":{LineStringSegment:As(Ig.prototype.readLineStringSegment_)}},Dg.prototype.MULTIPOINT_PARSERS_={"http://www.opengis.net/gml/3.2":{pointMember:ws(dg.prototype.pointMemberParser_),pointMembers:ws(dg.prototype.pointMemberParser_)}},Dg.prototype.MULTILINESTRING_PARSERS_={"http://www.opengis.net/gml/3.2":{lineStringMember:ws(dg.prototype.lineStringMemberParser_),lineStringMembers:ws(dg.prototype.lineStringMemberParser_)}},Dg.prototype.MULTIPOLYGON_PARSERS_={"http://www.opengis.net/gml/3.2":{polygonMember:ws(dg.prototype.polygonMemberParser_),polygonMembers:ws(dg.prototype.polygonMemberParser_)}},Dg.prototype.POINTMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Point:ws(dg.prototype.readFlatCoordinatesFromNode_)}},Dg.prototype.LINESTRINGMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{LineString:ws(dg.prototype.readLineString)}},Dg.prototype.POLYGONMEMBER_PARSERS_={"http://www.opengis.net/gml/3.2":{Polygon:ws(dg.prototype.readPolygon)}},Dg.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:As(dg.prototype.readFlatLinearRing_)}},Dg.prototype.RING_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{exterior:Vs(Ig.prototype.writeRing_),interior:Vs(Ig.prototype.writeRing_)}},Dg.prototype.ENVELOPE_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{lowerCorner:Vs(Eg),upperCorner:Vs(Eg)}},Dg.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{surfaceMember:Vs(Ig.prototype.writeSurfaceOrPolygonMember_),polygonMember:Vs(Ig.prototype.writeSurfaceOrPolygonMember_)}},Dg.prototype.POINTMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{pointMember:Vs(Ig.prototype.writePointMember_)}},Dg.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{lineStringMember:Vs(Ig.prototype.writeLineStringOrCurveMember_),curveMember:Vs(Ig.prototype.writeLineStringOrCurveMember_)}},Dg.prototype.GEOMETRY_SERIALIZERS_={"http://www.opengis.net/gml/3.2":{Curve:Vs(Ig.prototype.writeCurveOrLineString_),MultiCurve:Vs(Ig.prototype.writeMultiCurveOrLineString_),Point:Vs(Dg.prototype.writePoint_),MultiPoint:Vs(Ig.prototype.writeMultiPoint_),LineString:Vs(Ig.prototype.writeCurveOrLineString_),MultiLineString:Vs(Ig.prototype.writeMultiCurveOrLineString_),LinearRing:Vs(Ig.prototype.writeLinearRing_),Polygon:Vs(Ig.prototype.writeSurfaceOrPolygon_),MultiPolygon:Vs(Ig.prototype.writeMultiSurfaceOrPolygon_),Surface:Vs(Ig.prototype.writeSurfaceOrPolygon_),MultiSurface:Vs(Ig.prototype.writeMultiSurfaceOrPolygon_),Envelope:Vs(Ig.prototype.writeEnvelope)}};var kg=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),zg=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Bg={rte:bg,trk:Mg,wpt:Ug},Yg=qs(zg,{rte:ws(bg),trk:ws(Mg),wpt:ws(Ug)}),Vg=qs(zg,{text:Ys(mg,"linkText"),type:Ys(mg,"linkType")}),Xg=qs(zg,{rte:Vs(function(p,t,e){var r=e[0],n=t.getProperties(),i={node:p};i.properties=n;var o=t.getGeometry();if(o.getType()==oe.LINE_STRING){var a=j_(o,!0,r);i.geometryLayout=a.getLayout(),n.rtept=a.getCoordinates()}var s=e[e.length-1].node,d=ey[s.namespaceURI],l=Zs(n,d);nl(i,ry,Yu,l,e,d)}),trk:Vs(function(p,t,e){var r=e[0],n=t.getProperties(),i={node:p};i.properties=n;var o=t.getGeometry();if(o.getType()==oe.MULTI_LINE_STRING){var a=j_(o,!0,r);n.trkseg=a.getLineStrings()}var s=e[e.length-1].node,d=iy[s.namespaceURI],l=Zs(n,d);nl(i,oy,Yu,l,e,d)}),wpt:Vs(function(s,t,e){var r=e[0],n=e[e.length-1];n.properties=t.getProperties();var i=t.getGeometry();if(i.getType()==oe.POINT){var o=j_(i,!0,r);n.geometryLayout=o.getLayout(),iu(s,o.getCoordinates(),e)}})}),Wg=function(o){function t(t){var e=o.call(this)||this;return e.dataProjection=Ve("EPSG:4326"),e.readExtensions_=(t||{}).readExtensions,e}return kg(t,o),t.prototype.handleReadExtensions_=function(o){o||(o=[]);for(var a=0,s=o.length,r;a<s;++a){if(r=o[a],this.readExtensions_){var l=r.get("extensionsNode_")||null;this.readExtensions_(r,l)}r.set("extensionsNode_",void 0)}},t.prototype.readFeatureFromNode=function(o,t){if(!x(zg,o.namespaceURI))return null;var e=Bg[o.localName];if(!e)return null;var r=e(o,[this.getReadOptions(o,t)]);return r?(this.handleReadExtensions_([r]),r):null},t.prototype.readFeaturesFromNode=function(o,t){if(!x(zg,o.namespaceURI))return[];if("gpx"==o.localName){var e=tl([],Yg,o,[this.getReadOptions(o,t)]);return e?(this.handleReadExtensions_(e),e):[]}return[]},t.prototype.writeFeaturesNode=function(o,t){t=this.adaptOptions(t);var n=Ss("http://www.topografix.com/GPX/1/1","gpx");return n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",zu),n.setAttributeNS(zu,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),n.setAttribute("version","1.1"),n.setAttribute("creator","OpenLayers"),nl({node:n},Xg,Tg,o,[t]),n},t}(lg),Zg=qs(zg,{name:Ys(mg),cmt:Ys(mg),desc:Ys(mg),src:Ys(mg),link:wg,number:Ys(gg),extensions:vg,type:Ys(mg),rtept:function(a,t){var e=tl({},Kg,a,t);if(e){var r=t[t.length-1],n=r.flatCoordinates,i=r.layoutOptions;Cg(n,i,a,e)}}}),Kg=qs(zg,{ele:Ys(sg),time:Ys(ag)}),qg=qs(zg,{name:Ys(mg),cmt:Ys(mg),desc:Ys(mg),src:Ys(mg),link:wg,number:Ys(gg),type:Ys(mg),extensions:vg,trkseg:function(o,t){var e=t[t.length-1];el(Hg,o,t);var r=e.flatCoordinates;e.ends.push(r.length)}}),Hg=qs(zg,{trkpt:function(a,t){var e=tl({},Jg,a,t);if(e){var r=t[t.length-1],n=r.flatCoordinates,i=r.layoutOptions;Cg(n,i,a,e)}}}),Jg=qs(zg,{ele:Ys(sg),time:Ys(ag)}),Qg=qs(zg,{ele:Ys(sg),time:Ys(ag),magvar:Ys(sg),geoidheight:Ys(sg),name:Ys(mg),cmt:Ys(mg),desc:Ys(mg),src:Ys(mg),link:wg,sym:Ys(mg),type:Ys(mg),fix:Ys(mg),sat:Ys(gg),hdop:Ys(sg),vdop:Ys(sg),pdop:Ys(sg),ageofdgpsdata:Ys(sg),dgpsid:Ys(gg),extensions:vg}),$g=["text","type"],ty=qs(zg,{text:Vs(Eg),type:Vs(Eg)}),ey=qs(zg,["name","cmt","desc","src","link","number","type","rtept"]),ry=qs(zg,{name:Vs(Eg),cmt:Vs(Eg),desc:Vs(Eg),src:Vs(Eg),link:Vs(eu),number:Vs(Sg),type:Vs(Eg),rtept:Xs(Vs(iu))}),ny=qs(zg,["ele","time"]),iy=qs(zg,["name","cmt","desc","src","link","number","type","trkseg"]),oy=qs(zg,{name:Vs(Eg),cmt:Vs(Eg),desc:Vs(Eg),src:Vs(Eg),link:Vs(eu),number:Vs(Sg),type:Vs(Eg),trkseg:Xs(Vs(function(o,t,e){var r={node:o};r.geometryLayout=t.getLayout(),r.properties={},nl(r,sy,ay,t.getCoordinates(),e)}))}),ay=Ws("trkpt"),sy=qs(zg,{trkpt:Vs(iu)}),uy=qs(zg,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),ly=qs(zg,{ele:Vs(xg),time:Vs(function(o,t){var e=new Date(1e3*t),r=e.getUTCFullYear()+"-"+an(e.getUTCMonth()+1,2)+"-"+an(e.getUTCDate(),2)+"T"+an(e.getUTCHours(),2)+":"+an(e.getUTCMinutes(),2)+":"+an(e.getUTCSeconds(),2)+"Z";o.appendChild(il().createTextNode(r))}),magvar:Vs(xg),geoidheight:Vs(xg),name:Vs(Eg),cmt:Vs(Eg),desc:Vs(Eg),src:Vs(Eg),link:Vs(eu),sym:Vs(Eg),type:Vs(Eg),fix:Vs(Eg),sat:Vs(Sg),hdop:Vs(xg),vdop:Vs(xg),pdop:Vs(xg),ageofdgpsdata:Vs(xg),dgpsid:Vs(Sg)}),hy={Point:"wpt",LineString:"rte",MultiLineString:"trk"},cy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ey=function(o){function t(t){var e=this,i=t||{};return(e=o.call(this)||this).dataProjection=Ve(i.dataProjection?i.dataProjection:"EPSG:4326"),i.featureProjection&&(e.defaultFeatureProjection=Ve(i.featureProjection)),e.geometryName_=i.geometryName,e.extractGeometryName_=i.extractGeometryName,e}return cy(t,o),t.prototype.readFeatureFromObject=function(o,t){var e=null,a=su((e="Feature"===o.type?o:{type:"Feature",geometry:o,properties:null}).geometry,t),n=new ut;return this.geometryName_?n.setGeometryName(this.geometryName_):this.extractGeometryName_&&void 0!=="geometry_name"in e&&n.setGeometryName(e.geometry_name),n.setGeometry(a),"id"in e&&n.setId(e.id),e.properties&&n.setProperties(e.properties,!0),n},t.prototype.readFeaturesFromObject=function(a,t){var e=null;if("FeatureCollection"===a.type){e=[];for(var s=a.features,n=0,l=s.length;n<l;++n)e.push(this.readFeatureFromObject(s[n],t))}else e=[this.readFeatureFromObject(a,t)];return e},t.prototype.readGeometryFromObject=function(o,t){return su(o,t)},t.prototype.readProjectionFromObject=function(o){var t=o.crs,r;return t?"name"==t.type?r=Ve(t.properties.name):"EPSG"===t.type?r=Ve("EPSG:"+t.properties.code):O(!1,36):r=this.dataProjection,r},t.prototype.writeFeatureObject=function(a,t){t=this.adaptOptions(t);var s={type:"Feature",geometry:null,properties:null},r=a.getId();void 0!==r&&(s.id=r);var n=a.getGeometry();n&&(s.geometry=lu(n,t));var i=a.getProperties();return delete i[a.getGeometryName()],f(i)||(s.properties=i),s},t.prototype.writeFeaturesObject=function(o,t){t=this.adaptOptions(t);for(var a=[],r=0,s=o.length;r<s;++r)a.push(this.writeFeatureObject(o[r],t));return{type:"FeatureCollection",features:a}},t.prototype.writeGeometryObject=function(o,t){return lu(o,this.adaptOptions(t))},t}(Q_),by=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Py=function(o){function t(){return o.call(this)||this}return by(t,o),t.prototype.getType=function(){return"text"},t.prototype.readFeature=function(o,t){return this.readFeatureFromText(uu(o),this.adaptOptions(t))},t.prototype.readFeatureFromText=function(){return r()},t.prototype.readFeatures=function(o,t){return this.readFeaturesFromText(uu(o),this.adaptOptions(t))},t.prototype.readFeaturesFromText=function(){return r()},t.prototype.readGeometry=function(o,t){return this.readGeometryFromText(uu(o),this.adaptOptions(t))},t.prototype.readGeometryFromText=function(){return r()},t.prototype.readProjection=function(e){return this.readProjectionFromText(uu(e))},t.prototype.readProjectionFromText=function(){return this.dataProjection},t.prototype.writeFeature=function(o,t){return this.writeFeatureText(o,this.adaptOptions(t))},t.prototype.writeFeatureText=function(){return r()},t.prototype.writeFeatures=function(o,t){return this.writeFeaturesText(o,this.adaptOptions(t))},t.prototype.writeFeaturesText=function(){return r()},t.prototype.writeGeometry=function(o,t){return this.writeGeometryText(o,this.adaptOptions(t))},t.prototype.writeGeometryText=function(){return r()},t}(K_),Gy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jy="none",Uy=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.dataProjection=Ve("EPSG:4326"),e.altitudeMode_=r.altitudeMode?r.altitudeMode:jy,e}return Gy(t,o),t.prototype.readFeatureFromText=function(E,t){var e=this.altitudeMode_,i=E.split(/\r\n|\r|\n/),o={},a=[],s=2e3,T=0,C=1,P=-1,R,L;for(R=0,L=i.length;R<L;++R){var I=i[R],p=void 0;if(!("B"==I.charAt(0)))"H"==I.charAt(0)&&((p=/^HFDTE(\d{2})(\d{2})(\d{2})/.exec(I))?(C=parseInt(p[1],10),T=parseInt(p[2],10)-1,s=2e3+parseInt(p[3],10)):(p=/^H.([A-Z]{3}).*?:(.*)/.exec(I))&&(o[p[1]]=p[2].trim()));else if(p=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/.exec(I)){var b=parseInt(p[1],10),d=parseInt(p[2],10),_=parseInt(p[3],10),g=parseInt(p[4],10)+parseInt(p[5],10)/6e4;"S"==p[6]&&(g=-g);var F=parseInt(p[7],10)+parseInt(p[8],10)/6e4;if("W"==p[9]&&(F=-F),a.push(F,g),e!=jy){var O=void 0;O=e=="gps"?parseInt(p[11],10):e=="barometric"?parseInt(p[12],10):0,a.push(O)}var M=Date.UTC(s,T,C,b,d,_);M<P&&(M=Date.UTC(s,T,C+1,b,d,_)),a.push(M/1e3),P=M}}if(0===a.length)return null;var N=new Sd(a,e==jy?ne:ie),w=new ut(j_(N,!1,t));return w.setProperties(o,!0),w},t.prototype.readFeaturesFromText=function(o,t){var e=this.readFeatureFromText(o,t);return e?[e]:[]},t}(Py),Xy=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Wy=["http://www.google.com/kml/ext/2.2"],Zy=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Ky={fraction:zl,pixels:Bl,insetPixels:Bl},qy=qs(Zy,{ExtendedData:Du,Region:ku,MultiGeometry:Ys(bu,"geometry"),LineString:Ys(Iu,"geometry"),LinearRing:Ys(vu,"geometry"),Point:Ys(Fu,"geometry"),Polygon:Ys(Ou,"geometry"),Style:Ys(Nu),StyleMap:function(o,t){var e=Eu.call(this,o,t);if(e){var r=t[t.length-1];Array.isArray(e)?r.Style=e:"string"==typeof e?r.styleUrl=e:O(!1,38)}},address:Ys(mg),description:Ys(mg),name:Ys(mg),open:Ys(og),phoneNumber:Ys(mg),styleUrl:Ys(xu),visibility:Ys(og)},qs(Wy,{MultiTrack:Ys(function(o,t){var e=tl([],CS,o,t);return e?new Hd(e):void 0},"geometry"),Track:Ys(Ru,"geometry")})),Hy=qs(Zy,{ExtendedData:Du,Region:ku,Link:function(o,t){el(Jy,o,t)},address:Ys(mg),description:Ys(mg),name:Ys(mg),open:Ys(og),phoneNumber:Ys(mg),visibility:Ys(og)}),Jy=qs(Zy,{href:Ys(xu)}),Qy=qs(Zy,{LatLonAltBox:function(o,t){var e=tl({},PE,o,t);if(e){var r=t[t.length-1],n=[parseFloat(e.west),parseFloat(e.south),parseFloat(e.east),parseFloat(e.north)];r.extent=n,r.altitudeMode=e.altitudeMode,r.minAltitude=parseFloat(e.minAltitude),r.maxAltitude=parseFloat(e.maxAltitude)}},Lod:function(o,t){var e=tl({},RE,o,t);if(e){var r=t[t.length-1];r.minLodPixels=parseFloat(e.minLodPixels),r.maxLodPixels=parseFloat(e.maxLodPixels),r.minFadeExtent=parseFloat(e.minFadeExtent),r.maxFadeExtent=parseFloat(e.maxFadeExtent)}}}),$y=qs(Zy,["Document","Placemark"]),ax=qs(Zy,{Document:Vs(function(o,t,e){nl({node:o},BE,YE,t,e,void 0,this)}),Placemark:Vs(Xu)}),sx=null,lx=null,dx=null,_x=null,gx=null,ux=null,yx=function(o){function t(t){var e=o.call(this)||this,r=t||{};return ux||(sx=new Ul({color:zm=[255,255,255,1]}),lx=new eh({anchor:VE=[20,2],anchorOrigin:Hl,anchorXUnits:XE=Bl,anchorYUnits:WE=Bl,crossOrigin:"anonymous",rotation:0,scale:HE=.5,size:ZE=[64,64],src:KE="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"}),qE="NO_IMAGE",dx=new rh({color:zm,width:1}),JE=new rh({color:[51,51,51,1],width:2}),_x=new lh({font:"bold 16px Helvetica",fill:sx,stroke:JE,scale:.8}),gx=new Vf({fill:sx,image:lx,text:_x,stroke:dx,zIndex:0}),ux=[gx]),e.dataProjection=Ve("EPSG:4326"),e.defaultStyle_=r.defaultStyle?r.defaultStyle:ux,e.extractStyles_=void 0===r.extractStyles||r.extractStyles,e.writeStyles_=void 0===r.writeStyles||r.writeStyles,e.sharedStyles_={},e.showPointNames_=void 0===r.showPointNames||r.showPointNames,e.crossOrigin_=void 0===r.crossOrigin?"anonymous":r.crossOrigin,e}return Xy(t,o),t.prototype.readDocumentOrFolder_=function(o,t){var e=tl([],qs(Zy,{Document:Ps(this.readDocumentOrFolder_,this),Folder:Ps(this.readDocumentOrFolder_,this),Placemark:ws(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),o,t,this);return e||void 0},t.prototype.readPlacemark_=function(l,t){var e=tl({geometry:null},qy,l,t,this);if(e){var r=new ut,n=l.getAttribute("id");null!==n&&r.setId(n);var i=t[0],o=e.geometry;if(o&&j_(o,!1,i),r.setGeometry(o),delete e.geometry,this.extractStyles_){var a=function(a,t,e,r,n){return function(i){var o=n,d="",_=[];if(o){var g=i.getGeometry();if(g){var y=g.getType();o=y===oe.GEOMETRY_COLLECTION?0<(_=g.getGeometriesArrayRecursive().filter(function(o){var t=o.getType();return t===oe.POINT||t===oe.MULTI_POINT})).length:y===oe.POINT||y===oe.MULTI_POINT}}o&&(d=i.get("name"),(o=o&&!!d)&&-1<d.search(/&[^&]+;/)&&(QE||(QE=document.createElement("textarea")),QE.innerHTML=d,d=QE.value));var c=e;if(a?c=a:t&&(c=function o(t,i,r){return Array.isArray(t)?t:"string"==typeof t?(!(t in r)&&"#"+t in r&&(t="#"+t),o(r[t],i,r)):i}(t,e,r)),o){var m=function(l,t){var e=[0,0],r="start",p=l.getImage();if(p){var i=p.getImageSize();if(null===i&&(i=ZE),2==i.length){var d=p.getScale();e[0]=d*i[0]/2,e[1]=-d*i[1]/2,r="left"}}var a=l.getText();return a?((a=a.clone()).setFont(a.getFont()||_x.getFont()),a.setScale(a.getScale()||_x.getScale()),a.setFill(a.getFill()||_x.getFill()),a.setStroke(a.getStroke()||JE)):a=_x.clone(),a.setText(t),a.setOffsetX(e[0]),a.setOffsetY(e[1]),a.setTextAlign(r),new Vf({image:p,text:a})}(c[0],d);return 0<_.length?(m.setGeometry(new W_(_)),[m,new Vf({geometry:c[0].getGeometry(),image:null,fill:c[0].getFill(),stroke:c[0].getStroke(),text:null})].concat(c.slice(1))):m}return c}}(e.Style,e.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);r.setStyle(a)}return delete e.Style,r.setProperties(e,!0),r}},t.prototype.readSharedStyle_=function(a,t){var e=a.getAttribute("id");if(null!==e){var r=Nu.call(this,a,t);if(r){var n=a.baseURI,s;s=(n&&"about:blank"!=n||(n=window.location.href),n)?new URL("#"+e,n).href:"#"+e,this.sharedStyles_[s]=r}}},t.prototype.readSharedStyleMap_=function(a,t){var e=a.getAttribute("id");if(null!==e){var r=Eu.call(this,a,t);if(r){var n=a.baseURI,s;s=(n&&"about:blank"!=n||(n=window.location.href),n)?new URL("#"+e,n).href:"#"+e,this.sharedStyles_[s]=r}}},t.prototype.readFeatureFromNode=function(o,t){if(!x(Zy,o.namespaceURI))return null;var e=this.readPlacemark_(o,[this.getReadOptions(o,t)]);return e||null},t.prototype.readFeaturesFromNode=function(s,t){if(!x(Zy,s.namespaceURI))return[];var e=s.localName,n;if("Document"==e||"Folder"==e)return(n=this.readDocumentOrFolder_(s,[this.getReadOptions(s,t)]))||[];if("Placemark"==e){var l=this.readPlacemark_(s,[this.getReadOptions(s,t)]);return l?[l]:[]}if("kml"==e){n=[];for(var i=s.firstElementChild,p;i;i=i.nextElementSibling)p=this.readFeaturesFromNode(i,t),p&&v(n,p);return n}return[]},t.prototype.readName=function(o){if(o){if("string"==typeof o){var t=Cs(o);return this.readNameFromDocument(t)}return Ts(o)?this.readNameFromDocument(o):this.readNameFromNode(o)}},t.prototype.readNameFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){var n=this.readNameFromNode(t);if(n)return n}},t.prototype.readNameFromNode=function(o){for(var t=o.firstElementChild;t;t=t.nextElementSibling)if(x(Zy,t.namespaceURI)&&"name"==t.localName)return mg(t);for(t=o.firstElementChild;t;t=t.nextElementSibling){var i=t.localName;if(x(Zy,t.namespaceURI)&&("Document"==i||"Folder"==i||"Placemark"==i||"kml"==i)){var r=this.readNameFromNode(t);if(r)return r}}},t.prototype.readNetworkLinks=function(o){var t=[];if("string"==typeof o){var e=Cs(o);v(t,this.readNetworkLinksFromDocument(e))}else Ts(o)?v(t,this.readNetworkLinksFromDocument(o)):v(t,this.readNetworkLinksFromNode(o));return t},t.prototype.readNetworkLinksFromDocument=function(o){for(var t=[],e=o.firstChild;e;e=e.nextSibling)e.nodeType==Node.ELEMENT_NODE&&v(t,this.readNetworkLinksFromNode(e));return t},t.prototype.readNetworkLinksFromNode=function(o){for(var t=[],e=o.firstElementChild;e;e=e.nextElementSibling)if(x(Zy,e.namespaceURI)&&"NetworkLink"==e.localName){var a=tl({},Hy,e,[]);t.push(a)}for(e=o.firstElementChild;e;e=e.nextElementSibling){var n=e.localName;x(Zy,e.namespaceURI)&&("Document"==n||"Folder"==n||"kml"==n)&&v(t,this.readNetworkLinksFromNode(e))}return t},t.prototype.readRegion=function(o){var t=[];if("string"==typeof o){var e=Cs(o);v(t,this.readRegionFromDocument(e))}else Ts(o)?v(t,this.readRegionFromDocument(o)):v(t,this.readRegionFromNode(o));return t},t.prototype.readRegionFromDocument=function(o){for(var t=[],e=o.firstChild;e;e=e.nextSibling)e.nodeType==Node.ELEMENT_NODE&&v(t,this.readRegionFromNode(e));return t},t.prototype.readRegionFromNode=function(o){for(var t=[],e=o.firstElementChild;e;e=e.nextElementSibling)if(x(Zy,e.namespaceURI)&&"Region"==e.localName){var a=tl({},Qy,e,[]);t.push(a)}for(e=o.firstElementChild;e;e=e.nextElementSibling){var n=e.localName;x(Zy,e.namespaceURI)&&("Document"==n||"Folder"==n||"kml"==n)&&v(t,this.readRegionFromNode(e))}return t},t.prototype.writeFeaturesNode=function(n,t){t=this.adaptOptions(t);var i=Ss(Zy[4],"kml");i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:gx",Wy[0]),i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",zu),i.setAttributeNS(zu,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var r={};1<n.length?r.Document=n:1==n.length&&(r.Placemark=n[0]);var o=$y[i.namespaceURI],a=Zs(r,o);return nl({node:i},ax,Yu,a,[t],o,this),i},t}(lg),mx=qs(Zy,{Pair:function(a,t){var e=tl({},fE,a,t,this);if(e){var r=e.key;if(r&&"normal"==r){var n=e.styleUrl;n&&(t[t.length-1]=n);var i=e.Style;i&&(t[t.length-1]=i)}}}}),vx=qs(Zy,{Icon:Ys(function(o,t){var e=tl({},WS,o,t);return e||null}),color:Ys(yu),heading:Ys(sg),hotSpot:Ys(function(o){var t=o.getAttribute("xunits"),r=o.getAttribute("yunits"),n;return n="insetPixels"===t?"insetPixels"===r?$l:Jl:"insetPixels"===r?Ql:Hl,{x:parseFloat(o.getAttribute("x")),xunits:Ky[t],y:parseFloat(o.getAttribute("y")),yunits:Ky[r],origin:n}}),scale:Ys(Su)}),tS=qs(Zy,{color:Ys(yu),scale:Ys(Su)}),SS=qs(Zy,{color:Ys(yu),width:Ys(sg)}),ES=qs(Zy,{color:Ys(yu),fill:Ys(og),outline:Ys(og)}),TS=qs(Zy,{coordinates:As(mu)}),CS=qs(Wy,{Track:ws(Ru)}),bS=qs(Zy,{when:function(o,t){var e=t[t.length-1].whens,r=Es(o,!1),n=Date.parse(r);e.push(isNaN(n)?0:n)}},qs(Wy,{coord:function(l,t){var e=t[t.length-1].flatCoordinates,r=Es(l,!1),n=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(r);if(n){var i=parseFloat(n[1]),o=parseFloat(n[2]),a=parseFloat(n[3]);e.push(i,o,a,0)}else e.push(0,0,0,0)}})),WS=qs(Zy,{href:Ys(xu)},qs(Wy,{x:Ys(sg),y:Ys(sg),w:Ys(sg),h:Ys(sg)})),lE=qs(Zy,{coordinates:As(mu)}),pE=qs(Zy,{extrude:Ys(og),tessellate:Ys(og),altitudeMode:Ys(mg)}),dE=qs(Zy,{LineString:ws(Iu),LinearRing:ws(vu),MultiGeometry:ws(bu),Point:ws(Fu),Polygon:ws(Ou)}),_E=qs(Zy,{innerBoundaryIs:function(o,t){var e=tl(void 0,IE,o,t);e&&t[t.length-1].push(e)},outerBoundaryIs:function(o,t){var e=tl(void 0,FE,o,t);e&&(t[t.length-1][0]=e)}}),gE=qs(Zy,{IconStyle:function(T,t){var e=tl({},vx,T,t);if(e){var r=t[t.length-1],s="Icon"in e?e.Icon:{},u=!("Icon"in e)||0<Object.keys(s).length,l=s.href,h,C,P,R;l?h=l:u&&(h=KE);var L=Hl,I=e.hotSpot,f;I?(C=[I.x,I.y],P=I.xunits,R=I.yunits,L=I.origin):h===KE?(C=VE,P=XE,R=WE):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(h)&&(C=[.5,0],P=zl,R=zl);var b=s.x,_=s.y,g;void 0!==b&&void 0!==_&&(f=[b,_]);var F=s.w,v=s.h,m;void 0!==F&&void 0!==v&&(g=[F,v]);var O=e.heading;void 0!==O&&(m=de(O));var x=e.scale,M=e.color;if(u){h==KE&&(g=ZE,void 0===x&&(x=HE));var S=new eh({anchor:C,anchorOrigin:L,anchorXUnits:P,anchorYUnits:R,crossOrigin:this.crossOrigin_,offset:f,offsetOrigin:Hl,rotation:m,scale:x,size:g,src:h,color:M});r.imageStyle=S}else r.imageStyle=qE}},LabelStyle:function(o,t){var e=tl({},tS,o,t);if(e){var r=t[t.length-1],n=new lh({fill:new Ul({color:"color"in e?e.color:zm}),scale:e.scale});r.textStyle=n}},LineStyle:function(o,t){var e=tl({},SS,o,t);if(e){var r=t[t.length-1],n=new rh({color:"color"in e?e.color:zm,width:"width"in e?e.width:1});r.strokeStyle=n}},PolyStyle:function(s,t){var e=tl({},ES,s,t);if(e){var r=t[t.length-1],n=new Ul({color:"color"in e?e.color:zm});r.fillStyle=n;var i=e.fill;void 0!==i&&(r.fill=i);var o=e.outline;void 0!==o&&(r.outline=o)}}}),uE=qs(Zy,{displayName:Ys(mg),value:Ys(mg)}),mE=qs(Zy,{Data:function(o,t){var e=o.getAttribute("name");el(uE,o,t);var r=t[t.length-1];e&&r.displayName?r[e]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:null===e?null!==r.displayName&&(r[r.displayName]=r.value):r[e]=r.value,delete r.value},SchemaData:function(o,t){el(EE,o,t)}}),fE=qs(Zy,{Style:Ys(Nu),key:Ys(mg),styleUrl:Ys(xu)}),EE=qs(Zy,{SimpleData:function(o,t){var e=o.getAttribute("name");if(null!==e){var r=mg(o);t[t.length-1][e]=r}}}),PE=qs(Zy,{altitudeMode:Ys(mg),minAltitude:Ys(sg),maxAltitude:Ys(sg),north:Ys(sg),south:Ys(sg),east:Ys(sg),west:Ys(sg)}),RE=qs(Zy,{minLodPixels:Ys(sg),maxLodPixels:Ys(sg),minFadeExtent:Ys(sg),maxFadeExtent:Ys(sg)}),IE=qs(Zy,{LinearRing:As(Tu)}),FE=qs(Zy,{LinearRing:As(Tu)}),jE=qs(Zy,{Data:Vs(function(o,t,e){o.setAttribute("name",t.name);var r={node:o},n=t.value;"object"==typeof n?(null!==n&&n.displayName&&nl(r,jE,Yu,[n.displayName],e,["displayName"]),null!==n&&n.value&&nl(r,jE,Yu,[n.value],e,["value"])):nl(r,jE,Yu,[n],e,["value"])}),value:Vs(function(o,t){Eg(o,t)}),displayName:Vs(function(o,t){!function(o,t){o.appendChild(il().createCDATASection(t))}(o,t)})}),BE=qs(Zy,{Placemark:Vs(Xu)}),YE=function(o,t){return Ss(t[t.length-1].node.namespaceURI,"Placemark")},tm=Ws("Data"),em=qs(Zy,["href"],qs(Wy,["x","y","w","h"])),rm=qs(Zy,{href:Vs(Eg)},qs(Wy,{x:Vs(xg),y:Vs(xg),w:Vs(xg),h:Vs(xg)})),nm=function(o,t,e){return Ss(Wy[0],"gx:"+e)},im=qs(Zy,["scale","heading","Icon","color","hotSpot"]),om=qs(Zy,{Icon:Vs(function(s,t,e){var r={node:s},n=e[e.length-1].node,i=em[n.namespaceURI],l=Zs(t,i);nl(r,rm,Yu,l,e,i),l=Zs(t,i=em[Wy[0]]),nl(r,rm,nm,l,e,i)}),color:Vs(ju),heading:Vs(xg),hotSpot:Vs(function(o,t){o.setAttribute("x",t.x+""),o.setAttribute("y",t.y+""),o.setAttribute("xunits",t.xunits),o.setAttribute("yunits",t.yunits)}),scale:Vs(Ku)}),am=qs(Zy,["color","scale"]),sm=qs(Zy,{color:Vs(ju),scale:Vs(Ku)}),um=qs(Zy,["color","width"]),lm=qs(Zy,{color:Vs(ju),width:Vs(xg)}),hm={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},cm=function(o,t){if(o)return Ss(t[t.length-1].node.namespaceURI,hm[o.getType()])},pm=Ws("Point"),fm=Ws("LineString"),dm=Ws("LinearRing"),_m=Ws("Polygon"),gm=qs(Zy,{LineString:Vs(Wu),Point:Vs(Wu),Polygon:Vs(Zu),GeometryCollection:Vs(Bu)}),ym=qs(Zy,{LinearRing:Vs(Wu)}),mm=qs(Zy,{ExtendedData:Vs(function(l,t,e){for(var r={node:l},n=t.names,i=t.values,o=n.length,a=0;a<o;a++)nl(r,jE,tm,[{name:n[a],value:i[a]}],e)}),MultiGeometry:Vs(Bu),LineString:Vs(Wu),LinearRing:Vs(Wu),Point:Vs(Wu),Polygon:Vs(Zu),Style:Vs(function(n,t,e){var r={};if(t.pointStyles.length){var i=t.pointStyles[0].getText();i&&(r.LabelStyle=i);var o=t.pointStyles[0].getImage();o&&"function"==typeof o.getSrc&&(r.IconStyle=o)}if(t.lineStyles.length&&(a=t.lineStyles[0].getStroke())&&(r.LineStyle=a),t.polyStyles.length){var a;(a=t.polyStyles[0].getStroke())&&!r.LineStyle&&(r.LineStyle=a),r.PolyStyle=t.polyStyles[0]}var p=e[e.length-1].node,d=Mm[p.namespaceURI],l=Zs(r,d);nl({node:n},Nm,Yu,l,e,d)}),address:Vs(Eg),description:Vs(Eg),name:Vs(Eg),open:Vs(fg),phoneNumber:Vs(Eg),styleUrl:Vs(Eg),visibility:Vs(fg)}),wm=qs(Zy,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),Sm=Ws("ExtendedData"),Em=qs(Zy,["extrude","tessellate","altitudeMode","coordinates"]),Cm=qs(Zy,{extrude:Vs(fg),tessellate:Vs(fg),altitudeMode:Vs(Eg),coordinates:Vs(function(p,t,e){var r=e[e.length-1],i=r.layout,o=r.stride,a;i==lt||i==ne?a=2:i==re||i==ie?a=3:O(!1,34);var d=t.length,s="";if(0<d){s+=t[0];for(var _=1;_<a;++_)s+=","+t[_];for(var g=o;g<d;g+=o)for(s+=" "+t[g],_=1;_<a;++_)s+=","+t[g+_]}Eg(p,s)})}),bm=qs(Zy,["color","fill","outline"]),Rm=qs(Zy,{outerBoundaryIs:Vs(Vu),innerBoundaryIs:Vs(Vu)}),Om=Ws("innerBoundaryIs"),Im=Ws("outerBoundaryIs"),Lm=qs(Zy,{color:Vs(ju),fill:Vs(fg),outline:Vs(fg)}),Mm=qs(Zy,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Nm=qs(Zy,{IconStyle:Vs(function(n,t,e){var r={},i=t.getSrc(),o=t.getSize(),a=t.getImageSize(),s={href:i};if(o){s.w=o[0],s.h=o[1];var u=t.getAnchor(),l=t.getOrigin();if(l&&a&&0!==l[0]&&l[1]!==o[1]&&(s.x=l[0],s.y=a[1]-(l[1]+o[1])),u&&(u[0]!==o[0]/2||u[1]!==o[1]/2)){var m={x:u[0],xunits:Bl,y:o[1]-u[1],yunits:Bl};r.hotSpot=m}}r.Icon=s;var c=t.getScale();1!==c&&(r.scale=c);var p=t.getRotation();0!==p&&(r.heading=p);var h=t.getColor();h&&(r.color=h);var d=e[e.length-1].node,_=im[d.namespaceURI],g=Zs(r,_);nl({node:n},om,Yu,g,e,_)}),LabelStyle:Vs(function(n,t,e){var r={},i=t.getFill();i&&(r.color=i.getColor());var o=t.getScale();o&&1!==o&&(r.scale=o);var a=e[e.length-1].node,s=am[a.namespaceURI],p=Zs(r,s);nl({node:n},sm,Yu,p,e,s)}),LineStyle:Vs(function(n,t,e){var r={color:t.getColor(),width:+t.getWidth()||1},i=e[e.length-1].node,o=um[i.namespaceURI],a=Zs(r,o);nl({node:n},lm,Yu,a,e,o)}),PolyStyle:Vs(function(n,t,e){var r=t.getFill(),i=t.getStroke(),o={color:r?r.getColor():void 0,fill:!!r&&void 0,outline:!!i&&void 0},a=e[e.length-1].node,s=bm[a.namespaceURI],p=Zs(o,s);nl({node:n},Lm,Yu,p,e,s)})}),Gm=e(2),Dm=e.n(Gm),km=[1,0,0,1,0,0],Um=function(){function e(o,t,e,r,n){this.extent_,this.id_=n,this.type_=o,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=e,this.properties_=r}return e.prototype.get=function(e){return this.properties_[e]},e.prototype.getExtent=function(){return this.extent_||(this.extent_=this.type_===oe.POINT?ht(this.flatCoordinates_):ft(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_},e.prototype.getFlatInteriorPoint=function(){if(!this.flatInteriorPoints_){var e=vt(this.getExtent());this.flatInteriorPoints_=Nr(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_},e.prototype.getFlatInteriorPoints=function(){if(!this.flatInteriorPoints_){var e=Yd(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=Ar(this.flatCoordinates_,0,this.ends_,2,e)}return this.flatInteriorPoints_},e.prototype.getFlatMidpoint=function(){return this.flatMidpoints_||(this.flatMidpoints_=ad(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_},e.prototype.getFlatMidpoints=function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var s=this.flatCoordinates_,t=0,l=this.ends_,r=0,p=l.length;r<p;++r){var i=l[r],o=ad(s,t,i,2,.5);v(this.flatMidpoints_,o),t=i}}return this.flatMidpoints_},e.prototype.getId=function(){return this.id_},e.prototype.getOrientedFlatCoordinates=function(){return this.flatCoordinates_},e.prototype.getGeometry=function(){return this},e.prototype.getSimplifiedGeometry=function(){return this},e.prototype.simplifyTransformed=function(){return this},e.prototype.getProperties=function(){return this.properties_},e.prototype.getStride=function(){return 2},e.prototype.getStyleFunction=function(){},e.prototype.getType=function(){return this.type_},e.prototype.transform=function(e){var o=(e=Ve(e)).getExtent(),r=e.getWorldExtent(),n=Ot(r)/Ot(o);$t(km,r[0],r[3],n,-n,0,0,0),jt(this.flatCoordinates_,0,this.flatCoordinates_.length,2,km,this.flatCoordinates_)},e}(),zm,VE,XE,WE,ZE,KE,HE,qE,JE,QE;Um.prototype.getEnds=function(){return this.ends_},Um.prototype.getEndss=Um.prototype.getEnds,Um.prototype.getFlatCoordinates=Um.prototype.getOrientedFlatCoordinates;var $E=Um,Bm=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ym=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.dataProjection=new Te({code:"",units:bh.TILE_PIXELS}),e.featureClass_=r.featureClass?r.featureClass:$E,e.geometryName_=r.geometryName,e.layerName_=r.layerName?r.layerName:"layer",e.layers_=r.layers?r.layers:null,e.idProperty_=r.idProperty,e}return Bm(t,o),t.prototype.readRawGeometry_=function(p,t,e,r){p.pos=t.geometry;for(var n=p.readVarint()+p.pos,i=1,d=0,_=0,g=0,y=0,m=0;p.pos<n;){if(!d){var f=p.readVarint();i=7&f,d=f>>3}d--,1==i||2===i?(_+=p.readSVarint(),g+=p.readSVarint(),1===i&&y>m&&(r.push(y),m=y),e.push(_,g),y+=2):7===i?y>m&&(e.push(e[m],e[m+1]),y+=2):O(!1,59)}y>m&&(r.push(y),m=y)},t.prototype.createFeature_=function(m,t,e){var r=t.type,i;if(0===r)return null;var x=t.properties,a;this.idProperty_?(a=x[this.idProperty_],delete x[this.idProperty_]):a=t.id,x[this.layerName_]=t.layer.name;var S=[],s=[];this.readRawGeometry_(m,t,S,s);var u=function(o,t){var e;return 1===o?e=1===t?oe.POINT:oe.MULTI_POINT:2===o?e=1===t?oe.LINE_STRING:oe.MULTI_LINE_STRING:3==o&&(e=oe.POLYGON),e}(r,s.length);if(this.featureClass_===$E)(i=new this.featureClass_(u,S,s,x,a)).transform(e.dataProjection,e.featureProjection);else{var l;if(u==oe.POLYGON){for(var E=[],c=0,T=0,C=0,P=s.length,_;C<P;++C)_=s[C],zr(S,c,_,2)||(E.push(s.slice(T,C)),T=C),c=_;l=1<E.length?new e_(S,lt,E):new hn(S,lt,s)}else l=u===oe.POINT?new Zr(S,lt):u===oe.LINE_STRING?new Sd(S,lt):u===oe.POLYGON?new hn(S,lt,s):u===oe.MULTI_POINT?new Qd(S,lt):u===oe.MULTI_LINE_STRING?new Hd(S,lt,s):null;i=new(0,this.featureClass_),this.geometryName_&&i.setGeometryName(this.geometryName_);var R=j_(l,!1,e);i.setGeometry(R),i.setId(a),i.setProperties(x,!0)}return i},t.prototype.getType=function(){return"arraybuffer"},t.prototype.readFeatures=function(d,t){var e=this.layers_,r=this.adaptOptions(t),n=Ve(r.dataProjection);n.setWorldExtent(r.extent),r.dataProjection=n;var i=new Dm.a(d),o=i.readFields(Hu,{}),a=[];for(var s in o)if(!e||-1!=e.indexOf(s)){var _=o[s],l=_?[0,0,_.extent,_.extent]:null;n.setExtent(l);for(var g=0,u=_.length,p;g<u;++g)p=Qu(i,_,g),a.push(this.createFeature_(i,p,r))}return a},t.prototype.readProjection=function(){return this.dataProjection},t.prototype.setLayers=function(e){this.layers_=e},t}(K_),Km=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qm=[null],Hm=qs(qm,{nd:function(o,t){t[t.length-1].ndrefs.push(o.getAttribute("ref"))},tag:$u}),Jm=qs(qm,{node:function(l,t){var e=t[0],r=t[t.length-1],n=l.getAttribute("id"),i=[parseFloat(l.getAttribute("lon")),parseFloat(l.getAttribute("lat"))];r.nodes[n]=i;var o=tl({tags:{}},$m,l,t);if(!f(o.tags)){var a=new Zr(i);j_(a,!1,e);var s=new ut(a);s.setId(n),s.setProperties(o.tags,!0),r.features.push(s)}},way:function(o,t){var e=tl({id:o.getAttribute("id"),ndrefs:[],tags:{}},Hm,o,t);t[t.length-1].ways.push(e)}}),Qm=function(o){function t(){var t=o.call(this)||this;return t.dataProjection=Ve("EPSG:4326"),t}return Km(t,o),t.prototype.readFeaturesFromNode=function(p,t){var e=this.getReadOptions(p,t);if("osm"==p.localName){for(var r=tl({nodes:{},ways:[],features:[]},Jm,p,[e]),n=0;n<r.ways.length;n++){for(var d=r.ways[n],o=[],a=0,_=d.ndrefs.length;a<_;a++)v(o,r.nodes[d.ndrefs[a]]);var g=void 0;j_(g=d.ndrefs[0]==d.ndrefs[d.ndrefs.length-1]?new hn(o,lt,[o.length]):new Sd(o,lt),!1,e);var u=new ut(g);u.setId(d.id),u.setProperties(d.tags,!0),r.features.push(u)}if(r.features)return r.features}return[]},t}(lg),$m=qs(qm,{tag:$u}),tx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ix=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.dataProjection=Ve("EPSG:4326"),e.factor_=r.factor?r.factor:1e5,e.geometryLayout_=r.geometryLayout?r.geometryLayout:lt,e}return tx(t,o),t.prototype.readFeatureFromText=function(o,t){var e=this.readGeometryFromText(o,t);return new ut(e)},t.prototype.readFeaturesFromText=function(o,t){return[this.readFeatureFromText(o,t)]},t.prototype.readGeometryFromText=function(o,t){var e=rr(this.geometryLayout_),r=Sc(o,e,this.factor_);fc(r,0,r.length,e,r);var n=fr(r,0,r.length,e);return j_(new Sd(n,this.geometryLayout_),!1,this.adaptOptions(t))},t.prototype.writeFeatureText=function(o,t){var e=o.getGeometry();return e?this.writeGeometryText(e,t):(O(!1,40),"")},t.prototype.writeFeaturesText=function(o,t){return this.writeFeatureText(o[0],t)},t.prototype.writeGeometryText=function(o,i){var e=(o=j_(o,!0,this.adaptOptions(i))).getFlatCoordinates(),r=o.getStride();return fc(e,0,e.length,r,e),xc(e,r,this.factor_)},t}(Py),hx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),cx=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.layerName_=r.layerName,e.layers_=r.layers?r.layers:null,e.dataProjection=Ve(r.dataProjection?r.dataProjection:"EPSG:4326"),e}return hx(t,o),t.prototype.readFeaturesFromObject=function(p,t){if("Topology"==p.type){var e=p,r=null,d=null,_;e.transform&&(r=(_=e.transform).scale,d=_.translate);var g=e.arcs;_&&function(o,t,e){for(var r=0,a=o.length;r<a;++r)py(o[r],t,e)}(g,r,d);var a=[],s=e.objects,u=this.layerName_,l;for(var y in s)this.layers_&&-1==this.layers_.indexOf(y)||("GeometryCollection"===s[y].type?(l=s[y],a.push.apply(a,Nc(l,g,r,d,u,y,t))):(l=s[y],a.push(jc(l,g,r,d,u,y,t))));return a}return[]},t.prototype.readProjectionFromObject=function(){return this.dataProjection},t}(Q_),px={Point:function(o,t,e){var r=o.coordinates;return t&&e&&dy(r,t,e),new Zr(r)},LineString:function(o,t){var e=Mc(o.arcs,t);return new Sd(e)},Polygon:function(o,t){for(var e=[],r=0,a=o.arcs.length;r<a;++r)e[r]=Mc(o.arcs[r],t);return new hn(e)},MultiPoint:function(a,t,e){var r=a.coordinates;if(t&&e)for(var n=0,s=r.length;n<s;++n)dy(r[n],t,e);return new Qd(r)},MultiLineString:function(o,t){for(var e=[],r=0,a=o.arcs.length;r<a;++r)e[r]=Mc(o.arcs[r],t);return new Hd(e)},MultiPolygon:function(l,t){for(var e=[],r=0,p=l.arcs.length;r<p;++r){for(var i=l.arcs[r],o=[],a=0,d=i.length;a<d;++a)o[a]=Mc(i[a],t);e[r]=o}return new e_(e)}},fx=function(){function e(e){this.tagName_=e}return e.prototype.getTagName=function(){return this.tagName_},e}(),xx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wx=function(o){function t(t,e){var r=o.call(this,t)||this;return r.conditions=e,O(2<=r.conditions.length,57),r}return xx(t,o),t}(fx),Sx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ex=function(o){function t(){return o.call(this,"And",Array.prototype.slice.call(arguments))||this}return Sx(t,o),t}(wx),Tx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Cx=function(o){function t(t,e,r){var n=o.call(this,"BBOX")||this;if(n.geometryName=t,n.extent=e,4!==e.length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return n.srsName=r,n}return Tx(t,o),t}(fx),bx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Px=function(a){function t(t,e,r,n){var i=a.call(this,t)||this;return i.geometryName=e||"the_geom",i.geometry=r,i.srsName=n,i}return bx(t,a),t}(fx),Rx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ox=function(o){function t(t,e,r){return o.call(this,"Contains",t,e,r)||this}return Rx(t,o),t}(Px),Ix=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Lx=function(o){function t(t,e){var r=o.call(this,t)||this;return r.propertyName=e,r}return Ix(t,o),t}(fx),Fx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Mx=function(o){function t(t,e,r){var n=o.call(this,"During",t)||this;return n.begin=e,n.end=r,n}return Fx(t,o),t}(Lx),Ax=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nx=function(a){function t(t,e,r,n){var i=a.call(this,t,e)||this;return i.expression=r,i.matchCase=n,i}return Ax(t,a),t}(Lx),Gx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jx=function(o){function t(t,e,r){return o.call(this,"PropertyIsEqualTo",t,e,r)||this}return Gx(t,o),t}(Nx),Dx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kx=function(o){function t(t,e){return o.call(this,"PropertyIsGreaterThan",t,e)||this}return Dx(t,o),t}(Nx),Ux=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),zx=function(o){function t(t,e){return o.call(this,"PropertyIsGreaterThanOrEqualTo",t,e)||this}return Ux(t,o),t}(Nx),Bx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Yx=function(o){function t(t,e,r){return o.call(this,"Intersects",t,e,r)||this}return Bx(t,o),t}(Px),Vx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xx=function(o){function t(t,e,r){var n=o.call(this,"PropertyIsBetween",t)||this;return n.lowerBoundary=e,n.upperBoundary=r,n}return Vx(t,o),t}(Lx),Wx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zx=function(l){function t(t,e,r,n,i,o){var a=l.call(this,"PropertyIsLike",t)||this;return a.pattern=e,a.wildCard=void 0===r?"*":r,a.singleChar=void 0===n?".":n,a.escapeChar=void 0===i?"!":i,a.matchCase=o,a}return Wx(t,l),t}(Lx),Kx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qx=function(o){function t(t){return o.call(this,"PropertyIsNull",t)||this}return Kx(t,o),t}(Lx),Hx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jx=function(o){function t(t,e){return o.call(this,"PropertyIsLessThan",t,e)||this}return Hx(t,o),t}(Nx),Qx=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),$x=function(o){function t(t,e){return o.call(this,"PropertyIsLessThanOrEqualTo",t,e)||this}return Qx(t,o),t}(Nx),eT=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),tT=function(o){function t(t){var e=o.call(this,"Not")||this;return e.condition=t,e}return eT(t,o),t}(fx),oT=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),rT=function(o){function t(t,e,r){return o.call(this,"PropertyIsNotEqualTo",t,e,r)||this}return oT(t,o),t}(Nx),nT=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),iT=function(o){function t(){return o.call(this,"Or",Array.prototype.slice.call(arguments))||this}return nT(t,o),t}(wx),aT=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),sT=function(o){function t(t,e,r){return o.call(this,"Within",t,e,r)||this}return aT(t,o),t}(Px),lT=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),pT={"http://www.opengis.net/gml":{boundedBy:Ys(dg.prototype.readGeometryElement,"bounds")}},dT={"http://www.opengis.net/wfs":{totalInserted:Ys(gg),totalUpdated:Ys(gg),totalDeleted:Ys(gg)}},_T={"http://www.opengis.net/wfs":{TransactionSummary:Ys(function(o,t){return tl({},dT,o,t)},"transactionSummary"),InsertResults:Ys(function(o,t){return tl([],ST,o,t)},"insertIds")}},gT={"http://www.opengis.net/wfs":{PropertyName:Vs(Eg)}},uT={"http://www.opengis.net/wfs":{Insert:Vs(function(l,t,e){var r=e[e.length-1],n=r.featureType,i=r.featureNS,o=r.gmlVersion,a=Ss(i,n);l.appendChild(a),2===o?Gg.prototype.writeFeatureElement(a,t,e):Ig.prototype.writeFeatureElement(a,t,e)}),Update:Vs(function(g,t,e){var r=e[e.length-1];O(void 0!==t.getId(),27);var n=r.featureType,i=r.featurePrefix,o=r.featureNS,a=my(i,n),s=t.getGeometryName();g.setAttribute("typeName",a),g.setAttributeNS(cT,"xmlns:"+i,o);var u=t.getId();if(void 0!==u){for(var l=t.getKeys(),y=[],c=0,m=l.length,h;c<m;c++)if(h=t.get(l[c]),void 0!==h){var f=l[c];h&&"function"==typeof h.getSimplifiedGeometry&&(f=s),y.push({name:f,value:h})}nl({gmlVersion:r.gmlVersion,node:g,hasZ:r.hasZ,srsName:r.srsName},uT,Ws("Property"),y,e),yy(g,u,e)}}),Delete:Vs(function(l,t,e){var r=e[e.length-1];O(void 0!==t.getId(),26);var n=r.featureType,i=r.featurePrefix,o=r.featureNS,a=my(i,n);l.setAttribute("typeName",a),l.setAttributeNS(cT,"xmlns:"+i,o);var s=t.getId();void 0!==s&&yy(l,s,e)}),Property:Vs(function(a,t,e){var r=Ss(mT,"Name"),n=e[e.length-1].gmlVersion;if(a.appendChild(r),Eg(r,t.name),void 0!==t.value&&null!==t.value){var i=Ss(mT,"Value");a.appendChild(i),t.value&&"function"==typeof t.value.getSimplifiedGeometry?2===n?Gg.prototype.writeGeometryElement(i,t.value,e):Ig.prototype.writeGeometryElement(i,t.value,e):Eg(i,t.value)}}),Native:Vs(function(o,t){t.vendorId&&o.setAttribute("vendorId",t.vendorId),void 0!==t.safeToIgnore&&o.setAttribute("safeToIgnore",t.safeToIgnore+""),void 0!==t.value&&Eg(o,t.value)})}},cT="http://www.w3.org/2000/xmlns/",yT="http://www.opengis.net/ogc",mT="http://www.opengis.net/wfs",hT={"1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},fT=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.featureType_=r.featureType,e.featureNS_=r.featureNS,e.gmlFormat_=r.gmlFormat?r.gmlFormat:new Ig,e.schemaLocation_=r.schemaLocation?r.schemaLocation:hT["1.1.0"],e}return lT(t,o),t.prototype.getFeatureType=function(){return this.featureType_},t.prototype.setFeatureType=function(e){this.featureType_=e},t.prototype.readFeaturesFromNode=function(o,t){var e={node:o};yh(e,{featureType:this.featureType_,featureNS:this.featureNS_}),yh(e,this.getReadOptions(o,t||{}));this.gmlFormat_.FEATURE_COLLECTION_PARSERS["http://www.opengis.net/gml"].featureMember=ws(dg.prototype.readFeaturesInternal);var r=tl([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,o,[e],this.gmlFormat_);return r||(r=[]),r},t.prototype.readTransactionResponse=function(o){if(o){if("string"==typeof o){var t=Cs(o);return this.readTransactionResponseFromDocument(t)}return Ts(o)?this.readTransactionResponseFromDocument(o):this.readTransactionResponseFromNode(o)}},t.prototype.readFeatureCollectionMetadata=function(o){if(o){if("string"==typeof o){var t=Cs(o);return this.readFeatureCollectionMetadataFromDocument(t)}return Ts(o)?this.readFeatureCollectionMetadataFromDocument(o):this.readFeatureCollectionMetadataFromNode(o)}},t.prototype.readFeatureCollectionMetadataFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)},t.prototype.readFeatureCollectionMetadataFromNode=function(o){var t={},e=yg(o.getAttribute("numberOfFeatures"));return t.numberOfFeatures=e,tl(t,pT,o,[],this.gmlFormat_)},t.prototype.readTransactionResponseFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)},t.prototype.readTransactionResponseFromNode=function(e){return tl({},_T,e,[])},t.prototype.writeGetFeature=function(o){var t=Ss(mT,"GetFeature"),r;if(t.setAttribute("service","WFS"),t.setAttribute("version","1.1.0"),o&&(o.handle&&t.setAttribute("handle",o.handle),o.outputFormat&&t.setAttribute("outputFormat",o.outputFormat),void 0!==o.maxFeatures&&t.setAttribute("maxFeatures",o.maxFeatures+""),o.resultType&&t.setAttribute("resultType",o.resultType),void 0!==o.startIndex&&t.setAttribute("startIndex",o.startIndex+""),void 0!==o.count&&t.setAttribute("count",o.count+""),void 0!==o.viewParams&&t.setAttribute("viewParams",o.viewParams),r=o.filter,o.bbox)){O(o.geometryName,12);var a=gy(o.geometryName,o.bbox,o.srsName);r=r?_y(r,a):a}t.setAttributeNS(zu,"xsi:schemaLocation",this.schemaLocation_);var n={node:t};return yh(n,{srsName:o.srsName,featureNS:o.featureNS?o.featureNS:this.featureNS_,featurePrefix:o.featurePrefix,geometryName:o.geometryName,filter:r,propertyNames:o.propertyNames?o.propertyNames:[]}),O(Array.isArray(o.featureTypes),11),function(o,t,e){var r=e[e.length-1],n=yh({},r);n.node=o,nl(n,ET,Ws("Query"),t,e)}(t,o.featureTypes,[n]),t},t.prototype.writeTransaction=function(p,t,e,r){var n=[],a=Ss(mT,"Transaction"),s=r.version?r.version:"1.1.0",d="1.0.0"===s?2:3,l,_;a.setAttribute("service","WFS"),a.setAttribute("version",s),r&&(l=r.gmlOptions?r.gmlOptions:{},r.handle&&a.setAttribute("handle",r.handle));var g=hT[s];a.setAttributeNS(zu,"xsi:schemaLocation",g);var u=r.featurePrefix?r.featurePrefix:"feature";return p&&(_=yh({node:a},{featureNS:r.featureNS,featureType:r.featureType,featurePrefix:u,gmlVersion:d,hasZ:r.hasZ,srsName:r.srsName}),yh(_,l),nl(_,uT,Ws("Insert"),p,n)),t&&(_=yh({node:a},{featureNS:r.featureNS,featureType:r.featureType,featurePrefix:u,gmlVersion:d,hasZ:r.hasZ,srsName:r.srsName}),yh(_,l),nl(_,uT,Ws("Update"),t,n)),e&&nl({node:a,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:u,gmlVersion:d,srsName:r.srsName},uT,Ws("Delete"),e,n),r.nativeElements&&nl({node:a,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:u,gmlVersion:d,srsName:r.srsName},uT,Ws("Native"),r.nativeElements,n),a},t.prototype.readProjectionFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null},t.prototype.readProjectionFromNode=function(o){if(o.firstElementChild&&o.firstElementChild.firstElementChild)for(var n=(o=o.firstElementChild.firstElementChild).firstElementChild;n;n=n.nextElementSibling)if(0!==n.childNodes.length&&(1!==n.childNodes.length||3!==n.firstChild.nodeType)){var i=[{}];return this.gmlFormat_.readGeometryElement(n,i),Ve(i.pop().srsName)}return null},t}(lg),xT={"http://www.opengis.net/ogc":{FeatureId:ws(function(e){return e.getAttribute("fid")})}},ST={"http://www.opengis.net/wfs":{Feature:function(o,t){el(xT,o,t)}}},ET={"http://www.opengis.net/wfs":{Query:Vs(function(p,t,e){var r=e[e.length-1],i=r.featurePrefix,o=r.featureNS,a=r.propertyNames,s=r.srsName,d;d=i?my(i,t):t,p.setAttribute("typeName",d),s&&p.setAttribute("srsName",s),o&&p.setAttributeNS(cT,"xmlns:"+i,o);var _=yh({},r);_.node=p,nl(_,gT,Ws("PropertyName"),a,e);var l=r.filter;if(l){var g=Ss(yT,"Filter");p.appendChild(g),fy(g,l,e)}})},"http://www.opengis.net/ogc":{During:Vs(function(r,t){var e=Ss("http://www.opengis.net/fes","ValueReference");Eg(e,t.propertyName),r.appendChild(e);var n=Ss("http://www.opengis.net/gml","TimePeriod");r.appendChild(n);var i=Ss("http://www.opengis.net/gml","begin");n.appendChild(i),wy(i,t.begin);var o=Ss("http://www.opengis.net/gml","end");n.appendChild(o),wy(o,t.end)}),And:Vs(xy),Or:Vs(xy),Not:Vs(function(o,t,e){var r=t.condition;nl({node:o},ET,Ws(r.getTagName()),[r],e)}),BBOX:Vs(function(o,t,e){e[e.length-1].srsName=t.srsName,Cy(o,t.geometryName),Ig.prototype.writeGeometryElement(o,t.extent,e)}),Contains:Vs(function(o,t,e){e[e.length-1].srsName=t.srsName,Cy(o,t.geometryName),Ig.prototype.writeGeometryElement(o,t.geometry,e)}),Intersects:Vs(function(o,t,e){e[e.length-1].srsName=t.srsName,Cy(o,t.geometryName),Ig.prototype.writeGeometryElement(o,t.geometry,e)}),Within:Vs(function(o,t,e){e[e.length-1].srsName=t.srsName,Cy(o,t.geometryName),Ig.prototype.writeGeometryElement(o,t.geometry,e)}),PropertyIsEqualTo:Vs(Sy),PropertyIsNotEqualTo:Vs(Sy),PropertyIsLessThan:Vs(Sy),PropertyIsLessThanOrEqualTo:Vs(Sy),PropertyIsGreaterThan:Vs(Sy),PropertyIsGreaterThanOrEqualTo:Vs(Sy),PropertyIsNull:Vs(function(o,t){Cy(o,t.propertyName)}),PropertyIsBetween:Vs(function(o,t){Cy(o,t.propertyName);var e=Ss(yT,"LowerBoundary");o.appendChild(e),Ry(e,""+t.lowerBoundary);var r=Ss(yT,"UpperBoundary");o.appendChild(r),Ry(r,""+t.upperBoundary)}),PropertyIsLike:Vs(function(o,t){o.setAttribute("wildCard",t.wildCard),o.setAttribute("singleChar",t.singleChar),o.setAttribute("escapeChar",t.escapeChar),void 0!==t.matchCase&&o.setAttribute("matchCase",t.matchCase.toString()),Cy(o,t.propertyName),Ry(o,""+t.pattern)})}},TT=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),CT={POINT:Zr,LINESTRING:Sd,POLYGON:hn,MULTIPOINT:Qd,MULTILINESTRING:Hd,MULTIPOLYGON:e_},PT=1,RT=2,wT=3,LT=4,IT=5,vT={};for(var bT in oe)vT[bT]=oe[bT].toUpperCase();var FT=function(){function e(e){this.wkt=e,this.index_=-1}return e.prototype.isAlpha_=function(e){return"a"<=e&&"z">=e||"A"<=e&&"Z">=e},e.prototype.isNumeric_=function(o,t){return"0"<=o&&"9">=o||"."==o&&!(void 0!==t&&t)},e.prototype.isWhiteSpace_=function(e){return" "==e||"\t"==e||"\r"==e||"\n"==e},e.prototype.nextChar_=function(){return this.wkt.charAt(++this.index_)},e.prototype.nextToken=function(){var o=this.nextChar_(),e=this.index_,r=o,i;if("("==o)i=RT;else if(","==o)i=IT;else if(")"==o)i=wT;else if(this.isNumeric_(o)||"-"==o)i=LT,r=this.readNumber_();else if(this.isAlpha_(o))i=PT,r=this.readText_();else{if(this.isWhiteSpace_(o))return this.nextToken();if(""!==o)throw new Error("Unexpected character: "+o);i=6}return{position:e,value:r,type:i}},e.prototype.readNumber_=function(){var o=this.index_,e=!1,i=!1,a;do"."==a?e=!0:"e"!=a&&"E"!=a||(i=!0),a=this.nextChar_();while(this.isNumeric_(a,e)||!i&&("e"==a||"E"==a)||i&&("-"==a||"+"==a));return parseFloat(this.wkt.substring(o,this.index_--))},e.prototype.readText_=function(){var o=this.index_,e;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(o,this.index_--).toUpperCase()},e}(),OT=function(){function e(e){this.lexer_=e,this.token_,this.layout_=lt}return e.prototype.consume_=function(){this.token_=this.lexer_.nextToken()},e.prototype.isTokenType=function(e){return this.token_.type==e},e.prototype.match=function(o){var t=this.isTokenType(o);return t&&this.consume_(),t},e.prototype.parse=function(){return this.consume_(),this.parseGeometry_()},e.prototype.parseGeometryLayout_=function(){var o=lt,n=this.token_;if(this.isTokenType(PT)){var e=n.value;"Z"===e?o=re:"M"===e?o=ne:"ZM"===e&&(o=ie),o!==lt&&this.consume_()}return o},e.prototype.parseGeometryCollectionText_=function(){if(this.match(RT)){var e=[];do e.push(this.parseGeometry_());while(this.match(IT));if(this.match(wT))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},e.prototype.parsePointText_=function(){if(this.match(RT)){var e=this.parsePoint_();if(this.match(wT))return e}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())},e.prototype.parseLineStringText_=function(){if(this.match(RT)){var e=this.parsePointList_();if(this.match(wT))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},e.prototype.parsePolygonText_=function(){if(this.match(RT)){var e=this.parseLineStringTextList_();if(this.match(wT))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},e.prototype.parseMultiPointText_=function(){if(this.match(RT)){var e;if(e=this.token_.type==RT?this.parsePointTextList_():this.parsePointList_(),this.match(wT))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},e.prototype.parseMultiLineStringText_=function(){if(this.match(RT)){var e=this.parseLineStringTextList_();if(this.match(wT))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},e.prototype.parseMultiPolygonText_=function(){if(this.match(RT)){var e=this.parsePolygonTextList_();if(this.match(wT))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())},e.prototype.parsePoint_=function(){for(var o=[],t=this.layout_.length,e=0,i;e<t&&(i=this.token_,!!this.match(LT));++e)o.push(i.value);if(o.length==t)return o;throw new Error(this.formatErrorMessage_())},e.prototype.parsePointList_=function(){for(var e=[this.parsePoint_()];this.match(IT);)e.push(this.parsePoint_());return e},e.prototype.parsePointTextList_=function(){for(var e=[this.parsePointText_()];this.match(IT);)e.push(this.parsePointText_());return e},e.prototype.parseLineStringTextList_=function(){for(var e=[this.parseLineStringText_()];this.match(IT);)e.push(this.parseLineStringText_());return e},e.prototype.parsePolygonTextList_=function(){for(var e=[this.parsePolygonText_()];this.match(IT);)e.push(this.parsePolygonText_());return e},e.prototype.isEmptyGeometry_=function(){var e=this.isTokenType(PT)&&"EMPTY"==this.token_.value;return e&&this.consume_(),e},e.prototype.formatErrorMessage_=function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"},e.prototype.parseGeometry_=function(){var o=this.token_;if(this.match(PT)){var t=o.value;if(this.layout_=this.parseGeometryLayout_(),"GEOMETRYCOLLECTION"==t){var e=this.parseGeometryCollectionText_();return new W_(e)}var r=CT[t];if(!r)throw new Error("Invalid geometry type: "+t);var n;switch(t){case"POINT":n=this.parsePointText_();break;case"LINESTRING":n=this.parseLineStringText_();break;case"POLYGON":n=this.parsePolygonText_();break;case"MULTIPOINT":n=this.parseMultiPointText_();break;case"MULTILINESTRING":n=this.parseMultiLineStringText_();break;case"MULTIPOLYGON":n=this.parseMultiPolygonText_();break;default:throw new Error("Invalid geometry type: "+t);}return n||(n=r===CT.POINT?[NaN,NaN]:[]),new r(n,this.layout_)}throw new Error(this.formatErrorMessage_())},e}(),MT=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.splitCollection_=void 0!==r.splitCollection&&r.splitCollection,e}return TT(t,o),t.prototype.parse_=function(o){var t=new FT(o);return new OT(t).parse()},t.prototype.readFeatureFromText=function(o,t){var e=this.readGeometryFromText(o,t);if(e){var r=new ut;return r.setGeometry(e),r}return null},t.prototype.readFeaturesFromText=function(l,t){for(var e=[],p=this.readGeometryFromText(l,t),n=[],i=0,d=(e=this.splitCollection_&&p.getType()==oe.GEOMETRY_COLLECTION?p.getGeometriesArray():[p]).length,a;i<d;++i)a=new ut,a.setGeometry(e[i]),n.push(a);return n},t.prototype.readGeometryFromText=function(o,t){var e=this.parse_(o);return e?j_(e,!1,t):null},t.prototype.writeFeatureText=function(o,t){var e=o.getGeometry();return e?this.writeGeometryText(e,t):""},t.prototype.writeFeaturesText=function(a,t){if(1==a.length)return this.writeFeatureText(a[0],t);for(var e=[],r=0,s=a.length;r<s;++r)e.push(a[r].getGeometry());var i=new W_(e);return this.writeGeometryText(i,t)},t.prototype.writeGeometryText=function(o,t){return zy(j_(o,!0,t))},t}(Py),NT={Point:vy,LineString:Dy,Polygon:ky,MultiPoint:function(o){for(var t=[],e=o.getPoints(),r=0,a=e.length;r<a;++r)t.push("("+vy(e[r])+")");return t.join(",")},MultiLineString:function(o){for(var t=[],e=o.getLineStrings(),r=0,a=e.length;r<a;++r)t.push("("+Dy(e[r])+")");return t.join(",")},MultiPolygon:function(o){for(var t=[],e=o.getPolygons(),r=0,a=e.length;r<a;++r)t.push("("+ky(e[r])+")");return t.join(",")},GeometryCollection:function(o){for(var t=[],e=o.getGeometries(),r=0,a=e.length;r<a;++r)t.push(zy(e[r]));return t.join(",")}},AT=function(){function e(){}return e.prototype.read=function(o){if(o){if("string"==typeof o){var t=Cs(o);return this.readFromDocument(t)}return Ts(o)?this.readFromDocument(o):this.readFromNode(o)}return null},e.prototype.readFromDocument=function(){},e.prototype.readFromNode=function(){},e}(),eS=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),rS=[null,"http://www.opengis.net/wms"],nS=qs(rS,{Service:Ys(function(o,t){return tl({},aS,o,t)}),Capability:Ys(function(o,t){return tl({},iS,o,t)})}),iS=qs(rS,{Request:Ys(function(o,t){return tl({},dS,o,t)}),Exception:Ys(function(o,t){return tl([],hS,o,t)}),Layer:Ys(function(o,t){return tl({},cS,o,t)})}),oS=function(o){function t(){var t=o.call(this)||this;return t.version=void 0,t}return eS(t,o),t.prototype.readFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},t.prototype.readFromNode=function(o){this.version=o.getAttribute("version").trim();var t=tl({version:this.version},nS,o,[]);return t||null},t}(AT),aS=qs(rS,{Name:Ys(mg),Title:Ys(mg),Abstract:Ys(mg),KeywordList:Ys(Tm),OnlineResource:Ys(By),ContactInformation:Ys(function(o,t){return tl({},sS,o,t)}),Fees:Ys(mg),AccessConstraints:Ys(mg),LayerLimit:Ys(gg),MaxWidth:Ys(gg),MaxHeight:Ys(gg)}),sS=qs(rS,{ContactPersonPrimary:Ys(function(o,t){return tl({},uS,o,t)}),ContactPosition:Ys(mg),ContactAddress:Ys(function(o,t){return tl({},lS,o,t)}),ContactVoiceTelephone:Ys(mg),ContactFacsimileTelephone:Ys(mg),ContactElectronicMailAddress:Ys(mg)}),uS=qs(rS,{ContactPerson:Ys(mg),ContactOrganization:Ys(mg)}),lS=qs(rS,{AddressType:Ys(mg),Address:Ys(mg),City:Ys(mg),StateOrProvince:Ys(mg),PostCode:Ys(mg),Country:Ys(mg)}),hS=qs(rS,{Format:ws(mg)}),cS=qs(rS,{Name:Ys(mg),Title:Ys(mg),Abstract:Ys(mg),KeywordList:Ys(Tm),CRS:Bs(mg),EX_GeographicBoundingBox:Ys(function(s,t){var e=tl({},fS,s,t);if(e){var r=e.westBoundLongitude,n=e.southBoundLatitude,i=e.eastBoundLongitude,o=e.northBoundLatitude;return void 0===r||void 0===n||void 0===i||void 0===o?void 0:[r,n,i,o]}}),BoundingBox:Bs(function(e){var t=[pg(e.getAttribute("minx")),pg(e.getAttribute("miny")),pg(e.getAttribute("maxx")),pg(e.getAttribute("maxy"))],o=[pg(e.getAttribute("resx")),pg(e.getAttribute("resy"))];return{crs:e.getAttribute("CRS"),extent:t,res:o}}),Dimension:Bs(function(e){return{name:e.getAttribute("name"),units:e.getAttribute("units"),unitSymbol:e.getAttribute("unitSymbol"),default:e.getAttribute("default"),multipleValues:ig(e.getAttribute("multipleValues")),nearestValue:ig(e.getAttribute("nearestValue")),current:ig(e.getAttribute("current")),values:mg(e)}}),Attribution:Ys(function(o,t){return tl({},pS,o,t)}),AuthorityURL:Bs(function(o,t){var e=Yy(o,t);return e?(e.name=o.getAttribute("name"),e):void 0}),Identifier:Bs(mg),MetadataURL:Bs(function(o,t){var e=Yy(o,t);return e?(e.type=o.getAttribute("type"),e):void 0}),DataURL:Bs(Yy),FeatureListURL:Bs(Yy),Style:Bs(function(o,t){return tl({},vS,o,t)}),MinScaleDenominator:Ys(sg),MaxScaleDenominator:Ys(sg),Layer:Bs(function(p,t){var d=t[t.length-1],r=tl({},cS,p,t);if(r){var e=ig(p.getAttribute("queryable"));void 0===e&&(e=d.queryable),r.queryable=void 0!==e&&e;var n=yg(p.getAttribute("cascaded"));void 0===n&&(n=d.cascaded),r.cascaded=n;var _=ig(p.getAttribute("opaque"));void 0===_&&(_=d.opaque),r.opaque=void 0!==_&&_;var g=ig(p.getAttribute("noSubsets"));void 0===g&&(g=d.noSubsets),r.noSubsets=void 0!==g&&g;var c=pg(p.getAttribute("fixedWidth"));c||(c=d.fixedWidth),r.fixedWidth=c;var y=pg(p.getAttribute("fixedHeight"));return y||(y=d.fixedHeight),r.fixedHeight=y,["Style","CRS","AuthorityURL"].forEach(function(o){if(o in d){var t=r[o]||[];r[o]=t.concat(d[o])}}),(["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach(function(o){if(!(o in r)){var t=d[o];r[o]=t}}),r)}})}),pS=qs(rS,{Title:Ys(mg),OnlineResource:Ys(By),LogoURL:Ys(xm)}),fS=qs(rS,{westBoundLongitude:Ys(sg),eastBoundLongitude:Ys(sg),southBoundLatitude:Ys(sg),northBoundLatitude:Ys(sg)}),dS=qs(rS,{GetCapabilities:Ys(Vy),GetMap:Ys(Vy),GetFeatureInfo:Ys(Vy)}),_S=qs(rS,{Format:Bs(mg),DCPType:Bs(function(o,t){return tl({},gS,o,t)})}),gS=qs(rS,{HTTP:Ys(function(o,t){return tl({},yS,o,t)})}),yS=qs(rS,{Get:Ys(Yy),Post:Ys(Yy)}),vS=qs(rS,{Name:Ys(mg),Title:Ys(mg),Abstract:Ys(mg),LegendURL:Bs(xm),StyleSheetURL:Ys(Yy),StyleURL:Ys(Yy)}),mS=qs(rS,{Format:Ys(mg),OnlineResource:Ys(By)}),xS=qs(rS,{Keyword:ws(mg)}),wS=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),PS=function(o){function t(t){var e=o.call(this)||this,r=t||{};return e.featureNS_="http://mapserver.gis.umn.edu/mapserver",e.gmlFormat_=new Gg,e.layers_=r.layers?r.layers:null,e}return wS(t,o),t.prototype.getLayers=function(){return this.layers_},t.prototype.setLayers=function(e){this.layers_=e},t.prototype.readFeatures_=function(_,t){_.setAttribute("namespaceURI",this.featureNS_);var e=_.localName,r=[];if(0===_.childNodes.length)return r;if("msGMLOutput"==e)for(var g=0,y=_.childNodes.length,o;g<y;g++)if(o=_.childNodes[g],o.nodeType===Node.ELEMENT_NODE){var m=o,s=t[0],u=m.localName.replace("_layer","");if(!this.layers_||x(this.layers_,u)){var l=u+"_feature";s.featureType=l,s.featureNS=this.featureNS_;var h={};h[l]=ws(this.gmlFormat_.readFeatureElement,this.gmlFormat_);var c=qs([s.featureNS,null],h);m.setAttribute("namespaceURI",this.featureNS_);var p=tl([],c,m,t,this.gmlFormat_);p&&v(r,p)}}if("FeatureCollection"==e){var f=tl([],this.gmlFormat_.FEATURE_COLLECTION_PARSERS,_,[{}],this.gmlFormat_);f&&(r=f)}return r},t.prototype.readFeaturesFromNode=function(o,t){var e={};return t&&yh(e,this.getReadOptions(o,t)),this.readFeatures_(o,[e])},t}(lg),RS=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),OS=[null,"http://www.opengis.net/ows/1.1"],IS=qs(OS,{ServiceIdentification:Ys(function(o,t){return tl({},YS,o,t)}),ServiceProvider:Ys(function(o,t){return tl({},VS,o,t)}),OperationsMetadata:Ys(function(o,t){return tl({},kS,o,t)})}),LS=function(o){function t(){return o.call(this)||this}return RS(t,o),t.prototype.readFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},t.prototype.readFromNode=function(o){var t=tl({},IS,o,[]);return t||null},t}(AT),FS=qs(OS,{DeliveryPoint:Ys(mg),City:Ys(mg),AdministrativeArea:Ys(mg),PostalCode:Ys(mg),Country:Ys(mg),ElectronicMailAddress:Ys(mg)}),MS=qs(OS,{Value:Bs(function(e){return mg(e)})}),AS=qs(OS,{AllowedValues:Ys(function(o,t){return tl({},MS,o,t)})}),NS=qs(OS,{Phone:Ys(function(o,t){return tl({},US,o,t)}),Address:Ys(function(o,t){return tl({},FS,o,t)})}),GS=qs(OS,{HTTP:Ys(function(o,t){return tl({},jS,o,t)})}),jS=qs(OS,{Get:Bs(function(o,t){var e=By(o);return e?tl({href:e},zS,o,t):void 0}),Post:void 0}),DS=qs(OS,{DCP:Ys(function(o,t){return tl({},GS,o,t)})}),kS=qs(OS,{Operation:function(o,t){var e=o.getAttribute("name"),r=tl({},DS,o,t);r&&(t[t.length-1][e]=r)}}),US=qs(OS,{Voice:Ys(mg),Facsimile:Ys(mg)}),zS=qs(OS,{Constraint:Bs(function(o,t){var e=o.getAttribute("name");return e?tl({name:e},AS,o,t):void 0})}),BS=qs(OS,{IndividualName:Ys(mg),PositionName:Ys(mg),ContactInfo:Ys(function(o,t){return tl({},NS,o,t)})}),YS=qs(OS,{Abstract:Ys(mg),AccessConstraints:Ys(mg),Fees:Ys(mg),Title:Ys(mg),ServiceTypeVersion:Ys(mg),ServiceType:Ys(mg)}),VS=qs(OS,{ProviderName:Ys(mg),ProviderSite:Ys(By),ServiceContact:Ys(function(o,t){return tl({},BS,o,t)})}),XS=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ZS=[null,"http://www.opengis.net/wmts/1.0"],KS=[null,"http://www.opengis.net/ows/1.1"],qS=qs(ZS,{Contents:Ys(function(o,t){return tl({},JS,o,t)})}),HS=function(o){function t(){var t=o.call(this)||this;return t.owsParser_=new LS,t}return XS(t,o),t.prototype.readFromDocument=function(o){for(var t=o.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null},t.prototype.readFromNode=function(o){var t=o.getAttribute("version");t&&(t=t.trim());var n=this.owsParser_.readFromNode(o);return n?(n.version=t,(n=tl(n,qS,o,[]))||null):null},t}(AT),JS=qs(ZS,{Layer:Bs(function(o,t){return tl({},QS,o,t)}),TileMatrixSet:Bs(function(o,t){return tl({},oE,o,t)})}),QS=qs(ZS,{Style:Bs(function(o,t){var e=tl({},$S,o,t);if(e){var r="true"===o.getAttribute("isDefault");return e.isDefault=r,e}}),Format:Bs(mg),TileMatrixSetLink:Bs(function(o,t){return tl({},tE,o,t)}),Dimension:Bs(function(o,t){return tl({},nE,o,t)}),ResourceURL:Bs(function(e){var t=e.getAttribute("format"),r=e.getAttribute("template"),n=e.getAttribute("resourceType"),i={};return t&&(i.format=t),r&&(i.template=r),n&&(i.resourceType=n),i})},qs(KS,{Title:Ys(mg),Abstract:Ys(mg),WGS84BoundingBox:Ys(function(o,t){var e=tl([],iE,o,t);return 2==e.length?Y(e):void 0}),Identifier:Ys(mg)})),$S=qs(ZS,{LegendURL:Bs(function(e){var t={};return t.format=e.getAttribute("format"),t.href=By(e),t})},qs(KS,{Title:Ys(mg),Identifier:Ys(mg)})),tE=qs(ZS,{TileMatrixSet:Ys(mg),TileMatrixSetLimits:Ys(function(o,t){return tl([],eE,o,t)})}),eE=qs(ZS,{TileMatrixLimits:ws(function(o,t){return tl({},rE,o,t)})}),rE=qs(ZS,{TileMatrix:Ys(mg),MinTileRow:Ys(gg),MaxTileRow:Ys(gg),MinTileCol:Ys(gg),MaxTileCol:Ys(gg)}),nE=qs(ZS,{Default:Ys(mg),Value:Bs(mg)},qs(KS,{Identifier:Ys(mg)})),iE=qs(KS,{LowerCorner:ws(Pm),UpperCorner:ws(Pm)}),oE=qs(ZS,{WellKnownScaleSet:Ys(mg),TileMatrix:Bs(function(o,t){return tl({},aE,o,t)})},qs(KS,{SupportedCRS:Ys(mg),Identifier:Ys(mg)})),aE=qs(ZS,{TopLeftCorner:Ys(Pm),ScaleDenominator:Ys(sg),TileWidth:Ys(gg),TileHeight:Ys(gg),MatrixWidth:Ys(gg),MatrixHeight:Ys(gg)},qs(KS,{Identifier:Ys(mg)})),sE=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),hE=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],cE=function(l){function t(t){var e=this,p=t||{};(e=l.call(this,{element:document.createElement("div"),target:p.target})||this).cssClassName_=void 0===p.className?"ol-full-screen":p.className;var n=void 0===p.label?"\u2922":p.label;e.labelNode_="string"==typeof n?document.createTextNode(n):n;var i=void 0===p.labelActive?"\xD7":p.labelActive;e.labelActiveNode_="string"==typeof i?document.createTextNode(i):i,e.button_=document.createElement("button");var o=p.tipLabel?p.tipLabel:"Toggle full-screen";e.setClassName_(e.button_,Fm()),e.button_.setAttribute("type","button"),e.button_.title=o,e.button_.appendChild(e.labelNode_),e.button_.addEventListener(j,e.handleClick_.bind(e),!1);var a=e.cssClassName_+" ol-unselectable ol-control "+(vm()?"":"ol-unsupported"),s=e.element;return s.className=a,s.appendChild(e.button_),e.keys_=void 0!==p.keys&&p.keys,e.source_=p.source,e}return sE(t,l),t.prototype.handleClick_=function(e){e.preventDefault(),this.handleFullScreen_()},t.prototype.handleFullScreen_=function(){if(vm()){var o=this.getMap();if(o)if(Fm())document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{var t;t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:o.getTargetElement(),this.keys_?function(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():Am(e)}(t):Am(t)}}},t.prototype.handleFullScreenChange_=function(){var e=this.getMap();Fm()?(this.setClassName_(this.button_,!0),Ni(this.labelActiveNode_,this.labelNode_),this.dispatchEvent("enterfullscreen")):(this.setClassName_(this.button_,!1),Ni(this.labelNode_,this.labelActiveNode_),this.dispatchEvent("leavefullscreen")),e&&e.updateSize()},t.prototype.setClassName_=function(o,t){var e=this.cssClassName_+"-true",r=this.cssClassName_+"-false",n=t?e:r;o.classList.remove(e),o.classList.remove(r),o.classList.add(n)},t.prototype.setMap=function(t){if(l.prototype.setMap.call(this,t),t)for(var e=0,o=hE.length;e<o;++e)this.listenerKeys.push(_(document,hE[e],this.handleFullScreenChange_,this))},t}(Po),yE=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),vE=function(o){function t(t){var e=this,a=t||{},n=document.createElement("div");return n.className=void 0===a.className?"ol-mouse-position":a.className,(e=o.call(this,{element:n,render:a.render||jm,target:a.target})||this).addEventListener(L("projection"),e.handleProjectionChanged_),a.coordinateFormat&&e.setCoordinateFormat(a.coordinateFormat),a.projection&&e.setProjection(a.projection),e.undefinedHTML_=void 0===a.undefinedHTML?"&#160;":a.undefinedHTML,e.renderOnMouseOut_=!!e.undefinedHTML_,e.renderedHTML_=n.innerHTML,e.mapProjection_=null,e.transform_=null,e}return yE(t,o),t.prototype.handleProjectionChanged_=function(){this.transform_=null},t.prototype.getCoordinateFormat=function(){return this.get("coordinateFormat")},t.prototype.getProjection=function(){return this.get("projection")},t.prototype.handleMouseMove=function(o){var t=this.getMap();this.updateHTML_(t.getEventPixel(o))},t.prototype.handleMouseOut=function(){this.updateHTML_(null)},t.prototype.setMap=function(t){if(o.prototype.setMap.call(this,t),t){var e=t.getViewport();this.listenerKeys.push(_(e,Vn,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(_(e,"pointerout",this.handleMouseOut,this))}},t.prototype.setCoordinateFormat=function(e){this.set("coordinateFormat",e)},t.prototype.setProjection=function(e){this.set("projection",Ve(e))},t.prototype.updateHTML_=function(a){var t=this.undefinedHTML_;if(a&&this.mapProjection_){if(!this.transform_){var s=this.getProjection();this.transform_=s?Je(this.mapProjection_,s):ze}var r=this.getMap().getCoordinateFromPixelInternal(a);if(r){var n=Yt();n&&(this.transform_=Je(this.mapProjection_,n)),this.transform_(r,r);var i=this.getCoordinateFormat();t=i?i(r):r.toString()}}this.renderedHTML_&&t===this.renderedHTML_||(this.element.innerHTML=t,this.renderedHTML_=t)},t}(Po),xE=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wE=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return xE(t,o),t.prototype.createRenderer=function(){return new Js(this)},t}(Co),SE=function(m){function t(t){var e=this,x=t||{};(e=m.call(this,{element:document.createElement("div"),render:x.render||Vm,target:x.target})||this).boundHandleRotationChanged_=e.handleRotationChanged_.bind(e),e.collapsed_=void 0===x.collapsed||x.collapsed,e.collapsible_=void 0===x.collapsible||x.collapsible,e.collapsible_||(e.collapsed_=!1),e.rotateWithView_=void 0!==x.rotateWithView&&x.rotateWithView,e.viewExtent_=void 0;var n=void 0===x.className?"ol-overviewmap":x.className,i=void 0===x.tipLabel?"Overview map":x.tipLabel,o=void 0===x.collapseLabel?"\xAB":x.collapseLabel;"string"==typeof o?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=o):e.collapseLabel_=o;var a=void 0===x.label?"\xBB":x.label;"string"==typeof a?(e.label_=document.createElement("span"),e.label_.textContent=a):e.label_=a;var s=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_,u=document.createElement("button");u.setAttribute("type","button"),u.title=i,u.appendChild(s),u.addEventListener(j,e.handleClick_.bind(e),!1),e.ovmapDiv_=document.createElement("div"),e.ovmapDiv_.className="ol-overviewmap-map",e.view_=x.view,e.ovmap_=new wE({view:x.view});var l=e.ovmap_;x.layers&&x.layers.forEach(function(e){l.addLayer(e)});var h=document.createElement("div");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",e.boxOverlay_=new _u({position:[0,0],positioning:nu,element:h}),e.ovmap_.addOverlay(e.boxOverlay_);var c=n+" ol-unselectable ol-control"+(e.collapsed_&&e.collapsible_?" ol-collapsed":"")+(e.collapsible_?"":" ol-uncollapsible"),p=e.element;p.className=c,p.appendChild(e.ovmapDiv_),p.appendChild(u);var f=e,d=e.boxOverlay_,_=e.boxOverlay_.getElement(),g=function(o){var t={clientX:(n=o).clientX,clientY:n.clientY},r=l.getEventCoordinateInternal(t),n;d.setPosition(r)},y=function(o){var t=l.getEventCoordinateInternal(o);f.getMap().getView().setCenterInternal(t),window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",y)};return _.addEventListener("mousedown",function(){window.addEventListener("mousemove",g),window.addEventListener("mouseup",y)}),e}return xE(t,m),t.prototype.setMap=function(t){var e=this.getMap();if(t!==e){if(e){var o=e.getView();o&&this.unbindView_(o),this.ovmap_.setTarget(null)}if(m.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(_(t,h,this.handleMapPropertyChange_,this));var r=t.getView();r&&(this.bindView_(r),r.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},t.prototype.handleMapPropertyChange_=function(o){if(o.key===ri){var t=o.oldValue;t&&this.unbindView_(t);var e=this.getMap().getView();this.bindView_(e)}},t.prototype.bindView_=function(o){if(!this.view_){var t=new Zi({projection:o.getProjection()});this.ovmap_.setView(t)}o.addEventListener(L(Pi),this.boundHandleRotationChanged_),this.handleRotationChanged_()},t.prototype.unbindView_=function(e){e.removeEventListener(L(Pi),this.boundHandleRotationChanged_)},t.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var p=this.getMap(),t=this.ovmap_;if(p.isRendered()&&t.isRendered()){var e=p.getSize(),r=p.getView().calculateExtentInternal(e);if(!this.viewExtent_||!xt(r,this.viewExtent_)){this.viewExtent_=r;var n=t.getSize(),i=t.getView().calculateExtentInternal(n),o=t.getPixelFromCoordinateInternal(Nt(r)),a=t.getPixelFromCoordinateInternal(It(r)),s=P(o[0]-a[0]),d=P(o[1]-a[1]),l=n[0],_=n[1];s<.1*l||d<.1*_||s>.75*l||d>.75*_?this.resetExtent_():dt(i,r)||this.recenter_()}}},t.prototype.resetExtent_=function(){var a=this.getMap(),t=this.ovmap_,e=a.getSize(),r=a.getView().calculateExtentInternal(e),n=t.getView();Ut(r,1/(.1*M(2,2.0149030205422647/o/2))),n.fitInternal(Hr(r))},t.prototype.recenter_=function(){var o=this.getMap(),t=this.ovmap_,e=o.getView();t.getView().setCenterInternal(e.getCenterInternal())},t.prototype.updateBox_=function(){var d=this.getMap(),t=this.ovmap_;if(d.isRendered()&&t.isRendered()){var e=d.getSize(),r=d.getView(),n=t.getView(),i=this.rotateWithView_?0:-r.getRotation(),o=this.boxOverlay_,a=this.boxOverlay_.getElement(),s=r.getCenterInternal(),_=r.getResolution(),l=n.getResolution(),g=e[0]*_/l,u=e[1]*_/l;if(o.setPosition(s),a){a.style.width=g+"px",a.style.height=u+"px";a.style.transform="rotate("+i+"rad)"}}},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Ni(this.collapseLabel_,this.label_):Ni(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;if(!this.collapsed_){if(e.isRendered())return this.viewExtent_=void 0,void e.render();e.updateSize(),this.resetExtent_(),g(e,Hn,function(){this.updateBox_()},this)}},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.setRotateWithView=function(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(Po),TE=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),CE="degrees",bE="metric",OE=[1,2,5],LE=function(o){function t(t){var e=this,a=t||{},n=void 0===a.className?a.bar?"ol-scale-bar":"ol-scale-line":a.className;return(e=o.call(this,{element:document.createElement("div"),render:a.render||Xm,target:a.target})||this).innerElement_=document.createElement("div"),e.innerElement_.className=n+"-inner",e.element.className=n+" ol-unselectable",e.element.appendChild(e.innerElement_),e.viewState_=null,e.minWidth_=void 0===a.minWidth?64:a.minWidth,e.renderedVisible_=!1,e.renderedWidth_=void 0,e.renderedHTML_="",e.addEventListener(L("units"),e.handleUnitsChanged_),e.setUnits(a.units||bE),e.scaleBar_=a.bar||!1,e.scaleBarSteps_=a.steps||4,e.scaleBarText_=a.text||!1,e}return TE(t,o),t.prototype.getUnits=function(){return this.get("units")},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(e){this.set("units",e)},t.prototype.updateElement_=function(){var _=this.viewState_;if(_){var t=_.center,e=_.projection,r=this.getUnits(),n=r==CE?bh.DEGREES:bh.METERS,i=Xe(e,_.resolution,t,n),g=this.minWidth_*i,y="";if(r==CE){var x=Se[bh.DEGREES];(g*=x)<x/60?(y="\u2033",i*=3600):g<x?(y="\u2032",i*=60):y="\xB0"}else r=="imperial"?.9144>g?(y="in",i/=.0254):1609.344>g?(y="ft",i/=.3048):(y="mi",i/=1609.344):r=="nautical"?(i/=1852,y="nm"):r==bE?.001>g?(y="\u03BCm",i*=1e6):1>g?(y="mm",i*=1e3):1e3>g?y="m":(y="km",i/=1e3):r=="us"?.9144>g?(y="in",i*=39.37):1609.344>g?(y="ft",i/=.30480061):(y="mi",i/=1609.3472):O(!1,33);for(var u=3*N(m(this.minWidth_*i)/2.302585092994046),S,E,T,C;;){T=N(u/3);var P=M(10,T);if(S=OE[(u%3+3)%3]*P,E=Zm(S/i),isNaN(E))return this.element.style.display="none",void(this.renderedVisible_=!1);if(E>=this.minWidth_)break;++u}C=this.scaleBar_?this.createScaleBar(E,S,y):S.toFixed(0>T?-T:0)+" "+y,this.renderedHTML_!=C&&(this.innerElement_.innerHTML=C,this.renderedHTML_=C),this.renderedWidth_!=E&&(this.innerElement_.style.width=E+"px",this.renderedWidth_=E),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.createScaleBar=function(l,t,e){for(var r="1 : "+Zm(this.getScaleForResolution()).toLocaleString(),n=[],i=l/this.scaleBarSteps_,o="#ffffff",p=0;p<this.scaleBarSteps_;p++)0==p&&n.push(this.createMarker("absolute",p)),n.push("<div><div class=\"ol-scale-singlebar\" style=\"width: "+i+"px;background-color: "+o+";\"></div>"+this.createMarker("relative",p)+(0==p%2||2===this.scaleBarSteps_?this.createStepText(p,l,!1,t,e):"")+"</div>"),p==this.scaleBarSteps_-1&&n.push(this.createStepText(p+1,l,!0,t,e)),o="#ffffff"==o?"#000000":"#ffffff";return"<div style=\"display: flex;\">"+(this.scaleBarText_?"<div class=\"ol-scale-text\" style=\"width: "+l+"px;\">"+r+"</div>":"")+n.join("")+"</div>"},t.prototype.createMarker=function(e){return"<div class=\"ol-scale-step-marker\" style=\"position: "+e+";top: "+("absolute"===e?3:-10)+"px;\"></div>"},t.prototype.createStepText=function(a,t,e,r,n){var i=(0===a?0:Zm(100*(r/this.scaleBarSteps_*a))/100)+(0===a?"":" "+n);return"<div class=\"ol-scale-step-text\" style=\"margin-left: "+(0===a?-3:-1*(t/this.scaleBarSteps_))+"px;text-align: "+(0===a?"left":"center")+"; min-width: "+(0===a?0:2*(t/this.scaleBarSteps_))+"px;left: "+(e?t+"px":"unset")+";\">"+i+"</div>"},t.prototype.getScaleForResolution=function(){var o=this.getMap().getView().getResolution(),t=this.viewState_.projection.getMetersPerUnit();return 39.37*(parseFloat(o.toString())*t)*(25.4/.28)},t}(Po),ME=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),AE=0,NE=1,GE=function(s){function t(t){var e=this,l=t||{};(e=s.call(this,{element:document.createElement("div"),render:l.render||Wm})||this).dragListenerKeys_=[],e.currentResolution_=void 0,e.direction_=AE,e.dragging_,e.heightLimit_=0,e.widthLimit_=0,e.startX_,e.startY_,e.thumbSize_=null,e.sliderInitialized_=!1,e.duration_=void 0===l.duration?200:l.duration;var n=void 0===l.className?"ol-zoomslider":l.className,i=document.createElement("button");i.setAttribute("type","button"),i.className=n+"-thumb ol-unselectable";var o=e.element;return o.className=n+" ol-unselectable ol-control",o.appendChild(i),o.addEventListener(Xn,e.handleDraggerStart_.bind(e),!1),o.addEventListener(Vn,e.handleDraggerDrag_.bind(e),!1),o.addEventListener(Wn,e.handleDraggerEnd_.bind(e),!1),o.addEventListener(j,e.handleContainerClick_.bind(e),!1),i.addEventListener(j,I,!1),e}return ME(t,s),t.prototype.setMap=function(t){s.prototype.setMap.call(this,t),t&&t.render()},t.prototype.initSlider_=function(){var s=this.element,t=s.offsetWidth,e=s.offsetHeight,r=s.firstElementChild,n=getComputedStyle(r),i=r.offsetWidth+parseFloat(n.marginRight)+parseFloat(n.marginLeft),o=r.offsetHeight+parseFloat(n.marginTop)+parseFloat(n.marginBottom);this.thumbSize_=[i,o],t>e?(this.direction_=NE,this.widthLimit_=t-i):(this.direction_=AE,this.heightLimit_=e-o),this.sliderInitialized_=!0},t.prototype.handleContainerClick_=function(o){var t=this.getMap().getView(),e=this.getRelativePosition_(o.offsetX-this.thumbSize_[0]/2,o.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(e),n=t.getConstrainedZoom(t.getZoomForResolution(r));t.animateInternal({zoom:n,duration:this.duration_,easing:Ei})},t.prototype.handleDraggerStart_=function(o){if(!this.dragging_&&o.target===this.element.firstElementChild){var t=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=o.clientX-parseFloat(t.style.left),this.startY_=o.clientY-parseFloat(t.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var e=this.handleDraggerDrag_,r=this.handleDraggerEnd_;this.dragListenerKeys_.push(_(document,Vn,e,this),_(document,Wn,r,this))}}},t.prototype.handleDraggerDrag_=function(o){if(this.dragging_){var t=o.clientX-this.startX_,e=o.clientY-this.startY_,r=this.getRelativePosition_(t,e);this.currentResolution_=this.getResolutionForPosition_(r),this.getMap().getView().setResolution(this.currentResolution_)}},t.prototype.handleDraggerEnd_=function(){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(y),this.dragListenerKeys_.length=0)},t.prototype.setThumbPosition_=function(o){var t=this.getPositionForResolution_(o),e=this.element.firstElementChild;this.direction_==NE?e.style.left=this.widthLimit_*t+"px":e.style.top=this.heightLimit_*t+"px"},t.prototype.getRelativePosition_=function(o,t){return le(this.direction_===NE?o/this.widthLimit_:t/this.heightLimit_,0,1)},t.prototype.getResolutionForPosition_=function(e){return this.getMap().getView().getResolutionForValueFunction()(1-e)},t.prototype.getPositionForResolution_=function(e){return le(1-this.getMap().getView().getValueForResolutionFunction()(e),0,1)},t}(Po),DE=function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),kE=function(p){function t(t){var e=this,d=t||{};(e=p.call(this,{element:document.createElement("div"),target:d.target})||this).extent=d.extent?d.extent:null;var n=void 0===d.className?"ol-zoom-extent":d.className,i=void 0===d.label?"E":d.label,o=void 0===d.tipLabel?"Fit to extent":d.tipLabel,a=document.createElement("button");a.setAttribute("type","button"),a.title=o,a.appendChild("string"==typeof i?document.createTextNode(i):i),a.addEventListener(j,e.handleClick_.bind(e),!1);var s=e.element;return s.className=n+" ol-unselectable ol-control",s.appendChild(a),e}return DE(t,p),t.prototype.handleClick_=function(e){e.preventDefault(),this.handleZoomToExtent()},t.prototype.handleZoomToExtent=function(){var o=this.getMap().getView(),t=this.extent?this.extent:o.getProjection().getExtent();o.fitInternal(Hr(t))},t}(Po),UE={array:{},color:{},colorlike:{},control:{},coordinate:{},easing:{},events:{}};UE.events.condition={},UE.extent={},UE.featureloader={},UE.format={},UE.format.filter={},UE.geom={},UE.has={},UE.interaction={},UE.layer={},UE.loadingstrategy={},UE.proj={},UE.proj.Units={},UE.proj.proj4={},UE.render={},UE.render.canvas={},UE.renderer={},UE.renderer.canvas={},UE.renderer.webgl={},UE.size={},UE.source={},UE.sphere={},UE.style={},UE.style.IconImageCache={},UE.tilegrid={},UE.transform={},UE.util={},UE.webgl={},UE.xml={},UE.Collection=ot,UE.Feature=ut,UE.Geolocation=Pn,UE.Kinetic=Rn,UE.Map=$s,UE.Object=tt,UE.Observable=q,UE.Observable.unByKey=function(o){if(Array.isArray(o))for(var t=0,n=o.length;t<n;++t)y(o[t]);else y(o)},UE.Overlay=_u,UE.PluggableMap=Co,UE.View=Zi,UE.array.stableSort=function(o,a){var e=o.length,t=Array(o.length),n;for(n=0;n<e;n++)t[n]={index:n,value:o[n]};for(t.sort(function(e,t){return a(e.value,t.value)||e.index-t.index}),n=0;n<o.length;n++)o[n]=t[n].value},UE.color.asArray=Bi,UE.color.asString=zi,UE.colorlike.asColorLike=Wi,UE.control.Attribution=No,UE.control.Control=Po,UE.control.FullScreen=cE,UE.control.MousePosition=vE,UE.control.OverviewMap=SE,UE.control.Rotate=Do,UE.control.ScaleLine=LE,UE.control.Zoom=zo,UE.control.ZoomSlider=GE,UE.control.ZoomToExtent=kE,UE.control.defaults=ko,UE.coordinate.add=pn,UE.coordinate.createStringXY=function(o){return function(t){return mi(t,o)}},UE.coordinate.format=un,UE.coordinate.rotate=Qn,UE.coordinate.toStringHDMS=function(o,t){return o?_n("NS",o[1],t)+" "+_n("EW",o[0],t):""},UE.coordinate.toStringXY=mi,UE.easing.easeIn=Si,UE.easing.easeOut=Ei,UE.easing.inAndOut=wi,UE.easing.linear=Li,UE.easing.upAndDown=function(e){return .5>e?wi(2*e):1-wi(2*(e-.5))},UE.events.condition.altKeyOnly=Ho,UE.events.condition.altShiftKeysOnly=Jo,UE.events.condition.always=$o,UE.events.condition.click=function(e){return e.type==zn.CLICK},UE.events.condition.doubleClick=function(e){return e.type==zn.DBLCLICK},UE.events.condition.focus=Qo,UE.events.condition.mouseOnly=aa,UE.events.condition.never=ea,UE.events.condition.noModifierKeys=na,UE.events.condition.penOnly=function(o){var t=o.pointerEvent;return O(void 0!==t,56),"pen"===t.pointerType},UE.events.condition.platformModifierKeyOnly=function(o){var t=o.originalEvent;return!t.altKey&&(Gn?t.metaKey:t.ctrlKey)&&!t.shiftKey},UE.events.condition.pointerMove=function(e){return"pointermove"==e.type},UE.events.condition.primaryAction=sa,UE.events.condition.shiftKeyOnly=ia,UE.events.condition.singleClick=ra,UE.events.condition.targetNotEditable=oa,UE.events.condition.touchOnly=function(o){var t=o.pointerEvent;return O(void 0!==t,56),"touch"===t.pointerType},UE.extent.applyTransform=zt,UE.extent.boundingExtent=Y,UE.extent.buffer=V,UE.extent.containsCoordinate=pt,UE.extent.containsExtent=dt,UE.extent.containsXY=_t,UE.extent.createEmpty=ct,UE.extent.equals=xt,UE.extent.extend=St,UE.extent.getArea=wt,UE.extent.getBottomLeft=Lt,UE.extent.getBottomRight=It,UE.extent.getCenter=vt,UE.extent.getHeight=Ot,UE.extent.getIntersection=Mt,UE.extent.getSize=function(e){return[e[2]-e[0],e[3]-e[1]]},UE.extent.getTopLeft=Nt,UE.extent.getTopRight=At,UE.extent.getWidth=Gt,UE.extent.intersects=Dt,UE.extent.isEmpty=kt,UE.featureloader.setWithCredentials=function(e){gu=e},UE.featureloader.xhr=Oa,UE.format.EsriJSON=ng,UE.format.Feature=K_,UE.format.GML=Lg,UE.format.GML2=Gg,UE.format.GML3=Ig,UE.format.GML32=Dg,UE.format.GPX=Wg,UE.format.GeoJSON=Ey,UE.format.IGC=Uy,UE.format.IIIFInfo=Ec,UE.format.KML=yx,UE.format.MVT=Ym,UE.format.OSMXML=Qm,UE.format.Polyline=ix,UE.format.Polyline.decodeDeltas=Sc,UE.format.Polyline.decodeFloats=bc,UE.format.Polyline.encodeDeltas=xc,UE.format.Polyline.encodeFloats=Lc,UE.format.TopoJSON=cx,UE.format.WFS=fT,UE.format.WFS.writeFilter=function(o){var t=Ss(yT,"Filter");return fy(t,o,[]),t},UE.format.WKT=MT,UE.format.WMSCapabilities=oS,UE.format.WMSGetFeatureInfo=PS,UE.format.WMTSCapabilities=HS,UE.format.filter.Bbox=Cx,UE.format.filter.Contains=Ox,UE.format.filter.During=Mx,UE.format.filter.EqualTo=jx,UE.format.filter.GreaterThan=kx,UE.format.filter.GreaterThanOrEqualTo=zx,UE.format.filter.Intersects=Yx,UE.format.filter.IsBetween=Xx,UE.format.filter.IsLike=Zx,UE.format.filter.IsNull=qx,UE.format.filter.LessThan=Jx,UE.format.filter.LessThanOrEqualTo=$x,UE.format.filter.Not=tT,UE.format.filter.NotEqualTo=rT,UE.format.filter.Or=iT,UE.format.filter.Within=sT,UE.format.filter.and=_y,UE.format.filter.bbox=gy,UE.format.filter.between=function(o,t,e){return new Xx(o,t,e)},UE.format.filter.contains=function(o,t,e){return new Ox(o,t,e)},UE.format.filter.during=function(o,t,e){return new Mx(o,t,e)},UE.format.filter.equalTo=function(o,t,e){return new jx(o,t,e)},UE.format.filter.greaterThan=function(o,t){return new kx(o,t)},UE.format.filter.greaterThanOrEqualTo=function(o,t){return new zx(o,t)},UE.format.filter.intersects=function(o,t,e){return new Yx(o,t,e)},UE.format.filter.isNull=function(e){return new qx(e)},UE.format.filter.lessThan=function(o,t){return new Jx(o,t)},UE.format.filter.lessThanOrEqualTo=function(o,t){return new $x(o,t)},UE.format.filter.like=function(a,t,e,r,n,i){return new Zx(a,t,e,r,n,i)},UE.format.filter.not=function(e){return new tT(e)},UE.format.filter.notEqualTo=function(o,t,e){return new rT(o,t,e)},UE.format.filter.or=function(){var t=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(iT,t))},UE.format.filter.within=function(o,t,e){return new sT(o,t,e)},UE.geom.Circle=Kd,UE.geom.Geometry=Sr,UE.geom.GeometryCollection=W_,UE.geom.LineString=Sd,UE.geom.LinearRing=Xr,UE.geom.MultiLineString=Hd,UE.geom.MultiPoint=Qd,UE.geom.MultiPolygon=e_,UE.geom.Point=Zr,UE.geom.Polygon=hn,UE.geom.Polygon.circular=Vr,UE.geom.Polygon.fromCircle=qr,UE.geom.Polygon.fromExtent=Hr,UE.geom.SimpleGeometry=Tr,UE.has.DEVICE_PIXEL_RATIO=jn,UE.interaction.DoubleClickZoom=Ko,UE.interaction.DragAndDrop=zd,UE.interaction.DragBox=Ea,UE.interaction.DragPan=pa,UE.interaction.DragRotate=_a,UE.interaction.DragRotateAndZoom=Xd,UE.interaction.DragZoom=Ca,UE.interaction.Draw=c_,UE.interaction.Draw.createBox=function(){return function(s,t,e){var r=Y(s.map(function(o){return Xt(o,e)})),n=[[Lt(r),It(r),At(r),Nt(r),Lt(r)]],i=t;i?i.setCoordinates(n):i=new hn(n);var l=Yt();return l&&i.transform(e,l),i}},UE.interaction.Draw.createRegularPolygon=function(d,t){return function(e,r,n){var i=Xt(e[0],n),o=Xt(e[1],n),a=ee(ii(i,o)),s=r||qr(new Kd(i),d),_=t;if(!t){var g=o[0]-i[0],u=o[1]-i[1];_=ah(u/g)-(0>g?dh:0)}Jr(s,i,a,_);var c=Yt();return c&&s.transform(n,c),s}},UE.interaction.Extent=__,UE.interaction.Interaction=Xo,UE.interaction.KeyboardPan=Fa,UE.interaction.KeyboardZoom=Na,UE.interaction.Modify=C_,UE.interaction.MouseWheelZoom=ka,UE.interaction.PinchRotate=Ba,UE.interaction.PinchZoom=Va,UE.interaction.Pointer=la,UE.interaction.Select=M_,UE.interaction.Snap=D_,UE.interaction.Translate=V_,UE.interaction.defaults=Ui,UE.layer.Base=po,UE.layer.BaseImage=op,UE.layer.BaseTile=yp,UE.layer.BaseVector=wf,UE.layer.Graticule=Pd,UE.layer.Group=xo,UE.layer.Heatmap=Md,UE.layer.Image=fp,UE.layer.Layer=Fo,UE.layer.Tile=Sp,UE.layer.Vector=vd,UE.layer.VectorImage=Nd,UE.layer.VectorTile=jd,UE.loadingstrategy.all=Ma,UE.loadingstrategy.bbox=function(e){return[e]},UE.loadingstrategy.tile=function(s){return function(t,e){var r=s.getZForResolution(e),n=s.getTileRangeForExtentAndZ(t,r),i=[],o=[r,0,0];for(o[1]=n.minX;o[1]<=n.maxX;++o[1])for(o[2]=n.minY;o[2]<=n.maxY;++o[2])i.push(s.getTileCoordExtent(o));return i}},UE.proj.Projection=Te,UE.proj.Units.METERS_PER_UNIT=Se,UE.proj.addCoordinateTransforms=He,UE.proj.addEquivalentProjections=We,UE.proj.addProjection=Ye,UE.proj.equivalent=qe,UE.proj.fromLonLat=function(o,t){return $e(o,"EPSG:4326",void 0===t?"EPSG:3857":t)},UE.proj.get=Ve,UE.proj.getPointResolution=Xe,UE.proj.getTransform=Qe,UE.proj.proj4.register=function(p){var t=Object.keys(p.defs),n=t.length,i,d;for(i=0;i<n;++i){var _=t[i];if(!Ve(_)){var o=p.defs(_);Ye(new Te({code:_,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:o.units}))}}for(i=0;i<n;++i){var a=t[i],s=Ve(a);for(d=0;d<n;++d){var g=t[d],l=Ve(g);if(!Me(a,g))if(p.defs[a]===p.defs[g])We([s,l]);else{var u=p(a,g);He(s,l,u.forward,u.inverse)}}}},UE.proj.toLonLat=function(o,t){var e=$e(o,void 0===t?"EPSG:3857":t,"EPSG:4326"),r=e[0];return(-180>r||180<r)&&(e[0]=_e(r+180,360)-180),e},UE.proj.transform=$e,UE.proj.transformExtent=Bt,UE.render.VectorContext=ss,UE.render.canvas.labelCache=ps,UE.render.getRenderPixel=function(o,t){var e=t.slice(0);return Jt(o.inversePixelTransform.slice(),e),e},UE.render.getVectorContext=wa,UE.render.toContext=function(l,t){var e=l.canvas,r=t||{},n=r.pixelRatio||jn,i=r.size;i&&(e.width=i[0]*n,e.height=i[1]*n,e.style.width=i[0]+"px",e.style.height=i[1]+"px");var o=[0,0,e.width,e.height],a=Qt([1,0,0,1,0,0],n,n);return new Rs(l,n,o,a,0)},UE.renderer.Composite=Js,UE.renderer.canvas.ImageLayer=cp,UE.renderer.canvas.TileLayer=xp,UE.renderer.canvas.VectorImageLayer=ld,UE.renderer.canvas.VectorLayer=sd,UE.renderer.canvas.VectorTileLayer=gd,UE.renderer.webgl.PointsLayer=Ef,UE.size.toSize=Eo,UE.source.BingMaps=Zh,UE.source.CartoDB=Jh,UE.source.Cluster=lc,UE.source.IIIF=Cc,UE.source.Image=Ac,UE.source.ImageArcGISRest=Dc,UE.source.ImageCanvas=Bc,UE.source.ImageMapGuide=Vc,UE.source.ImageStatic=Wc,UE.source.ImageWMS=$c,UE.source.OSM=rp,UE.source.OSM.ATTRIBUTION=ep,UE.source.Raster=Op,UE.source.Source=Fh,UE.source.Stamen=Dp,UE.source.Tile=jh,UE.source.TileArcGISRest=Up,UE.source.TileDebug=Vp,UE.source.TileImage=Vh,UE.source.TileJSON=Wp,UE.source.TileWMS=Kp,UE.source.UTFGrid=Qp,UE.source.Vector=sc,UE.source.VectorTile=af,UE.source.WMTS=cf,UE.source.WMTS.optionsFromCapabilities=function(C,P){var e=U(C.Contents.Layer,function(e){return e.Identifier==P.layer});if(null===e)return null;var r=C.Contents.TileMatrixSet,t;0>(t=1<e.TileMatrixSetLink.length?z(e.TileMatrixSetLink,"projection"in P?function(n){var e=U(r,function(t){return t.Identifier==n.TileMatrixSet}).SupportedCRS,t=Ve(e.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||Ve(e),o=Ve(P.projection);return t&&o?qe(t,o):e==P.projection}:function(e){return e.TileMatrixSet==P.matrixSet}):0)&&(t=0);var i=e.TileMatrixSetLink[t].TileMatrixSet,o=e.TileMatrixSetLink[t].TileMatrixSetLimits,a=e.Format[0];"format"in P&&(a=P.format),0>(t=z(e.Style,function(e){return"style"in P?e.Title==P.style:e.isDefault}))&&(t=0);var w=e.Style[t].Identifier,u={};"Dimension"in e&&e.Dimension.forEach(function(e){var t=e.Identifier,o=e.Default;void 0===o&&(o=e.Value[0]),u[t]=o});var l=U(C.Contents.TileMatrixSet,function(e){return e.Identifier==i}),c=l.SupportedCRS,p;if(c&&(p=Ve(c.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||Ve(c)),"projection"in P){var L=Ve(P.projection);L&&(p&&!qe(L,p)||(p=L))}var f=l.TileMatrix[0],d=28e-5*f.ScaleDenominator,_=p===Ve("EPSG:4326")?[f.TopLeftCorner[1],f.TopLeftCorner[0]]:f.TopLeftCorner,g=f.TileWidth*d,y=f.TileHeight*d,I=[_[0],_[1]-y*f.MatrixHeight,_[0]+g*f.MatrixWidth,_[1]];null===p.getExtent()&&p.setExtent(I);var m=cl(l,I,o),v=[],S=P.requestEncoding;if(S=void 0===S?"":S,"OperationsMetadata"in C&&"GetTile"in C.OperationsMetadata)for(var F=C.OperationsMetadata.GetTile.DCP.HTTP.Get,T=0,M=F.length;T<M;++T)if(F[T].Constraint){var R=U(F[T].Constraint,function(e){return"GetEncoding"==e.name}).AllowedValues.Value;if(""===S&&(S=R[0]),S!==sf)break;x(R,sf)&&v.push(F[T].href)}else F[T].href&&(S=sf,v.push(F[T].href));return 0===v.length&&(S="REST",e.ResourceURL.forEach(function(e){"tile"===e.resourceType&&(a=e.format,v.push(e.template))})),{urls:v,layer:P.layer,matrixSet:i,format:a,projection:p,requestEncoding:S,tileGrid:m,style:w,dimensions:u,wrapX:!1,crossOrigin:P.crossOrigin}},UE.source.XYZ=qh,UE.source.Zoomify=dc,UE.sphere.getArea=function _(t,g){var r=g||{},n=r.radius||6371008.8,i=r.projection||"EPSG:3857",o=t.getType();o!==oe.GEOMETRY_COLLECTION&&(t=t.clone().transform(i,"EPSG:4326"));var a=0,y,m,x,S,E,T;switch(o){case oe.POINT:case oe.MULTI_POINT:case oe.LINE_STRING:case oe.MULTI_LINE_STRING:case oe.LINEAR_RING:break;case oe.POLYGON:for(y=t.getCoordinates(),a=P(me(y[0],n)),x=1,S=y.length;x<S;++x)a-=P(me(y[x],n));break;case oe.MULTI_POLYGON:for(x=0,S=(y=t.getCoordinates()).length;x<S;++x)for(m=y[x],a+=P(me(m[0],n)),E=1,T=m.length;E<T;++E)a-=P(me(m[E],n));break;case oe.GEOMETRY_COLLECTION:var C=t.getGeometries();for(x=0,S=C.length;x<S;++x)a+=_(C[x],g);break;default:throw new Error("Unsupported geometry type: "+o);}return a},UE.sphere.getDistance=ye,UE.sphere.getLength=function _(t,g){var r=g||{},y=r.radius||6371008.8,i=r.projection||"EPSG:3857",o=t.getType();o!==oe.GEOMETRY_COLLECTION&&(t=t.clone().transform(i,"EPSG:4326"));var a=0,m,x,S,E,T,C;switch(o){case oe.POINT:case oe.MULTI_POINT:break;case oe.LINE_STRING:case oe.LINEAR_RING:a=n(m=t.getCoordinates(),y);break;case oe.MULTI_LINE_STRING:case oe.POLYGON:for(S=0,E=(m=t.getCoordinates()).length;S<E;++S)a+=n(m[S],y);break;case oe.MULTI_POLYGON:for(S=0,E=(m=t.getCoordinates()).length;S<E;++S)for(T=0,C=(x=m[S]).length;T<C;++T)a+=n(x[T],y);break;case oe.GEOMETRY_COLLECTION:var P=t.getGeometries();for(S=0,E=P.length;S<E;++S)a+=_(P[S],g);break;default:throw new Error("Unsupported geometry type: "+o);}return a},UE.style.Circle=kl,UE.style.Fill=Ul,UE.style.Icon=eh,UE.style.IconImageCache.shared=os,UE.style.Image=Ml,UE.style.RegularShape=jl,UE.style.Stroke=rh,UE.style.Style=Vf,UE.style.Text=lh,UE.tilegrid.TileGrid=Mu,UE.tilegrid.WMTS=Fl,UE.tilegrid.WMTS.createFromCapabilitiesMatrixSet=cl,UE.tilegrid.createXYZ=rs,UE.transform.composeCssTransform=function(s,t,e,r,n,i,o){return tr($t([1,0,0,1,0,0],s,t,e,r,n,i,o))},UE.util.getUid=X,UE.webgl.ARRAY_BUFFER=34962,UE.webgl.Buffer=kf,UE.webgl.DYNAMIC_DRAW=35048,UE.webgl.ELEMENT_ARRAY_BUFFER=34963,UE.webgl.Helper=bl,UE.webgl.Helper.computeAttributesStride=pl,UE.webgl.PostProcessingPass=gl,UE.webgl.RenderTarget=Il,UE.webgl.STATIC_DRAW=35044,UE.webgl.STREAM_DRAW=35040,UE.xml.getAllTextContent=Es,UE.xml.parse=Cs,UE.xml.registerDocument=function(e){ff=e},UE.xml.registerXMLSerializer=function(e){rl=e},t.default=UE}]).default});